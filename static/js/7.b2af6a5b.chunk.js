(this.webpackJsonpdisc=this.webpackJsonpdisc||[]).push([[7],{171:function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n=r(1),i=r(5);function c(e,t){i.a.setState({isCameraEnabled:t});var r=Object(n.useCallback)((function(){var t;return null===(t=e.current)||void 0===t?void 0:t.play()}),[e]),c=Object(n.useCallback)((function(){var t;return null===(t=e.current)||void 0===t?void 0:t.pause()}),[e]),u=Object(n.useCallback)((function(){e.current&&(e.current.currentTime=0)}),[e]),a=Object(n.useCallback)((function(){return!!e.current&&!!(e.current.currentTime>0&&!e.current.paused&&!e.current.ended&&e.current.readyState>2)}),[e]),o=Object(n.useCallback)((function(){return e.current?e.current.currentTime/e.current.duration:0}),[e]),s=Object(n.useCallback)((function(t){e.current&&(e.current.currentTime=t*e.current.duration)}),[e]),l=Object(n.useCallback)((function(t){if(e.current){var r=e.current.currentTime+t,n=Math.min(Math.max(0,r),e.current.duration);e.current.currentTime=n}}),[e]),d=Object(n.useCallback)((function(){return a()?c():r()}),[a,c,r]);Object(n.useEffect)((function(){var t,n,f,b,h=function(){return i.a.setState({chapter:{play:r,pause:c,rewind:u,getIsPlaying:a,getProgress:o,setProgress:s,seekTimeDelta:l,progress:o(),intention:a()?"PLAY":"PAUSE"}})},v=e.current;return null===(t=e.current)||void 0===t||t.addEventListener("click",d),null===(n=e.current)||void 0===n||n.addEventListener("playing",h),null===(f=e.current)||void 0===f||f.addEventListener("pause",h),null===(b=e.current)||void 0===b||b.addEventListener("timeupdate",h),h(),function(){null===v||void 0===v||v.removeEventListener("click",d),null===v||void 0===v||v.removeEventListener("play",h),null===v||void 0===v||v.removeEventListener("pause",h),null===v||void 0===v||v.removeEventListener("timeupdate",h),i.a.setState({chapter:void 0})}}),[a,c,r,o,u,s,l,e,d])}},214:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(13),i=r.n(n),c=r(20),u=r(1),a=function(e,t){var r=Object(u.useRef)(),n=Object(u.useRef)(),a=Object(u.useRef)(Date.now()),o=1e3/e,s=Object(u.useCallback)(function(){var e=Object(c.a)(i.a.mark((function e(c){var u;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u=c-a.current,e.next=3,new Promise((function(e){return e(t(u))}));case 3:a.current=c,n.current=setTimeout((function(){r.current=requestAnimationFrame(s)}),o);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,o]);Object(u.useEffect)((function(){return n.current=setTimeout((function(){r.current=requestAnimationFrame(s)}),o),function(){r.current&&cancelAnimationFrame(r.current),n.current&&clearTimeout(n.current)}}),[s,o])}},414:function(e,t){},415:function(e,t){},442:function(e,t){},505:function(e,t,r){"use strict";r.r(t),r.d(t,"default",(function(){return g}));var n=r(13),i=r.n(n),c=r(20),u=r(12),a=r(499),o=(r(498),r(26)),s=r(1),l=r(500),d=r(259),f=r(260),b=r(171),h=r(5),v=r.p+"static/media/p2.2bd44c1d.mp4";var j=r(214),p=r(0);function m(e){var t=Object(l.b)().size;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("points",{scale:[t.width,t.height,1],position:[-t.width/2,t.height/2,-5],frustumCulled:!1,children:[Object(p.jsx)("bufferGeometry",{ref:e.geometry}),Object(p.jsx)("pointsMaterial",{color:"red",size:10})]})})}function O(e){var t=Object(l.b)().size;return Object(p.jsx)("group",{position:[-t.width/2,t.height/2,-6],scale:[t.width,t.height,1],children:Object(p.jsxs)("mesh",{ref:e.rectRef,frustumCulled:!1,children:[Object(p.jsx)("planeBufferGeometry",{}),Object(p.jsx)("meshNormalMaterial",{color:"red",transparent:!0,opacity:.1})]})})}function g(){var e=Object(s.useRef)(null),t=Object(s.useRef)(),r=Object(s.useRef)(null),n=Object(s.useRef)(null),g=Object(s.useState)([window.innerWidth,window.innerHeight]),x=Object(u.a)(g,2),w=Object(u.a)(x[0],2),k=w[0],y=w[1],E=x[1];Object(b.a)(e,!0);var T=Object(h.b)((function(e){return e.webcamStream})),S=function(e,t,r){var n=Object(s.useState)(r),i=Object(u.a)(n,2),c=i[0],a=i[1];return Object(s.useEffect)((function(){var t=!1,r=e();if(void 0!==r&&null!==r)return r.then((function(e){t||a(e)})),function(){t=!0}}),t),c}(Object(c.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a.b(a.a.mediapipeFacemesh,{shouldLoadIrisModel:!1,maxFaces:1});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),[],void 0),A=Object(f.a)({ref:e}),C=A.width,L=A.height;return Object(s.useEffect)((function(){if(T&&r.current){var e=r.current;e.srcObject=T,e.play();var t=T.getVideoTracks()[0];e.width=t.getSettings().width,e.height=t.getSettings().height}}),[T]),Object(s.useEffect)((function(){if(T&&r.current&&C&&L){var e=r.current,t=e.width/e.height,n=Math.min(C,L*t),i=Math.min(C/t,L);E([n,i])}}),[L,C,T]),Object(j.a)(60,Object(c.a)(i.a.mark((function e(){var c,a,o,s,l,f,b,h,v,j,p,m,O,g,x;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(T&&r.current&&S&&t.current){e.next=2;break}return e.abrupt("return");case 2:if(!((f=r.current).readyState<HTMLMediaElement.HAVE_METADATA)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,S.estimateFaces({input:r.current,returnTensors:!1,flipHorizontal:!1,predictIrises:!1});case 7:if(!((null===(b=e.sent)||void 0===b?void 0:b.length)<=0)){e.next=10;break}return e.abrupt("return");case 10:h=b[0].scaledMesh,v=b[0].boundingBox.topLeft,j=b[0].boundingBox.bottomRight,p=h.flatMap((function(e,t){var r=Object(u.a)(e,2),n=r[0],i=r[1];return[n/f.videoWidth,-i/f.videoHeight,0]})),null===(c=n.current)||void 0===c||c.setAttribute("position",new d.BufferAttribute(new Float32Array(p),3)),m=(v[0]+j[0])/2,O=(v[1]+j[1])/2,g=j[0]-v[0],x=j[1]-v[1],null===(a=t.current)||void 0===a||a.scale.setX(g/f.videoWidth),null===(o=t.current)||void 0===o||o.scale.setY(x/f.videoHeight),null===(s=t.current)||void 0===s||s.position.setX(m/f.videoWidth),null===(l=t.current)||void 0===l||l.position.setY(-O/f.videoHeight);case 23:case"end":return e.stop()}}),e)})))),Object(p.jsxs)(o.a,{style:{position:"relative",width:"100%",height:"100%"},align:"center",children:[Object(p.jsx)("video",{style:{position:"absolute",top:0,boxSizing:"border-box",outline:"none",width:"100%",height:"100%"},ref:r,hidden:!0}),Object(p.jsxs)(l.a,{style:{position:"absolute",width:k+"px",height:y+"px",top:"50%",transform:"translateY(-50%)"},orthographic:!0,children:[Object(p.jsx)(m,{geometry:n}),Object(p.jsx)(O,{rectRef:t})]}),Object(p.jsx)("video",{ref:e,style:{boxSizing:"border-box",outline:"none",width:"100%",height:"100%"},width:"100%",height:"100%",src:v})]})}}}]);
//# sourceMappingURL=7.b2af6a5b.chunk.js.map