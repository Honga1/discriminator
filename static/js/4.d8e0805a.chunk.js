/*! For license information please see 4.d8e0805a.chunk.js.LICENSE.txt */
(this.webpackJsonpdisc=this.webpackJsonpdisc||[]).push([[4],Array(142).concat([function(e,t,n){"use strict";n.d(t,"Qc",(function(){return ce.a})),n.d(t,"Rc",(function(){return ce.b})),n.d(t,"Ed",(function(){return ut.a})),n.d(t,"Kd",(function(){return ut.b})),n.d(t,"bd",(function(){return lt.a})),n.d(t,"ed",(function(){return lt.b})),n.d(t,"fd",(function(){return lt.c})),n.d(t,"gd",(function(){return lt.d})),n.d(t,"hd",(function(){return lt.e})),n.d(t,"id",(function(){return lt.f})),n.d(t,"kd",(function(){return lt.g})),n.d(t,"nd",(function(){return lt.h})),n.d(t,"td",(function(){return lt.k})),n.d(t,"wd",(function(){return lt.l})),n.d(t,"xd",(function(){return lt.m})),n.d(t,"yd",(function(){return lt.n})),n.d(t,"zd",(function(){return lt.o})),n.d(t,"Bd",(function(){return lt.p})),n.d(t,"Cd",(function(){return lt.q})),n.d(t,"Dd",(function(){return lt.r})),n.d(t,"Fd",(function(){return lt.s})),n.d(t,"Gd",(function(){return lt.t})),n.d(t,"Hd",(function(){return lt.u})),n.d(t,"Jd",(function(){return lt.v})),n.d(t,"Md",(function(){return lt.w})),n.d(t,"pd",(function(){return lt.j})),n.d(t,"ld",(function(){return dt.b})),n.d(t,"Id",(function(){return dt.f})),n.d(t,"rd",(function(){return dt.d})),n.d(t,"od",(function(){return dt.c})),n.d(t,"ud",(function(){return dt.e})),n.d(t,"vd",(function(){return Le.d})),n.d(t,"md",(function(){return h.b})),n.d(t,"dd",(function(){return a})),n.d(t,"qd",(function(){return r})),n.d(t,"Ld",(function(){return ct})),n.d(t,"cd",(function(){return s})),n.d(t,"Ad",(function(){return i})),n.d(t,"jd",(function(){return Zt})),n.d(t,"sd",(function(){return c})),n.d(t,"tb",(function(){return tn.b})),n.d(t,"L",(function(){return tn.a})),n.d(t,"a",(function(){return Be.a})),n.d(t,"b",(function(){return Be.b})),n.d(t,"c",(function(){return Be.c})),n.d(t,"d",(function(){return Be.d})),n.d(t,"e",(function(){return Be.e})),n.d(t,"f",(function(){return Be.f})),n.d(t,"g",(function(){return Be.g})),n.d(t,"h",(function(){return Be.h})),n.d(t,"i",(function(){return Be.i})),n.d(t,"j",(function(){return Be.j})),n.d(t,"k",(function(){return Be.k})),n.d(t,"l",(function(){return Be.l})),n.d(t,"n",(function(){return Be.n})),n.d(t,"m",(function(){return Be.m})),n.d(t,"o",(function(){return Be.o})),n.d(t,"r",(function(){return Be.r})),n.d(t,"p",(function(){return Be.p})),n.d(t,"q",(function(){return Be.q})),n.d(t,"s",(function(){return Be.s})),n.d(t,"t",(function(){return Be.t})),n.d(t,"u",(function(){return Be.u})),n.d(t,"v",(function(){return Be.v})),n.d(t,"w",(function(){return Be.w})),n.d(t,"x",(function(){return Be.x})),n.d(t,"y",(function(){return Be.y})),n.d(t,"z",(function(){return Be.z})),n.d(t,"A",(function(){return Be.A})),n.d(t,"B",(function(){return Be.B})),n.d(t,"C",(function(){return Be.C})),n.d(t,"D",(function(){return Be.D})),n.d(t,"E",(function(){return Be.E})),n.d(t,"F",(function(){return Be.F})),n.d(t,"G",(function(){return Be.G})),n.d(t,"H",(function(){return Be.H})),n.d(t,"I",(function(){return Be.I})),n.d(t,"K",(function(){return Be.K})),n.d(t,"J",(function(){return Be.J})),n.d(t,"M",(function(){return Be.L})),n.d(t,"N",(function(){return Be.M})),n.d(t,"O",(function(){return Be.N})),n.d(t,"P",(function(){return Be.O})),n.d(t,"Q",(function(){return Be.P})),n.d(t,"R",(function(){return Be.Q})),n.d(t,"S",(function(){return Be.R})),n.d(t,"hc",(function(){return Be.fc})),n.d(t,"T",(function(){return Be.S})),n.d(t,"U",(function(){return Be.T})),n.d(t,"W",(function(){return Be.V})),n.d(t,"V",(function(){return Be.U})),n.d(t,"X",(function(){return Be.W})),n.d(t,"Y",(function(){return Be.X})),n.d(t,"Z",(function(){return Be.Y})),n.d(t,"ab",(function(){return Be.Z})),n.d(t,"bb",(function(){return Be.ab})),n.d(t,"cb",(function(){return Be.bb})),n.d(t,"db",(function(){return Be.cb})),n.d(t,"eb",(function(){return Be.db})),n.d(t,"gb",(function(){return Be.fb})),n.d(t,"kb",(function(){return Be.jb})),n.d(t,"jb",(function(){return Be.ib})),n.d(t,"lb",(function(){return Be.kb})),n.d(t,"mb",(function(){return Be.lb})),n.d(t,"ob",(function(){return Be.nb})),n.d(t,"nb",(function(){return Be.mb})),n.d(t,"pb",(function(){return Be.ob})),n.d(t,"qb",(function(){return Be.pb})),n.d(t,"rb",(function(){return Be.qb})),n.d(t,"sb",(function(){return Be.rb})),n.d(t,"wb",(function(){return Be.ub})),n.d(t,"xb",(function(){return Be.vb})),n.d(t,"yb",(function(){return Be.wb})),n.d(t,"zb",(function(){return Be.xb})),n.d(t,"Ab",(function(){return Be.yb})),n.d(t,"Bb",(function(){return Be.zb})),n.d(t,"Cb",(function(){return Be.Ab})),n.d(t,"Db",(function(){return Be.Bb})),n.d(t,"Eb",(function(){return Be.Cb})),n.d(t,"ub",(function(){return Be.sb})),n.d(t,"vb",(function(){return Be.tb})),n.d(t,"Fb",(function(){return Be.Db})),n.d(t,"Lb",(function(){return Be.Jb})),n.d(t,"Gb",(function(){return Be.Eb})),n.d(t,"Jb",(function(){return Be.Hb})),n.d(t,"Hb",(function(){return Be.Fb})),n.d(t,"Ib",(function(){return Be.Gb})),n.d(t,"Kb",(function(){return Be.Ib})),n.d(t,"Mb",(function(){return Be.Kb})),n.d(t,"Nb",(function(){return Be.Lb})),n.d(t,"Ob",(function(){return Be.Mb})),n.d(t,"Pb",(function(){return Be.Nb})),n.d(t,"Qb",(function(){return Be.Ob})),n.d(t,"Rb",(function(){return Be.Pb})),n.d(t,"Sb",(function(){return Be.Qb})),n.d(t,"Tb",(function(){return Be.Rb})),n.d(t,"Xb",(function(){return Be.Vb})),n.d(t,"Ub",(function(){return Be.Sb})),n.d(t,"Vb",(function(){return Be.Tb})),n.d(t,"Wb",(function(){return Be.Ub})),n.d(t,"Zb",(function(){return Be.Xb})),n.d(t,"Yb",(function(){return Be.Wb})),n.d(t,"ac",(function(){return Be.Yb})),n.d(t,"bc",(function(){return Be.Zb})),n.d(t,"cc",(function(){return Be.ac})),n.d(t,"dc",(function(){return Be.bc})),n.d(t,"ec",(function(){return Be.cc})),n.d(t,"fc",(function(){return Be.dc})),n.d(t,"gc",(function(){return Be.ec})),n.d(t,"ic",(function(){return Be.gc})),n.d(t,"jc",(function(){return Be.hc})),n.d(t,"lc",(function(){return Be.jc})),n.d(t,"oc",(function(){return Be.mc})),n.d(t,"pc",(function(){return Be.nc})),n.d(t,"mc",(function(){return Be.kc})),n.d(t,"nc",(function(){return Be.lc})),n.d(t,"kc",(function(){return Be.ic})),n.d(t,"qc",(function(){return Be.oc})),n.d(t,"sc",(function(){return Be.qc})),n.d(t,"tc",(function(){return Be.rc})),n.d(t,"uc",(function(){return Be.sc})),n.d(t,"vc",(function(){return Be.tc})),n.d(t,"wc",(function(){return Be.uc})),n.d(t,"Bc",(function(){return Be.zc})),n.d(t,"zc",(function(){return Be.xc})),n.d(t,"Ac",(function(){return Be.yc})),n.d(t,"yc",(function(){return Be.wc})),n.d(t,"xc",(function(){return Be.vc})),n.d(t,"Dc",(function(){return Be.Bc})),n.d(t,"Hc",(function(){return Be.Fc})),n.d(t,"Nc",(function(){return Be.Lc})),n.d(t,"Ec",(function(){return Be.Cc})),n.d(t,"Gc",(function(){return Be.Ec})),n.d(t,"Cc",(function(){return Be.Ac})),n.d(t,"Jc",(function(){return Be.Hc})),n.d(t,"Ic",(function(){return Be.Gc})),n.d(t,"Mc",(function(){return Be.Kc})),n.d(t,"Fc",(function(){return Be.Dc})),n.d(t,"Lc",(function(){return Be.Jc})),n.d(t,"Oc",(function(){return Be.Mc})),n.d(t,"Pc",(function(){return Be.Nc})),n.d(t,"Sc",(function(){return Be.Oc})),n.d(t,"Tc",(function(){return Be.Pc})),n.d(t,"Uc",(function(){return Be.Qc})),n.d(t,"Vc",(function(){return Be.Rc})),n.d(t,"Wc",(function(){return Be.Sc})),n.d(t,"Xc",(function(){return Be.Tc})),n.d(t,"Yc",(function(){return Be.Uc})),n.d(t,"Zc",(function(){return Be.Vc})),n.d(t,"Kc",(function(){return Be.Ic})),n.d(t,"fb",(function(){return Be.eb})),n.d(t,"rc",(function(){return Be.pc})),n.d(t,"ad",(function(){return Be.Wc})),n.d(t,"hb",(function(){return Be.gb})),n.d(t,"ib",(function(){return Be.hb}));var r={};n.r(r),n.d(r,"copyModel",(function(){return $})),n.d(r,"listModels",(function(){return q})),n.d(r,"moveModel",(function(){return te})),n.d(r,"removeModel",(function(){return Q})),n.d(r,"browserFiles",(function(){return pe})),n.d(r,"browserHTTPRequest",(function(){return Te})),n.d(r,"concatenateArrayBuffers",(function(){return g.d})),n.d(r,"decodeWeights",(function(){return g.e})),n.d(r,"encodeWeights",(function(){return g.f})),n.d(r,"fromMemory",(function(){return Re})),n.d(r,"getLoadHandlers",(function(){return O})),n.d(r,"getModelArtifactsInfoForJSON",(function(){return g.g})),n.d(r,"getSaveHandlers",(function(){return w})),n.d(r,"http",(function(){return Ce})),n.d(r,"isHTTPScheme",(function(){return Ee})),n.d(r,"loadWeights",(function(){return xe})),n.d(r,"registerLoadRouter",(function(){return x})),n.d(r,"registerSaveRouter",(function(){return y})),n.d(r,"weightsLoaderFactory",(function(){return Oe})),n.d(r,"withSaveHandler",(function(){return Ie}));var a={};n.r(a),n.d(a,"fromPixelsAsync",(function(){return Ue})),n.d(a,"toPixels",(function(){return He})),n.d(a,"fromPixels",(function(){return We}));var i={};n.r(i),n.d(i,"assertParamsValid",(function(){return Je})),n.d(i,"maskToAxes",(function(){return Xe})),n.d(i,"computeOutShape",(function(){return Ke})),n.d(i,"stridesWithElidedDims",(function(){return qe})),n.d(i,"getNormalizedAxes",(function(){return Ze})),n.d(i,"startIndicesWithElidedDims",(function(){return $e})),n.d(i,"stopIndicesWithElidedDims",(function(){return et})),n.d(i,"stridesForAxis",(function(){return tt})),n.d(i,"startForAxis",(function(){return nt})),n.d(i,"stopForAxis",(function(){return rt})),n.d(i,"isSliceContinous",(function(){return at})),n.d(i,"computeFlatOffset",(function(){return it})),n.d(i,"parseSliceParams",(function(){return ot})),n.d(i,"sliceInfo",(function(){return st}));var o={};n.r(o),n.d(o,"segOpComputeOptimalWindowSize",(function(){return Xt})),n.d(o,"computeOutShape",(function(){return Kt})),n.d(o,"collectGatherOpShapeInfo",(function(){return qt}));var s={};n.r(s),n.d(s,"axesAreInnerMostDims",(function(){return ht.b})),n.d(s,"combineLocations",(function(){return ht.c})),n.d(s,"computeOutAndReduceShapes",(function(){return ht.d})),n.d(s,"expandShapeToKeepDim",(function(){return ht.e})),n.d(s,"assertAxesAreInnerMostDims",(function(){return ht.a})),n.d(s,"getAxesPermutation",(function(){return ht.f})),n.d(s,"getUndoAxesPermutation",(function(){return ht.h})),n.d(s,"getInnerMostAxes",(function(){return ht.g})),n.d(s,"getBroadcastDims",(function(){return ft.b})),n.d(s,"getReductionAxes",(function(){return ft.c})),n.d(s,"assertAndGetBroadcastShape",(function(){return ft.a})),n.d(s,"assertParamsConsistent",(function(){return pt})),n.d(s,"computeOutShape",(function(){return mt})),n.d(s,"computeDilation2DInfo",(function(){return vt.d})),n.d(s,"computePool2DInfo",(function(){return vt.e})),n.d(s,"computePool3DInfo",(function(){return vt.f})),n.d(s,"computeConv2DInfo",(function(){return vt.a})),n.d(s,"computeConv3DInfo",(function(){return vt.b})),n.d(s,"computeDefaultPad",(function(){return vt.c})),n.d(s,"tupleValuesAreOne",(function(){return vt.i})),n.d(s,"eitherStridesOrDilationsAreOne",(function(){return vt.h})),n.d(s,"convertConv2DDataFormat",(function(){return vt.g})),n.d(s,"getFusedDyActivation",(function(){return gt.c})),n.d(s,"getFusedBiasGradient",(function(){return gt.b})),n.d(s,"applyActivation",(function(){return gt.a})),n.d(s,"shouldFuse",(function(){return gt.d})),n.d(s,"PARALLELIZE_THRESHOLD",(function(){return bt})),n.d(s,"computeOptimalWindowSize",(function(){return yt})),n.d(s,"slice_util",(function(){return i})),n.d(s,"upcastType",(function(){return ut.b})),n.d(s,"getImageCenter",(function(){return xt})),n.d(s,"getReshaped",(function(){return wt})),n.d(s,"getPermuted",(function(){return Ot})),n.d(s,"getReshapedPermuted",(function(){return At})),n.d(s,"getSliceBeginCoords",(function(){return _t})),n.d(s,"getSliceSize",(function(){return Et})),n.d(s,"prepareAndValidate",(function(){return St})),n.d(s,"validateUpdateShape",(function(){return Ct.c})),n.d(s,"validateInput",(function(){return Ct.b})),n.d(s,"calculateShapes",(function(){return Ct.a})),n.d(s,"SELU_SCALEALPHA",(function(){return Tt})),n.d(s,"SELU_SCALE",(function(){return Mt})),n.d(s,"ERF_P",(function(){return kt})),n.d(s,"ERF_A1",(function(){return Rt})),n.d(s,"ERF_A2",(function(){return It})),n.d(s,"ERF_A3",(function(){return jt})),n.d(s,"ERF_A4",(function(){return Bt})),n.d(s,"ERF_A5",(function(){return Lt})),n.d(s,"warn",(function(){return Nt})),n.d(s,"log",(function(){return Dt})),n.d(s,"mergeRealAndImagArrays",(function(){return Pt})),n.d(s,"splitRealAndImagArrays",(function(){return Ft})),n.d(s,"complexWithEvenIndex",(function(){return Gt})),n.d(s,"complexWithOddIndex",(function(){return Ut})),n.d(s,"getComplexWithIndex",(function(){return zt})),n.d(s,"assignToTypedArray",(function(){return Ht})),n.d(s,"exponents",(function(){return Vt})),n.d(s,"exponent",(function(){return Wt})),n.d(s,"prepareSplitSize",(function(){return Jt})),n.d(s,"segment_util",(function(){return o})),n.d(s,"fromUint8ToStringArray",(function(){return Yt})),n.d(s,"fromStringArrayToUint8",(function(){return Qt}));var c={};n.r(c),n.d(c,"nonMaxSuppressionV3Impl",(function(){return $t.a})),n.d(c,"nonMaxSuppressionV4Impl",(function(){return $t.b})),n.d(c,"nonMaxSuppressionV5Impl",(function(){return $t.c})),n.d(c,"whereImpl",(function(){return en.a}));var u=n(145),l=(n(190),n(147)),d=n(149),h=n(153),f=n(161),p=n(13),m=n.n(p),v=n(20),g=n(165),b=function(){function e(){Object(l.a)(this,e),this.saveRouters=[],this.loadRouters=[]}return Object(d.a)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerSaveRouter",value:function(t){e.getInstance().saveRouters.push(t)}},{key:"registerLoadRouter",value:function(t){e.getInstance().loadRouters.push(t)}},{key:"getSaveHandlers",value:function(t){return e.getHandlers(t,"save")}},{key:"getLoadHandlers",value:function(t,n){return e.getHandlers(t,"load",n)}},{key:"getHandlers",value:function(t,n,r){var a=[];return("load"===n?e.getInstance().loadRouters:e.getInstance().saveRouters).forEach((function(e){var n=e(t,r);null!==n&&a.push(n)})),a}}]),e}(),y=function(e){return b.registerSaveRouter(e)},x=function(e){return b.registerLoadRouter(e)},w=function(e){return b.getSaveHandlers(e)},O=function(e,t){return b.getLoadHandlers(e,t)},A="tensorflowjs",_="models_store",E="model_info_store";function S(){if(!Object(h.b)().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");var e="undefined"===typeof window?self:window,t=e.indexedDB||e.mozIndexedDB||e.webkitIndexedDB||e.msIndexedDB||e.shimIndexedDB;if(null==t)throw new Error("The current browser does not appear to support IndexedDB.");return t}function C(e){var t=e.result;t.createObjectStore(_,{keyPath:"modelPath"}),t.createObjectStore(E,{keyPath:"modelPath"})}var T=function(){function e(t){if(Object(l.a)(this,e),this.indexedDB=S(),null==t||!t)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=t}return Object(d.a)(e,[{key:"save",value:function(){var e=Object(v.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 2:return e.abrupt("return",this.databaseAction(this.modelPath,t));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(v.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.databaseAction(this.modelPath));case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"databaseAction",value:function(e,t){var n=this;return new Promise((function(e,r){var a=n.indexedDB.open(A,1);a.onupgradeneeded=function(){return C(a)},a.onsuccess=function(){var i=a.result;if(null==t){var o=i.transaction(_,"readonly"),s=o.objectStore(_).get(n.modelPath);s.onsuccess=function(){if(null==s.result)return i.close(),r(new Error("Cannot find model with path '".concat(n.modelPath,"' ")+"in IndexedDB."));e(s.result.modelArtifacts)},s.onerror=function(e){return i.close(),r(s.error)},o.oncomplete=function(){return i.close()}}else{var c,u=Object(g.g)(t),l=i.transaction(E,"readwrite"),d=l.objectStore(E),h=d.put({modelPath:n.modelPath,modelArtifactsInfo:u});h.onsuccess=function(){var a=(c=i.transaction(_,"readwrite")).objectStore(_).put({modelPath:n.modelPath,modelArtifacts:t,modelArtifactsInfo:u});a.onsuccess=function(){return e({modelArtifactsInfo:u})},a.onerror=function(e){var t=(d=l.objectStore(E)).delete(n.modelPath);t.onsuccess=function(){return i.close(),r(a.error)},t.onerror=function(e){return i.close(),r(a.error)}}},h.onerror=function(e){return i.close(),r(h.error)},l.oncomplete=function(){null==c?i.close():c.oncomplete=function(){return i.close()}}}},a.onerror=function(e){return r(a.error)}}))}}]),e}();T.URL_SCHEME="indexeddb://";var M=function(e){return Object(h.b)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(T.URL_SCHEME)?(t=e.slice(T.URL_SCHEME.length),new T(t)):null;var t};b.registerSaveRouter(M),b.registerLoadRouter(M);var k=function(){function e(){Object(l.a)(this,e),this.indexedDB=S()}return Object(d.a)(e,[{key:"listModels",value:function(){var e=Object(v.a)(m.a.mark((function e(){var t=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=t.indexedDB.open(A,1);r.onupgradeneeded=function(){return C(r)},r.onsuccess=function(){var t=r.result,a=t.transaction(E,"readonly"),i=a.objectStore(E).getAll();i.onsuccess=function(){var t,n={},r=Object(f.a)(i.result);try{for(r.s();!(t=r.n()).done;){var a=t.value;n[a.modelPath]=a.modelArtifactsInfo}}catch(o){r.e(o)}finally{r.f()}e(n)},i.onerror=function(e){return t.close(),n(i.error)},a.oncomplete=function(){return t.close()}},r.onerror=function(e){return n(r.error)}})));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=Object(v.a)(m.a.mark((function e(t){var n=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=(r=t).startsWith(T.URL_SCHEME)?r.slice(T.URL_SCHEME.length):r,e.abrupt("return",new Promise((function(e,r){var a=n.indexedDB.open(A,1);a.onupgradeneeded=function(){return C(a)},a.onsuccess=function(){var n,i=a.result,o=i.transaction(E,"readwrite"),s=o.objectStore(E),c=s.get(t);c.onsuccess=function(){if(null==c.result)return i.close(),r(new Error("Cannot find model with path '".concat(t,"' ")+"in IndexedDB."));var a=s.delete(t),o=function(){var a=(n=i.transaction(_,"readwrite")).objectStore(_).delete(t);a.onsuccess=function(){return e(c.result.modelArtifactsInfo)},a.onerror=function(e){return r(c.error)}};a.onsuccess=o,a.onerror=function(e){return o(),i.close(),r(c.error)}},c.onerror=function(e){return i.close(),r(c.error)},o.oncomplete=function(){null==n?i.close():n.oncomplete=function(){return i.close()}}},a.onerror=function(e){return r(a.error)}})));case 2:case"end":return e.stop()}var r}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),R=n(202),I="/",j="tensorflowjs_models",B="info",L="model_topology",N="weight_specs",D="weight_data",P="model_metadata";function F(e){return{info:[j,e,B].join(I),topology:[j,e,L].join(I),weightSpecs:[j,e,N].join(I),weightData:[j,e,D].join(I),modelMetadata:[j,e,P].join(I)}}function G(e){var t=e.split(I);if(t.length<3)throw new Error("Invalid key format: ".concat(e));return t.slice(1,t.length-1).join(I)}var U=function(){function e(t){if(Object(l.a)(this,e),!Object(h.b)().getBool("IS_BROWSER")||"undefined"===typeof window||"undefined"===typeof window.localStorage)throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,null==t||!t)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=t,this.keys=F(this.modelPath)}return Object(d.a)(e,[{key:"save",value:function(){var e=Object(v.a)(m.a.mark((function e(t){var n,r,a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=4;break}throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");case 4:return n=JSON.stringify(t.modelTopology),r=JSON.stringify(t.weightSpecs),a=Object(g.g)(t),e.prev=7,this.LS.setItem(this.keys.info,JSON.stringify(a)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,Object(g.a)(t.weightData)),i={format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy},null!=t.signature&&(i.signature=t.signature),null!=t.userDefinedMetadata&&(i.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(i.modelInitializer=t.modelInitializer),this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),e.abrupt("return",{modelArtifactsInfo:a});case 20:throw e.prev=20,e.t0=e.catch(7),this.LS.removeItem(this.keys.info),this.LS.removeItem(this.keys.topology),this.LS.removeItem(this.keys.weightSpecs),this.LS.removeItem(this.keys.weightData),this.LS.removeItem(this.keys.modelMetadata),new Error("Failed to save model '".concat(this.modelPath,"' to local storage: ")+"size quota being exceeded is a possible cause of this failure: "+"modelTopologyBytes=".concat(a.modelTopologyBytes,", ")+"weightSpecsBytes=".concat(a.weightSpecsBytes,", ")+"weightDataBytes=".concat(a.weightDataBytes,"."));case 28:case"end":return e.stop()}}),e,this,[[7,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(v.a)(m.a.mark((function e(){var t,n,r,a,i,o,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=(t=JSON.parse(this.LS.getItem(this.keys.info)))){e.next=3;break}throw new Error("In local storage, there is no model with name '".concat(this.modelPath,"'"));case 3:if("JSON"===t.modelTopologyType){e.next=5;break}throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");case 5:if(n={},null!=(r=JSON.parse(this.LS.getItem(this.keys.topology)))){e.next=9;break}throw new Error("In local storage, the topology of model '".concat(this.modelPath,"' ")+"is missing.");case 9:if(n.modelTopology=r,null!=(a=JSON.parse(this.LS.getItem(this.keys.weightSpecs)))){e.next=13;break}throw new Error("In local storage, the weight specs of model '".concat(this.modelPath,"' ")+"are missing.");case 13:if(n.weightSpecs=a,null!=(i=this.LS.getItem(this.keys.modelMetadata))&&(o=JSON.parse(i),n.format=o.format,n.generatedBy=o.generatedBy,n.convertedBy=o.convertedBy,null!=o.signature&&(n.signature=o.signature),null!=o.userDefinedMetadata&&(n.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(n.modelInitializer=o.modelInitializer)),null!=(s=this.LS.getItem(this.keys.weightData))){e.next=19;break}throw new Error("In local storage, the binary weight values of model "+"'".concat(this.modelPath,"' are missing."));case 19:return n.weightData=Object(g.b)(s),e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();U.URL_SCHEME="localstorage://";var z=function(e){return Object(h.b)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(U.URL_SCHEME)?(t=e.slice(U.URL_SCHEME.length),new U(t)):null;var t};b.registerSaveRouter(z),b.registerLoadRouter(z);var H=function(){function e(){Object(l.a)(this,e),Object(R.b)(Object(h.b)().getBool("IS_BROWSER"),(function(){return"Current environment is not a web browser"})),Object(R.b)("undefined"===typeof window||"undefined"!==typeof window.localStorage,(function(){return"Current browser does not appear to support localStorage"})),this.LS=window.localStorage}return Object(d.a)(e,[{key:"listModels",value:function(){var e=Object(v.a)(m.a.mark((function e(){var t,n,r,a,i,o;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t={},n=j+I,r=I+B,a=0;a<this.LS.length;++a)(i=this.LS.key(a)).startsWith(n)&&i.endsWith(r)&&(o=G(i),t[o]=JSON.parse(this.LS.getItem(i)));return e.abrupt("return",t);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"removeModel",value:function(){var e=Object(v.a)(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(a=t).startsWith(U.URL_SCHEME)?a.slice(U.URL_SCHEME.length):a,n=F(t),null!=this.LS.getItem(n.info)){e.next=4;break}throw new Error("Cannot find model at path '".concat(t,"'"));case 4:return r=JSON.parse(this.LS.getItem(n.info)),this.LS.removeItem(n.info),this.LS.removeItem(n.topology),this.LS.removeItem(n.weightSpecs),this.LS.removeItem(n.weightData),e.abrupt("return",r);case 10:case"end":return e.stop()}var a}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),V="://",W=function(){function e(){Object(l.a)(this,e),this.managers={}}return Object(d.a)(e,null,[{key:"getInstance",value:function(){return null==e.instance&&(e.instance=new e),e.instance}},{key:"registerManager",value:function(t,n){Object(R.b)(null!=t,(function(){return"scheme must not be undefined or null."})),t.endsWith(V)&&(t=t.slice(0,t.indexOf(V))),Object(R.b)(t.length>0,(function(){return"scheme must not be an empty string."}));var r=e.getInstance();Object(R.b)(null==r.managers[t],(function(){return"A model store manager is already registered for scheme '".concat(t,"'.")})),r.managers[t]=n}},{key:"getManager",value:function(e){var t=this.getInstance().managers[e];if(null==t)throw new Error("Cannot find model manager for scheme '".concat(e,"'"));return t}},{key:"getSchemes",value:function(){return Object.keys(this.getInstance().managers)}}]),e}();function J(e){if(-1===e.indexOf(V))throw new Error("The url string provided does not contain a scheme. Supported schemes are: "+"".concat(W.getSchemes().join(",")));return{scheme:e.split(V)[0],path:e.split(V)[1]}}function X(e,t){return K.apply(this,arguments)}function K(){return(K=Object(v.a)(m.a.mark((function e(t,n){var r,a,i,o,s,c,u,l,d,h,f=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=f.length>2&&void 0!==f[2]&&f[2],Object(R.b)(t!==n,(function(){return"Old path and new path are the same: '".concat(t,"'")})),a=b.getLoadHandlers(t),Object(R.b)(a.length>0,(function(){return"Copying failed because no load handler is found for source URL ".concat(t,".")})),Object(R.b)(a.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"load handlers for source URL ".concat(t,".")})),i=a[0],o=b.getSaveHandlers(n),Object(R.b)(o.length>0,(function(){return"Copying failed because no save handler is found for destination "+"URL ".concat(n,".")})),Object(R.b)(o.length<2,(function(){return"Copying failed because more than one (".concat(a.length,") ")+"save handlers for destination URL ".concat(n,".")})),s=o[0],c=J(t).scheme,u=J(t).path,l=c===J(t).scheme,e.next=15,i.load();case 15:if(d=e.sent,!r||!l){e.next=19;break}return e.next=19,W.getManager(c).removeModel(u);case 19:return e.next=21,s.save(d);case 21:if(h=e.sent,!r||l){e.next=25;break}return e.next=25,W.getManager(c).removeModel(u);case 25:return e.abrupt("return",h.modelArtifactsInfo);case 26:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function q(){return Y.apply(this,arguments)}function Y(){return(Y=Object(v.a)(m.a.mark((function e(){var t,n,r,a,i,o,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=W.getSchemes(),n={},r=Object(f.a)(t),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=13;break}return i=a.value,e.next=9,W.getManager(i).listModels();case 9:for(s in o=e.sent)n[i+V+s]=o[s];case 11:e.next=5;break;case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(3),r.e(e.t0);case 18:return e.prev=18,r.f(),e.finish(18);case 21:return e.abrupt("return",n);case 22:case"end":return e.stop()}}),e,null,[[3,15,18,21]])})))).apply(this,arguments)}function Q(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(v.a)(m.a.mark((function e(t){var n,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=J(t),r=W.getManager(n.scheme),e.abrupt("return",r.removeModel(n.path));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function $(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(v.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!1,e.abrupt("return",X(t,n,false));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(v.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return!0,e.abrupt("return",X(t,n,true));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,[{key:"fetch",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){return fetch(e,t)}))},{key:"now",value:function(){return performance.now()}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Browser's encoder only supports utf-8, but got ".concat(t));return null==this.textEncoder&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return new TextDecoder(t).decode(e)}}]),e}();if(Object(h.b)().get("IS_BROWSER")){Object(h.b)().setPlatform("browser",new re);try{W.registerManager(U.URL_SCHEME,new H)}catch(nn){}try{W.registerManager(T.URL_SCHEME,new k)}catch(nn){}}n(414);var ae=n(175),ie=n(157),oe=n(184),se=n(224),ce=n(160);Object(u.b)();var ue={buffer:ae.a,cast:ie.a,clone:oe.a,print:se.a};Object(ce.e)(ue);var le=n(65);function de(e){return new Promise((function(e){return setTimeout(e)})).then(e)}var he=function(){function e(t){if(Object(l.a)(this,e),!Object(h.b)().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");t.startsWith(e.URL_SCHEME)&&(t=t.slice(e.URL_SCHEME.length)),null!=t&&0!==t.length||(t="model"),this.modelTopologyFileName=t+".json",this.weightDataFileName=t+".weights.bin"}return Object(d.a)(e,[{key:"save",value:function(){var e=Object(v.a)(m.a.mark((function e(t){var n,r,a,i,o,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("undefined"!==typeof document){e.next=2;break}throw new Error("Browser downloads are not supported in this environment since `document` is not present");case 2:if(n=window.URL.createObjectURL(new Blob([t.weightData],{type:"application/octet-stream"})),!(t.modelTopology instanceof ArrayBuffer)){e.next=7;break}throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");case 7:return r=[{paths:["./"+this.weightDataFileName],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},null!=t.signature&&(a.signature=t.signature),null!=t.userDefinedMetadata&&(a.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(a.modelInitializer=t.modelInitializer),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),(o=null==this.jsonAnchor?document.createElement("a"):this.jsonAnchor).download=this.modelTopologyFileName,o.href=i,e.next=18,de((function(){return o.dispatchEvent(new MouseEvent("click"))}));case 18:if(null==t.weightData){e.next=24;break}return(s=null==this.weightDataAnchor?document.createElement("a"):this.weightDataAnchor).download=this.weightDataFileName,s.href=n,e.next=24,de((function(){return s.dispatchEvent(new MouseEvent("click"))}));case 24:return e.abrupt("return",{modelArtifactsInfo:Object(g.g)(t)});case 25:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();he.URL_SCHEME="downloads://";var fe=function(){function e(t){if(Object(l.a)(this,e),null==t||t.length<1)throw new Error("When calling browserFiles, at least 1 file is required, "+"but received ".concat(t));this.files=t}return Object(d.a)(e,[{key:"load",value:function(){var e=Object(v.a)(m.a.mark((function e(){var t,n,r=this;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.files[0],n=this.files.slice(1),e.abrupt("return",new Promise((function(e,a){var i=new FileReader;i.onload=function(i){var o=JSON.parse(i.target.result),s=o.modelTopology;if(null!=s){0===n.length&&e({modelTopology:s});var c=o.weightsManifest;if(null!=c){var u;try{u=r.checkManifestAndWeightFiles(c,n)}catch(nn){return void a(nn)}var l=[],d=[],h=[];c.forEach((function(e){e.paths.forEach((function(e){d.push(e),h.push(null)})),l.push.apply(l,Object(le.a)(e.weights))})),c.forEach((function(t){t.paths.forEach((function(t){var n=new FileReader;n.onload=function(n){var r=n.target.result,a=d.indexOf(t);if(h[a]=r,-1===h.indexOf(null)){var i={modelTopology:s,weightSpecs:l,weightData:Object(g.d)(h),format:o.format,generatedBy:o.generatedBy,convertedBy:o.convertedBy};null!=o.signature&&(i.signature=o.signature),null!=o.userDefinedMetadata&&(i.userDefinedMetadata=o.userDefinedMetadata),null!=o.modelInitializer&&(i.modelInitializer=o.modelInitializer),e(i)}},n.onerror=function(e){return a("Failed to weights data from file of path '".concat(t,"'."))},n.readAsArrayBuffer(u[t])}))}))}else a(new Error("weightManifest field is missing from file ".concat(t.name)))}else a(new Error("modelTopology field is missing from file ".concat(t.name)))},i.onerror=function(e){return a("Failed to read model topology and weights manifest JSON "+"from file '".concat(t.name,"'. BrowserFiles supports loading ")+"Keras-style tf.Model artifacts only.")},i.readAsText(t)})));case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"checkManifestAndWeightFiles",value:function(e,t){var n,r=[],a=t.map((function(e){return Object(g.c)(e.name)})),i={},o=Object(f.a)(e);try{for(o.s();!(n=o.n()).done;){n.value.paths.forEach((function(e){var n=Object(g.c)(e);if(-1!==r.indexOf(n))throw new Error("Duplicate file basename found in weights manifest: "+"'".concat(n,"'"));if(r.push(n),-1===a.indexOf(n))throw new Error("Weight file with basename '".concat(n,"' is not provided."));i[e]=t[a.indexOf(n)]}))}}catch(nn){o.e(nn)}finally{o.f()}if(r.length!==t.length)throw new Error("Mismatch in the number of files in weights manifest "+"(".concat(r.length,") and the number of weight files provided ")+"(".concat(t.length,")."));return i}}]),e}();function pe(e){return new fe(e)}b.registerSaveRouter((function(e){return Object(h.b)().getBool("IS_BROWSER")&&!Array.isArray(e)&&e.startsWith(he.URL_SCHEME)?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"model";return new he(e)}(e.slice(he.URL_SCHEME.length)):null}));var me=n(12);function ve(e,t,n,r){!function(e){Object(R.b)(null!=e&&Array.isArray(e)&&e.length>0,(function(){return"promises must be a none empty array"}))}(e),function(e,t){Object(R.b)(e>=0&&e<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got startFraction ".concat(e)})),Object(R.b)(t>=0&&t<=1,(function(){return"Progress fraction must be in range [0, 1], but "+"got endFraction ".concat(t)})),Object(R.b)(t>=e,(function(){return"startFraction must be no more than endFraction, but "+"got startFraction ".concat(e," and endFraction ")+"".concat(t)}))}(n=null==n?0:n,r=null==r?1:r);var a=0;return Promise.all(e.map((function(i){return i.then((function(i){var o=n+ ++a/e.length*(r-n);return t(o),i})),i})))}var ge=n(266);function be(e,t){return ye.apply(this,arguments)}function ye(){return(ye=Object(v.a)(m.a.mark((function e(t,n){var r,a,i,o,s,c,u,l,d;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==n&&(n={}),r=null==n.fetchFunc?Object(h.b)().platform.fetch:n.fetchFunc,a=t.map((function(e){return r(e,n.requestInit,{isBinary:!0})})),i=0,o=.5,null!=n.onProgress){e.next=11;break}return e.next=8,Promise.all(a);case 8:e.t0=e.sent,e.next=14;break;case 11:return e.next=13,ve(a,n.onProgress,i,o);case 13:e.t0=e.sent;case 14:if(s=e.t0,c=s.map((function(e){return e.arrayBuffer()})),u=.5,l=1,null!=n.onProgress){e.next=24;break}return e.next=21,Promise.all(c);case 21:e.t1=e.sent,e.next=27;break;case 24:return e.next=26,ve(c,n.onProgress,u,l);case 26:e.t1=e.sent;case 27:return d=e.t1,e.abrupt("return",d);case 29:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e){return we.apply(this,arguments)}function we(){return(we=Object(v.a)(m.a.mark((function e(t){var n,r,a,i,o=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:"",r=o.length>2?o[2]:void 0,a=o.length>3?o[3]:void 0,i=Oe((function(e){return be(e,{requestInit:a})})),e.abrupt("return",i(t,n,r));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e){return function(){var t=Object(v.a)(m.a.mark((function t(n){var r,a,i,o,s,c,u,l,d,h,f,p,v=arguments;return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=v.length>1&&void 0!==v[1]?v[1]:"",a=v.length>2?v[2]:void 0,i=n.map((function(){return!1})),o={},s=null!=a?a.map((function(){return!1})):[],c=[],n.forEach((function(e,t){var n=0;e.weights.forEach((function(e){var r="quantization"in e?e.quantization.dtype:e.dtype,u=ge.a[r]*R.O(e.shape),l=function(){i[t]=!0,null==o[t]&&(o[t]=[]),o[t].push({manifestEntry:e,groupOffset:n,sizeBytes:u})};null!=a?a.forEach((function(t,n){t===e.name&&(l(),s[n]=!0)})):l(),c.push(e.name),n+=u}))})),s.every((function(e){return e}))){t.next=10;break}throw u=a.filter((function(e,t){return!s[t]})),new Error("Could not find weights in manifest with names: "+"".concat(u.join(", "),". \n")+"Manifest JSON has weights with names: "+"".concat(c.join(", "),"."));case 10:return l=i.reduce((function(e,t,n){return t&&e.push(n),e}),[]),d=[],l.forEach((function(e){n[e].paths.forEach((function(e){var t=r+(r.endsWith("/")?"":"/")+e;d.push(t)}))})),t.next=15,e(d);case 15:return h=t.sent,f={},p=0,l.forEach((function(e){for(var t=n[e].paths.length,r=0,a=0;a<t;a++)r+=h[p+a].byteLength;for(var i=new ArrayBuffer(r),s=new Uint8Array(i),c=0,u=0;u<t;u++){var l=new Uint8Array(h[p+u]);s.set(l,c),c+=l.byteLength}o[e].forEach((function(e){var t=i.slice(e.groupOffset,e.groupOffset+e.sizeBytes),n=Object(g.e)(t,[e.manifestEntry]);for(var r in n)f[r]=n[r]})),p+=t})),t.abrupt("return",f);case 20:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()}var Ae=function(){function e(t,n){if(Object(l.a)(this,e),this.DEFAULT_METHOD="POST",null==n&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.onProgress=n.onProgress,this.weightUrlConverter=n.weightUrlConverter,null!=n.fetchFunc?(Object(R.b)("function"===typeof n.fetchFunc,(function(){return"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"})),this.fetch=n.fetchFunc):this.fetch=Object(h.b)().platform.fetch,Object(R.b)(null!=t&&t.length>0,(function(){return"URL path for http must not be null, undefined or empty."})),Array.isArray(t)&&Object(R.b)(2===t.length,(function(){return"URL paths for http must have a length of 2, "+"(actual length is ".concat(t.length,").")})),this.path=t,null!=n.requestInit&&null!=n.requestInit.body)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{}}return Object(d.a)(e,[{key:"save",value:function(){var e=Object(v.a)(m.a.mark((function e(t){var n,r,a,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.modelTopology instanceof ArrayBuffer)){e.next=2;break}throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");case 2:return(n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit)).body=new FormData,r=[{paths:["./model.weights.bin"],weights:t.weightSpecs}],a={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:r},null!=t.signature&&(a.signature=t.signature),null!=t.userDefinedMetadata&&(a.userDefinedMetadata=t.userDefinedMetadata),null!=t.modelInitializer&&(a.modelInitializer=t.modelInitializer),n.body.append("model.json",new Blob([JSON.stringify(a)],{type:"application/json"}),"model.json"),null!=t.weightData&&n.body.append("model.weights.bin",new Blob([t.weightData],{type:"application/octet-stream"}),"model.weights.bin"),e.next=13,this.fetch(this.path,n);case 13:if(!(i=e.sent).ok){e.next=18;break}return e.abrupt("return",{modelArtifactsInfo:Object(g.g)(t),responses:[i]});case 18:throw new Error("BrowserHTTPRequest.save() failed due to HTTP response status "+"".concat(i.status,"."));case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"load",value:function(){var e=Object(v.a)(m.a.mark((function e(){var t,n,r,a,i,o,s,c,u,l,d,h,f,p,v,g;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetch(this.path,this.requestInit);case 2:if((t=e.sent).ok){e.next=5;break}throw new Error("Request to ".concat(this.path," failed with status code ")+"".concat(t.status,". Please verify this URL points to ")+"the model JSON of the model to load.");case 5:return e.prev=5,e.next=8,t.json();case 8:n=e.sent,e.next=16;break;case 11:throw e.prev=11,e.t0=e.catch(5),r="Failed to parse model JSON of response from ".concat(this.path,"."),this.path.endsWith(".pb")?r+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":r+=" Please make sure the server is serving valid JSON for this request.",new Error(r);case 16:if(a=n.modelTopology,i=n.weightsManifest,o=n.generatedBy,s=n.convertedBy,c=n.format,u=n.signature,l=n.userDefinedMetadata,null!=a||null!=i){e.next=25;break}throw new Error("The JSON from HTTP path ".concat(this.path," contains neither model ")+"topology or manifest for weights.");case 25:if(null==i){e.next=32;break}return e.next=28,this.loadWeights(i);case 28:f=e.sent,p=Object(me.a)(f,2),d=p[0],h=p[1];case 32:return v={modelTopology:a,weightSpecs:d,weightData:h,generatedBy:o,convertedBy:s,format:c},null!=u&&(v.signature=u),null!=l&&(v.userDefinedMetadata=l),(g=n.modelInitializer)&&(v.modelInitializer=g),e.abrupt("return",v);case 38:case"end":return e.stop()}}),e,this,[[5,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadWeights",value:function(){var e=Object(v.a)(m.a.mark((function e(t){var n,r,a,i,o,s,c,u,l,d,h,p,v,b,y,x,w,O,A;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=Array.isArray(this.path)?this.path[1]:this.path,r=_e(n),a=Object(me.a)(r,2),i=a[0],o=a[1],s=this.weightPathPrefix||i,c=[],u=Object(f.a)(t);try{for(u.s();!(l=u.n()).done;)d=l.value,c.push.apply(c,Object(le.a)(d.weights))}catch(nn){u.e(nn)}finally{u.f()}h=[],p=[],v=Object(f.a)(t);try{for(v.s();!(b=v.n()).done;){y=b.value,x=Object(f.a)(y.paths);try{for(x.s();!(w=x.n()).done;)O=w.value,null!=this.weightUrlConverter?p.push(this.weightUrlConverter(O)):h.push(s+O+o)}catch(nn){x.e(nn)}finally{x.f()}}}catch(nn){v.e(nn)}finally{v.f()}if(!this.weightUrlConverter){e.next=19;break}return e.t0=h.push,e.t1=h,e.t2=le.a,e.next=16,Promise.all(p);case 16:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4);case 19:return e.next=21,be(h,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});case 21:return A=e.sent,e.abrupt("return",[c,Object(g.d)(A)]);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function _e(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("?");return[e.substring(0,t)+"/",n>t?e.substring(n):""]}function Ee(e){return null!=e.match(Ae.URL_SCHEME_REGEX)}Ae.URL_SCHEME_REGEX=/^https?:\/\//;var Se=function(e,t){if("undefined"===typeof fetch&&(null==t||null==t.fetchFunc))return null;return(Array.isArray(e)?e.every((function(e){return Ee(e)})):Ee(e))?Ce(e,t):null};function Ce(e,t){return new Ae(e,t)}function Te(e,t){return Ce(e,t)}b.registerSaveRouter(Se),b.registerLoadRouter(Se);var Me=function(){function e(t){Object(l.a)(this,e),this.modelArtifacts=t}return Object(d.a)(e,[{key:"load",value:function(){var e=Object(v.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.modelArtifacts);case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),ke=function(){function e(t){Object(l.a)(this,e),this.saveHandler=t}return Object(d.a)(e,[{key:"save",value:function(){var e=Object(v.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.saveHandler(t));case 1:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()}]),e}();function Re(e,t,n,r){if(1===arguments.length){var a=null!=e.modelTopology||null!=e.weightSpecs;return a?new Me(e):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Me({modelTopology:e}))}return console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Me({modelTopology:e,weightSpecs:t,weightData:n,trainingConfig:r})}function Ie(e){return new ke(e)}var je,Be=n(146),Le=n(203),Ne=n(144),De=n(143),Pe=n(256);function Fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3;if(t>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(null==e)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");var n=!1,r=!1,a=!1,i=!1,o=!1,s=!1;if(e.data instanceof Uint8Array)n=!0;else if("undefined"!==typeof ImageData&&e instanceof ImageData)r=!0;else if("undefined"!==typeof HTMLVideoElement&&e instanceof HTMLVideoElement)a=!0;else if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement)i=!0;else if(null!=e.getContext)o=!0;else{if(!("undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap))throw new Error("pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, "+"but was ".concat(e.constructor.name));s=!0}if(a){var c=2;if(a&&e.readyState<c)throw new Error("The video element has not loaded data yet. Please wait for `loadeddata` event on the <video> element.")}var l=Object(Le.b)(Be.eb,u.a.backendName);if(null!=l){var d={pixels:e},h={numChannels:t};return u.a.runKernel(Be.eb,d,h)}var f,p,m=a?[e.videoWidth,e.videoHeight]:[e.width,e.height],v=Object(me.a)(m,2),g=v[0],b=v[1];if(o?f=e.getContext("2d").getImageData(0,0,g,b).data:r||n?f=e.data:(i||a||s)&&(null==je&&(je=document.createElement("canvas").getContext("2d")),je.canvas.width=g,je.canvas.height=b,je.drawImage(e,0,0,g,b),f=je.getImageData(0,0,g,b).data),4===t)p=new Int32Array(f);else{var y=g*b;p=new Int32Array(y*t);for(var x=0;x<y;x++)for(var w=0;w<t;++w)p[x*t+w]=f[4*x+w]}var O=[b,g,t];return Object(Pe.a)(p,O,"int32")}function Ge(e){return"undefined"!==typeof window&&"undefined"!==typeof ImageBitmap&&window.hasOwnProperty("createImageBitmap")&&!(e instanceof ImageBitmap)&&function(e){return null!=e&&0!==e.width&&0!==e.height}(e)&&!function(e){return null!=e&&e.data instanceof Uint8Array}(e)}function Ue(e){return ze.apply(this,arguments)}function ze(){return(ze=Object(v.a)(m.a.mark((function e(t){var n,r,a,i=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:3,r=null,!Object(h.b)().getBool("WRAP_TO_IMAGEBITMAP")||!Ge(t)){e.next=15;break}return e.prev=3,e.next=6,createImageBitmap(t,{premultiplyAlpha:"none"});case 6:a=e.sent,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(3),a=null;case 12:r=null!=a&&a.width===t.width&&a.height===t.height?a:t,e.next=16;break;case 15:r=t;case 16:return e.abrupt("return",Fe(r,n));case 17:case"end":return e.stop()}}),e,null,[[3,9]])})))).apply(this,arguments)}function He(e,t){return Ve.apply(this,arguments)}function Ve(){return(Ve=Object(v.a)(m.a.mark((function e(t,n){var r,a,i,o,s,c,u,l,d,h,f,p,v,g,b,y,x;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Object(Ne.a)(t,"img","toPixels"),t instanceof ce.a||(a=r,r=Object(ie.a)(a,"int32"),a.dispose()),2===r.rank||3===r.rank){e.next=4;break}throw new Error("toPixels only supports rank 2 or 3 tensors, got rank ".concat(r.rank,"."));case 4:if(i=r.shape.slice(0,2),o=Object(me.a)(i,2),s=o[0],c=o[1],!((u=2===r.rank?1:r.shape[2])>4||2===u)){e.next=8;break}throw new Error("toPixels only supports depth of size "+"1, 3 or 4 but got ".concat(u));case 8:if("float32"===r.dtype||"int32"===r.dtype){e.next=10;break}throw new Error("Unsupported type for toPixels: ".concat(r.dtype,".")+" Please use float32 or int32 tensors.");case 10:return e.next=12,r.data();case 12:l=e.sent,d="float32"===r.dtype?255:1,h=new Uint8ClampedArray(c*s*4),f=0;case 16:if(!(f<s*c)){e.next=41;break}p=[0,0,0,255],v=0;case 19:if(!(v<u)){e.next=33;break}if(g=l[f*u+v],"float32"!==r.dtype){e.next=26;break}if(!(g<0||g>1)){e.next=24;break}throw new Error("Tensor values for a float32 Tensor must be in the "+"range [0 - 1] but encountered ".concat(g,"."));case 24:e.next=29;break;case 26:if("int32"!==r.dtype){e.next=29;break}if(!(g<0||g>255)){e.next=29;break}throw new Error("Tensor values for a int32 Tensor must be in the "+"range [0 - 255] but encountered ".concat(g,"."));case 29:1===u?(p[0]=g*d,p[1]=g*d,p[2]=g*d):p[v]=g*d;case 30:v++,e.next=19;break;case 33:h[(b=4*f)+0]=Math.round(p[0]),h[b+1]=Math.round(p[1]),h[b+2]=Math.round(p[2]),h[b+3]=Math.round(p[3]);case 38:++f,e.next=16;break;case 41:return null!=n&&(n.width=c,n.height=s,y=n.getContext("2d"),x=new ImageData(h,c,s),y.putImageData(x,0,0)),r!==t&&r.dispose(),e.abrupt("return",h);case 44:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var We=Object(De.a)({fromPixels_:Fe});function Je(e,t,n){var r=e.shape.length;R.b(r===t.length,(function(){return"Error in slice".concat(r,"D: Length of begin ").concat(t," must ")+"match the rank of the array (".concat(r,").")})),R.b(r===n.length,(function(){return"Error in slice".concat(r,"D: Length of size ").concat(n," must ")+"match the rank of the array (".concat(r,").")}));for(var a=function(a){R.b(t[a]+n[a]<=e.shape[a],(function(){return"Error in slice".concat(r,"D: begin[").concat(a,"] + size[").concat(a,"] ")+"(".concat(t[a]+n[a],") would overflow input.shape[").concat(a,"] (").concat(e.shape[a],")")}))},i=0;i<r;++i)a(i)}function Xe(e){for(var t=[],n=0;e>0;)1&e&&t.push(n),e/=2,n++;return t}function Ke(e,t,n){for(var r=[],a=0;a<e.length;a++)r[a]=Math.ceil((t[a]-e[a])/n[a]);return r}function qe(e,t,n,r){for(var a=Object(le.a)(e),i=a.length;i<r.length;i++)a.push(1);for(var o=0;o<n;o++)0===o?a[t]=1:(a.splice(t,0,1),a.pop());return a}function Ye(e,t,n){return n<=e?n:n-(t-1)}function Qe(e,t){for(var n=[],r=0;r<e;r++)n.push(t+r);return n}function Ze(e,t,n,r,a,i,o,s,c){var u=e.length,l=new Array(u),d=new Array(u),h=new Array(u);if(t.length&&n>0){var f=t[0],p=n+1;l=$e(o,f,p,r,e),d=et(s,f,p,a,e),h=qe(i,f,p,e)}else for(var m=0;m<u;m++)l[m]=nt(o,r,i,e,m,c),d[m]=rt(s,a,i,e,m,c),h[m]=tt(i,m,c);return{begin:l,end:d,strides:h}}function $e(e,t,n,r,a){for(var i=Object(le.a)(a),o=Qe(n,t),s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=0;else{var c=Ye(t,n,s),u=r[c];e&1<<c&&(u=0),i[s]=u}return i}function et(e,t,n,r,a){for(var i=Object(le.a)(a),o=Qe(n,t),s=0;s<i.length;s++)if(o.indexOf(s)>-1)i[s]=Number.MAX_SAFE_INTEGER;else{var c=Ye(t,n,s),u=r[c];e&1<<c&&(u=Number.MAX_SAFE_INTEGER),i[s]=u}for(var l=0;l<i.length;l++){var d=a[l];i[l]<0&&(i[l]+=d),i[l]=R.i(0,i[l],a[l])}return i}function tt(e,t,n){var r=e[t];return(n&1<<t||null==r)&&(r=1),r}function nt(e,t,n,r,a,i){var o=t[a],s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MIN_SAFE_INTEGER:Number.MAX_SAFE_INTEGER);var c=r[a];return o<0&&(o+=c),o=R.i(0,o,c-1)}function rt(e,t,n,r,a,i){var o=t[a],s=n[a]||1;(e&1<<a||i&1<<a||null==o)&&(o=s>0?Number.MAX_SAFE_INTEGER:Number.MIN_SAFE_INTEGER);var c=r[a];return o<0&&(o+=c),o=s>0?R.i(0,o,c):R.i(-1,o,c-1)}function at(e,t,n){for(var r=n.length,a=0;a<n.length;a++)if(n[a]>1){r=a;break}for(var i=r+1;i<n.length;i++)if(t[i]>0||n[i]!==e[i])return!1;return!0}function it(e,t){for(var n=e.length>0?e[e.length-1]:1,r=0;r<e.length-1;r++)n+=e[r]*t[r];return n}function ot(e,t,n){var r,a,i=e.shape.length;return(r="number"===typeof t?[t].concat(Object(le.a)(new Array(i-1).fill(0))):t.length<i?t.concat(new Array(i-t.length).fill(0)):t.slice()).forEach((function(e){R.b(-1!==e,(function(){return"slice() does not support negative begin indexing."}))})),a=(a=null==n?new Array(i).fill(-1):"number"===typeof n?[n].concat(Object(le.a)(new Array(i-1).fill(-1))):n.length<i?n.concat(new Array(i-n.length).fill(-1)):n).map((function(t,n){return t>=0?t:(R.b(-1===t,(function(){return"Negative size values should be exactly -1 but got "+"".concat(t," for the slice() size at index ").concat(n,".")})),e.shape[n]-r[n])})),[r,a]}function st(e,t,n,r,a,i,o,s,c){var u=t.slice(),l=n.slice(),d=r;null==r&&(d=new Array(u.length));var h=Xe(o);if(h.length>1)throw new Error("Multiple ellipses in slice is not allowed.");if(0!==o&&0!==s)throw new Error("Using both ellipsisMask and newAxisMask is not yet supported.");if(0!==o&&0!==c)throw new Error("Using both ellipsisMask and shrinkAxisMask is not yet supported.");var f=e.length-u.length,p=Xe(s),m=e.slice();p.forEach((function(e){u[e]=0,l[e]=1,m.splice(e,0,1)}));var v=Ze(m,h,f,u,l,d,a,i,o),g=v.begin,b=v.end,y=v.strides;u=g,l=b,d=y;var x=Xe(c);x.forEach((function(e){l[e]=u[e]+1,d[e]=1}));var w=Ke(u,l,d),O=w.filter((function(e,t){return-1===x.indexOf(t)}));return{nonStrided:d.every((function(e){return 1===e})),$begin:u,$end:l,$strides:d,size:w,newShape:m,outShape:O}}var ct=n(148),ut=n(173),lt=n(346),dt=n(243),ht=n(195),ft=n(154);function pt(e,t){var n=e[0].length;e.forEach((function(e,t){R.b(e.length===n,(function(){return"Error in concat".concat(n,"D: rank of tensors[").concat(t,"] must be the same ")+"as the rank of the rest (".concat(n,")")}))})),R.b(t>=0&&t<n,(function(){return"Error in concat".concat(n,"D: axis must be between 0 and ").concat(n-1,".")}));var r=e[0];e.forEach((function(e,a){for(var i=0;i<n;i++)R.b(i===t||e[i]===r[i],(function(){return"Error in concat".concat(n,"D: Shape of tensors[").concat(a,"] (").concat(e,") ")+"does not match the shape of the rest (".concat(r,") ")+"along the non-concatenated axis ".concat(a,".")}))}))}function mt(e,t){for(var n=e[0].slice(),r=1;r<e.length;r++)n[t]+=e[r][t];return n}var vt=n(168),gt=n(178),bt=30;function yt(e){return e<=bt?e:Object(R.G)(e,Math.floor(Math.sqrt(e)))}function xt(e,t,n){return[n*("number"===typeof e?e:e[0]),t*("number"===typeof e?e:e[1])]}function wt(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];if(r)(a=a.concat(t.slice(0))).push(e[0]/n),a=a.concat(e.slice(1));else{a=a.concat(e[0]);for(var i=t.length,o=0;o<i;++o)a=a.concat([e[o+1]/t[o],t[o]]);a=a.concat(e.slice(i+1))}return a}function Ot(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[];if(n){r.push(t);for(var a=t+1;a<e;++a)a<=2*t?(r.push(a),r.push(a-(t+1))):r.push(a)}else{for(var i=[],o=[],s=1;s<e;++s)s>=2*t+1||s%2===1?o.push(s):i.push(s);r.push.apply(r,i),r.push(0),r.push.apply(r,o)}return r}function At(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=[];r?a.push(e[0]/n):a.push(e[0]*n);for(var i=1;i<e.length;++i)i<=t.length?r?a.push(t[i-1]*e[i]):a.push(e[i]/t[i-1]):a.push(e[i]);return a}function _t(e,t){for(var n=[0],r=0;r<t;++r)n.push(e[r][0]);return n}function Et(e,t,n){for(var r=e.slice(0,1),a=0;a<n;++a)r.push(e[a+1]-t[a][0]-t[a][1]);return r}function St(e,t){var n=e.shape.length,r=t.shape.length;if(n<1)throw new Error("tf.gatherND() expects the input to be rank 1 or higher,"+" but the rank was ".concat(n,"."));if(r<1)throw new Error("tf.gatherND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(r,"."));if("int32"!==t.dtype)throw new Error("tf.gatherND() expects the indices to be int32 type,"+" but the dtype was ".concat(t.dtype,"."));if(t.shape[r-1]>n)throw new Error("index innermost dimension length must be <= tensor rank; saw: "+"".concat(t.shape[r-1]," vs. ").concat(n));if(0===Object(R.O)(e.shape))throw new Error("Requested more than 0 entries, but input is empty."+" Input shape: ".concat(e.shape,"."));for(var a=t.shape,i=a[a.length-1],o=1,s=0;s<a.length-1;++s)o*=a[s];var c=e.shape,u=a.slice();u.pop();for(var l=1,d=i;d<n;++d)l*=c[d],u.push(c[d]);var h=[].concat(Object(le.a)(Object(R.j)(e.shape).map((function(e){return e/l}))),[1]).slice(0,i);return[u,o,l,h]}var Ct=n(199),Tt=1.7580993408473768,Mt=1.0507009873554805,kt=.3275911,Rt=.254829592,It=-.284496736,jt=1.421413741,Bt=-1.453152027,Lt=1.061405429;function Nt(){var e;Object(h.b)().getBool("IS_TEST")||(e=console).warn.apply(e,arguments)}function Dt(){var e;Object(h.b)().getBool("IS_TEST")||(e=console).log.apply(e,arguments)}function Pt(e,t){if(e.length!==t.length)throw new Error("Cannot merge real and imag arrays of different lengths. real:"+"".concat(e.length,", imag: ").concat(t.length,"."));for(var n=new Float32Array(2*e.length),r=0;r<n.length;r+=2)n[r]=e[r/2],n[r+1]=t[r/2];return n}function Ft(e){for(var t=new Float32Array(e.length/2),n=new Float32Array(e.length/2),r=0;r<e.length;r+=2)t[r/2]=e[r],n[r/2]=e[r+1];return{real:t,imag:n}}function Gt(e){for(var t=Math.ceil(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=0;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function Ut(e){for(var t=Math.floor(e.length/4),n=new Float32Array(t),r=new Float32Array(t),a=2;a<e.length;a+=4)n[Math.floor(a/4)]=e[a],r[Math.floor(a/4)]=e[a+1];return{real:n,imag:r}}function zt(e,t){return{real:e[2*t],imag:e[2*t+1]}}function Ht(e,t,n,r){e[2*r]=t,e[2*r+1]=n}function Vt(e,t){for(var n=new Float32Array(e/2),r=new Float32Array(e/2),a=0;a<Math.ceil(e/2);a++){var i=(t?2:-2)*Math.PI*(a/e);n[a]=Math.cos(i),r[a]=Math.sin(i)}return{real:n,imag:r}}function Wt(e,t,n){var r=(n?2:-2)*Math.PI*(e/t);return{real:Math.cos(r),imag:Math.sin(r)}}function Jt(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=[];if("number"===typeof t)Object(R.b)(e.shape[n]%t===0,(function(){return"Number of splits must evenly divide the axis."})),r=new Array(t).fill(e.shape[n]/t);else{var a=t.reduce((function(e,t){return-1===t&&(e+=1),e}),0);Object(R.b)(a<=1,(function(){return"There should be only one negative value in split array."}));var i=t.indexOf(-1);if(-1!==i){var o=t.reduce((function(e,t){return t>0?e+t:e}));t[i]=e.shape[n]-o}Object(R.b)(e.shape[n]===t.reduce((function(e,t){return e+t})),(function(){return"The sum of sizes must match the size of the axis dimension."})),r=t}return r}function Xt(e,t){var n,r=!1;for(e<=bt?(n=e,r=!0):n=Object(R.G)(e,Math.floor(Math.sqrt(e)));!r;)n>t||n===e?r=!0:n=Object(R.G)(e,n+1);return n}function Kt(e,t,n){for(var r=[],a=e.length,i=0;i<a;i++)i!==t?r.push(e[i]):r.push(n);return r}function qt(e,t,n,r){var a=t.shape.length,i=e.shape.length;if(0!==r&&(r<-a||r>a))throw new Error("Expect batchDims in the range of [-".concat(a,", ").concat(a,"], but got ").concat(r));if(r<0&&(r+=a),r>i)throw new Error("batchDims (".concat(r,") must be less than rank(x) (\n    ").concat(i,")."));if(n<r)throw new Error("batchDims (".concat(r,") must be less than or equal to axis (").concat(n,")."));for(var o=0;o<r;++o)if(e.shape[o]!==t.shape[o])throw new Error("x.shape[".concat(o,"]: ").concat(e.shape[o]," should be equal to indices.shape[").concat(o,"]: ").concat(t.shape[o],"."));for(var s=e.shape[n],c=[],u=1,l=1,d=1,h=0;h<r;++h)c.push(e.shape[h]),u*=e.shape[h];for(var f=r;f<n;f++)c.push(e.shape[f]),l*=e.shape[f];for(var p=r;p<a;p++)c.push(t.shape[p]);for(var m=n+1;m<i;m++)c.push(e.shape[m]),d*=e.shape[m];return{batchSize:u,sliceSize:d,outerSize:l,dimSize:s,outputShape:c}}function Yt(e){try{return e.map((function(e){return Object(ct.decodeString)(e)}))}catch(nn){throw new Error("Failed to decode encoded string bytes into utf-8, error: ".concat(nn))}}function Qt(e){return e.map((function(e){return Object(ct.encodeString)(e)}))}var Zt=n(222),$t=n(182),en=n(257),tn=n(204)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(145),a=n(202);function i(e){var t=Object.keys(e);if(1!==t.length)throw new Error("Please provide an object with a single key (operation name) mapping to a function. Got an object with "+"".concat(t.length," keys."));var n=t[0],i=e[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n+="__op";var o=function(){r.a.startScope(n);try{var e=i.apply(void 0,arguments);return Object(a.x)(e)&&console.error("Cannot return a Promise inside of tidy."),r.a.endScope(e),e}catch(t){throw r.a.endScope(null),t}};return Object.defineProperty(o,"name",{value:n,configurable:!0}),o}},function(e,t,n){"use strict";n.d(t,"c",(function(){return c})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var r=n(145),a=n(153),i=n(160),o=n(202),s=n(148);function c(e,t){var n=e;if(Object(o.A)(e))return"string"===t?[]:[e.length];if(!Array.isArray(e))return[];for(var r=[];Array.isArray(n)||Object(o.A)(n)&&"string"!==t;)r.push(n.length),n=n[0];return Array.isArray(e)&&Object(a.b)().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&u(e,r,[]),r}function u(e,t,n){if(n=n||[],Array.isArray(e)||Object(o.A)(e)){Object(o.b)(t.length>0,(function(){return"Element arr[".concat(n.join("]["),"] should be a primitive, ")+"but is an array of ".concat(e.length," elements")})),Object(o.b)(e.length===t[0],(function(){return"Element arr[".concat(n.join("]["),"] should have ").concat(t[0]," ")+"elements, but has ".concat(e.length," elements")}));for(var r=t.slice(1),a=0;a<e.length;++a)u(e[a],r,n.concat(a))}else Object(o.b)(0===t.length,(function(){return"Element arr[".concat(n.join("]["),"] is a primitive, ")+"but should be an array/TypedArray of ".concat(t[0]," elements")}))}function l(e,t,n,r){if("string_or_numeric"!==e){if(null==e)throw new Error("Expected dtype cannot be null.");if("numeric"!==e&&e!==t||"numeric"===e&&"string"===t)throw new Error("Argument '".concat(n,"' passed to '").concat(r,"' must ")+"be ".concat(e," tensor, but got ").concat(t," tensor"))}}function d(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(e instanceof i.a)return l(a,e.dtype,t,n),e;var u=Object(o.r)(e);if("string"!==u&&["bool","int32","float32"].indexOf(a)>=0&&(u=a),l(a,u,t,n),null==e||!Object(o.A)(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e){var d=null==e?"null":e.constructor.name;throw new Error("Argument '".concat(t,"' passed to '").concat(n,"' must be a ")+"Tensor or TensorLike, but got '".concat(d,"'"))}var h=c(e,u);Object(o.A)(e)||Array.isArray(e)||(e=[e]);var f=!0,p="string"!==u?Object(s.toTypedArray)(e,u):Object(o.m)(e,[],f);return r.a.makeTensor(p,h,u)}function h(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"numeric";if(!Array.isArray(e))throw new Error("Argument ".concat(t," passed to ").concat(n," must be a ")+"`Tensor[]` or `TensorLike[]`");var a=e;return a.map((function(e,a){return d(e,"".concat(t,"[").concat(a,"]"),n,r)}))}},function(e,t,n){"use strict";n.d(t,"b",(function(){return C})),n.d(t,"a",(function(){return T}));var r=n(161),a=n(65),i=n(13),o=n.n(i),s=n(20),c=n(147),u=n(149),l=n(204),d=n(153),h=n(221),f=n(146),p=n(203),m=n(148),v=n(202),g=function(){function e(t,n){Object(c.a)(this,e),this.backendTimer=t,this.logger=n,null==n&&(this.logger=new b)}return Object(u.a)(e,[{key:"profileKernel",value:function(e,t,n){var a,i,o=function(){a=n()},s=m.now();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();var c,u=Object(r.a)(a);try{for(u.s();!(c=u.n()).done;){c.value.dataSync()}}catch(f){u.e(f)}finally{u.f()}i=Promise.resolve({kernelMs:m.now()-s})}if(Object(d.b)().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(var l=function(t){var n=a[t];n.data().then((function(t){!function(e,t,n){if("float32"!==t)return!1;for(var r=0;r<e.length;r++){var a=e[r];if(isNaN(a)||!isFinite(a))return console.warn("Found ".concat(a," in the result of '").concat(n,"'")),!0}}(t,n.dtype,e)}))},h=0;h<a.length;h++)l(h);return{kernelName:e,outputs:a,inputs:t,timeMs:i.then((function(e){return e.kernelMs})),extraInfo:i.then((function(e){return null!=e.getExtraProfileInfo?e.getExtraProfileInfo():""}))}}},{key:"logKernelProfile",value:function(e){var t=this,n=e.kernelName,r=e.outputs,a=e.timeMs,i=e.inputs,o=e.extraInfo;r.forEach((function(e){Promise.all([e.data(),a,o]).then((function(r){t.logger.logKernelProfile(n,e,r[0],r[1],i,r[2])}))}))}}]),e}();var b=function(){function e(){Object(c.a)(this,e)}return Object(u.a)(e,[{key:"logKernelProfile",value:function(e,t,n,r,a,i){var o="number"===typeof r?v.L("".concat(r,"ms"),9):r.error,s=v.L(e,25),c=t.rank,u=t.size,l=v.L(t.shape.toString(),14),d="";for(var h in a){var f=a[h];if(null!=f){var p=f.shape||t.shape,m=p.length;d+="".concat(h,": ").concat(m,"D ").concat(m>0?p:""," ")}}console.log("%c".concat(s,"\t%c").concat(o,"\t%c").concat(c,"D ").concat(l,"\t%c").concat(u,"\t%c").concat(d,"\t%c").concat(i),"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}]),e}();function y(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(var o=0;o<e.length;o++){var s=e[o],c=s.inputs;for(var u in c){for(var l=c[u],d=!1,h=0;h<t.length;h++)if(r[l.id]){s.outputs.forEach((function(e){return r[e.id]=!0})),d=!0,a[s.id]=!0;break}if(d)break}}var f={};f[n.id]=!0;for(var p={},m=e.length-1;m>=0;m--)for(var v=e[m],g=v.inputs,b=0;b<v.outputs.length;b++)if(f[v.outputs[b].id]){for(var y in g)f[g[y].id]=!0,p[v.id]=!0;break}for(var x=[],w=0;w<e.length;w++){var O=e[w];if(a[O.id]&&p[O.id]){var A={};for(var _ in O.inputs){var E=O.inputs[_];r[E.id]&&(A[_]=E)}var S=Object.assign({},O);S.inputs=A,S.outputs=O.outputs,x.push(S)}}return x}function x(e,t,n,r){for(var a=function(a){var i=t[a],o=[];if(i.outputs.forEach((function(t){var n=e[t.id];null!=n?o.push(n):o.push(null)})),null==i.gradient)throw new Error("Cannot compute gradient: gradient function not found "+"for ".concat(i.kernelName,"."));var s=i.gradient(o),c=function(t){if(!(t in s))throw new Error("Cannot backprop through input ".concat(t,". ")+"Available gradients found: ".concat(Object.keys(s),"."));var a=n((function(){return s[t]()}));if("float32"!==a.dtype)throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"".concat(t," must have 'float32' dtype, but has '").concat(a.dtype,"'"));var o=i.inputs[t];if(!v.a(a.shape,o.shape))throw new Error("Error in gradient for op ".concat(i.kernelName,". The gradient of input ")+"'".concat(t,"' has shape '").concat(a.shape,"', which does not match ")+"the shape of the input '".concat(o.shape,"'"));if(null==e[o.id])e[o.id]=a;else{var c=e[o.id];e[o.id]=r(c,a),c.dispose()}};for(var u in i.inputs)c(u)},i=t.length-1;i>=0;i--)a(i)}var w=n(160),O=n(151);function A(e){return null!=e.kernelName}var _=function(){function e(){Object(c.a)(this,e),this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map((function(e){return e.name}))))}}}return Object(u.a)(e,[{key:"dispose",value:function(){for(var e in this.registeredVariables)this.registeredVariables[e].dispose()}}]),e}(),E=function(){function e(t){Object(c.a)(this,e),this.ENV=t,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new _}return Object(u.a)(e,[{key:"ready",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null==this.pendingBackendInit){e.next=2;break}return e.abrupt("return",this.pendingBackendInit.then((function(){})));case 2:if(null==this.backendInstance){e.next=4;break}return e.abrupt("return");case 4:t=this.getSortedBackends(),n=0;case 6:if(!(n<t.length)){e.next=18;break}return r=t[n],e.next=10,this.initializeBackend(r).success;case 10:if(!e.sent){e.next=15;break}return e.next=14,this.setBackend(r);case 14:return e.abrupt("return");case 15:n++,e.next=6;break;case 18:throw new Error("Could not initialize any backends, all backend initializations failed.");case 19:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"backend",get:function(){if(null!=this.pendingBackendInit)throw new Error("Backend '".concat(this.backendName,"' has not yet been initialized. Make ")+"sure to await tf.ready() or await tf.setBackend() before calling other methods");if(null==this.backendInstance){var e=this.initializeBackendsAndReturnBest(),t=e.name;if(e.asyncInit)throw new Error("The highest priority backend '".concat(t,"' has not yet been ")+"initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods");this.setBackend(t)}return this.backendInstance}},{key:"backendNames",value:function(){return Object.keys(this.registryFactory)}},{key:"findBackend",value:function(e){if(!(e in this.registry)){if(!(e in this.registryFactory))return null;if(this.initializeBackend(e).asyncInit)return null}return this.registry[e]}},{key:"findBackendFactory",value:function(e){return e in this.registryFactory?this.registryFactory[e].factory:null}},{key:"registerBackend",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return e in this.registryFactory?(console.warn("".concat(e," backend was already registered. ")+"Reusing existing backend factory."),!1):(this.registryFactory[e]={factory:t,priority:n},!0)}},{key:"setBackend",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!=this.registryFactory[t]){e.next=2;break}throw new Error("Backend name '".concat(t,"' not found in registry"));case 2:if(this.backendName=t,null!=this.registry[t]){e.next=16;break}if(this.backendInstance=null,n=this.initializeBackend(t),r=n.success,!n.asyncInit){e.next=12;break}return e.next=9,r;case 9:e.t0=e.sent,e.next=13;break;case 12:e.t0=r;case 13:if(e.t0){e.next=16;break}return e.abrupt("return",!1);case 16:return this.backendInstance=this.registry[t],this.setupRegisteredKernels(),this.profiler=new g(this.backendInstance),e.abrupt("return",!0);case 20:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setupRegisteredKernels",value:function(){var e=this;Object(p.c)(this.backendName).forEach((function(t){null!=t.setupFunc&&t.setupFunc(e.backendInstance)}))}},{key:"disposeRegisteredKernels",value:function(e){var t=this;Object(p.c)(e).forEach((function(n){null!=n.disposeFunc&&n.disposeFunc(t.registry[e])}))}},{key:"initializeBackend",value:function(e){var t=this,n=this.registryFactory[e];if(null==n)throw new Error("Cannot initialize backend ".concat(e,", no registration found."));try{var r=n.factory();if(!r||r instanceof l.b||"function"!==typeof r.then)return this.registry[e]=r,{success:!0,asyncInit:!1};var a=++this.pendingBackendInitId,i=r.then((function(n){return!(a<t.pendingBackendInitId)&&(t.registry[e]=n,t.pendingBackendInit=null,!0)})).catch((function(n){return a<t.pendingBackendInitId||(t.pendingBackendInit=null,console.warn("Initialization of backend ".concat(e," failed")),console.warn(n.stack||n.message)),!1}));return this.pendingBackendInit=i,{success:i,asyncInit:!0}}catch(o){return console.warn("Initialization of backend ".concat(e," failed")),console.warn(o.stack||o.message),{success:!1,asyncInit:!1}}}},{key:"removeBackend",value:function(e){if(!(e in this.registryFactory))throw new Error("".concat(e," backend not found in registry"));this.backendName===e&&null!=this.pendingBackendInit&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}},{key:"getSortedBackends",value:function(){var e=this;if(0===Object.keys(this.registryFactory).length)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((function(t,n){return e.registryFactory[n].priority-e.registryFactory[t].priority}))}},{key:"initializeBackendsAndReturnBest",value:function(){for(var e=this.getSortedBackends(),t=0;t<e.length;t++){var n=e[t],r=this.initializeBackend(n),a=r.success,i=r.asyncInit;if(i||a)return{name:n,asyncInit:i}}throw new Error("Could not initialize any backends, all backend initializations failed.")}},{key:"moveData",value:function(e,t){var n=this.state.tensorInfo.get(t),r=n.backend,a=this.readSync(t),i=r.refCount(t);r.disposeData(t,!0),n.backend=e,e.move(t,a,n.shape,n.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}},{key:"tidy",value:function(e,t){var n,r=this,a=null;if(null==t){if("function"!==typeof e)throw new Error("Please provide a function to tidy()");t=e}else{if("string"!==typeof e&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if("function"!==typeof t)throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");a=e}return this.scopedRun((function(){return r.startScope(a)}),(function(){return r.endScope(n)}),(function(){return(n=t())instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),n}))}},{key:"scopedRun",value:function(e,t,n){e();try{var r=n();return t(),r}catch(a){throw t(),a}}},{key:"nextTensorId",value:function(){return e.nextTensorId++}},{key:"nextVariableId",value:function(){return e.nextVariableId++}},{key:"clone",value:function(e){var t=T.runKernel(f.nb,{x:e}),n={x:e};return this.addTapeNode(this.state.activeScope.name,n,[t],(function(e){return{x:function(){var t={x:e},n={dtype:"float32"};return T.runKernel(f.v,t,n)}}}),[],{}),t}},{key:"runKernel",value:function(e,t,n){if(!(null!=Object(p.b)(e,this.backendName)))throw new Error("Kernel '".concat(e,"' not registered for backend '").concat(this.backendName,"'"));return this.runKernelFunc({kernelName:e,inputs:t,attrs:n})}},{key:"shouldCheckForMemLeaks",value:function(){return this.ENV.getBool("IS_TEST")}},{key:"checkKernelForMemLeak",value:function(e,t,n){var r=this.backend.numDataIds(),a=0;n.forEach((function(e){a+="complex64"===e.dtype?3:1}));var i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],o=r-t-a-i;if(o>0)throw new Error("Backend '".concat(this.backendName,"' has an internal memory leak ")+"(".concat(o," data ids) after running '").concat(e,"'"))}},{key:"runKernelFunc",value:function(e){var t,n,r,a=this,i=[],o=this.isTapeOn(),s=this.state.numBytes,c=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0),null==this.backendName&&this.backend;var u=A(e)?e.kernelName:null!=this.state.activeScope?this.state.activeScope.name:"";if(A(e)){var l=e.kernelName,d=e.inputs,h=e.attrs;null==this.backendName&&this.backend;var f=Object(p.b)(l,this.backendName);v.b(null!=f,(function(){return"Cannot find registered kernel '".concat(l,"' for backend '").concat(a.backendName,"'")})),n=function(){var e=a.backend.numDataIds();r=f.kernelFunc({inputs:d,attrs:h,backend:a.backend});var t=Array.isArray(r)?r:[r];a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(l,e,t);var n=t.map((function(e){if(null!=e.rank)return e;var t=e.dataId,n=e.shape,r=e.dtype;return a.makeTensorFromDataId(t,n,r)}));if(o){var s=a.getTensorsForGradient(l,d,n);i=a.saveTensorsForBackwardMode(s)}return n}}else{var m=e.forwardFunc,g=function(e){o&&(i=e.map((function(e){return a.keep(a.clone(e))})))};n=function(){var e=a.backend.numDataIds();r=a.tidy((function(){return m(a.backend,g)}));var t=Array.isArray(r)?r:[r];return a.shouldCheckForMemLeaks()&&a.checkKernelForMemLeak(u,e,t),t}}var b,y=e.inputs,x=e.attrs,w=A(e)?null:e.backwardsFunc;return this.scopedRun((function(){return a.state.kernelDepth++}),(function(){return a.state.kernelDepth--}),(function(){a.ENV.getBool("DEBUG")||a.state.profiling?(b=a.profiler.profileKernel(u,y,(function(){return n()})),a.ENV.getBool("DEBUG")&&a.profiler.logKernelProfile(b),t=b.outputs):t=n()})),o&&this.addTapeNode(u,y,t,w,i,x),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-s,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-c,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(y).map((function(e){return null!=y[e]?y[e].shape:null})),outputShapes:t.map((function(e){return e.shape})),kernelTimeMs:b.timeMs,extraInfo:b.extraInfo}),Array.isArray(r)?t:t[0]}},{key:"saveTensorsForBackwardMode",value:function(e){var t=this;return e.map((function(e){return t.keep(t.clone(e))}))}},{key:"getTensorsForGradient",value:function(e,t,n){var r=Object(p.a)(e);if(null!=r){var a,i=r.inputsToSave||[],o=r.outputsToSave||[];r.saveAllInputs?(v.b(Array.isArray(t),(function(){return"saveAllInputs is true, expected inputs to be an array."})),a=Object.keys(t).map((function(e){return t[e]}))):a=i.map((function(e){return t[e]}));var s=n.filter((function(e,t){return o[t]}));return a.concat(s)}return[]}},{key:"makeTensor",value:function(e,t,n,r){if(null==e)throw new Error("Values passed to engine.makeTensor() are null");n=n||"float32",r=r||this.backend;var a=e;"string"===n&&v.z(e[0])&&(a=e.map((function(e){return m.encodeString(e)})));var i=r.write(a,t,n),o=new w.a(t,n,i,this.nextTensorId());if(this.trackTensor(o,r),"string"===n){var s=this.state.tensorInfo.get(i),c=Object(v.f)(a);this.state.numBytes+=c-s.bytes,s.bytes=c}return o}},{key:"makeTensorFromDataId",value:function(e,t,n,r){n=n||"float32";var a=new w.a(t,n,e,this.nextTensorId());return this.trackTensor(a,r),a}},{key:"makeVariable",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;n=n||this.nextVariableId().toString(),null!=r&&r!==e.dtype&&(e=e.cast(r));var a=new w.c(e,t,n,this.nextTensorId());if(null!=this.state.registeredVariables[a.name])throw new Error("Variable with name ".concat(a.name," was already registered"));return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}},{key:"trackTensor",value:function(e,t){this.state.numTensors++,"string"===e.dtype&&this.state.numStringTensors++;var n=0;"complex64"!==e.dtype&&"string"!==e.dtype&&(n=e.size*v.g(e.dtype)),this.state.numBytes+=n,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:n})),e instanceof w.c||this.track(e)}},{key:"incRef",value:function(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}},{key:"removeDataId",value:function(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}},{key:"disposeTensor",value:function(e){if(this.state.tensorInfo.has(e.dataId)){var t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,"string"===e.dtype&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),"complex64"!==e.dtype&&"string"!==e.dtype){var n=e.size*v.g(e.dtype);this.state.numBytes-=n}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}}},{key:"disposeVariables",value:function(){for(var e in this.state.registeredVariables){var t=this.state.registeredVariables[e];this.disposeVariable(t)}}},{key:"disposeVariable",value:function(e){this.disposeTensor(e),null!=this.state.registeredVariables[e.name]&&delete this.state.registeredVariables[e.name]}},{key:"memory",value:function(){var e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,null==e.reasons&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}},{key:"profile",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,i,s,c,u;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state.profiling=!0,n=this.state.numBytes,i=this.state.numTensors,this.state.activeProfile.kernels=[],e.next=6,t();case 6:this.state.activeProfile.result=e.sent,this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max.apply(Math,Object(a.a)(this.state.activeProfile.kernels.map((function(e){return e.totalBytesSnapshot})))),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-i,s=Object(r.a)(this.state.activeProfile.kernels),e.prev=12,s.s();case 14:if((c=s.n()).done){e.next=24;break}return u=c.value,e.next=18,u.kernelTimeMs;case 18:return u.kernelTimeMs=e.sent,e.next=21,u.extraInfo;case 21:u.extraInfo=e.sent;case 22:e.next=14;break;case 24:e.next=29;break;case 26:e.prev=26,e.t0=e.catch(12),s.e(e.t0);case 29:return e.prev=29,s.f(),e.finish(29);case 32:return e.abrupt("return",this.state.activeProfile);case 33:case"end":return e.stop()}}),e,this,[[12,26,29,32]])})));return function(t){return e.apply(this,arguments)}}()},{key:"isTapeOn",value:function(){return this.state.gradientDepth>0&&0===this.state.kernelDepth}},{key:"addTapeNode",value:function(e,t,n,r,a,i){var o=this,s={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:n,saved:a},c=Object(p.a)(e);null!=c&&(r=c.gradFunc),null!=r&&(s.gradient=function(e){return e=e.map((function(e,t){if(null==e){var r=n[t],a=v.F(r.size,r.dtype);return o.makeTensor(a,r.shape,r.dtype)}return e})),r(e.length>1?e:e[0],a,i)}),this.state.activeTape.push(s)}},{key:"keep",value:function(e){return e.kept=!0,e}},{key:"startTape",value:function(){0===this.state.gradientDepth&&(this.state.activeTape=[]),this.state.gradientDepth++}},{key:"endTape",value:function(){this.state.gradientDepth--}},{key:"startScope",value:function(e){var t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}},{key:"endScope",value:function(e){for(var t=this,n=Object(O.a)(e),r=new Set(n.map((function(e){return e.id}))),a=0;a<this.state.activeScope.track.length;a++){var i=this.state.activeScope.track[a];i.kept||r.has(i.id)||i.dispose()}var o=this.state.scopeStack.pop();this.state.activeScope=0===this.state.scopeStack.length?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach((function(e){e.kept||e.scopeId!==o.id||t.track(e)}))}},{key:"gradients",value:function(e,t,n){var a=this,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(v.b(t.length>0,(function(){return"gradients() received an empty list of xs."})),null!=n&&"float32"!==n.dtype)throw new Error("dy must have 'float32' dtype, but has '".concat(n.dtype,"'"));var o=this.scopedRun((function(){return a.startTape()}),(function(){return a.endTape()}),(function(){return a.tidy("forward",e)}));v.b(o instanceof w.a,(function(){return"The result y returned by f() must be a tensor."}));var s=y(this.state.activeTape,t,o);if(!i&&0===s.length&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",(function(){var e={};e[o.id]=null==n?S(o.shape):n,x(e,s,(function(e){return a.tidy(e)}),M);var i=t.map((function(t){return e[t.id]}));return 0===a.state.gradientDepth&&(a.state.activeTape.forEach((function(e){var t,n=Object(r.a)(e.saved);try{for(n.s();!(t=n.n()).done;){t.value.dispose()}}catch(a){n.e(a)}finally{n.f()}})),a.state.activeTape=null),{value:o,grads:i}}))}},{key:"customGrad",value:function(e){var t=this;return v.b(v.u(e),(function(){return"The f passed in customGrad(f) must be a function."})),function(){for(var n=arguments.length,r=new Array(n),a=0;a<n;a++)r[a]=arguments[a];var i;v.b(r.every((function(e){return e instanceof w.a})),(function(){return"The args passed in customGrad(f)(x1, x2,...) must all be tensors"}));var o={};r.forEach((function(e,t){o[t]=e}));var s=function(t,n){return i=e.apply(void 0,[].concat(r,[n])),v.b(i.value instanceof w.a,(function(){return"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"})),v.b(v.u(i.gradFunc),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."})),i.value},c=function(e,t){var n=i.gradFunc(e,t),a=Array.isArray(n)?n:[n];v.b(a.length===r.length,(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."})),v.b(a.every((function(e){return e instanceof w.a})),(function(){return"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors."}));var o={};return a.forEach((function(e,t){o[t]=function(){return e}})),o};return t.runKernelFunc({forwardFunc:s,backwardsFunc:c,inputs:o})}}},{key:"readSync",value:function(e){return this.state.tensorInfo.get(e).backend.readSync(e)}},{key:"read",value:function(e){return this.state.tensorInfo.get(e).backend.read(e)}},{key:"time",value:function(){var e=Object(s.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(m.now)(),e.next=3,this.backend.time(t);case 3:return(r=e.sent).wallMs=Object(m.now)()-n,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"track",value:function(e){return null!=this.state.activeScope&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}},{key:"registeredVariables",get:function(){return this.state.registeredVariables}},{key:"reset",value:function(){for(var e in this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new _,this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}]),e}();function S(e){var t=Object(v.D)(Object(v.O)(e),"float32");return T.makeTensor(t,e,"float32")}function C(){var e=Object(h.b)();if(null==e._tfengine){var t=new d.a(e);e._tfengine=new E(t)}return Object(d.c)(e._tfengine.ENV),Object(w.f)((function(){return e._tfengine})),e._tfengine}E.nextTensorId=0,E.nextVariableId=0;var T=C();function M(e,t){var n={a:e,b:t};return T.runKernel(f.d,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return h})),n.d(t,"k",(function(){return f})),n.d(t,"l",(function(){return p})),n.d(t,"n",(function(){return m})),n.d(t,"m",(function(){return v})),n.d(t,"o",(function(){return g})),n.d(t,"r",(function(){return b})),n.d(t,"p",(function(){return y})),n.d(t,"q",(function(){return x})),n.d(t,"s",(function(){return w})),n.d(t,"t",(function(){return O})),n.d(t,"u",(function(){return A})),n.d(t,"v",(function(){return _})),n.d(t,"w",(function(){return E})),n.d(t,"x",(function(){return S})),n.d(t,"y",(function(){return C})),n.d(t,"z",(function(){return T})),n.d(t,"A",(function(){return M})),n.d(t,"B",(function(){return k})),n.d(t,"C",(function(){return R})),n.d(t,"D",(function(){return I})),n.d(t,"E",(function(){return j})),n.d(t,"F",(function(){return B})),n.d(t,"G",(function(){return L})),n.d(t,"H",(function(){return N})),n.d(t,"I",(function(){return D})),n.d(t,"K",(function(){return P})),n.d(t,"J",(function(){return F})),n.d(t,"L",(function(){return G})),n.d(t,"M",(function(){return U})),n.d(t,"N",(function(){return z})),n.d(t,"O",(function(){return H})),n.d(t,"P",(function(){return V})),n.d(t,"Q",(function(){return W})),n.d(t,"R",(function(){return J})),n.d(t,"fc",(function(){return X})),n.d(t,"S",(function(){return K})),n.d(t,"T",(function(){return q})),n.d(t,"V",(function(){return Y})),n.d(t,"U",(function(){return Q})),n.d(t,"W",(function(){return Z})),n.d(t,"X",(function(){return $})),n.d(t,"Y",(function(){return ee})),n.d(t,"Z",(function(){return te})),n.d(t,"ab",(function(){return ne})),n.d(t,"bb",(function(){return re})),n.d(t,"cb",(function(){return ae})),n.d(t,"db",(function(){return ie})),n.d(t,"fb",(function(){return oe})),n.d(t,"jb",(function(){return se})),n.d(t,"ib",(function(){return ce})),n.d(t,"kb",(function(){return ue})),n.d(t,"lb",(function(){return le})),n.d(t,"nb",(function(){return de})),n.d(t,"mb",(function(){return he})),n.d(t,"ob",(function(){return fe})),n.d(t,"pb",(function(){return pe})),n.d(t,"qb",(function(){return me})),n.d(t,"rb",(function(){return ve})),n.d(t,"ub",(function(){return ge})),n.d(t,"vb",(function(){return be})),n.d(t,"wb",(function(){return ye})),n.d(t,"xb",(function(){return xe})),n.d(t,"yb",(function(){return we})),n.d(t,"zb",(function(){return Oe})),n.d(t,"Ab",(function(){return Ae})),n.d(t,"Bb",(function(){return _e})),n.d(t,"Cb",(function(){return Ee})),n.d(t,"sb",(function(){return Se})),n.d(t,"tb",(function(){return Ce})),n.d(t,"Db",(function(){return Te})),n.d(t,"Jb",(function(){return Me})),n.d(t,"Eb",(function(){return ke})),n.d(t,"Hb",(function(){return Re})),n.d(t,"Fb",(function(){return Ie})),n.d(t,"Gb",(function(){return je})),n.d(t,"Ib",(function(){return Be})),n.d(t,"Kb",(function(){return Le})),n.d(t,"Lb",(function(){return Ne})),n.d(t,"Mb",(function(){return De})),n.d(t,"Nb",(function(){return Pe})),n.d(t,"Ob",(function(){return Fe})),n.d(t,"Pb",(function(){return Ge})),n.d(t,"Qb",(function(){return Ue})),n.d(t,"Rb",(function(){return ze})),n.d(t,"Vb",(function(){return He})),n.d(t,"Sb",(function(){return Ve})),n.d(t,"Tb",(function(){return We})),n.d(t,"Ub",(function(){return Je})),n.d(t,"Xb",(function(){return Xe})),n.d(t,"Wb",(function(){return Ke})),n.d(t,"Yb",(function(){return qe})),n.d(t,"Zb",(function(){return Ye})),n.d(t,"ac",(function(){return Qe})),n.d(t,"bc",(function(){return Ze})),n.d(t,"cc",(function(){return $e})),n.d(t,"dc",(function(){return et})),n.d(t,"ec",(function(){return tt})),n.d(t,"gc",(function(){return nt})),n.d(t,"hc",(function(){return rt})),n.d(t,"jc",(function(){return at})),n.d(t,"mc",(function(){return it})),n.d(t,"nc",(function(){return ot})),n.d(t,"kc",(function(){return st})),n.d(t,"lc",(function(){return ct})),n.d(t,"ic",(function(){return ut})),n.d(t,"oc",(function(){return lt})),n.d(t,"qc",(function(){return dt})),n.d(t,"rc",(function(){return ht})),n.d(t,"sc",(function(){return ft})),n.d(t,"tc",(function(){return pt})),n.d(t,"uc",(function(){return mt})),n.d(t,"zc",(function(){return vt})),n.d(t,"xc",(function(){return gt})),n.d(t,"yc",(function(){return bt})),n.d(t,"wc",(function(){return yt})),n.d(t,"vc",(function(){return xt})),n.d(t,"Bc",(function(){return wt})),n.d(t,"Fc",(function(){return Ot})),n.d(t,"Lc",(function(){return At})),n.d(t,"Cc",(function(){return _t})),n.d(t,"Ec",(function(){return Et})),n.d(t,"Ac",(function(){return St})),n.d(t,"Hc",(function(){return Ct})),n.d(t,"Gc",(function(){return Tt})),n.d(t,"Kc",(function(){return Mt})),n.d(t,"Dc",(function(){return kt})),n.d(t,"Jc",(function(){return Rt})),n.d(t,"Mc",(function(){return It})),n.d(t,"Nc",(function(){return jt})),n.d(t,"Oc",(function(){return Bt})),n.d(t,"Pc",(function(){return Lt})),n.d(t,"Qc",(function(){return Nt})),n.d(t,"Rc",(function(){return Dt})),n.d(t,"Sc",(function(){return Pt})),n.d(t,"Tc",(function(){return Ft})),n.d(t,"Uc",(function(){return Gt})),n.d(t,"Vc",(function(){return Ut})),n.d(t,"Ic",(function(){return zt})),n.d(t,"eb",(function(){return Ht})),n.d(t,"pc",(function(){return Vt})),n.d(t,"Wc",(function(){return Wt})),n.d(t,"gb",(function(){return Jt})),n.d(t,"hb",(function(){return Xt}));var r="Abs",a="Acos",i="Acosh",o="Add",s="AddN",c="All",u="Any",l="ArgMax",d="ArgMin",h="Asin",f="Asinh",p="Atan",m="Atanh",v="Atan2",g="AvgPool",b="AvgPoolGrad",y="AvgPool3D",x="AvgPool3DGrad",w="BatchMatMul",O="BatchToSpaceND",A="Bincount",_="Cast",E="Ceil",S="ClipByValue",C="Complex",T="ComplexAbs",M="Concat",k="Conv2D",R="Conv2DBackpropFilter",I="Conv2DBackpropInput",j="Conv3D",B="Conv3DBackpropFilterV2",L="Conv3DBackpropInputV2",N="Cos",D="Cosh",P="Cumsum",F="CropAndResize",G="DenseBincount",U="DepthToSpace",z="DepthwiseConv2dNative",H="DepthwiseConv2dNativeBackpropFilter",V="DepthwiseConv2dNativeBackpropInput",W="Diag",J="Dilation2D",X="RealDiv",K="Elu",q="EluGrad",Y="Erf",Q="Equal",Z="Exp",$="ExpandDims",ee="Expm1",te="FFT",ne="Fill",re="FlipLeftRight",ae="Floor",ie="FloorDiv",oe="FusedBatchNorm",se="GatherV2",ce="GatherNd",ue="Greater",le="GreaterEqual",de="Identity",he="IFFT",fe="Imag",pe="IsFinite",me="IsInf",ve="IsNan",ge="LeakyRelu",be="Less",ye="LessEqual",xe="LinSpace",we="Log",Oe="Log1p",Ae="LogicalAnd",_e="LogicalNot",Ee="LogicalOr",Se="LRN",Ce="LRNGrad",Te="Max",Me="Maximum",ke="MaxPool",Re="MaxPoolGrad",Ie="MaxPool3D",je="MaxPool3DGrad",Be="MaxPoolWithArgmax",Le="Mean",Ne="Min",De="Minimum",Pe="MirrorPad",Fe="Mod",Ge="Multinomial",Ue="Multiply",ze="Neg",He="NotEqual",Ve="NonMaxSuppressionV3",We="NonMaxSuppressionV4",Je="NonMaxSuppressionV5",Xe="OnesLike",Ke="OneHot",qe="Pack",Ye="PadV2",Qe="Pow",Ze="Prelu",$e="Prod",et="Range",tt="Real",nt="Reciprocal",rt="Relu",at="Reshape",it="ResizeNearestNeighbor",ot="ResizeNearestNeighborGrad",st="ResizeBilinear",ct="ResizeBilinearGrad",ut="Relu6",lt="Reverse",dt="Round",ht="Rsqrt",ft="ScatterNd",pt="Select",mt="Selu",vt="Slice",gt="Sin",bt="Sinh",yt="Sign",xt="Sigmoid",wt="Softplus",Ot="Sqrt",At="Sum",_t="SpaceToBatchND",Et="SplitV",St="Softmax",Ct="SquaredDifference",Tt="Square",Mt="Sub",kt="SparseToDense",Rt="StridedSlice",It="Tan",jt="Tanh",Bt="Tile",Lt="TopK",Nt="Transform",Dt="Transpose",Pt="Unique",Ft="Unpack",Gt="UnsortedSegmentSum",Ut="ZerosLike",zt="Step",Ht="FromPixels",Vt="RotateWithOffset",Wt="_FusedMatMul",Jt="FusedConv2D",Xt="FusedDepthwiseConv2D"},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.r(t),n.d(t,"createScalarValue",(function(){return i})),n.d(t,"toTypedArray",(function(){return o})),n.d(t,"now",(function(){return s})),n.d(t,"fetch",(function(){return c})),n.d(t,"encodeString",(function(){return u})),n.d(t,"decodeString",(function(){return l}));var r=n(153),a=n(202);function i(e,t){return"string"===t?u(e):o([e],t)}function o(e,t){if("string"===t)throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(e)&&(e=a.m(e)),Object(r.b)().getBool("DEBUG")&&a.h(e,t),function(e,t){return e instanceof Float32Array&&"float32"===t||e instanceof Int32Array&&"int32"===t||e instanceof Uint8Array&&"bool"===t}(e,t))return e;if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t){for(var n=new Uint8Array(e.length),i=0;i<n.length;++i)0!==Math.round(e[i])&&(n[i]=1);return n}throw new Error("Unknown data type ".concat(t))}function s(){return Object(r.b)().platform.now()}function c(e,t){return Object(r.b)().platform.fetch(e,t)}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Object(r.b)().platform.encode(e,t)}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf-8";return t=t||"utf-8",Object(r.b)().platform.decode(e,t)}n.d(t,"shuffle",(function(){return a.M})),n.d(t,"shuffleCombo",(function(){return a.N})),n.d(t,"clamp",(function(){return a.i})),n.d(t,"nearestLargerEven",(function(){return a.H})),n.d(t,"sum",(function(){return a.R})),n.d(t,"randUniform",(function(){return a.J})),n.d(t,"distSquared",(function(){return a.l})),n.d(t,"assert",(function(){return a.b})),n.d(t,"assertShapesMatch",(function(){return a.e})),n.d(t,"assertNonNull",(function(){return a.d})),n.d(t,"flatten",(function(){return a.m})),n.d(t,"sizeFromShape",(function(){return a.O})),n.d(t,"isScalarShape",(function(){return a.y})),n.d(t,"arraysEqual",(function(){return a.a})),n.d(t,"isInt",(function(){return a.v})),n.d(t,"tanh",(function(){return a.S})),n.d(t,"sizeToSquarishShape",(function(){return a.P})),n.d(t,"createShuffledIndices",(function(){return a.k})),n.d(t,"rightPad",(function(){return a.L})),n.d(t,"repeatedTry",(function(){return a.K})),n.d(t,"inferFromImplicitShape",(function(){return a.s})),n.d(t,"parseAxisParam",(function(){return a.I})),n.d(t,"squeezeShape",(function(){return a.Q})),n.d(t,"getTypedArrayFromDType",(function(){return a.o})),n.d(t,"getArrayFromDType",(function(){return a.n})),n.d(t,"checkConversionForErrors",(function(){return a.h})),n.d(t,"isValidDtype",(function(){return a.B})),n.d(t,"hasEncodingLoss",(function(){return a.p})),n.d(t,"isTypedArray",(function(){return a.A})),n.d(t,"bytesPerElement",(function(){return a.g})),n.d(t,"bytesFromStringArray",(function(){return a.f})),n.d(t,"isString",(function(){return a.z})),n.d(t,"isBoolean",(function(){return a.t})),n.d(t,"isNumber",(function(){return a.w})),n.d(t,"inferDtype",(function(){return a.r})),n.d(t,"isFunction",(function(){return a.u})),n.d(t,"nearestDivisor",(function(){return a.G})),n.d(t,"computeStrides",(function(){return a.j})),n.d(t,"toNestedArray",(function(){return a.T})),n.d(t,"makeOnesTypedArray",(function(){return a.D})),n.d(t,"makeZerosTypedArray",(function(){return a.F})),n.d(t,"makeZerosNestedTypedArray",(function(){return a.E})),n.d(t,"assertNonNegativeIntegerDimensions",(function(){return a.c})),n.d(t,"locToIndex",(function(){return a.C})),n.d(t,"indexToLoc",(function(){return a.q})),n.d(t,"isPromise",(function(){return a.x}))},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({reshape_:function(e,t){var n={x:Object(i.a)(e,"x","reshape","string_or_numeric")},o={shape:t};return r.a.runKernel(a.jc,n,o)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}));var r=n(160),a=n(173);n(202);function i(e,t){if(e.dtype===t.dtype)return[e,t];var n=Object(a.b)(e.dtype,t.dtype);return[e.cast(n),t.cast(n)]}function o(e){var t=[];return s(e,t,new Set),t}function s(e,t,n){if(null!=e)if(e instanceof r.a)t.push(e);else if(a=e,Array.isArray(a)||"object"===typeof a){var a,i=e;for(var o in i){var c=i[o];n.has(c)||(n.add(c),s(c,t,n))}}}},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return h}));var r=n(12),a=n(142);function i(e,t,n,r,i){var s=t.inputParams[e];if(s&&void 0!==s.inputIndexStart){var c=s.inputIndexStart,u=0===s.inputIndexEnd?void 0:void 0===s.inputIndexEnd?c+1:s.inputIndexEnd;if("tensor"===s.type)return o(t.inputNames[s.inputIndexStart],n,r,i);if("tensors"===s.type)return t.inputNames.slice(c,u).map((function(e){return o(e,n,r,i)}));var l=o(t.inputNames.slice(c)[0],n,r,i),d=l.dataSync();return"number"===s.type?d[0]:a.Ld.toNestedArray(l.shape,d)}var h=t.attrParams[e];return h&&h.value}function o(e,t,n,a){var i=l(e),o=Object(r.a)(i,2),s=o[0],c=o[1];if(null!=a){var d=a.getHashTableHandleByName(s);if(null!=d)return d}var h=n.currentContextIds.find((function(e){return!!t[u(s,e)]}));return void 0!==h?t[u(s,h)][c]:void 0}function s(e,t,n){return t[u(e,n.currentContextId)]}function c(e,t){var n=l(e),a=Object(r.a)(n,2),i=a[0],o=a[1];return[u(i,t&&t.currentContextId),o]}function u(e,t){return t?"".concat(e,"-").concat(t):e}function l(e){var t=e.split(":");return 1===t.length?[e,0]:[t[0],Number(t[t.length-1])]}function d(e,t,n){var r=i("pad",e,t,n);if("explicit"===r){r=i("explicitPaddings",e,t,n);for(var a=[[0,0],[0,0],[0,0],[0,0]],o=0;o<4;o++)a[o][0]=r[2*o],a[o][1]=r[2*o+1];return a}return r}function h(e){return e.kept?e:Object(a.gd)(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"c",(function(){return m}));var r=n(12),a=n(13),i=n.n(a),o=n(20),s=n(147),c=n(149),u=n(202),l="tfjsflags",d=function(){function e(t){Object(s.a)(this,e),this.global=t,this.flags={},this.flagRegistry={},this.urlFlags={},this.populateURLFlags()}return Object(c.a)(e,[{key:"setPlatform",value:function(e,t){null!=this.platform&&console.warn("Platform ".concat(this.platformName," has already been set. ")+"Overwriting the platform with ".concat(t,".")),this.platformName=e,this.platform=t}},{key:"registerFlag",value:function(e,t,n){if(this.flagRegistry[e]={evaluationFn:t,setHook:n},null!=this.urlFlags[e]){var r=this.urlFlags[e];console.warn("Setting feature override from URL ".concat(e,": ").concat(r,".")),this.set(e,r)}}},{key:"getAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t in this.flags)){e.next=2;break}return e.abrupt("return",this.flags[t]);case 2:return e.next=4,this.evaluateFlag(t);case 4:return this.flags[t]=e.sent,e.abrupt("return",this.flags[t]);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"get",value:function(e){if(e in this.flags)return this.flags[e];var t=this.evaluateFlag(e);if(Object(u.x)(t))throw new Error("Flag ".concat(e," cannot be synchronously evaluated. ")+"Please use getAsync() instead.");return this.flags[e]=t,this.flags[e]}},{key:"getNumber",value:function(e){return this.get(e)}},{key:"getBool",value:function(e){return this.get(e)}},{key:"getFlags",value:function(){return this.flags}},{key:"features",get:function(){return this.flags}},{key:"set",value:function(e,t){if(null==this.flagRegistry[e])throw new Error("Cannot set flag ".concat(e," as it has not been registered."));this.flags[e]=t,null!=this.flagRegistry[e].setHook&&this.flagRegistry[e].setHook(t)}},{key:"evaluateFlag",value:function(e){if(null==this.flagRegistry[e])throw new Error("Cannot evaluate flag '".concat(e,"': no evaluation function found."));return this.flagRegistry[e].evaluationFn()}},{key:"setFlags",value:function(e){this.flags=Object.assign({},e)}},{key:"reset",value:function(){this.flags={},this.urlFlags={},this.populateURLFlags()}},{key:"populateURLFlags",value:function(){var e=this;if("undefined"!==typeof this.global&&"undefined"!==typeof this.global.location&&"undefined"!==typeof this.global.location.search){var t=function(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return h(t,r[0],r[1]),r.join("=")})),t}(this.global.location.search);if(l in t)t.tfjsflags.split(",").forEach((function(t){var n=t.split(":"),a=Object(r.a)(n,2),i=a[0],o=a[1];e.urlFlags[i]=function(e,t){if("true"===(t=t.toLowerCase())||"false"===t)return"true"===t;if("".concat(+t)===t)return+t;throw new Error("Could not parse value flag value ".concat(t," for flag ").concat(e,"."))}(i,o)}))}}}]),e}();function h(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||"")}function f(){return p}var p=null;function m(e){p=e}},function(e,t,n){"use strict";function r(e,t){for(var n=e.length,r=[],a=0;a<n;a++){var i=n-1-a,o=e[i]||1;(t[t.length-1-a]||1)>1&&1===o&&r.unshift(i)}return r}function a(e,t){for(var n=[],r=0;r<t.length;r++){var a=e[e.length-r-1],i=t.length-r-1,o=t[i];(null==a||1===a&&o>1)&&n.unshift(i)}return n}function i(e,t){for(var n=[],r=Math.max(e.length,t.length),a=0;a<r;a++){var i=e[e.length-a-1];null==i&&(i=1);var o=t[t.length-a-1];if(null==o&&(o=1),1===i)n.unshift(o);else if(1===o)n.unshift(i);else{if(i!==o){var s="Operands could not be broadcast together with shapes "+"".concat(e," and ").concat(t,".");throw Error(s)}n.unshift(i)}}return n}n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return i}))},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(143);var u=Object(c.a)({mul_:function(e,t){var n=Object(s.a)(e,"a","mul"),c=Object(s.a)(t,"b","mul"),u=Object(o.b)(n,c),l=Object(r.a)(u,2),d={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.Qb,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({cast_:function(e,t){var n=Object(i.a)(e,"x","cast");if(!o.B(t))throw new Error("Failed to cast to unknown dtype ".concat(t));if("string"===t&&"string"!==n.dtype||"string"!==t&&"string"===n.dtype)throw new Error("Only strings can be casted to strings");var s={x:n},c={dtype:t};return r.a.runKernel(a.v,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(143);var u=Object(c.a)({sub_:function(e,t){var n=Object(s.a)(e,"a","sub"),c=Object(s.a)(t,"b","sub"),u=Object(o.b)(n,c),l=Object(r.a)(u,2),d={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.Kc,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(202),a=n(191);function i(e,t){if((Object(r.A)(e)&&"string"!==t||Array.isArray(e))&&"complex64"!==t)throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if("string"===t&&Object(r.A)(e)&&!(e instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Object(a.a)(e,[],[],t)}},function(e,t,n){"use strict";n.d(t,"b",(function(){return y})),n.d(t,"f",(function(){return O})),n.d(t,"e",(function(){return A})),n.d(t,"d",(function(){return _})),n.d(t,"a",(function(){return E})),n.d(t,"c",(function(){return S}));var r=n(171),a=n(172),i=n(13),o=n.n(i),s=n(20),c=n(147),u=n(149),l=n(221),d=n(65),h=n(202);function f(e,t,n,r){var a=Object(h.j)(t),i=function(e,t,n,r){var a=Object(h.O)(t),i=r[r.length-1],o=new Array(i).fill(0),s=t.length,c="complex64"===n?g(e):e;if(s>1)for(var u=0;u<a/i;u++)for(var l=u*i,d=0;d<i;d++)o[d]=Math.max(o[d],p(c[l+d],0,n).length);return o}(e,t,n,a),o=t.length,s=v(e,t,n,a,i),c=["Tensor"];return r&&(c.push("  dtype: ".concat(n)),c.push("  rank: ".concat(o)),c.push("  shape: [".concat(t,"]")),c.push("  values:")),c.push(s.map((function(e){return"    "+e})).join("\n")),c.join("\n")}function p(e,t,n){var r;return r=Array.isArray(e)?"".concat(parseFloat(e[0].toFixed(7))," + ")+"".concat(parseFloat(e[1].toFixed(7)),"j"):Object(h.z)(e)?"'".concat(e,"'"):"bool"===n?m(e):parseFloat(e.toFixed(7)).toString(),Object(h.L)(r,t)}function m(e){return 0===e?"false":"true"}function v(e,t,n,r,a){var i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],o="complex64"===n?2:1,s=t[0],c=t.length;if(0===c){if("complex64"===n){var u=g(e);return[p(u[0],0,n)]}return"bool"===n?[m(e[0])]:[e[0].toString()]}if(1===c){if(s>20){var l=3*o,h=Array.from(e.slice(0,l)),f=Array.from(e.slice((s-3)*o,s*o));return"complex64"===n&&(h=g(h),f=g(f)),["["+h.map((function(e,t){return p(e,a[t],n)})).join(", ")+", ..., "+f.map((function(e,t){return p(e,a[s-3+t],n)})).join(", ")+"]"]}var b="complex64"===n?g(e):Array.from(e);return["["+b.map((function(e,t){return p(e,a[t],n)})).join(", ")+"]"]}var y=t.slice(1),x=r.slice(1),w=r[0]*o,O=[];if(s>20){for(var A=0;A<3;A++){var _=A*w,E=_+w;O.push.apply(O,Object(d.a)(v(e.slice(_,E),y,n,x,a,!1)))}O.push("...");for(var S=s-3;S<s;S++){var C=S*w,T=C+w;O.push.apply(O,Object(d.a)(v(e.slice(C,T),y,n,x,a,S===s-1)))}}else for(var M=0;M<s;M++){var k=M*w,R=k+w;O.push.apply(O,Object(d.a)(v(e.slice(k,R),y,n,x,a,M===s-1)))}var I=2===c?",":"";O[0]="["+O[0]+I;for(var j=1;j<O.length-1;j++)O[j]=" "+O[j]+I;for(var B=",\n",L=2;L<c;L++)B+="\n";return O[O.length-1]=" "+O[O.length-1]+"]"+(i?"":B),O}function g(e){for(var t=[],n=0;n<e.length;n+=2)t.push([e[n],e[n+1]]);return t}var b=n(148),y=function(){function e(t,n,r){var a=this;if(Object(c.a)(this,e),this.dtype=n,this.shape=t.slice(),this.size=h.O(t),null!=r){var i=r.length;h.b(i===this.size,(function(){return"Length of values '".concat(i,"' does not match the size ")+"inferred by the shape '".concat(a.size,"'.")}))}if("complex64"===n)throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||h.n(n,this.size),this.strides=Object(h.j)(t)}return Object(u.a)(e,[{key:"set",value:function(e){for(var t=this,n=arguments.length,r=new Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];0===r.length&&(r=[0]),h.b(r.length===this.rank,(function(){return"The number of provided coordinates (".concat(r.length,") must ")+"match the rank (".concat(t.rank,")")}));var i=this.locToIndex(r);this.values[i]=e}},{key:"get",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];0===t.length&&(t=[0]);for(var r=0,a=0,i=t;a<i.length;a++){var o=i[a];if(o<0||o>=this.shape[r]){var s="Requested out of range element at ".concat(t,". ")+"  Buffer shape=".concat(this.shape);throw new Error(s)}r++}for(var c=t[t.length-1],u=0;u<t.length-1;++u)c+=this.strides[u]*t[u];return this.values[c]}},{key:"locToIndex",value:function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t}},{key:"indexToLoc",value:function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t}},{key:"rank",get:function(){return this.shape.length}},{key:"toTensor",value:function(){return x().makeTensor(this.values,this.shape,this.dtype)}}]),e}(),x=null,w=null;function O(e){x=e}function A(e){w=e}function _(e){e}var E=function(){function e(t,n,r,a){Object(c.a)(this,e),this.kept=!1,this.isDisposedInternal=!1,this.shape=t.slice(),this.dtype=n||"float32",this.size=h.O(t),this.strides=Object(h.j)(t),this.dataId=r,this.id=a,this.rankType=this.rank<5?this.rank.toString():"higher"}return Object(u.a)(e,[{key:"rank",get:function(){return this.shape.length}},{key:"buffer",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",w.buffer(this.shape,this.dtype,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(){return w.buffer(this.shape,this.dtype,this.dataSync())}},{key:"array",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.data();case 2:return t=e.sent,e.abrupt("return",Object(h.T)(this.shape,t));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"arraySync",value:function(){return Object(h.T)(this.shape,this.dataSync())}},{key:"data",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.throwIfDisposed(),t=x().read(this.dataId),"string"!==this.dtype){e.next=13;break}return e.next=5,t;case 5:return n=e.sent,e.prev=6,e.abrupt("return",n.map((function(e){return b.decodeString(e)})));case 10:throw e.prev=10,e.t0=e.catch(6),new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().");case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this,[[6,10]])})));return function(){return e.apply(this,arguments)}}()},{key:"dataSync",value:function(){this.throwIfDisposed();var e=x().readSync(this.dataId);if("string"===this.dtype)try{return e.map((function(e){return b.decodeString(e)}))}catch(t){throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}},{key:"bytes",value:function(){var e=Object(s.a)(o.a.mark((function e(){var t;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.throwIfDisposed(),e.next=3,x().read(this.dataId);case 3:if(t=e.sent,"string"!==this.dtype){e.next=8;break}return e.abrupt("return",t);case 8:return e.abrupt("return",new Uint8Array(t.buffer));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"dispose",value:function(){this.isDisposed||(x().disposeTensor(this),this.isDisposedInternal=!0)}},{key:"isDisposed",get:function(){return this.isDisposedInternal}},{key:"throwIfDisposed",value:function(){if(this.isDisposed)throw new Error("Tensor is disposed.")}},{key:"print",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return w.print(this,e)}},{key:"clone",value:function(){return this.throwIfDisposed(),w.clone(this)}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.dataSync();return f(t,this.shape,this.dtype,e)}},{key:"cast",value:function(e){return this.throwIfDisposed(),w.cast(this,e)}},{key:"variable",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return this.throwIfDisposed(),x().makeVariable(this,e,t,n)}}]),e}();Object.defineProperty(E,Symbol.hasInstance,{value:function(e){return!!e&&null!=e.data&&null!=e.dataSync&&null!=e.throwIfDisposed}}),Object(l.a)("Tensor",(function(){return E}));var S=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r,a,i){var o;return Object(c.a)(this,n),(o=t.call(this,e.shape,e.dtype,e.dataId,i)).trainable=r,o.name=a,o}return Object(u.a)(n,[{key:"assign",value:function(e){if(e.dtype!==this.dtype)throw new Error("dtype of the new value (".concat(e.dtype,") and ")+"previous value (".concat(this.dtype,") must match"));if(!h.a(e.shape,this.shape))throw new Error("shape of the new value (".concat(e.shape,") and ")+"previous value (".concat(this.shape,") must match"));x().disposeTensor(this),this.dataId=e.dataId,x().incRef(this,null)}},{key:"dispose",value:function(){x().disposeVariable(this),this.isDisposedInternal=!0}}]),n}(E);Object.defineProperty(S,Symbol.hasInstance,{value:function(e){return e instanceof E&&null!=e.assign&&e.assign instanceof Function}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(38);function a(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(r.a)(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,i=function(){};return{s:i,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw o}}}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n(65);var r=n(145);n(160),n(144),n(202);function a(e){return r.a.customGrad(e)}},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t,n){"use strict";var r;n.d(t,"a",(function(){return r})),function(e){e[e.NONE=0]="NONE",e[e.MEAN=1]="MEAN",e[e.SUM=2]="SUM",e[e.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"}(r||(r={}))},function(e,t,n){"use strict";(function(e){n.d(t,"f",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return b})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return x})),n.d(t,"g",(function(){return w}));var r=n(13),a=n.n(r),i=n(161),o=n(20),s=n(174),c=n(223),u=n(202),l=n(266);function d(e,t){return h.apply(this,arguments)}function h(){return(h=Object(o.a)(a.a.mark((function e(t,n){var r,i,s,c,u,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=[],i=[],s=Array.isArray(t)?t.map((function(e){return e.name})):Object.keys(t),c=function(e){var c=s[e],u=Array.isArray(t)?t[e].tensor:t[c];if("float32"!==u.dtype&&"int32"!==u.dtype&&"bool"!==u.dtype&&"string"!==u.dtype&&"complex64"!==u.dtype)throw new Error("Unsupported dtype in weight '".concat(c,"': ").concat(u.dtype));var l={name:c,shape:u.shape,dtype:u.dtype};if("string"===u.dtype){var d=new Promise(function(){var e=Object(o.a)(a.a.mark((function e(t){var n,r,i,o,s,c,l;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u.bytes();case 2:for(n=e.sent,r=n.reduce((function(e,t){return e+t.length}),0)+4*n.length,i=new Uint8Array(r),o=0,s=0;s<n.length;s++)c=n[s],l=new Uint8Array(new Uint32Array([c.length]).buffer),i.set(l,o),o+=4,i.set(c,o),o+=c.length;t(i);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());i.push(d)}else i.push(u.data());null!=n&&(l.group=n),r.push(l)},u=0;u<s.length;++u)c(u);return e.next=7,Promise.all(i);case 7:return l=e.sent,e.abrupt("return",{data:p(l),specs:r});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function f(e,t){var n,r,a={},o=0,d=Object(i.a)(t);try{for(d.s();!(r=d.n()).done;){var h=r.value,f=h.name,p=h.dtype,m=h.shape,v=Object(u.O)(m),g=void 0;if("quantization"in h){var b=h.quantization;if("uint8"===b.dtype||"uint16"===b.dtype){if(!("min"in b)||!("scale"in b))throw new Error("Weight ".concat(h.name," with quantization ").concat(b.dtype," ")+"doesn't have corresponding metadata min and scale.")}else{if("float16"!==b.dtype)throw new Error("Weight ".concat(h.name," has unknown ")+"quantization dtype ".concat(b.dtype,". ")+"Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.");if("float32"!==p)throw new Error("Weight ".concat(h.name," is quantized with ").concat(b.dtype," ")+"which only supports weights of type float32 not ".concat(p,"."))}var y=l.a[b.dtype],x=e.slice(o,o+v*y),w="uint8"===b.dtype?new Uint8Array(x):new Uint16Array(x);if("float32"===p)if("uint8"===b.dtype||"uint16"===b.dtype){g=new Float32Array(w.length);for(var A=0;A<w.length;A++){var _=w[A];g[A]=_*b.scale+b.min}}else{if("float16"!==b.dtype)throw new Error("Unsupported quantization type ".concat(b.dtype," ")+"for weight type float32.");void 0===n&&(n=O()),g=n(w)}else{if("int32"!==p)throw new Error("Unsupported dtype in weight '".concat(f,"': ").concat(p));if("uint8"!==b.dtype&&"uint16"!==b.dtype)throw new Error("Unsupported quantization type ".concat(b.dtype," ")+"for weight type int32.");g=new Int32Array(w.length);for(var E=0;E<w.length;E++){var S=w[E];g[E]=Math.round(S*b.scale+b.min)}}o+=v*y}else if("string"===p){var C=Object(u.O)(h.shape);g=[];for(var T=0;T<C;T++){var M=new Uint32Array(e.slice(o,o+4))[0];o+=4;var k=new Uint8Array(e.slice(o,o+M));g.push(k),o+=M}}else{var R=l.a[p],I=e.slice(o,o+v*R);if("float32"===p)g=new Float32Array(I);else if("int32"===p)g=new Int32Array(I);else if("bool"===p)g=new Uint8Array(I);else{if("complex64"!==p)throw new Error("Unsupported dtype in weight '".concat(f,"': ").concat(p));g=new Float32Array(I);for(var j=new Float32Array(g.length/2),B=new Float32Array(g.length/2),L=0;L<j.length;L++)j[L]=g[2*L],B[L]=g[2*L+1];var N=Object(c.a)(j,m,"float32"),D=Object(c.a)(B,m,"float32");a[f]=Object(s.a)(N,D),N.dispose(),D.dispose()}o+=v*R}"complex64"!==p&&(a[f]=Object(c.a)(g,m,p))}}catch(P){d.e(P)}finally{d.f()}return a}function p(e){if(null===e)throw new Error("Invalid input value: ".concat(JSON.stringify(e)));var t=0,n=[];e.forEach((function(e){if(t+=e.byteLength,n.push(e.byteLength===e.buffer.byteLength?e:new e.constructor(e)),!(e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array))throw new Error("Unsupported TypedArray subtype: ".concat(e.constructor.name))}));var r=new Uint8Array(t),a=0;return n.forEach((function(e){r.set(new Uint8Array(e.buffer),a),a+=e.byteLength})),r.buffer}var m="undefined"!==typeof e&&("undefined"===typeof Blob||"undefined"===typeof atob||"undefined"===typeof btoa);function v(t){return m?e.byteLength(t):new Blob([t]).size}function g(t){if(m)return e.from(t).toString("base64");for(var n=new Uint8Array(t),r="",a=0,i=n.length;a<i;a++)r+=String.fromCharCode(n[a]);return btoa(r)}function b(t){if(m){var n=e.from(t,"base64");return n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength)}for(var r=atob(t),a=new Uint8Array(r.length),i=0;i<r.length;++i)a.set([r.charCodeAt(i)],i);return a.buffer}function y(e){if(1===e.length)return e[0];var t=0;e.forEach((function(e){t+=e.byteLength}));var n=new Uint8Array(t),r=0;return e.forEach((function(e){n.set(new Uint8Array(e),r),r+=e.byteLength})),n.buffer}function x(e){for(e=e.trim();e.endsWith("/");)e=e.slice(0,e.length-1);var t=e.split("/");return t[t.length-1]}function w(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:null==e.modelTopology?0:v(JSON.stringify(e.modelTopology)),weightSpecsBytes:null==e.weightSpecs?0:v(JSON.stringify(e.weightSpecs)),weightDataBytes:null==e.weightData?0:e.weightData.byteLength}}function O(){var e=function(){var e=function(e){for(var t=e<<13,n=0;0===(8388608&t);)n-=8388608,t<<=1;return(t&=-8388609)|n+947912704},t=new Uint32Array(2048);t[0]=0;for(var n=1;n<1024;n++)t[n]=e(n);for(var r=1024;r<2048;r++)t[r]=939524096+(r-1024<<13);return t}(),t=function(){var e=new Uint32Array(64);e[0]=0,e[31]=1199570944,e[32]=2147483648,e[63]=3347054592;for(var t=1;t<31;t++)e[t]=t<<23;for(var n=33;n<63;n++)e[n]=2147483648+(n-32<<23);return e}(),n=function(){for(var e=new Uint32Array(64),t=0;t<64;t++)e[t]=1024;return e[0]=e[32]=0,e}();return function(r){for(var a=new ArrayBuffer(4*r.length),i=new Uint32Array(a),o=0;o<r.length;o++){var s=r[o],c=e[n[s>>10]+(1023&s)]+t[s>>10];i[o]=c}return new Float32Array(a)}}}).call(this,n(265).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(143);var u=Object(c.a)({add_:function(e,t){var n=Object(s.a)(e,"a","add"),c=Object(s.a)(t,"b","add"),u=Object(o.b)(n,c),l=Object(r.a)(u,2),d={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.d,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(157),s=n(143);var c=Object(s.a)({sum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=Object(i.a)(e,"x","sum");"bool"===s.dtype&&(s=Object(o.a)(s,"int32"));var c={x:s},u={axis:t,keepDims:n};return r.a.runKernel(a.Lc,c,u)}})},function(e,t,n){"use strict";n.d(t,"d",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return l})),n.d(t,"i",(function(){return g})),n.d(t,"h",(function(){return b})),n.d(t,"g",(function(){return y}));var r=n(12),a=n(65);function i(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",o=arguments.length>5?arguments[5]:void 0,s=e[3],u=[].concat(Object(a.a)(t),[s]),l=y(i);return c(e,u,n,o,r,null,null,l)}function o(e,t,n,a,i,o){var s,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",l=d(t),h=Object(r.a)(l,2),f=h[0],p=h[1];if("channelsLast"===u)s=[f,p,e[3],e[3]];else{if("channelsFirst"!==u)throw new Error("Unknown dataFormat ".concat(u));s=[f,p,e[1],e[1]]}return c(e,s,n,a,i,o,!1,u)}function s(e,t,n,a,i,o){var s,c,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"NDHWC",d=h(t),f=Object(r.a)(d,3),p=f[0],m=f[1],v=f[2];if("NDHWC"===l)c="channelsLast",s=[p,m,v,e[4],e[4]];else{if("NCDHW"!==l)throw new Error("Unknown dataFormat ".concat(l));c="channelsFirst",s=[p,m,v,e[1],e[1]]}return u(e,s,n,a,i,!1,c,o)}function c(e,t,n,a,i,o){var s=arguments.length>6&&void 0!==arguments[6]&&arguments[6],c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"channelsLast",u=-1,l=-1,h=-1,m=-1;if("channelsLast"===c){var v=Object(r.a)(e,4);u=v[0],l=v[1],h=v[2],m=v[3]}else{if("channelsFirst"!==c)throw new Error("Unknown dataFormat ".concat(c));var g=Object(r.a)(e,4);u=g[0],m=g[1],l=g[2],h=g[3]}var b,y=Object(r.a)(t,4),x=y[0],w=y[1],O=y[3],A=d(n),_=Object(r.a)(A,2),E=_[0],S=_[1],C=d(a),T=Object(r.a)(C,2),M=T[0],k=T[1],R=f(x,M),I=f(w,k),j=p(i,l,h,E,S,R,I,o,c),B=j.padInfo,L=j.outHeight,N=j.outWidth,D=s?O*m:O;return"channelsFirst"===c?b=[u,D,L,N]:"channelsLast"===c&&(b=[u,L,N,D]),{batchSize:u,dataFormat:c,inHeight:l,inWidth:h,inChannels:m,outHeight:L,outWidth:N,outChannels:D,padInfo:B,strideHeight:E,strideWidth:S,filterHeight:x,filterWidth:w,effectiveFilterHeight:R,effectiveFilterWidth:I,dilationHeight:M,dilationWidth:k,inShape:e,outShape:b,filterShape:t}}function u(e,t,n,a,i){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"channelsLast",c=arguments.length>7?arguments[7]:void 0,u=-1,l=-1,d=-1,p=-1,v=-1;if("channelsLast"===s){var g=Object(r.a)(e,5);u=g[0],l=g[1],d=g[2],p=g[3],v=g[4]}else{if("channelsFirst"!==s)throw new Error("Unknown dataFormat ".concat(s));var b=Object(r.a)(e,5);u=b[0],v=b[1],l=b[2],d=b[3],p=b[4]}var y,x=Object(r.a)(t,5),w=x[0],O=x[1],A=x[2],_=x[4],E=h(n),S=Object(r.a)(E,3),C=S[0],T=S[1],M=S[2],k=h(a),R=Object(r.a)(k,3),I=R[0],j=R[1],B=R[2],L=f(w,I),N=f(O,j),D=f(A,B),P=m(i,l,d,p,C,T,M,L,N,D,c),F=P.padInfo,G=P.outDepth,U=P.outHeight,z=P.outWidth,H=o?_*v:_;return"channelsFirst"===s?y=[u,H,G,U,z]:"channelsLast"===s&&(y=[u,G,U,z,H]),{batchSize:u,dataFormat:s,inDepth:l,inHeight:d,inWidth:p,inChannels:v,outDepth:G,outHeight:U,outWidth:z,outChannels:H,padInfo:F,strideDepth:C,strideHeight:T,strideWidth:M,filterDepth:w,filterHeight:O,filterWidth:A,effectiveFilterDepth:L,effectiveFilterHeight:N,effectiveFilterWidth:D,dilationDepth:I,dilationHeight:j,dilationWidth:B,inShape:e,outShape:y,filterShape:t}}function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=f(t,r);return Math.floor((e[0]*(n-1)-n+a)/2)}function d(e){return"number"===typeof e?[e,e,e]:2===e.length?[e[0],e[1],1]:e}function h(e){return"number"===typeof e?[e,e,e]:e}function f(e,t){return t<=1?e:e+(e-1)*(t-1)}function p(e,t,n,r,a,i,o,s,c){var u,d,h;if("number"===typeof e){u={top:e,bottom:e,left:e,right:e,type:0===e?"VALID":"NUMBER"};var f=function(e,t,n,r,a){null==r&&(r=l(e,t,n));var i=e[0],o=e[1];return[v((i-t+2*r)/n+1,a),v((o-t+2*r)/n+1,a)]}([t,n],i,r,e,s);d=f[0],h=f[1]}else if("same"===e){d=Math.ceil(t/r),h=Math.ceil(n/a);var p=Math.max(0,(d-1)*r+i-t),m=Math.max(0,(h-1)*a+o-n),g=Math.floor(p/2),b=p-g,y=Math.floor(m/2);u={top:g,bottom:b,left:y,right:m-y,type:"SAME"}}else if("valid"===e)u={top:0,bottom:0,left:0,right:0,type:"VALID"},d=Math.ceil((t-i+1)/r),h=Math.ceil((n-o+1)/a);else{if("object"!==typeof e)throw Error("Unknown padding parameter: ".concat(e));var x="channelsLast"===c?e[1][0]:e[2][0],w="channelsLast"===c?e[1][1]:e[2][1],O="channelsLast"===c?e[2][0]:e[3][0],A="channelsLast"===c?e[2][1]:e[3][1];u={top:x,bottom:w,left:O,right:A,type:0===x&&0===w&&0===O&&0===A?"VALID":"EXPLICIT"},d=v((t-i+x+w)/r+1,s),h=v((n-o+O+A)/a+1,s)}return{padInfo:u,outHeight:d,outWidth:h}}function m(e,t,n,r,a,i,o,s,c,u,d){var h,f,p,m;if("number"===typeof e){h={top:e,bottom:e,left:e,right:e,front:e,back:e,type:0===e?"VALID":"NUMBER"};var g=function(e,t,n,r,a,i){null==a&&(a=l(e,t,r));var o=e[0],s=e[1],c=e[2];return[v((o-t+2*a)/r+1,i),v((s-t+2*a)/r+1,i),v((c-t+2*a)/r+1,i),n]}([t,n,r,1],s,1,a,e,d);f=g[0],p=g[1],m=g[2]}else if("same"===e){var b=((f=Math.ceil(t/a))-1)*a+s-t,y=((p=Math.ceil(n/i))-1)*i+c-n,x=((m=Math.ceil(r/o))-1)*o+u-r,w=Math.floor(b/2),O=b-w,A=Math.floor(y/2),_=y-A,E=Math.floor(x/2);h={top:A,bottom:_,left:E,right:x-E,front:w,back:O,type:"SAME"}}else{if("valid"!==e)throw Error("Unknown padding parameter: ".concat(e));h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},f=Math.ceil((t-s+1)/a),p=Math.ceil((n-c+1)/i),m=Math.ceil((r-u+1)/o)}return{padInfo:h,outDepth:f,outHeight:p,outWidth:m}}function v(e,t){if(!t)return Math.trunc(e);switch(t){case"round":return Math.round(e);case"ceil":return Math.ceil(e);case"floor":return Math.floor(e);default:throw new Error("Unknown roundingMode ".concat(t))}}function g(e){var t=d(e),n=Object(r.a)(t,3),a=n[0],i=n[1],o=n[2];return 1===a&&1===i&&1===o}function b(e,t){return g(e)||g(t)}function y(e){if("NHWC"===e)return"channelsLast";if("NCHW"===e)return"channelsFirst";throw new Error("Unknown dataFormat ".concat(e))}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(184),c=n(143);var u=Object(c.a)({concat_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(o.b)(e.length>=1,(function(){return"Pass at least one tensor to concat"}));var n=Object(i.b)(e,"tensors","concat","string_or_numeric");if("complex64"===n[0].dtype&&n.forEach((function(e){if("complex64"!==e.dtype)throw new Error("Cannot concatenate complex64 tensors with a tensor\n          with dtype ".concat(e.dtype,". "))})),1===n.length)return Object(s.a)(n[0]);var c=n,u={axis:t};return r.a.runKernel(a.A,c,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(39);function a(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Object(r.a)(e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(66),a=n(70),i=n(219);function o(e){var t=Object(a.a)();return function(){var n,a=Object(r.a)(e);if(t){var o=Object(r.a)(this).constructor;n=Reflect.construct(a,arguments,o)}else n=a.apply(this,arguments);return Object(i.a)(this,n)}}},function(e,t,n){"use strict";var r,a,i,o,s;n.d(t,"b",(function(){return u})),n.d(t,"a",(function(){return l})),function(e){e.R0="R0",e.R1="R1",e.R2="R2",e.R3="R3",e.R4="R4",e.R5="R5",e.R6="R6"}(r||(r={})),function(e){e.float32="float32",e.int32="int32",e.bool="int32",e.complex64="complex64"}(a||(a={})),function(e){e.float32="float32",e.int32="int32",e.bool="bool",e.complex64="complex64"}(i||(i={})),function(e){e.float32="float32",e.int32="float32",e.bool="float32",e.complex64="complex64"}(o||(o={})),function(e){e.float32="complex64",e.int32="complex64",e.bool="complex64",e.complex64="complex64"}(s||(s={}));var c={float32:o,int32:a,bool:i,complex64:s};function u(e,t){if("string"===e||"string"===t){if("string"===e&&"string"===t)return"string";throw new Error("Can not upcast ".concat(e," with ").concat(t))}return c[e][t]}function l(e){return u(e,"int32")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({complex_:function(e,t){var n=Object(i.a)(e,"real","complex"),s=Object(i.a)(t,"imag","complex");o.e(n.shape,s.shape,"real and imag shapes, ".concat(n.shape," and ").concat(s.shape,", ")+"must match in call to tf.complex().");var c={real:n,imag:s};return r.a.runKernel(a.y,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(160),a=n(202);function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32",n=arguments.length>2?arguments[2]:void 0;return t=t||"float32",a.c(e),new r.b(e,t,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(225),u=n(143);var l=Object(u.a)({div_:function(e,t){var n=Object(s.a)(e,"a","div"),u=Object(s.a)(t,"b","div"),l=Object(o.b)(n,u),d=Object(r.a)(l,2);if(n=d[0],u=d[1],"int32"===n.dtype&&"int32"===u.dtype)return Object(c.a)(n,u);var h={a:n,b:u};return a.a.runKernel(i.fc,h,{})}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({slice_:function(e,t,n){var o=Object(i.a)(e,"x","slice","string_or_numeric");if(0===o.rank)throw new Error("Slicing scalar is not possible");var s={x:o},c={begin:t,size:n};return r.a.runKernel(a.zc,s,c)}})},function(e,t,n){"use strict";n.d(t,"c",(function(){return f})),n.d(t,"b",(function(){return p})),n.d(t,"a",(function(){return m})),n.d(t,"d",(function(){return v}));var r=n(154),a=n(251),i=n(254),o=n(156),s=n(253),c=n(197),u=n(252),l=n(150),d=n(250),h=n(167);function f(e,t,n){if(null==n||"linear"===n)return e;if("relu"===n)return Object(o.a)(e,Object(d.a)(t));throw new Error("Cannot compute gradient for fused activation ".concat(n,"."))}function p(e,t){var n=t,a=r.c(e.shape,t.shape);return a.length>0&&(n=Object(h.a)(n,a)),Object(l.a)(n,e.shape)}function m(e,t,n,r){if("linear"===t)return e;if("relu"===t)return Object(c.a)(e);if("elu"===t)return Object(a.a)(e);if("relu6"===t)return Object(u.a)(e);if("prelu"===t)return Object(s.a)(e,n);if("leakyrelu"===t)return Object(i.a)(e,r);throw new Error("Unknown fused activation ".concat(t,"."))}var v=function(e,t){return!(e>0)||"linear"===t}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";n.r(t),n.d(t,"ACESFilmicToneMapping",(function(){return ge})),n.d(t,"AddEquation",(function(){return G})),n.d(t,"AddOperation",(function(){return he})),n.d(t,"AdditiveAnimationBlendMode",(function(){return cn})),n.d(t,"AdditiveBlending",(function(){return N})),n.d(t,"AlphaFormat",(function(){return Qe})),n.d(t,"AlwaysDepth",(function(){return re})),n.d(t,"AlwaysStencilFunc",(function(){return Fn})),n.d(t,"AmbientLight",(function(){return Pd})),n.d(t,"AmbientLightProbe",(function(){return sh})),n.d(t,"AnimationClip",(function(){return Fl})),n.d(t,"AnimationLoader",(function(){return Xl})),n.d(t,"AnimationMixer",(function(){return Gh})),n.d(t,"AnimationObjectGroup",(function(){return Ph})),n.d(t,"AnimationUtils",(function(){return Sl})),n.d(t,"ArcCurve",(function(){return td})),n.d(t,"ArrayCamera",(function(){return ec})),n.d(t,"ArrowHelper",(function(){return Rf})),n.d(t,"Audio",(function(){return bh})),n.d(t,"AudioAnalyser",(function(){return _h})),n.d(t,"AudioContext",(function(){return ah})),n.d(t,"AudioListener",(function(){return gh})),n.d(t,"AudioLoader",(function(){return ih})),n.d(t,"AxesHelper",(function(){return If})),n.d(t,"AxisHelper",(function(){return Rp})),n.d(t,"BackSide",(function(){return k})),n.d(t,"BasicDepthPacking",(function(){return xn})),n.d(t,"BasicShadowMap",(function(){return E})),n.d(t,"BinaryTextureLoader",(function(){return Np})),n.d(t,"Bone",(function(){return Pc})),n.d(t,"BooleanKeyframeTrack",(function(){return Il})),n.d(t,"BoundingBoxHelper",(function(){return Ip})),n.d(t,"Box2",(function(){return Yh})),n.d(t,"Box3",(function(){return vr})),n.d(t,"Box3Helper",(function(){return Tf})),n.d(t,"BoxBufferGeometry",(function(){return ki})),n.d(t,"BoxGeometry",(function(){return ki})),n.d(t,"BoxHelper",(function(){return Cf})),n.d(t,"BufferAttribute",(function(){return Ha})),n.d(t,"BufferGeometry",(function(){return li})),n.d(t,"BufferGeometryLoader",(function(){return Jd})),n.d(t,"ByteType",(function(){return Ge})),n.d(t,"Cache",(function(){return Ul})),n.d(t,"Camera",(function(){return Li})),n.d(t,"CameraHelper",(function(){return Of})),n.d(t,"CanvasRenderer",(function(){return Pp})),n.d(t,"CanvasTexture",(function(){return fu})),n.d(t,"CatmullRomCurve3",(function(){return sd})),n.d(t,"CineonToneMapping",(function(){return ve})),n.d(t,"CircleBufferGeometry",(function(){return mu})),n.d(t,"CircleGeometry",(function(){return mu})),n.d(t,"ClampToEdgeWrapping",(function(){return Ce})),n.d(t,"Clock",(function(){return dh})),n.d(t,"Color",(function(){return Fa})),n.d(t,"ColorKeyframeTrack",(function(){return jl})),n.d(t,"CompressedTexture",(function(){return hu})),n.d(t,"CompressedTextureLoader",(function(){return Kl})),n.d(t,"ConeBufferGeometry",(function(){return gu})),n.d(t,"ConeGeometry",(function(){return gu})),n.d(t,"CubeCamera",(function(){return Pi})),n.d(t,"CubeReflectionMapping",(function(){return xe})),n.d(t,"CubeRefractionMapping",(function(){return we})),n.d(t,"CubeTexture",(function(){return Fi})),n.d(t,"CubeTextureLoader",(function(){return Yl})),n.d(t,"CubeUVReflectionMapping",(function(){return _e})),n.d(t,"CubeUVRefractionMapping",(function(){return Ee})),n.d(t,"CubicBezierCurve",(function(){return dd})),n.d(t,"CubicBezierCurve3",(function(){return hd})),n.d(t,"CubicInterpolant",(function(){return Tl})),n.d(t,"CullFaceBack",(function(){return O})),n.d(t,"CullFaceFront",(function(){return A})),n.d(t,"CullFaceFrontBack",(function(){return _})),n.d(t,"CullFaceNone",(function(){return w})),n.d(t,"Curve",(function(){return $l})),n.d(t,"CurvePath",(function(){return yd})),n.d(t,"CustomBlending",(function(){return F})),n.d(t,"CustomToneMapping",(function(){return be})),n.d(t,"CylinderBufferGeometry",(function(){return vu})),n.d(t,"CylinderGeometry",(function(){return vu})),n.d(t,"Cylindrical",(function(){return Kh})),n.d(t,"DataTexture",(function(){return Ui})),n.d(t,"DataTexture2DArray",(function(){return ho})),n.d(t,"DataTexture3D",(function(){return fo})),n.d(t,"DataTextureLoader",(function(){return Ql})),n.d(t,"DataUtils",(function(){return Lf})),n.d(t,"DecrementStencilOp",(function(){return Tn})),n.d(t,"DecrementWrapStencilOp",(function(){return kn})),n.d(t,"DefaultLoadingManager",(function(){return Hl})),n.d(t,"DepthFormat",(function(){return rt})),n.d(t,"DepthStencilFormat",(function(){return at})),n.d(t,"DepthTexture",(function(){return pu})),n.d(t,"DirectionalLight",(function(){return Dd})),n.d(t,"DirectionalLightHelper",(function(){return yf})),n.d(t,"DiscreteInterpolant",(function(){return kl})),n.d(t,"DodecahedronBufferGeometry",(function(){return yu})),n.d(t,"DodecahedronGeometry",(function(){return yu})),n.d(t,"DoubleSide",(function(){return R})),n.d(t,"DstAlphaFactor",(function(){return Q})),n.d(t,"DstColorFactor",(function(){return $})),n.d(t,"DynamicBufferAttribute",(function(){return wp})),n.d(t,"DynamicCopyUsage",(function(){return Xn})),n.d(t,"DynamicDrawUsage",(function(){return Un})),n.d(t,"DynamicReadUsage",(function(){return Vn})),n.d(t,"EdgesGeometry",(function(){return _u})),n.d(t,"EdgesHelper",(function(){return jp})),n.d(t,"EllipseCurve",(function(){return ed})),n.d(t,"EqualDepth",(function(){return oe})),n.d(t,"EqualStencilFunc",(function(){return Bn})),n.d(t,"EquirectangularReflectionMapping",(function(){return Oe})),n.d(t,"EquirectangularRefractionMapping",(function(){return Ae})),n.d(t,"Euler",(function(){return ea})),n.d(t,"EventDispatcher",(function(){return Qn})),n.d(t,"ExtrudeBufferGeometry",(function(){return $u})),n.d(t,"ExtrudeGeometry",(function(){return $u})),n.d(t,"FaceColors",(function(){return lp})),n.d(t,"FileLoader",(function(){return Jl})),n.d(t,"FlatShading",(function(){return I})),n.d(t,"Float16BufferAttribute",(function(){return Qa})),n.d(t,"Float32Attribute",(function(){return Mp})),n.d(t,"Float32BufferAttribute",(function(){return Za})),n.d(t,"Float64Attribute",(function(){return kp})),n.d(t,"Float64BufferAttribute",(function(){return $a})),n.d(t,"FloatType",(function(){return We})),n.d(t,"Fog",(function(){return cc})),n.d(t,"FogExp2",(function(){return sc})),n.d(t,"Font",(function(){return $d})),n.d(t,"FontLoader",(function(){return rh})),n.d(t,"FrontSide",(function(){return M})),n.d(t,"Frustum",(function(){return Vi})),n.d(t,"GLBufferAttribute",(function(){return Hh})),n.d(t,"GLSL1",(function(){return qn})),n.d(t,"GLSL3",(function(){return Yn})),n.d(t,"GammaEncoding",(function(){return pn})),n.d(t,"GreaterDepth",(function(){return ce})),n.d(t,"GreaterEqualDepth",(function(){return se})),n.d(t,"GreaterEqualStencilFunc",(function(){return Pn})),n.d(t,"GreaterStencilFunc",(function(){return Nn})),n.d(t,"GridHelper",(function(){return pf})),n.d(t,"Group",(function(){return tc})),n.d(t,"HalfFloatType",(function(){return Je})),n.d(t,"HemisphereLight",(function(){return Ad})),n.d(t,"HemisphereLightHelper",(function(){return ff})),n.d(t,"HemisphereLightProbe",(function(){return oh})),n.d(t,"IcosahedronBufferGeometry",(function(){return tl})),n.d(t,"IcosahedronGeometry",(function(){return tl})),n.d(t,"ImageBitmapLoader",(function(){return Qd})),n.d(t,"ImageLoader",(function(){return ql})),n.d(t,"ImageUtils",(function(){return ir})),n.d(t,"ImmediateRenderObject",(function(){return ef})),n.d(t,"IncrementStencilOp",(function(){return Cn})),n.d(t,"IncrementWrapStencilOp",(function(){return Mn})),n.d(t,"InstancedBufferAttribute",(function(){return Wd})),n.d(t,"InstancedBufferGeometry",(function(){return Vd})),n.d(t,"InstancedInterleavedBuffer",(function(){return zh})),n.d(t,"InstancedMesh",(function(){return Jc})),n.d(t,"Int16Attribute",(function(){return Ep})),n.d(t,"Int16BufferAttribute",(function(){return Xa})),n.d(t,"Int32Attribute",(function(){return Cp})),n.d(t,"Int32BufferAttribute",(function(){return qa})),n.d(t,"Int8Attribute",(function(){return Op})),n.d(t,"Int8BufferAttribute",(function(){return Va})),n.d(t,"IntType",(function(){return He})),n.d(t,"InterleavedBuffer",(function(){return lc})),n.d(t,"InterleavedBufferAttribute",(function(){return hc})),n.d(t,"Interpolant",(function(){return Cl})),n.d(t,"InterpolateDiscrete",(function(){return en})),n.d(t,"InterpolateLinear",(function(){return tn})),n.d(t,"InterpolateSmooth",(function(){return nn})),n.d(t,"InvertStencilOp",(function(){return Rn})),n.d(t,"JSONLoader",(function(){return Fp})),n.d(t,"KeepStencilOp",(function(){return En})),n.d(t,"KeyframeTrack",(function(){return Rl})),n.d(t,"LOD",(function(){return Rc})),n.d(t,"LatheBufferGeometry",(function(){return nl})),n.d(t,"LatheGeometry",(function(){return nl})),n.d(t,"Layers",(function(){return ta})),n.d(t,"LensFlare",(function(){return Up})),n.d(t,"LessDepth",(function(){return ae})),n.d(t,"LessEqualDepth",(function(){return ie})),n.d(t,"LessEqualStencilFunc",(function(){return Ln})),n.d(t,"LessStencilFunc",(function(){return jn})),n.d(t,"Light",(function(){return Od})),n.d(t,"LightProbe",(function(){return Ud})),n.d(t,"Line",(function(){return $c})),n.d(t,"Line3",(function(){return $h})),n.d(t,"LineBasicMaterial",(function(){return Xc})),n.d(t,"LineCurve",(function(){return fd})),n.d(t,"LineCurve3",(function(){return pd})),n.d(t,"LineDashedMaterial",(function(){return _l})),n.d(t,"LineLoop",(function(){return ru})),n.d(t,"LinePieces",(function(){return cp})),n.d(t,"LineSegments",(function(){return nu})),n.d(t,"LineStrip",(function(){return sp})),n.d(t,"LinearEncoding",(function(){return hn})),n.d(t,"LinearFilter",(function(){return Be})),n.d(t,"LinearInterpolant",(function(){return Ml})),n.d(t,"LinearMipMapLinearFilter",(function(){return Pe})),n.d(t,"LinearMipMapNearestFilter",(function(){return Ne})),n.d(t,"LinearMipmapLinearFilter",(function(){return De})),n.d(t,"LinearMipmapNearestFilter",(function(){return Le})),n.d(t,"LinearToneMapping",(function(){return pe})),n.d(t,"Loader",(function(){return Vl})),n.d(t,"LoaderUtils",(function(){return Hd})),n.d(t,"LoadingManager",(function(){return zl})),n.d(t,"LogLuvEncoding",(function(){return vn})),n.d(t,"LoopOnce",(function(){return Qt})),n.d(t,"LoopPingPong",(function(){return $t})),n.d(t,"LoopRepeat",(function(){return Zt})),n.d(t,"LuminanceAlphaFormat",(function(){return tt})),n.d(t,"LuminanceFormat",(function(){return et})),n.d(t,"MOUSE",(function(){return y})),n.d(t,"Material",(function(){return Ia})),n.d(t,"MaterialLoader",(function(){return zd})),n.d(t,"Math",(function(){return tr})),n.d(t,"MathUtils",(function(){return tr})),n.d(t,"Matrix3",(function(){return ar})),n.d(t,"Matrix4",(function(){return Vr})),n.d(t,"MaxEquation",(function(){return V})),n.d(t,"Mesh",(function(){return Ti})),n.d(t,"MeshBasicMaterial",(function(){return Ga})),n.d(t,"MeshDepthMaterial",(function(){return Ks})),n.d(t,"MeshDistanceMaterial",(function(){return qs})),n.d(t,"MeshFaceMaterial",(function(){return hp})),n.d(t,"MeshLambertMaterial",(function(){return Ol})),n.d(t,"MeshMatcapMaterial",(function(){return Al})),n.d(t,"MeshNormalMaterial",(function(){return wl})),n.d(t,"MeshPhongMaterial",(function(){return yl})),n.d(t,"MeshPhysicalMaterial",(function(){return bl})),n.d(t,"MeshStandardMaterial",(function(){return gl})),n.d(t,"MeshToonMaterial",(function(){return xl})),n.d(t,"MinEquation",(function(){return H})),n.d(t,"MirroredRepeatWrapping",(function(){return Te})),n.d(t,"MixOperation",(function(){return de})),n.d(t,"MultiMaterial",(function(){return fp})),n.d(t,"MultiplyBlending",(function(){return P})),n.d(t,"MultiplyOperation",(function(){return le})),n.d(t,"NearestFilter",(function(){return Me})),n.d(t,"NearestMipMapLinearFilter",(function(){return je})),n.d(t,"NearestMipMapNearestFilter",(function(){return Re})),n.d(t,"NearestMipmapLinearFilter",(function(){return Ie})),n.d(t,"NearestMipmapNearestFilter",(function(){return ke})),n.d(t,"NeverDepth",(function(){return ne})),n.d(t,"NeverStencilFunc",(function(){return In})),n.d(t,"NoBlending",(function(){return B})),n.d(t,"NoColors",(function(){return up})),n.d(t,"NoToneMapping",(function(){return fe})),n.d(t,"NormalAnimationBlendMode",(function(){return sn})),n.d(t,"NormalBlending",(function(){return L})),n.d(t,"NotEqualDepth",(function(){return ue})),n.d(t,"NotEqualStencilFunc",(function(){return Dn})),n.d(t,"NumberKeyframeTrack",(function(){return Bl})),n.d(t,"Object3D",(function(){return ma})),n.d(t,"ObjectLoader",(function(){return Xd})),n.d(t,"ObjectSpaceNormalMap",(function(){return An})),n.d(t,"OctahedronBufferGeometry",(function(){return rl})),n.d(t,"OctahedronGeometry",(function(){return rl})),n.d(t,"OneFactor",(function(){return J})),n.d(t,"OneMinusDstAlphaFactor",(function(){return Z})),n.d(t,"OneMinusDstColorFactor",(function(){return ee})),n.d(t,"OneMinusSrcAlphaFactor",(function(){return Y})),n.d(t,"OneMinusSrcColorFactor",(function(){return K})),n.d(t,"OrthographicCamera",(function(){return Ld})),n.d(t,"PCFShadowMap",(function(){return S})),n.d(t,"PCFSoftShadowMap",(function(){return C})),n.d(t,"PMREMGenerator",(function(){return ep})),n.d(t,"ParametricBufferGeometry",(function(){return al})),n.d(t,"ParametricGeometry",(function(){return al})),n.d(t,"Particle",(function(){return mp})),n.d(t,"ParticleBasicMaterial",(function(){return bp})),n.d(t,"ParticleSystem",(function(){return vp})),n.d(t,"ParticleSystemMaterial",(function(){return yp})),n.d(t,"Path",(function(){return xd})),n.d(t,"PerspectiveCamera",(function(){return Ni})),n.d(t,"Plane",(function(){return ya})),n.d(t,"PlaneBufferGeometry",(function(){return Xi})),n.d(t,"PlaneGeometry",(function(){return Xi})),n.d(t,"PlaneHelper",(function(){return Mf})),n.d(t,"PointCloud",(function(){return pp})),n.d(t,"PointCloudMaterial",(function(){return gp})),n.d(t,"PointLight",(function(){return Bd})),n.d(t,"PointLightHelper",(function(){return uf})),n.d(t,"Points",(function(){return uu})),n.d(t,"PointsMaterial",(function(){return au})),n.d(t,"PolarGridHelper",(function(){return mf})),n.d(t,"PolyhedronBufferGeometry",(function(){return bu})),n.d(t,"PolyhedronGeometry",(function(){return bu})),n.d(t,"PositionalAudio",(function(){return Ah})),n.d(t,"PropertyBinding",(function(){return Dh})),n.d(t,"PropertyMixer",(function(){return Eh})),n.d(t,"QuadraticBezierCurve",(function(){return md})),n.d(t,"QuadraticBezierCurve3",(function(){return vd})),n.d(t,"Quaternion",(function(){return hr})),n.d(t,"QuaternionKeyframeTrack",(function(){return Nl})),n.d(t,"QuaternionLinearInterpolant",(function(){return Ll})),n.d(t,"REVISION",(function(){return b})),n.d(t,"RGBADepthPacking",(function(){return wn})),n.d(t,"RGBAFormat",(function(){return $e})),n.d(t,"RGBAIntegerFormat",(function(){return lt})),n.d(t,"RGBA_ASTC_10x10_Format",(function(){return jt})),n.d(t,"RGBA_ASTC_10x5_Format",(function(){return kt})),n.d(t,"RGBA_ASTC_10x6_Format",(function(){return Rt})),n.d(t,"RGBA_ASTC_10x8_Format",(function(){return It})),n.d(t,"RGBA_ASTC_12x10_Format",(function(){return Bt})),n.d(t,"RGBA_ASTC_12x12_Format",(function(){return Lt})),n.d(t,"RGBA_ASTC_4x4_Format",(function(){return Ot})),n.d(t,"RGBA_ASTC_5x4_Format",(function(){return At})),n.d(t,"RGBA_ASTC_5x5_Format",(function(){return _t})),n.d(t,"RGBA_ASTC_6x5_Format",(function(){return Et})),n.d(t,"RGBA_ASTC_6x6_Format",(function(){return St})),n.d(t,"RGBA_ASTC_8x5_Format",(function(){return Ct})),n.d(t,"RGBA_ASTC_8x6_Format",(function(){return Tt})),n.d(t,"RGBA_ASTC_8x8_Format",(function(){return Mt})),n.d(t,"RGBA_BPTC_Format",(function(){return Nt})),n.d(t,"RGBA_ETC2_EAC_Format",(function(){return wt})),n.d(t,"RGBA_PVRTC_2BPPV1_Format",(function(){return bt})),n.d(t,"RGBA_PVRTC_4BPPV1_Format",(function(){return gt})),n.d(t,"RGBA_S3TC_DXT1_Format",(function(){return ht})),n.d(t,"RGBA_S3TC_DXT3_Format",(function(){return ft})),n.d(t,"RGBA_S3TC_DXT5_Format",(function(){return pt})),n.d(t,"RGBDEncoding",(function(){return yn})),n.d(t,"RGBEEncoding",(function(){return mn})),n.d(t,"RGBEFormat",(function(){return nt})),n.d(t,"RGBFormat",(function(){return Ze})),n.d(t,"RGBIntegerFormat",(function(){return ut})),n.d(t,"RGBM16Encoding",(function(){return bn})),n.d(t,"RGBM7Encoding",(function(){return gn})),n.d(t,"RGB_ETC1_Format",(function(){return yt})),n.d(t,"RGB_ETC2_Format",(function(){return xt})),n.d(t,"RGB_PVRTC_2BPPV1_Format",(function(){return vt})),n.d(t,"RGB_PVRTC_4BPPV1_Format",(function(){return mt})),n.d(t,"RGB_S3TC_DXT1_Format",(function(){return dt})),n.d(t,"RGFormat",(function(){return st})),n.d(t,"RGIntegerFormat",(function(){return ct})),n.d(t,"RawShaderMaterial",(function(){return vl})),n.d(t,"Ray",(function(){return Hr})),n.d(t,"Raycaster",(function(){return Vh})),n.d(t,"RectAreaLight",(function(){return Fd})),n.d(t,"RedFormat",(function(){return it})),n.d(t,"RedIntegerFormat",(function(){return ot})),n.d(t,"ReinhardToneMapping",(function(){return me})),n.d(t,"RepeatWrapping",(function(){return Se})),n.d(t,"ReplaceStencilOp",(function(){return Sn})),n.d(t,"ReverseSubtractEquation",(function(){return z})),n.d(t,"RingBufferGeometry",(function(){return il})),n.d(t,"RingGeometry",(function(){return il})),n.d(t,"SRGB8_ALPHA8_ASTC_10x10_Format",(function(){return Kt})),n.d(t,"SRGB8_ALPHA8_ASTC_10x5_Format",(function(){return Wt})),n.d(t,"SRGB8_ALPHA8_ASTC_10x6_Format",(function(){return Jt})),n.d(t,"SRGB8_ALPHA8_ASTC_10x8_Format",(function(){return Xt})),n.d(t,"SRGB8_ALPHA8_ASTC_12x10_Format",(function(){return qt})),n.d(t,"SRGB8_ALPHA8_ASTC_12x12_Format",(function(){return Yt})),n.d(t,"SRGB8_ALPHA8_ASTC_4x4_Format",(function(){return Dt})),n.d(t,"SRGB8_ALPHA8_ASTC_5x4_Format",(function(){return Pt})),n.d(t,"SRGB8_ALPHA8_ASTC_5x5_Format",(function(){return Ft})),n.d(t,"SRGB8_ALPHA8_ASTC_6x5_Format",(function(){return Gt})),n.d(t,"SRGB8_ALPHA8_ASTC_6x6_Format",(function(){return Ut})),n.d(t,"SRGB8_ALPHA8_ASTC_8x5_Format",(function(){return zt})),n.d(t,"SRGB8_ALPHA8_ASTC_8x6_Format",(function(){return Ht})),n.d(t,"SRGB8_ALPHA8_ASTC_8x8_Format",(function(){return Vt})),n.d(t,"Scene",(function(){return uc})),n.d(t,"SceneUtils",(function(){return Gp})),n.d(t,"ShaderChunk",(function(){return Ki})),n.d(t,"ShaderLib",(function(){return Yi})),n.d(t,"ShaderMaterial",(function(){return Bi})),n.d(t,"ShadowMaterial",(function(){return ml})),n.d(t,"Shape",(function(){return wd})),n.d(t,"ShapeBufferGeometry",(function(){return ol})),n.d(t,"ShapeGeometry",(function(){return ol})),n.d(t,"ShapePath",(function(){return Zd})),n.d(t,"ShapeUtils",(function(){return Yu})),n.d(t,"ShortType",(function(){return Ue})),n.d(t,"Skeleton",(function(){return Uc})),n.d(t,"SkeletonHelper",(function(){return sf})),n.d(t,"SkinnedMesh",(function(){return Dc})),n.d(t,"SmoothShading",(function(){return j})),n.d(t,"Sphere",(function(){return Lr})),n.d(t,"SphereBufferGeometry",(function(){return sl})),n.d(t,"SphereGeometry",(function(){return sl})),n.d(t,"Spherical",(function(){return Xh})),n.d(t,"SphericalHarmonics3",(function(){return Gd})),n.d(t,"SplineCurve",(function(){return gd})),n.d(t,"SpotLight",(function(){return Md})),n.d(t,"SpotLightHelper",(function(){return nf})),n.d(t,"Sprite",(function(){return Cc})),n.d(t,"SpriteMaterial",(function(){return pc})),n.d(t,"SrcAlphaFactor",(function(){return q})),n.d(t,"SrcAlphaSaturateFactor",(function(){return te})),n.d(t,"SrcColorFactor",(function(){return X})),n.d(t,"StaticCopyUsage",(function(){return Jn})),n.d(t,"StaticDrawUsage",(function(){return Gn})),n.d(t,"StaticReadUsage",(function(){return Hn})),n.d(t,"StereoCamera",(function(){return lh})),n.d(t,"StreamCopyUsage",(function(){return Kn})),n.d(t,"StreamDrawUsage",(function(){return zn})),n.d(t,"StreamReadUsage",(function(){return Wn})),n.d(t,"StringKeyframeTrack",(function(){return Dl})),n.d(t,"SubtractEquation",(function(){return U})),n.d(t,"SubtractiveBlending",(function(){return D})),n.d(t,"TOUCH",(function(){return x})),n.d(t,"TangentSpaceNormalMap",(function(){return On})),n.d(t,"TetrahedronBufferGeometry",(function(){return cl})),n.d(t,"TetrahedronGeometry",(function(){return cl})),n.d(t,"TextBufferGeometry",(function(){return ul})),n.d(t,"TextGeometry",(function(){return ul})),n.d(t,"Texture",(function(){return sr})),n.d(t,"TextureLoader",(function(){return Zl})),n.d(t,"TorusBufferGeometry",(function(){return ll})),n.d(t,"TorusGeometry",(function(){return ll})),n.d(t,"TorusKnotBufferGeometry",(function(){return dl})),n.d(t,"TorusKnotGeometry",(function(){return dl})),n.d(t,"Triangle",(function(){return ka})),n.d(t,"TriangleFanDrawMode",(function(){return dn})),n.d(t,"TriangleStripDrawMode",(function(){return ln})),n.d(t,"TrianglesDrawMode",(function(){return un})),n.d(t,"TubeBufferGeometry",(function(){return hl})),n.d(t,"TubeGeometry",(function(){return hl})),n.d(t,"UVMapping",(function(){return ye})),n.d(t,"Uint16Attribute",(function(){return Sp})),n.d(t,"Uint16BufferAttribute",(function(){return Ka})),n.d(t,"Uint32Attribute",(function(){return Tp})),n.d(t,"Uint32BufferAttribute",(function(){return Ya})),n.d(t,"Uint8Attribute",(function(){return Ap})),n.d(t,"Uint8BufferAttribute",(function(){return Wa})),n.d(t,"Uint8ClampedAttribute",(function(){return _p})),n.d(t,"Uint8ClampedBufferAttribute",(function(){return Ja})),n.d(t,"Uniform",(function(){return Uh})),n.d(t,"UniformsLib",(function(){return qi})),n.d(t,"UniformsUtils",(function(){return ji})),n.d(t,"UnsignedByteType",(function(){return Fe})),n.d(t,"UnsignedInt248Type",(function(){return Ye})),n.d(t,"UnsignedIntType",(function(){return Ve})),n.d(t,"UnsignedShort4444Type",(function(){return Xe})),n.d(t,"UnsignedShort5551Type",(function(){return Ke})),n.d(t,"UnsignedShort565Type",(function(){return qe})),n.d(t,"UnsignedShortType",(function(){return ze})),n.d(t,"VSMShadowMap",(function(){return T})),n.d(t,"Vector2",(function(){return nr})),n.d(t,"Vector3",(function(){return fr})),n.d(t,"Vector4",(function(){return ur})),n.d(t,"VectorKeyframeTrack",(function(){return Pl})),n.d(t,"Vertex",(function(){return xp})),n.d(t,"VertexColors",(function(){return dp})),n.d(t,"VideoTexture",(function(){return du})),n.d(t,"WebGL1Renderer",(function(){return oc})),n.d(t,"WebGLCubeRenderTarget",(function(){return Gi})),n.d(t,"WebGLMultisampleRenderTarget",(function(){return dr})),n.d(t,"WebGLRenderTarget",(function(){return lr})),n.d(t,"WebGLRenderTargetCube",(function(){return Dp})),n.d(t,"WebGLRenderer",(function(){return ic})),n.d(t,"WebGLUtils",(function(){return $s})),n.d(t,"WireframeGeometry",(function(){return fl})),n.d(t,"WireframeHelper",(function(){return Bp})),n.d(t,"WrapAroundEnding",(function(){return on})),n.d(t,"XHRLoader",(function(){return Lp})),n.d(t,"ZeroCurvatureEnding",(function(){return rn})),n.d(t,"ZeroFactor",(function(){return W})),n.d(t,"ZeroSlopeEnding",(function(){return an})),n.d(t,"ZeroStencilOp",(function(){return _n})),n.d(t,"sRGBEncoding",(function(){return fn}));var r,a=n(13),i=n.n(a),o=n(20),s=n(161),c=n(68),u=n(12),l=n(219),d=n(220),h=n(66),f=n(67),p=n(171),m=n(172),v=n(147),g=n(149),b="127",y={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},x={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},w=0,O=1,A=2,_=3,E=0,S=1,C=2,T=3,M=0,k=1,R=2,I=1,j=2,B=0,L=1,N=2,D=3,P=4,F=5,G=100,U=101,z=102,H=103,V=104,W=200,J=201,X=202,K=203,q=204,Y=205,Q=206,Z=207,$=208,ee=209,te=210,ne=0,re=1,ae=2,ie=3,oe=4,se=5,ce=6,ue=7,le=0,de=1,he=2,fe=0,pe=1,me=2,ve=3,ge=4,be=5,ye=300,xe=301,we=302,Oe=303,Ae=304,_e=306,Ee=307,Se=1e3,Ce=1001,Te=1002,Me=1003,ke=1004,Re=1004,Ie=1005,je=1005,Be=1006,Le=1007,Ne=1007,De=1008,Pe=1008,Fe=1009,Ge=1010,Ue=1011,ze=1012,He=1013,Ve=1014,We=1015,Je=1016,Xe=1017,Ke=1018,qe=1019,Ye=1020,Qe=1021,Ze=1022,$e=1023,et=1024,tt=1025,nt=$e,rt=1026,at=1027,it=1028,ot=1029,st=1030,ct=1031,ut=1032,lt=1033,dt=33776,ht=33777,ft=33778,pt=33779,mt=35840,vt=35841,gt=35842,bt=35843,yt=36196,xt=37492,wt=37496,Ot=37808,At=37809,_t=37810,Et=37811,St=37812,Ct=37813,Tt=37814,Mt=37815,kt=37816,Rt=37817,It=37818,jt=37819,Bt=37820,Lt=37821,Nt=36492,Dt=37840,Pt=37841,Ft=37842,Gt=37843,Ut=37844,zt=37845,Ht=37846,Vt=37847,Wt=37848,Jt=37849,Xt=37850,Kt=37851,qt=37852,Yt=37853,Qt=2200,Zt=2201,$t=2202,en=2300,tn=2301,nn=2302,rn=2400,an=2401,on=2402,sn=2500,cn=2501,un=0,ln=1,dn=2,hn=3e3,fn=3001,pn=3007,mn=3002,vn=3003,gn=3004,bn=3005,yn=3006,xn=3200,wn=3201,On=0,An=1,_n=0,En=7680,Sn=7681,Cn=7682,Tn=7683,Mn=34055,kn=34056,Rn=5386,In=512,jn=513,Bn=514,Ln=515,Nn=516,Dn=517,Pn=518,Fn=519,Gn=35044,Un=35048,zn=35040,Hn=35045,Vn=35049,Wn=35041,Jn=35046,Xn=35050,Kn=35042,qn="100",Yn="300 es";function Qn(){}Object.assign(Qn.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,a=n.length;r<a;r++)n[r].call(this,e);e.target=null}}}});for(var Zn=[],$n=0;$n<256;$n++)Zn[$n]=($n<16?"0":"")+$n.toString(16);var er=1234567,tr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(Zn[255&e]+Zn[e>>8&255]+Zn[e>>16&255]+Zn[e>>24&255]+"-"+Zn[255&t]+Zn[t>>8&255]+"-"+Zn[t>>16&15|64]+Zn[t>>24&255]+"-"+Zn[63&n|128]+Zn[n>>8&255]+"-"+Zn[n>>16&255]+Zn[n>>24&255]+Zn[255&r]+Zn[r>>8&255]+Zn[r>>16&255]+Zn[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,a){return r+(e-t)*(a-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:function(e,t,n){return(1-n)*e+n*t},damp:function(e,t,n,r){return tr.lerp(e,t,1-Math.exp(-n*r))},pingpong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(tr.euclideanModulo(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(e){return void 0!==e&&(er=e%2147483647),((er=16807*er%2147483647)-1)/2147483646},degToRad:function(e){return e*tr.DEG2RAD},radToDeg:function(e){return e*tr.RAD2DEG},isPowerOfTwo:function(e){return 0===(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,t,n,r,a){var i=Math.cos,o=Math.sin,s=i(n/2),c=o(n/2),u=i((t+r)/2),l=o((t+r)/2),d=i((t-r)/2),h=o((t-r)/2),f=i((r-t)/2),p=o((r-t)/2);switch(a){case"XYX":e.set(s*l,c*d,c*h,s*u);break;case"YZY":e.set(c*h,s*l,c*d,s*u);break;case"ZXZ":e.set(c*d,c*h,s*l,s*u);break;case"XZX":e.set(s*l,c*p,c*f,s*u);break;case"YXY":e.set(c*f,s*l,c*p,s*u);break;case"ZYZ":e.set(c*p,c*f,s*l,s*u);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+a)}}},nr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(v.a)(this,e),this.x=t,this.y=n}return Object(g.a)(e,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),a=this.x-e.x,i=this.y-e.y;return this.x=a*n-i*r+e.x,this.y=a*r+i*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}}]),e}();nr.prototype.isVector2=!0;var rr,ar=function(){function e(){Object(v.a)(this,e),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}return Object(g.a)(e,[{key:"set",value:function(e,t,n,r,a,i,o,s,c){var u=this.elements;return u[0]=e,u[1]=r,u[2]=o,u[3]=t,u[4]=a,u[5]=s,u[6]=n,u[7]=i,u[8]=c,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,a=this.elements,i=n[0],o=n[3],s=n[6],c=n[1],u=n[4],l=n[7],d=n[2],h=n[5],f=n[8],p=r[0],m=r[3],v=r[6],g=r[1],b=r[4],y=r[7],x=r[2],w=r[5],O=r[8];return a[0]=i*p+o*g+s*x,a[3]=i*m+o*b+s*w,a[6]=i*v+o*y+s*O,a[1]=c*p+u*g+l*x,a[4]=c*m+u*b+l*w,a[7]=c*v+u*y+l*O,a[2]=d*p+h*g+f*x,a[5]=d*m+h*b+f*w,a[8]=d*v+h*y+f*O,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6],c=e[7],u=e[8];return t*i*u-t*o*c-n*a*u+n*o*s+r*a*c-r*i*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6],c=e[7],u=e[8],l=u*i-o*c,d=o*s-u*a,h=c*a-i*s,f=t*l+n*d+r*h;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);var p=1/f;return e[0]=l*p,e[1]=(r*c-u*n)*p,e[2]=(o*n-r*i)*p,e[3]=d*p,e[4]=(u*t-r*s)*p,e[5]=(r*a-o*t)*p,e[6]=h*p,e[7]=(n*s-c*t)*p,e[8]=(i*t-n*a)*p,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,a,i,o){var s=Math.cos(a),c=Math.sin(a);return this.set(n*s,n*c,-n*(s*i+c*o)+i+e,-r*c,r*s,-r*(-c*i+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),n=Math.sin(e),r=this.elements,a=r[0],i=r[3],o=r[6],s=r[1],c=r[4],u=r[7];return r[0]=t*a+n*s,r[3]=t*i+n*c,r[6]=t*o+n*u,r[1]=-n*a+t*s,r[4]=-n*i+t*c,r[7]=-n*o+t*u,this}},{key:"translate",value:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}();ar.prototype.isMatrix3=!0;var ir={getDataURL:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"==typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===rr&&(rr=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),rr.width=e.width,rr.height=e.height;var n=rr.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=rr}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}},or=0,sr=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ce,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ce,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Be,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:De,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:$e,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:Fe,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,h=arguments.length>9&&void 0!==arguments[9]?arguments[9]:hn;return Object(v.a)(this,n),e=t.call(this),Object.defineProperty(Object(f.a)(e),"id",{value:or++}),e.uuid=tr.generateUUID(),e.name="",e.image=r,e.mipmaps=[],e.mapping=a,e.wrapS=i,e.wrapT=o,e.magFilter=s,e.minFilter=c,e.anisotropy=d,e.format=u,e.internalFormat=null,e.type=l,e.offset=new nr(0,0),e.repeat=new nr(1,1),e.center=new nr(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new ar,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,e.encoding=h,e.version=0,e.onUpdate=null,e}return Object(g.a)(n,[{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var r=this.image;if(void 0===r.uuid&&(r.uuid=tr.generateUUID()),!t&&void 0===e.images[r.uuid]){var a;if(Array.isArray(r)){a=[];for(var i=0,o=r.length;i<o;i++)r[i].isDataTexture?a.push(cr(r[i].image)):a.push(cr(r[i]))}else a=cr(r);e.images[r.uuid]={uuid:r.uuid,url:a}}n.image=r.uuid}return t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(this.mapping!==ye)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case Se:e.x=e.x-Math.floor(e.x);break;case Ce:e.x=e.x<0?0:1;break;case Te:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case Se:e.y=e.y-Math.floor(e.y);break;case Ce:e.y=e.y<0?0:1;break;case Te:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(Qn);function cr(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?ir.getDataURL(e):e.data?{data:Array.prototype.slice.call(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}sr.DEFAULT_IMAGE=void 0,sr.DEFAULT_MAPPING=ye,sr.prototype.isTexture=!0;var ur=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(v.a)(this,e),this.x=t,this.y=n,this.z=r,this.w=a}return Object(g.a)(e,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,a=this.w,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r+i[12]*a,this.y=i[1]*t+i[5]*n+i[9]*r+i[13]*a,this.z=i[2]*t+i[6]*n+i[10]*r+i[14]*a,this.w=i[3]*t+i[7]*n+i[11]*r+i[15]*a,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,a,i=.01,o=.1,s=e.elements,c=s[0],u=s[4],l=s[8],d=s[1],h=s[5],f=s[9],p=s[2],m=s[6],v=s[10];if(Math.abs(u-d)<i&&Math.abs(l-p)<i&&Math.abs(f-m)<i){if(Math.abs(u+d)<o&&Math.abs(l+p)<o&&Math.abs(f+m)<o&&Math.abs(c+h+v-3)<o)return this.set(1,0,0,0),this;t=Math.PI;var g=(c+1)/2,b=(h+1)/2,y=(v+1)/2,x=(u+d)/4,w=(l+p)/4,O=(f+m)/4;return g>b&&g>y?g<i?(n=0,r=.707106781,a=.707106781):(r=x/(n=Math.sqrt(g)),a=w/n):b>y?b<i?(n=.707106781,r=0,a=.707106781):(n=x/(r=Math.sqrt(b)),a=O/r):y<i?(n=.707106781,r=.707106781,a=0):(n=w/(a=Math.sqrt(y)),r=O/a),this.set(n,r,a,t),this}var A=Math.sqrt((m-f)*(m-f)+(l-p)*(l-p)+(d-u)*(d-u));return Math.abs(A)<.001&&(A=1),this.x=(m-f)/A,this.y=(l-p)/A,this.z=(d-u)/A,this.w=Math.acos((c+h+v-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}]),e}();ur.prototype.isVector4=!0;var lr=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a){var i;return Object(v.a)(this,n),(i=t.call(this)).width=e,i.height=r,i.depth=1,i.scissor=new ur(0,0,e,r),i.scissorTest=!1,i.viewport=new ur(0,0,e,r),a=a||{},i.texture=new sr(void 0,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),i.texture.image={},i.texture.image.width=e,i.texture.image.height=r,i.texture.image.depth=1,i.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,i.texture.minFilter=void 0!==a.minFilter?a.minFilter:Be,i.depthBuffer=void 0===a.depthBuffer||a.depthBuffer,i.stencilBuffer=void 0!==a.stencilBuffer&&a.stencilBuffer,i.depthTexture=void 0!==a.depthTexture?a.depthTexture:null,i}return Object(g.a)(n,[{key:"setTexture",value:function(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}},{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.width=e.width,this.height=e.height,this.depth=e.depth,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(Qn);lr.prototype.isWebGLRenderTarget=!0;var dr=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a){var i;return Object(v.a)(this,n),(i=t.call(this,e,r,a)).samples=4,i}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.samples=e.samples,this}}]),n}(lr);dr.prototype.isWebGLMultisampleRenderTarget=!0;var hr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(v.a)(this,e),this._x=t,this._y=n,this._z=r,this._w=a}return Object(g.a)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,a=e._z,i=e._order,o=Math.cos,s=Math.sin,c=o(n/2),u=o(r/2),l=o(a/2),d=s(n/2),h=s(r/2),f=s(a/2);switch(i){case"XYZ":this._x=d*u*l+c*h*f,this._y=c*h*l-d*u*f,this._z=c*u*f+d*h*l,this._w=c*u*l-d*h*f;break;case"YXZ":this._x=d*u*l+c*h*f,this._y=c*h*l-d*u*f,this._z=c*u*f-d*h*l,this._w=c*u*l+d*h*f;break;case"ZXY":this._x=d*u*l-c*h*f,this._y=c*h*l+d*u*f,this._z=c*u*f+d*h*l,this._w=c*u*l-d*h*f;break;case"ZYX":this._x=d*u*l-c*h*f,this._y=c*h*l+d*u*f,this._z=c*u*f-d*h*l,this._w=c*u*l+d*h*f;break;case"YZX":this._x=d*u*l+c*h*f,this._y=c*h*l+d*u*f,this._z=c*u*f-d*h*l,this._w=c*u*l-d*h*f;break;case"XZY":this._x=d*u*l-c*h*f,this._y=c*h*l-d*u*f,this._z=c*u*f+d*h*l,this._w=c*u*l+d*h*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+i)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],a=t[8],i=t[1],o=t[5],s=t[9],c=t[2],u=t[6],l=t[10],d=n+o+l;if(d>0){var h=.5/Math.sqrt(d+1);this._w=.25/h,this._x=(u-s)*h,this._y=(a-c)*h,this._z=(i-r)*h}else if(n>o&&n>l){var f=2*Math.sqrt(1+n-o-l);this._w=(u-s)/f,this._x=.25*f,this._y=(r+i)/f,this._z=(a+c)/f}else if(o>l){var p=2*Math.sqrt(1+o-n-l);this._w=(a-c)/p,this._x=(r+i)/p,this._y=.25*p,this._z=(s+u)/p}else{var m=2*Math.sqrt(1+l-n-o);this._w=(i-r)/m,this._x=(a+c)/m,this._y=(s+u)/m,this._z=.25*m}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(tr.clamp(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,t)):this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,a=e._z,i=e._w,o=t._x,s=t._y,c=t._z,u=t._w;return this._x=n*u+i*o+r*c-a*s,this._y=r*u+i*s+a*o-n*c,this._z=a*u+i*c+n*s-r*o,this._w=i*u-n*o-r*s-a*c,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,a=this._z,i=this._w,o=i*e._w+n*e._x+r*e._y+a*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=i,this._x=n,this._y=r,this._z=a,this;var s=1-o*o;if(s<=Number.EPSILON){var c=1-t;return this._w=c*i+t*this._w,this._x=c*n+t*this._x,this._y=c*r+t*this._y,this._z=c*a+t*this._z,this.normalize(),this._onChangeCallback(),this}var u=Math.sqrt(s),l=Math.atan2(u,o),d=Math.sin((1-t)*l)/u,h=Math.sin(t*l)/u;return this._w=i*d+this._w*h,this._x=n*d+this._x*h,this._y=r*d+this._y*h,this._z=a*d+this._z*h,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){this.copy(e).slerp(t,n)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}],[{key:"slerp",value:function(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}},{key:"slerpFlat",value:function(e,t,n,r,a,i,o){var s=n[r+0],c=n[r+1],u=n[r+2],l=n[r+3],d=a[i+0],h=a[i+1],f=a[i+2],p=a[i+3];if(0===o)return e[t+0]=s,e[t+1]=c,e[t+2]=u,void(e[t+3]=l);if(1===o)return e[t+0]=d,e[t+1]=h,e[t+2]=f,void(e[t+3]=p);if(l!==p||s!==d||c!==h||u!==f){var m=1-o,v=s*d+c*h+u*f+l*p,g=v>=0?1:-1,b=1-v*v;if(b>Number.EPSILON){var y=Math.sqrt(b),x=Math.atan2(y,v*g);m=Math.sin(m*x)/y,o=Math.sin(o*x)/y}var w=o*g;if(s=s*m+d*w,c=c*m+h*w,u=u*m+f*w,l=l*m+p*w,m===1-o){var O=1/Math.sqrt(s*s+c*c+u*u+l*l);s*=O,c*=O,u*=O,l*=O}}e[t]=s,e[t+1]=c,e[t+2]=u,e[t+3]=l}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,a,i){var o=n[r],s=n[r+1],c=n[r+2],u=n[r+3],l=a[i],d=a[i+1],h=a[i+2],f=a[i+3];return e[t]=o*f+u*l+s*h-c*d,e[t+1]=s*f+u*d+c*l-o*h,e[t+2]=c*f+u*h+o*d-s*l,e[t+3]=u*f-o*l-s*d-c*h,e}}]),e}();hr.prototype.isQuaternion=!0;var fr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(v.a)(this,e),this.x=t,this.y=n,this.z=r}return Object(g.a)(e,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(mr.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(mr.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6]*r,this.y=a[1]*t+a[4]*n+a[7]*r,this.z=a[2]*t+a[5]*n+a[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements,i=1/(a[3]*t+a[7]*n+a[11]*r+a[15]);return this.x=(a[0]*t+a[4]*n+a[8]*r+a[12])*i,this.y=(a[1]*t+a[5]*n+a[9]*r+a[13])*i,this.z=(a[2]*t+a[6]*n+a[10]*r+a[14])*i,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.x,i=e.y,o=e.z,s=e.w,c=s*t+i*r-o*n,u=s*n+o*t-a*r,l=s*r+a*n-i*t,d=-a*t-i*n-o*r;return this.x=c*s+d*-a+u*-o-l*-i,this.y=u*s+d*-i+l*-a-c*-o,this.z=l*s+d*-o+c*-i-u*-a,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r,this.y=a[1]*t+a[5]*n+a[9]*r,this.z=a[2]*t+a[6]*n+a[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,a=e.z,i=t.x,o=t.y,s=t.z;return this.x=r*s-a*o,this.y=a*i-n*s,this.z=n*o-r*i,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return pr.copy(this).projectOnVector(e),this.sub(pr)}},{key:"reflect",value:function(e){return this.sub(pr.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(tr.clamp(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}]),e}();fr.prototype.isVector3=!0;var pr=new fr,mr=new hr,vr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fr(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr(-1/0,-1/0,-1/0);Object(v.a)(this,e),this.min=t,this.max=n}return Object(g.a)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){for(var t=1/0,n=1/0,r=1/0,a=-1/0,i=-1/0,o=-1/0,s=0,c=e.length;s<c;s+=3){var u=e[s],l=e[s+1],d=e[s+2];u<t&&(t=u),l<n&&(n=l),d<r&&(r=d),u>a&&(a=u),l>i&&(i=l),d>o&&(o=d)}return this.min.set(t,n,r),this.max.set(a,i,o),this}},{key:"setFromBufferAttribute",value:function(e){for(var t=1/0,n=1/0,r=1/0,a=-1/0,i=-1/0,o=-1/0,s=0,c=e.count;s<c;s++){var u=e.getX(s),l=e.getY(s),d=e.getZ(s);u<t&&(t=u),l<n&&(n=l),d<r&&(r=d),u>a&&(a=u),l>i&&(i=l),d>o&&(o=d)}return this.min.set(t,n,r),this.max.set(a,i,o),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=br.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e){return this.makeEmpty(),this.expandByObject(e)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new fr),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new fr),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){e.updateWorldMatrix(!1,!1);var t=e.geometry;void 0!==t&&(null===t.boundingBox&&t.computeBoundingBox(),yr.copy(t.boundingBox),yr.applyMatrix4(e.matrixWorld),this.union(yr));for(var n=e.children,r=0,a=n.length;r<a;r++)this.expandByObject(n[r]);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new fr),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,br),br.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(Sr),Cr.subVectors(this.max,Sr),xr.subVectors(e.a,Sr),wr.subVectors(e.b,Sr),Or.subVectors(e.c,Sr),Ar.subVectors(wr,xr),_r.subVectors(Or,wr),Er.subVectors(xr,Or);var t=[0,-Ar.z,Ar.y,0,-_r.z,_r.y,0,-Er.z,Er.y,Ar.z,0,-Ar.x,_r.z,0,-_r.x,Er.z,0,-Er.x,-Ar.y,Ar.x,0,-_r.y,_r.x,0,-Er.y,Er.x,0];return!!kr(t,xr,wr,Or,Cr)&&(!!kr(t=[1,0,0,0,1,0,0,0,1],xr,wr,Or,Cr)&&(Tr.crossVectors(Ar,_r),kr(t=[Tr.x,Tr.y,Tr.z],xr,wr,Or,Cr)))}},{key:"clampPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new fr),t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return br.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"getBoundingSphere",value:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(br).length(),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(gr[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),gr[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),gr[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),gr[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),gr[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),gr[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),gr[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),gr[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(gr)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();vr.prototype.isBox3=!0;var gr=[new fr,new fr,new fr,new fr,new fr,new fr,new fr,new fr],br=new fr,yr=new vr,xr=new fr,wr=new fr,Or=new fr,Ar=new fr,_r=new fr,Er=new fr,Sr=new fr,Cr=new fr,Tr=new fr,Mr=new fr;function kr(e,t,n,r,a){for(var i=0,o=e.length-3;i<=o;i+=3){Mr.fromArray(e,i);var s=a.x*Math.abs(Mr.x)+a.y*Math.abs(Mr.y)+a.z*Math.abs(Mr.z),c=t.dot(Mr),u=n.dot(Mr),l=r.dot(Mr);if(Math.max(-Math.max(c,u,l),Math.min(c,u,l))>s)return!1}return!0}var Rr=new vr,Ir=new fr,jr=new fr,Br=new fr,Lr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;Object(v.a)(this,e),this.center=t,this.radius=n}return Object(g.a)(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):Rr.setFromPoints(e).getCenter(n);for(var r=0,a=0,i=e.length;a<i;a++)r=Math.max(r,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new fr),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new vr),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){Br.subVectors(e,this.center);var t=Br.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(Br.multiplyScalar(r/n)),this.radius+=r}return this}},{key:"union",value:function(e){return jr.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Ir.copy(e.center).add(jr)),this.expandByPoint(Ir.copy(e.center).sub(jr)),this}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Nr=new fr,Dr=new fr,Pr=new fr,Fr=new fr,Gr=new fr,Ur=new fr,zr=new fr,Hr=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr(0,0,-1);Object(v.a)(this,e),this.origin=t,this.direction=n}return Object(g.a)(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new fr),t.copy(this.direction).multiplyScalar(e).add(this.origin)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,Nr)),this}},{key:"closestPointToPoint",value:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new fr),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=Nr.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Nr.copy(this.direction).multiplyScalar(t).add(this.origin),Nr.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){Dr.copy(e).add(t).multiplyScalar(.5),Pr.copy(t).sub(e).normalize(),Fr.copy(this.origin).sub(Dr);var a,i,o,s,c=.5*e.distanceTo(t),u=-this.direction.dot(Pr),l=Fr.dot(this.direction),d=-Fr.dot(Pr),h=Fr.lengthSq(),f=Math.abs(1-u*u);if(f>0)if(i=u*l-d,s=c*f,(a=u*d-l)>=0)if(i>=-s)if(i<=s){var p=1/f;o=(a*=p)*(a+u*(i*=p)+2*l)+i*(u*a+i+2*d)+h}else i=c,o=-(a=Math.max(0,-(u*i+l)))*a+i*(i+2*d)+h;else i=-c,o=-(a=Math.max(0,-(u*i+l)))*a+i*(i+2*d)+h;else i<=-s?o=-(a=Math.max(0,-(-u*c+l)))*a+(i=a>0?-c:Math.min(Math.max(-c,-d),c))*(i+2*d)+h:i<=s?(a=0,o=(i=Math.min(Math.max(-c,-d),c))*(i+2*d)+h):o=-(a=Math.max(0,-(u*c+l)))*a+(i=a>0?c:Math.min(Math.max(-c,-d),c))*(i+2*d)+h;else i=u>0?-c:c,o=-(a=Math.max(0,-(u*i+l)))*a+i*(i+2*d)+h;return n&&n.copy(this.direction).multiplyScalar(a).add(this.origin),r&&r.copy(Pr).multiplyScalar(i).add(Dr),o}},{key:"intersectSphere",value:function(e,t){Nr.subVectors(e.center,this.origin);var n=Nr.dot(this.direction),r=Nr.dot(Nr)-n*n,a=e.radius*e.radius;if(r>a)return null;var i=Math.sqrt(a-r),o=n-i,s=n+i;return o<0&&s<0?null:o<0?this.at(s,t):this.at(o,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,a,i,o,s,c=1/this.direction.x,u=1/this.direction.y,l=1/this.direction.z,d=this.origin;return c>=0?(n=(e.min.x-d.x)*c,r=(e.max.x-d.x)*c):(n=(e.max.x-d.x)*c,r=(e.min.x-d.x)*c),u>=0?(a=(e.min.y-d.y)*u,i=(e.max.y-d.y)*u):(a=(e.max.y-d.y)*u,i=(e.min.y-d.y)*u),n>i||a>r?null:((a>n||n!==n)&&(n=a),(i<r||r!==r)&&(r=i),l>=0?(o=(e.min.z-d.z)*l,s=(e.max.z-d.z)*l):(o=(e.max.z-d.z)*l,s=(e.min.z-d.z)*l),n>s||o>r?null:((o>n||n!==n)&&(n=o),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,Nr)}},{key:"intersectTriangle",value:function(e,t,n,r,a){Gr.subVectors(t,e),Ur.subVectors(n,e),zr.crossVectors(Gr,Ur);var i,o=this.direction.dot(zr);if(o>0){if(r)return null;i=1}else{if(!(o<0))return null;i=-1,o=-o}Fr.subVectors(this.origin,e);var s=i*this.direction.dot(Ur.crossVectors(Fr,Ur));if(s<0)return null;var c=i*this.direction.dot(Gr.cross(Fr));if(c<0)return null;if(s+c>o)return null;var u=-i*Fr.dot(zr);return u<0?null:this.at(u/o,a)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Vr=function(){function e(){Object(v.a)(this,e),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}return Object(g.a)(e,[{key:"set",value:function(e,t,n,r,a,i,o,s,c,u,l,d,h,f,p,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=a,v[5]=i,v[9]=o,v[13]=s,v[2]=c,v[6]=u,v[10]=l,v[14]=d,v[3]=h,v[7]=f,v[11]=p,v[15]=m,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/Wr.setFromMatrixColumn(e,0).length(),a=1/Wr.setFromMatrixColumn(e,1).length(),i=1/Wr.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=0,t[8]=n[8]*i,t[9]=n[9]*i,t[10]=n[10]*i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,a=e.z,i=Math.cos(n),o=Math.sin(n),s=Math.cos(r),c=Math.sin(r),u=Math.cos(a),l=Math.sin(a);if("XYZ"===e.order){var d=i*u,h=i*l,f=o*u,p=o*l;t[0]=s*u,t[4]=-s*l,t[8]=c,t[1]=h+f*c,t[5]=d-p*c,t[9]=-o*s,t[2]=p-d*c,t[6]=f+h*c,t[10]=i*s}else if("YXZ"===e.order){var m=s*u,v=s*l,g=c*u,b=c*l;t[0]=m+b*o,t[4]=g*o-v,t[8]=i*c,t[1]=i*l,t[5]=i*u,t[9]=-o,t[2]=v*o-g,t[6]=b+m*o,t[10]=i*s}else if("ZXY"===e.order){var y=s*u,x=s*l,w=c*u,O=c*l;t[0]=y-O*o,t[4]=-i*l,t[8]=w+x*o,t[1]=x+w*o,t[5]=i*u,t[9]=O-y*o,t[2]=-i*c,t[6]=o,t[10]=i*s}else if("ZYX"===e.order){var A=i*u,_=i*l,E=o*u,S=o*l;t[0]=s*u,t[4]=E*c-_,t[8]=A*c+S,t[1]=s*l,t[5]=S*c+A,t[9]=_*c-E,t[2]=-c,t[6]=o*s,t[10]=i*s}else if("YZX"===e.order){var C=i*s,T=i*c,M=o*s,k=o*c;t[0]=s*u,t[4]=k-C*l,t[8]=M*l+T,t[1]=l,t[5]=i*u,t[9]=-o*u,t[2]=-c*u,t[6]=T*l+M,t[10]=C-k*l}else if("XZY"===e.order){var R=i*s,I=i*c,j=o*s,B=o*c;t[0]=s*u,t[4]=-l,t[8]=c*u,t[1]=R*l+B,t[5]=i*u,t[9]=I*l-j,t[2]=j*l-I,t[6]=o*u,t[10]=B*l+R}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(Xr,e,Kr)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return Qr.subVectors(e,t),0===Qr.lengthSq()&&(Qr.z=1),Qr.normalize(),qr.crossVectors(n,Qr),0===qr.lengthSq()&&(1===Math.abs(n.z)?Qr.x+=1e-4:Qr.z+=1e-4,Qr.normalize(),qr.crossVectors(n,Qr)),qr.normalize(),Yr.crossVectors(Qr,qr),r[0]=qr.x,r[4]=Yr.x,r[8]=Qr.x,r[1]=qr.y,r[5]=Yr.y,r[9]=Qr.y,r[2]=qr.z,r[6]=Yr.z,r[10]=Qr.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,a=this.elements,i=n[0],o=n[4],s=n[8],c=n[12],u=n[1],l=n[5],d=n[9],h=n[13],f=n[2],p=n[6],m=n[10],v=n[14],g=n[3],b=n[7],y=n[11],x=n[15],w=r[0],O=r[4],A=r[8],_=r[12],E=r[1],S=r[5],C=r[9],T=r[13],M=r[2],k=r[6],R=r[10],I=r[14],j=r[3],B=r[7],L=r[11],N=r[15];return a[0]=i*w+o*E+s*M+c*j,a[4]=i*O+o*S+s*k+c*B,a[8]=i*A+o*C+s*R+c*L,a[12]=i*_+o*T+s*I+c*N,a[1]=u*w+l*E+d*M+h*j,a[5]=u*O+l*S+d*k+h*B,a[9]=u*A+l*C+d*R+h*L,a[13]=u*_+l*T+d*I+h*N,a[2]=f*w+p*E+m*M+v*j,a[6]=f*O+p*S+m*k+v*B,a[10]=f*A+p*C+m*R+v*L,a[14]=f*_+p*T+m*I+v*N,a[3]=g*w+b*E+y*M+x*j,a[7]=g*O+b*S+y*k+x*B,a[11]=g*A+b*C+y*R+x*L,a[15]=g*_+b*T+y*I+x*N,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],a=e[12],i=e[1],o=e[5],s=e[9],c=e[13],u=e[2],l=e[6],d=e[10],h=e[14];return e[3]*(+a*s*l-r*c*l-a*o*d+n*c*d+r*o*h-n*s*h)+e[7]*(+t*s*h-t*c*d+a*i*d-r*i*h+r*c*u-a*s*u)+e[11]*(+t*c*l-t*o*h-a*i*l+n*i*h+a*o*u-n*c*u)+e[15]*(-r*o*u-t*s*l+t*o*d+r*i*l-n*i*d+n*s*u)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6],c=e[7],u=e[8],l=e[9],d=e[10],h=e[11],f=e[12],p=e[13],m=e[14],v=e[15],g=l*m*c-p*d*c+p*s*h-o*m*h-l*s*v+o*d*v,b=f*d*c-u*m*c-f*s*h+i*m*h+u*s*v-i*d*v,y=u*p*c-f*l*c+f*o*h-i*p*h-u*o*v+i*l*v,x=f*l*s-u*p*s-f*o*d+i*p*d+u*o*m-i*l*m,w=t*g+n*b+r*y+a*x;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var O=1/w;return e[0]=g*O,e[1]=(p*d*a-l*m*a-p*r*h+n*m*h+l*r*v-n*d*v)*O,e[2]=(o*m*a-p*s*a+p*r*c-n*m*c-o*r*v+n*s*v)*O,e[3]=(l*s*a-o*d*a-l*r*c+n*d*c+o*r*h-n*s*h)*O,e[4]=b*O,e[5]=(u*m*a-f*d*a+f*r*h-t*m*h-u*r*v+t*d*v)*O,e[6]=(f*s*a-i*m*a-f*r*c+t*m*c+i*r*v-t*s*v)*O,e[7]=(i*d*a-u*s*a+u*r*c-t*d*c-i*r*h+t*s*h)*O,e[8]=y*O,e[9]=(f*l*a-u*p*a-f*n*h+t*p*h+u*n*v-t*l*v)*O,e[10]=(i*p*a-f*o*a+f*n*c-t*p*c-i*n*v+t*o*v)*O,e[11]=(u*o*a-i*l*a-u*n*c+t*l*c+i*n*h-t*o*h)*O,e[12]=x*O,e[13]=(u*p*r-f*l*r+f*n*d-t*p*d-u*n*m+t*l*m)*O,e[14]=(f*o*r-i*p*r-f*n*s+t*p*s+i*n*m-t*o*m)*O,e[15]=(i*l*r-u*o*r+u*n*s-t*l*s-i*n*d+t*o*d)*O,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,a=e.z;return t[0]*=n,t[4]*=r,t[8]*=a,t[1]*=n,t[5]*=r,t[9]*=a,t[2]*=n,t[6]*=r,t[10]*=a,t[3]*=n,t[7]*=r,t[11]*=a,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),a=1-n,i=e.x,o=e.y,s=e.z,c=a*i,u=a*o;return this.set(c*i+n,c*o-r*s,c*s+r*o,0,c*o+r*s,u*o+n,u*s-r*i,0,c*s-r*o,u*s+r*i,a*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,a=t._x,i=t._y,o=t._z,s=t._w,c=a+a,u=i+i,l=o+o,d=a*c,h=a*u,f=a*l,p=i*u,m=i*l,v=o*l,g=s*c,b=s*u,y=s*l,x=n.x,w=n.y,O=n.z;return r[0]=(1-(p+v))*x,r[1]=(h+y)*x,r[2]=(f-b)*x,r[3]=0,r[4]=(h-y)*w,r[5]=(1-(d+v))*w,r[6]=(m+g)*w,r[7]=0,r[8]=(f+b)*O,r[9]=(m-g)*O,r[10]=(1-(d+p))*O,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,a=Wr.set(r[0],r[1],r[2]).length(),i=Wr.set(r[4],r[5],r[6]).length(),o=Wr.set(r[8],r[9],r[10]).length();this.determinant()<0&&(a=-a),e.x=r[12],e.y=r[13],e.z=r[14],Jr.copy(this);var s=1/a,c=1/i,u=1/o;return Jr.elements[0]*=s,Jr.elements[1]*=s,Jr.elements[2]*=s,Jr.elements[4]*=c,Jr.elements[5]*=c,Jr.elements[6]*=c,Jr.elements[8]*=u,Jr.elements[9]*=u,Jr.elements[10]*=u,t.setFromRotationMatrix(Jr),n.x=a,n.y=i,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,a,i){void 0===i&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*a/(t-e),c=2*a/(n-r),u=(t+e)/(t-e),l=(n+r)/(n-r),d=-(i+a)/(i-a),h=-2*i*a/(i-a);return o[0]=s,o[4]=0,o[8]=u,o[12]=0,o[1]=0,o[5]=c,o[9]=l,o[13]=0,o[2]=0,o[6]=0,o[10]=d,o[14]=h,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,a,i){var o=this.elements,s=1/(t-e),c=1/(n-r),u=1/(i-a),l=(t+e)*s,d=(n+r)*c,h=(i+a)*u;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-l,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-d,o[2]=0,o[6]=0,o[10]=-2*u,o[14]=-h,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}();Vr.prototype.isMatrix4=!0;var Wr=new fr,Jr=new Vr,Xr=new fr(0,0,0),Kr=new fr(1,1,1),qr=new fr,Yr=new fr,Qr=new fr,Zr=new Vr,$r=new hr,ea=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;Object(v.a)(this,e),this._x=t,this._y=n,this._z=r,this._order=a}return Object(g.a)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e,t,n){var r=tr.clamp,a=e.elements,i=a[0],o=a[4],s=a[8],c=a[1],u=a[5],l=a[9],d=a[2],h=a[6],f=a[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-l,f),this._z=Math.atan2(-o,i)):(this._x=Math.atan2(h,u),this._z=0);break;case"YXZ":this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.9999999?(this._y=Math.atan2(s,f),this._z=Math.atan2(c,u)):(this._y=Math.atan2(-d,i),this._z=0);break;case"ZXY":this._x=Math.asin(r(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(-d,f),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(c,i));break;case"ZYX":this._y=Math.asin(-r(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(h,f),this._z=Math.atan2(c,i)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(r(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(-l,u),this._y=Math.atan2(-d,i)):(this._x=0,this._y=Math.atan2(s,f));break;case"XZY":this._z=Math.asin(-r(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(h,u),this._y=Math.atan2(s,i)):(this._x=Math.atan2(-l,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return Zr.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Zr,t,n)}},{key:"setFromVector3",value:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)}},{key:"reorder",value:function(e){return $r.setFromEuler(this),this.setFromQuaternion($r,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"toVector3",value:function(e){return e?e.set(this._x,this._y,this._z):new fr(this._x,this._y,this._z)}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}]),e}();ea.prototype.isEuler=!0,ea.DefaultOrder="XYZ",ea.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var ta=function(){function e(){Object(v.a)(this,e),this.mask=1}return Object(g.a)(e,[{key:"set",value:function(e){this.mask=1<<e|0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!==(this.mask&e.mask)}}]),e}(),na=0,ra=new fr,aa=new hr,ia=new Vr,oa=new fr,sa=new fr,ca=new fr,ua=new hr,la=new fr(1,0,0),da=new fr(0,1,0),ha=new fr(0,0,1),fa={type:"added"},pa={type:"removed"};function ma(){Object.defineProperty(this,"id",{value:na++}),this.uuid=tr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ma.DefaultUp.clone();var e=new fr,t=new ea,n=new hr,r=new fr(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new Vr},normalMatrix:{value:new ar}}),this.matrix=new Vr,this.matrixWorld=new Vr,this.matrixAutoUpdate=ma.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new ta,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}ma.DefaultUp=new fr(0,1,0),ma.DefaultMatrixAutoUpdate=!0,ma.prototype=Object.assign(Object.create(Qn.prototype),{constructor:ma,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,t){return aa.setFromAxisAngle(e,t),this.quaternion.multiply(aa),this},rotateOnWorldAxis:function(e,t){return aa.setFromAxisAngle(e,t),this.quaternion.premultiply(aa),this},rotateX:function(e){return this.rotateOnAxis(la,e)},rotateY:function(e){return this.rotateOnAxis(da,e)},rotateZ:function(e){return this.rotateOnAxis(ha,e)},translateOnAxis:function(e,t){return ra.copy(e).applyQuaternion(this.quaternion),this.position.add(ra.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(la,e)},translateY:function(e){return this.translateOnAxis(da,e)},translateZ:function(e){return this.translateOnAxis(ha,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(ia.copy(this.matrixWorld).invert())},lookAt:function(e,t,n){e.isVector3?oa.copy(e):oa.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),sa.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ia.lookAt(sa,oa,this.up):ia.lookAt(oa,sa,this.up),this.quaternion.setFromRotationMatrix(ia),r&&(ia.extractRotation(r.matrixWorld),aa.setFromRotationMatrix(ia),this.quaternion.premultiply(aa.invert()))},add:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(fa)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(pa)),this},clear:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(pa)}return this.children.length=0,this},attach:function(e){return this.updateWorldMatrix(!0,!1),ia.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),ia.multiply(e.parent.matrixWorld)),e.applyMatrix4(ia),this.add(e),e.updateWorldMatrix(!1,!0),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var a=this.children[n].getObjectByProperty(e,t);if(void 0!==a)return a}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new fr),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new hr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sa,e,ca),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new fr),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(sa,ua,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new fr),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,a=0,i=r.length;a<i;a++)r[a].updateWorldMatrix(!1,!0)},toJSON:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},n.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var r={};function a(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isMesh||this.isLine||this.isPoints){r.geometry=a(e.geometries,this.geometry);var i=this.geometry.parameters;if(void 0!==i&&void 0!==i.shapes){var o=i.shapes;if(Array.isArray(o))for(var s=0,c=o.length;s<c;s++){var u=o[s];a(e.shapes,u)}else a(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(a(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var l=[],d=0,h=this.material.length;d<h;d++)l.push(a(e.materials,this.material[d]));r.material=l}else r.material=a(e.materials,this.material);if(this.children.length>0){r.children=[];for(var f=0;f<this.children.length;f++)r.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var p=0;p<this.animations.length;p++){var m=this.animations[p];r.animations.push(a(e.animations,m))}}if(t){var v=A(e.geometries),g=A(e.materials),b=A(e.textures),y=A(e.images),x=A(e.shapes),w=A(e.skeletons),O=A(e.animations);v.length>0&&(n.geometries=v),g.length>0&&(n.materials=g),b.length>0&&(n.textures=b),y.length>0&&(n.images=y),x.length>0&&(n.shapes=x),w.length>0&&(n.skeletons=w),O.length>0&&(n.animations=O)}return n.object=r,n;function A(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}});var va=new fr,ga=new fr,ba=new ar,ya=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fr(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(v.a)(this,e),this.normal=t,this.constant=n}return Object(g.a)(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=va.subVectors(n,t).cross(ga.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new fr),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}},{key:"intersectLine",value:function(e,t){void 0===t&&(console.warn("THREE.Plane: .intersectLine() target is now required"),t=new fr);var n=e.delta(va),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var a=-(e.start.dot(this.normal)+this.constant)/r;return a<0||a>1?null:t.copy(n).multiplyScalar(a).add(e.start)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new fr),e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||ba.getNormalMatrix(e),r=this.coplanarPoint(va).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(a),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();ya.prototype.isPlane=!0;var xa=new fr,wa=new fr,Oa=new fr,Aa=new fr,_a=new fr,Ea=new fr,Sa=new fr,Ca=new fr,Ta=new fr,Ma=new fr,ka=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new fr;Object(v.a)(this,e),this.a=t,this.b=n,this.c=r}return Object(g.a)(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return xa.subVectors(this.c,this.b),wa.subVectors(this.a,this.b),.5*xa.cross(wa).length()}},{key:"getMidpoint",value:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new fr),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new ya),e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,a,i){return e.getUV(t,this.a,this.b,this.c,n,r,a,i)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){void 0===t&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),t=new fr);var n,r,a=this.a,i=this.b,o=this.c;_a.subVectors(i,a),Ea.subVectors(o,a),Ca.subVectors(e,a);var s=_a.dot(Ca),c=Ea.dot(Ca);if(s<=0&&c<=0)return t.copy(a);Ta.subVectors(e,i);var u=_a.dot(Ta),l=Ea.dot(Ta);if(u>=0&&l<=u)return t.copy(i);var d=s*l-u*c;if(d<=0&&s>=0&&u<=0)return n=s/(s-u),t.copy(a).addScaledVector(_a,n);Ma.subVectors(e,o);var h=_a.dot(Ma),f=Ea.dot(Ma);if(f>=0&&h<=f)return t.copy(o);var p=h*c-s*f;if(p<=0&&c>=0&&f<=0)return r=c/(c-f),t.copy(a).addScaledVector(Ea,r);var m=u*f-h*l;if(m<=0&&l-u>=0&&h-f>=0)return Sa.subVectors(o,i),r=(l-u)/(l-u+(h-f)),t.copy(i).addScaledVector(Sa,r);var v=1/(m+p+d);return n=p*v,r=d*v,t.copy(a).addScaledVector(_a,n).addScaledVector(Ea,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){void 0===r&&(console.warn("THREE.Triangle: .getNormal() target is now required"),r=new fr),r.subVectors(n,t),xa.subVectors(e,t),r.cross(xa);var a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,a){xa.subVectors(r,t),wa.subVectors(n,t),Oa.subVectors(e,t);var i=xa.dot(xa),o=xa.dot(wa),s=xa.dot(Oa),c=wa.dot(wa),u=wa.dot(Oa),l=i*c-o*o;if(void 0===a&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),a=new fr),0===l)return a.set(-2,-1,-1);var d=1/l,h=(c*s-o*u)*d,f=(i*u-o*s)*d;return a.set(1-h-f,f,h)}},{key:"containsPoint",value:function(e,t,n,r){return this.getBarycoord(e,t,n,r,Aa),Aa.x>=0&&Aa.y>=0&&Aa.x+Aa.y<=1}},{key:"getUV",value:function(e,t,n,r,a,i,o,s){return this.getBarycoord(e,t,n,r,Aa),s.set(0,0),s.addScaledVector(a,Aa.x),s.addScaledVector(i,Aa.y),s.addScaledVector(o,Aa.z),s}},{key:"isFrontFacing",value:function(e,t,n,r){return xa.subVectors(n,t),wa.subVectors(e,t),xa.cross(wa).dot(r)<0}}]),e}(),Ra=0;function Ia(){Object.defineProperty(this,"id",{value:Ra++}),this.uuid=tr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=L,this.side=M,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=q,this.blendDst=Y,this.blendEquation=G,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ie,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Fn,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=En,this.stencilZFail=En,this.stencilZPass=En,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}Ia.prototype=Object.assign(Object.create(Qn.prototype),{constructor:Ia,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===I;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(n.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,n.reflectivity=this.reflectivity,n.refractionRatio=this.refractionRatio,void 0!==this.combine&&(n.combine=this.combine),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==L&&(n.blending=this.blending),this.side!==M&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(n.morphTargets=!0),!0===this.morphNormals&&(n.morphNormals=!0),!0===this.skinning&&(n.skinning=!0),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),t){var a=r(e.textures),i=r(e.images);a.length>0&&(n.textures=a),i.length>0&&(n.images=i)}return n},clone:function(){return(new this.constructor).copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var a=0;a!==r;++a)n[a]=t[a].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(Ia.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});var ja={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ba={h:0,s:0,l:0},La={h:0,s:0,l:0};function Na(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}function Da(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function Pa(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var Fa=function(){function e(t,n,r){return Object(v.a)(this,e),void 0===n&&void 0===r?this.set(t):this.setRGB(t,n,r)}return Object(g.a)(e,[{key:"set",value:function(e){return e&&e.isColor?this.copy(e):"number"===typeof e?this.setHex(e):"string"===typeof e&&this.setStyle(e),this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}},{key:"setRGB",value:function(e,t,n){return this.r=e,this.g=t,this.b=n,this}},{key:"setHSL",value:function(e,t,n){if(e=tr.euclideanModulo(e,1),t=tr.clamp(t,0,1),n=tr.clamp(n,0,1),0===t)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+t):n+t-n*t,a=2*n-r;this.r=Na(a,r,e+1/3),this.g=Na(a,r,e),this.b=Na(a,r,e-1/3)}return this}},{key:"setStyle",value:function(e){function t(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(e)){var r,a=n[1],i=n[2];switch(a){case"rgb":case"rgba":if(r=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,t(r[4]),this;if(r=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,t(r[4]),this;break;case"hsl":case"hsla":if(r=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(i)){var o=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,c=parseInt(r[3],10)/100;return t(r[4]),this.setHSL(o,s,c)}}}else if(n=/^\#([A-Fa-f\d]+)$/.exec(e)){var u=n[1],l=u.length;if(3===l)return this.r=parseInt(u.charAt(0)+u.charAt(0),16)/255,this.g=parseInt(u.charAt(1)+u.charAt(1),16)/255,this.b=parseInt(u.charAt(2)+u.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(u.charAt(0)+u.charAt(1),16)/255,this.g=parseInt(u.charAt(2)+u.charAt(3),16)/255,this.b=parseInt(u.charAt(4)+u.charAt(5),16)/255,this}return e&&e.length>0?this.setColorName(e):this}},{key:"setColorName",value:function(e){var t=ja[e];return void 0!==t?this.setHex(t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copyGammaToLinear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}},{key:"copyLinearToGamma",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}},{key:"convertGammaToLinear",value:function(e){return this.copyGammaToLinear(this,e),this}},{key:"convertLinearToGamma",value:function(e){return this.copyLinearToGamma(this,e),this}},{key:"copySRGBToLinear",value:function(e){return this.r=Da(e.r),this.g=Da(e.g),this.b=Da(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=Pa(e.r),this.g=Pa(e.g),this.b=Pa(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}},{key:"getHexString",value:function(){return("000000"+this.getHex().toString(16)).slice(-6)}},{key:"getHSL",value:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,a=this.g,i=this.b,o=Math.max(r,a,i),s=Math.min(r,a,i),c=(s+o)/2;if(s===o)t=0,n=0;else{var u=o-s;switch(n=c<=.5?u/(o+s):u/(2-o-s),o){case r:t=(a-i)/u+(a<i?6:0);break;case a:t=(i-r)/u+2;break;case i:t=(r-a)/u+4}t/=6}return e.h=t,e.s=n,e.l=c,e}},{key:"getStyle",value:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(Ba),Ba.h+=e,Ba.s+=t,Ba.l+=n,this.setHSL(Ba.h,Ba.s,Ba.l),this}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(Ba),e.getHSL(La);var n=tr.lerp(Ba.h,La.h,t),r=tr.lerp(Ba.s,La.s,t),a=tr.lerp(Ba.l,La.l,t);return this.setHSL(n,r,a),this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}},{key:"toJSON",value:function(){return this.getHex()}}]),e}();Fa.NAMES=ja,Fa.prototype.isColor=!0,Fa.prototype.r=1,Fa.prototype.g=1,Fa.prototype.b=1;var Ga=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="MeshBasicMaterial",r.color=new Fa(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=le,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this}}]),n}(Ia);Ga.prototype.isMeshBasicMaterial=!0;var Ua=new fr,za=new nr;function Ha(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=Gn,this.updateRange={offset:0,count:-1},this.version=0}function Va(e,t,n){Ha.call(this,new Int8Array(e),t,n)}function Wa(e,t,n){Ha.call(this,new Uint8Array(e),t,n)}function Ja(e,t,n){Ha.call(this,new Uint8ClampedArray(e),t,n)}function Xa(e,t,n){Ha.call(this,new Int16Array(e),t,n)}function Ka(e,t,n){Ha.call(this,new Uint16Array(e),t,n)}function qa(e,t,n){Ha.call(this,new Int32Array(e),t,n)}function Ya(e,t,n){Ha.call(this,new Uint32Array(e),t,n)}function Qa(e,t,n){Ha.call(this,new Uint16Array(e),t,n)}function Za(e,t,n){Ha.call(this,new Float32Array(e),t,n)}function $a(e,t,n){Ha.call(this,new Float64Array(e),t,n)}function ei(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty(Ha.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Ha.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,a=this.itemSize;r<a;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),i=new Fa),t[n++]=i.r,t[n++]=i.g,t[n++]=i.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),i=new nr),t[n++]=i.x,t[n++]=i.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),i=new fr),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,a=e.length;r<a;r++){var i=e[r];void 0===i&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),i=new ur),t[n++]=i.x,t[n++]=i.y,t[n++]=i.z,t[n++]=i.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)za.fromBufferAttribute(this,t),za.applyMatrix3(e),this.setXY(t,za.x,za.y);else if(3===this.itemSize)for(var r=0,a=this.count;r<a;r++)Ua.fromBufferAttribute(this,r),Ua.applyMatrix3(e),this.setXYZ(r,Ua.x,Ua.y,Ua.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)Ua.x=this.getX(t),Ua.y=this.getY(t),Ua.z=this.getZ(t),Ua.applyMatrix4(e),this.setXYZ(t,Ua.x,Ua.y,Ua.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)Ua.x=this.getX(t),Ua.y=this.getY(t),Ua.z=this.getZ(t),Ua.applyNormalMatrix(e),this.setXYZ(t,Ua.x,Ua.y,Ua.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)Ua.x=this.getX(t),Ua.y=this.getY(t),Ua.z=this.getZ(t),Ua.transformDirection(e),this.setXYZ(t,Ua.x,Ua.y,Ua.z);return this},set:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,a){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=a,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),this.usage!==Gn&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}),Va.prototype=Object.create(Ha.prototype),Va.prototype.constructor=Va,Wa.prototype=Object.create(Ha.prototype),Wa.prototype.constructor=Wa,Ja.prototype=Object.create(Ha.prototype),Ja.prototype.constructor=Ja,Xa.prototype=Object.create(Ha.prototype),Xa.prototype.constructor=Xa,Ka.prototype=Object.create(Ha.prototype),Ka.prototype.constructor=Ka,qa.prototype=Object.create(Ha.prototype),qa.prototype.constructor=qa,Ya.prototype=Object.create(Ha.prototype),Ya.prototype.constructor=Ya,Qa.prototype=Object.create(Ha.prototype),Qa.prototype.constructor=Qa,Qa.prototype.isFloat16BufferAttribute=!0,Za.prototype=Object.create(Ha.prototype),Za.prototype.constructor=Za,$a.prototype=Object.create(Ha.prototype),$a.prototype.constructor=$a;var ti={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:Uint8ClampedArray,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function ni(e,t){return new ti[e](t)}var ri=0,ai=new Vr,ii=new ma,oi=new fr,si=new vr,ci=new vr,ui=new fr;function li(){Object.defineProperty(this,"id",{value:ri++}),this.uuid=tr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}li.prototype=Object.assign(Object.create(Qn.prototype),{constructor:li,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(ei(e)>65535?Ya:Ka)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},hasAttribute:function(e){return void 0!==this.attributes[e]},addGroup:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new ar).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var a=this.attributes.tangent;return void 0!==a&&(a.transformDirection(e),a.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return ai.makeRotationX(e),this.applyMatrix4(ai),this},rotateY:function(e){return ai.makeRotationY(e),this.applyMatrix4(ai),this},rotateZ:function(e){return ai.makeRotationZ(e),this.applyMatrix4(ai),this},translate:function(e,t,n){return ai.makeTranslation(e,t,n),this.applyMatrix4(ai),this},scale:function(e,t,n){return ai.makeScale(e,t,n),this.applyMatrix4(ai),this},lookAt:function(e){return ii.lookAt(e),ii.updateMatrix(),this.applyMatrix4(ii.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(oi).negate(),this.translate(oi.x,oi.y,oi.z),this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new Za(t,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new vr);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new fr(-1/0,-1/0,-1/0),new fr(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var a=t[n];si.setFromBufferAttribute(a),this.morphTargetsRelative?(ui.addVectors(this.boundingBox.min,si.min),this.boundingBox.expandByPoint(ui),ui.addVectors(this.boundingBox.max,si.max),this.boundingBox.expandByPoint(ui)):(this.boundingBox.expandByPoint(si.min),this.boundingBox.expandByPoint(si.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new Lr);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new fr,1/0);if(e){var n=this.boundingSphere.center;if(si.setFromBufferAttribute(e),t)for(var r=0,a=t.length;r<a;r++){var i=t[r];ci.setFromBufferAttribute(i),this.morphTargetsRelative?(ui.addVectors(si.min,ci.min),si.expandByPoint(ui),ui.addVectors(si.max,ci.max),si.expandByPoint(ui)):(si.expandByPoint(ci.min),si.expandByPoint(ci.max))}si.getCenter(n);for(var o=0,s=0,c=e.count;s<c;s++)ui.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(ui));if(t)for(var u=0,l=t.length;u<l;u++)for(var d=t[u],h=this.morphTargetsRelative,f=0,p=d.count;f<p;f++)ui.fromBufferAttribute(d,f),h&&(oi.fromBufferAttribute(e,f),ui.add(oi)),o=Math.max(o,n.distanceToSquared(ui));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,a=t.normal.array,i=t.uv.array,o=r.length/3;void 0===t.tangent&&this.setAttribute("tangent",new Ha(new Float32Array(4*o),4));for(var s=t.tangent.array,c=[],u=[],l=0;l<o;l++)c[l]=new fr,u[l]=new fr;var d=new fr,h=new fr,f=new fr,p=new nr,m=new nr,v=new nr,g=new fr,b=new fr,y=this.groups;0===y.length&&(y=[{start:0,count:n.length}]);for(var x=0,w=y.length;x<w;++x)for(var O=y[x],A=O.start,_=A,E=A+O.count;_<E;_+=3)N(n[_+0],n[_+1],n[_+2]);for(var S=new fr,C=new fr,T=new fr,M=new fr,k=0,R=y.length;k<R;++k)for(var I=y[k],j=I.start,B=j,L=j+I.count;B<L;B+=3)D(n[B+0]),D(n[B+1]),D(n[B+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function N(e,t,n){d.fromArray(r,3*e),h.fromArray(r,3*t),f.fromArray(r,3*n),p.fromArray(i,2*e),m.fromArray(i,2*t),v.fromArray(i,2*n),h.sub(d),f.sub(d),m.sub(p),v.sub(p);var a=1/(m.x*v.y-v.x*m.y);isFinite(a)&&(g.copy(h).multiplyScalar(v.y).addScaledVector(f,-m.y).multiplyScalar(a),b.copy(f).multiplyScalar(m.x).addScaledVector(h,-v.x).multiplyScalar(a),c[e].add(g),c[t].add(g),c[n].add(g),u[e].add(b),u[t].add(b),u[n].add(b))}function D(e){T.fromArray(a,3*e),M.copy(T);var t=c[e];S.copy(t),S.sub(T.multiplyScalar(T.dot(t))).normalize(),C.crossVectors(M,t);var n=C.dot(u[e])<0?-1:1;s[4*e]=S.x,s[4*e+1]=S.y,s[4*e+2]=S.z,s[4*e+3]=n}},computeVertexNormals:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new Ha(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,a=n.count;r<a;r++)n.setXYZ(r,0,0,0);var i=new fr,o=new fr,s=new fr,c=new fr,u=new fr,l=new fr,d=new fr,h=new fr;if(e)for(var f=0,p=e.count;f<p;f+=3){var m=e.getX(f+0),v=e.getX(f+1),g=e.getX(f+2);i.fromBufferAttribute(t,m),o.fromBufferAttribute(t,v),s.fromBufferAttribute(t,g),d.subVectors(s,o),h.subVectors(i,o),d.cross(h),c.fromBufferAttribute(n,m),u.fromBufferAttribute(n,v),l.fromBufferAttribute(n,g),c.add(d),u.add(d),l.add(d),n.setXYZ(m,c.x,c.y,c.z),n.setXYZ(v,u.x,u.y,u.z),n.setXYZ(g,l.x,l.y,l.z)}else for(var b=0,y=t.count;b<y;b+=3)i.fromBufferAttribute(t,b+0),o.fromBufferAttribute(t,b+1),s.fromBufferAttribute(t,b+2),d.subVectors(s,o),h.subVectors(i,o),d.cross(h),n.setXYZ(b+0,d.x,d.y,d.z),n.setXYZ(b+1,d.x,d.y,d.z),n.setXYZ(b+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var a=n[r].array,i=e.attributes[r],o=i.array,s=i.itemSize*t,c=Math.min(o.length,a.length-s),u=0,l=s;u<c;u++,l++)a[l]=o[u];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)ui.fromBufferAttribute(e,t),ui.normalize(),e.setXYZ(t,ui.x,ui.y,ui.z)},toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,a=e.normalized,i=new n.constructor(t.length*r),o=0,s=0,c=0,u=t.length;c<u;c++){o=t[c]*r;for(var l=0;l<r;l++)i[s++]=n[o++]}return new Ha(i,r,a)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new li,n=this.index.array,r=this.attributes;for(var a in r){var i=e(r[a],n);t.setAttribute(a,i)}var o=this.morphAttributes;for(var s in o){for(var c=[],u=o[s],l=0,d=u.length;l<d;l++){var h=e(u[l],n);c.push(h)}t.morphAttributes[s]=c}t.morphTargetsRelative=this.morphTargetsRelative;for(var f=this.groups,p=0,m=f.length;p<m;p++){var v=f[p];t.addGroup(v.start,v.count,v.materialIndex)}return t},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var a=this.attributes;for(var i in a){var o=a[i];e.data.attributes[i]=o.toJSON(e.data)}var s={},c=!1;for(var u in this.morphAttributes){for(var l=this.morphAttributes[u],d=[],h=0,f=l.length;h<f;h++){var p=l[h];d.push(p.toJSON(e.data))}d.length>0&&(s[u]=d,c=!0)}c&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var m=this.groups;m.length>0&&(e.data.groups=JSON.parse(JSON.stringify(m)));var v=this.boundingSphere;return null!==v&&(e.data.boundingSphere={center:v.center.toArray(),radius:v.radius}),e},clone:function(){return(new li).copy(this)},copy:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var a in r){var i=r[a];this.setAttribute(a,i.clone(t))}var o=e.morphAttributes;for(var s in o){for(var c=[],u=o[s],l=0,d=u.length;l<d;l++)c.push(u[l].clone(t));this.morphAttributes[s]=c}this.morphTargetsRelative=e.morphTargetsRelative;for(var h=e.groups,f=0,p=h.length;f<p;f++){var m=h[f];this.addGroup(m.start,m.count,m.materialIndex)}var v=e.boundingBox;null!==v&&(this.boundingBox=v.clone());var g=e.boundingSphere;return null!==g&&(this.boundingSphere=g.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var di=new Vr,hi=new Hr,fi=new Lr,pi=new fr,mi=new fr,vi=new fr,gi=new fr,bi=new fr,yi=new fr,xi=new fr,wi=new fr,Oi=new fr,Ai=new nr,_i=new nr,Ei=new nr,Si=new fr,Ci=new fr;function Ti(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new li,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ga;ma.call(this),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}function Mi(e,t,n,r,a,i,o,s,c,u,l,d){pi.fromBufferAttribute(a,u),mi.fromBufferAttribute(a,l),vi.fromBufferAttribute(a,d);var h=e.morphTargetInfluences;if(t.morphTargets&&i&&h){xi.set(0,0,0),wi.set(0,0,0),Oi.set(0,0,0);for(var f=0,p=i.length;f<p;f++){var m=h[f],v=i[f];0!==m&&(gi.fromBufferAttribute(v,u),bi.fromBufferAttribute(v,l),yi.fromBufferAttribute(v,d),o?(xi.addScaledVector(gi,m),wi.addScaledVector(bi,m),Oi.addScaledVector(yi,m)):(xi.addScaledVector(gi.sub(pi),m),wi.addScaledVector(bi.sub(mi),m),Oi.addScaledVector(yi.sub(vi),m)))}pi.add(xi),mi.add(wi),vi.add(Oi)}e.isSkinnedMesh&&t.skinning&&(e.boneTransform(u,pi),e.boneTransform(l,mi),e.boneTransform(d,vi));var g=function(e,t,n,r,a,i,o,s){if(null===(t.side===k?r.intersectTriangle(o,i,a,!0,s):r.intersectTriangle(a,i,o,t.side!==R,s)))return null;Ci.copy(s),Ci.applyMatrix4(e.matrixWorld);var c=n.ray.origin.distanceTo(Ci);return c<n.near||c>n.far?null:{distance:c,point:Ci.clone(),object:e}}(e,t,n,r,pi,mi,vi,Si);if(g){s&&(Ai.fromBufferAttribute(s,u),_i.fromBufferAttribute(s,l),Ei.fromBufferAttribute(s,d),g.uv=ka.getUV(Si,pi,mi,vi,Ai,_i,Ei,new nr)),c&&(Ai.fromBufferAttribute(c,u),_i.fromBufferAttribute(c,l),Ei.fromBufferAttribute(c,d),g.uv2=ka.getUV(Si,pi,mi,vi,Ai,_i,Ei,new nr));var b={a:u,b:l,c:d,normal:new fr,materialIndex:0};ka.getNormal(pi,mi,vi,b.normal),g.face=b}return g}Ti.prototype=Object.assign(Object.create(ma.prototype),{constructor:Ti,isMesh:!0,copy:function(e){return ma.prototype.copy.call(this,e),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var a=0,i=r.length;a<i;a++){var o=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var n,r=this.geometry,a=this.material,i=this.matrixWorld;if(void 0!==a&&(null===r.boundingSphere&&r.computeBoundingSphere(),fi.copy(r.boundingSphere),fi.applyMatrix4(i),!1!==e.ray.intersectsSphere(fi)&&(di.copy(i).invert(),hi.copy(e.ray).applyMatrix4(di),null===r.boundingBox||!1!==hi.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var o=r.index,s=r.attributes.position,c=r.morphAttributes.position,u=r.morphTargetsRelative,l=r.attributes.uv,d=r.attributes.uv2,h=r.groups,f=r.drawRange;if(null!==o)if(Array.isArray(a))for(var p=0,m=h.length;p<m;p++)for(var v=h[p],g=a[v.materialIndex],b=Math.max(v.start,f.start),y=Math.min(v.start+v.count,f.start+f.count);b<y;b+=3){var x=o.getX(b),w=o.getX(b+1),O=o.getX(b+2);(n=Mi(this,g,e,hi,s,c,u,l,d,x,w,O))&&(n.faceIndex=Math.floor(b/3),n.face.materialIndex=v.materialIndex,t.push(n))}else for(var A=Math.max(0,f.start),_=Math.min(o.count,f.start+f.count);A<_;A+=3){var E=o.getX(A),S=o.getX(A+1),C=o.getX(A+2);(n=Mi(this,a,e,hi,s,c,u,l,d,E,S,C))&&(n.faceIndex=Math.floor(A/3),t.push(n))}else if(void 0!==s)if(Array.isArray(a))for(var T=0,M=h.length;T<M;T++)for(var k=h[T],R=a[k.materialIndex],I=Math.max(k.start,f.start),j=Math.min(k.start+k.count,f.start+f.count);I<j;I+=3){(n=Mi(this,R,e,hi,s,c,u,l,d,I,I+1,I+2))&&(n.faceIndex=Math.floor(I/3),n.face.materialIndex=k.materialIndex,t.push(n))}else for(var B=Math.max(0,f.start),L=Math.min(s.count,f.start+f.count);B<L;B+=3){(n=Mi(this,a,e,hi,s,c,u,l,d,B,B+1,B+2))&&(n.faceIndex=Math.floor(B/3),t.push(n))}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});var ki=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;Object(v.a)(this,n),(e=t.call(this)).type="BoxGeometry",e.parameters={width:r,height:a,depth:i,widthSegments:o,heightSegments:s,depthSegments:c};var u=Object(f.a)(e);o=Math.floor(o),s=Math.floor(s),c=Math.floor(c);var l=[],d=[],h=[],p=[],m=0,g=0;function b(e,t,n,r,a,i,o,s,c,f,v){for(var b=i/c,y=o/f,x=i/2,w=o/2,O=s/2,A=c+1,_=f+1,E=0,S=0,C=new fr,T=0;T<_;T++)for(var M=T*y-w,k=0;k<A;k++){var R=k*b-x;C[e]=R*r,C[t]=M*a,C[n]=O,d.push(C.x,C.y,C.z),C[e]=0,C[t]=0,C[n]=s>0?1:-1,h.push(C.x,C.y,C.z),p.push(k/c),p.push(1-T/f),E+=1}for(var I=0;I<f;I++)for(var j=0;j<c;j++){var B=m+j+A*I,L=m+j+A*(I+1),N=m+(j+1)+A*(I+1),D=m+(j+1)+A*I;l.push(B,L,D),l.push(L,N,D),S+=6}u.addGroup(g,S,v),g+=S,m+=E}return b("z","y","x",-1,-1,i,a,r,c,s,0),b("z","y","x",1,-1,i,a,-r,c,s,1),b("x","z","y",1,1,r,i,a,o,c,2),b("x","z","y",1,-1,r,i,-a,o,c,3),b("x","y","z",1,-1,r,a,i,o,s,4),b("x","y","z",-1,-1,r,a,-i,o,s,5),e.setIndex(l),e.setAttribute("position",new Za(d,3)),e.setAttribute("normal",new Za(h,3)),e.setAttribute("uv",new Za(p,2)),e}return n}(li);function Ri(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var a=e[n][r];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?t[n][r]=a.clone():Array.isArray(a)?t[n][r]=a.slice():t[n][r]=a}return t}function Ii(e){for(var t={},n=0;n<e.length;n++){var r=Ri(e[n]);for(var a in r)t[a]=r[a]}return t}var ji={clone:Ri,merge:Ii};function Bi(e){Ia.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function Li(){ma.call(this),this.type="Camera",this.matrixWorldInverse=new Vr,this.projectionMatrix=new Vr,this.projectionMatrixInverse=new Vr}function Ni(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;Li.call(this),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}Bi.prototype=Object.create(Ia.prototype),Bi.prototype.constructor=Bi,Bi.prototype.isShaderMaterial=!0,Bi.prototype.copy=function(e){return Ia.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=Ri(e.uniforms),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this},Bi.prototype.toJSON=function(e){var t=Ia.prototype.toJSON.call(this,e);for(var n in t.glslVersion=this.glslVersion,t.uniforms={},this.uniforms){var r=this.uniforms[n].value;r&&r.isTexture?t.uniforms[n]={type:"t",value:r.toJSON(e).uuid}:r&&r.isColor?t.uniforms[n]={type:"c",value:r.getHex()}:r&&r.isVector2?t.uniforms[n]={type:"v2",value:r.toArray()}:r&&r.isVector3?t.uniforms[n]={type:"v3",value:r.toArray()}:r&&r.isVector4?t.uniforms[n]={type:"v4",value:r.toArray()}:r&&r.isMatrix3?t.uniforms[n]={type:"m3",value:r.toArray()}:r&&r.isMatrix4?t.uniforms[n]={type:"m4",value:r.toArray()}:t.uniforms[n]={value:r}}Object.keys(this.defines).length>0&&(t.defines=this.defines),t.vertexShader=this.vertexShader,t.fragmentShader=this.fragmentShader;var a={};for(var i in this.extensions)!0===this.extensions[i]&&(a[i]=!0);return Object.keys(a).length>0&&(t.extensions=a),t},Li.prototype=Object.assign(Object.create(ma.prototype),{constructor:Li,isCamera:!0,copy:function(e,t){return ma.prototype.copy.call(this,e,t),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new fr),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){ma.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(e,t){ma.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),Ni.prototype=Object.assign(Object.create(Li.prototype),{constructor:Ni,isPerspectiveCamera:!0,copy:function(e,t){return Li.prototype.copy.call(this,e,t),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*tr.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*tr.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*tr.RAD2DEG*Math.atan(Math.tan(.5*tr.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,a,i){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=i,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*tr.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,a=-.5*r,i=this.view;if(null!==this.view&&this.view.enabled){var o=i.fullWidth,s=i.fullHeight;a+=i.offsetX*r/o,t-=i.offsetY*n/s,r*=i.width/o,n*=i.height/s}var c=this.filmOffset;0!==c&&(a+=e*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(e){var t=ma.prototype.toJSON.call(this,e);return t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,null!==this.view&&(t.object.view=Object.assign({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}});var Di=90,Pi=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a){var i;if(Object(v.a)(this,n),(i=t.call(this)).type="CubeCamera",!0!==a.isWebGLCubeRenderTarget)return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),Object(l.a)(i);i.renderTarget=a;var o=new Ni(Di,1,e,r);o.layers=i.layers,o.up.set(0,-1,0),o.lookAt(new fr(1,0,0)),i.add(o);var s=new Ni(Di,1,e,r);s.layers=i.layers,s.up.set(0,-1,0),s.lookAt(new fr(-1,0,0)),i.add(s);var c=new Ni(Di,1,e,r);c.layers=i.layers,c.up.set(0,0,1),c.lookAt(new fr(0,1,0)),i.add(c);var u=new Ni(Di,1,e,r);u.layers=i.layers,u.up.set(0,0,-1),u.lookAt(new fr(0,-1,0)),i.add(u);var d=new Ni(Di,1,e,r);d.layers=i.layers,d.up.set(0,-1,0),d.lookAt(new fr(0,0,1)),i.add(d);var h=new Ni(Di,1,e,r);return h.layers=i.layers,h.up.set(0,-1,0),h.lookAt(new fr(0,0,-1)),i.add(h),i}return Object(g.a)(n,[{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=Object(u.a)(this.children,6),a=r[0],i=r[1],o=r[2],s=r[3],c=r[4],l=r[5],d=e.xr.enabled,h=e.getRenderTarget();e.xr.enabled=!1;var f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,a),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,s),e.setRenderTarget(n,4),e.render(t,c),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,l),e.setRenderTarget(h),e.xr.enabled=d}}]),n}(ma),Fi=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a,i,o,s,c,u,l,d){var h;return Object(v.a)(this,n),e=void 0!==e?e:[],r=void 0!==r?r:xe,c=void 0!==c?c:Ze,(h=t.call(this,e,r,a,i,o,s,c,u,l,d))._needsFlipEnvMap=!0,h.flipY=!1,h}return Object(g.a)(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(sr);Fi.prototype.isCubeTexture=!0;var Gi=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a){var i;return Object(v.a)(this,n),Number.isInteger(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=a),i=t.call(this,e,e,r),r=r||{},i.texture=new Fi(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),i.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,i.texture.minFilter=void 0!==r.minFilter?r.minFilter:Be,i.texture._needsFlipEnvMap=!1,i}return Object(g.a)(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.format=$e,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",a="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",i=new ki(5,5,5),o=new Bi({name:"CubemapFromEquirect",uniforms:Ri(n),vertexShader:r,fragmentShader:a,side:k,blending:B});o.uniforms.tEquirect.value=t;var s=new Ti(i,o),c=t.minFilter;return t.minFilter===De&&(t.minFilter=Be),new Pi(1,10,this).update(e,s),t.minFilter=c,s.geometry.dispose(),s.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var a=e.getRenderTarget(),i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(a)}}]),n}(lr);Gi.prototype.isWebGLCubeRenderTarget=!0;var Ui=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a,i,o,s,c,u,l,d,h,f){var p;return Object(v.a)(this,n),(p=t.call(this,null,s,c,u,l,d,i,o,h,f)).image={data:e||null,width:r||1,height:a||1},p.magFilter=void 0!==l?l:Me,p.minFilter=void 0!==d?d:Me,p.generateMipmaps=!1,p.flipY=!1,p.unpackAlignment=1,p.needsUpdate=!0,p}return n}(sr);Ui.prototype.isDataTexture=!0;var zi=new Lr,Hi=new fr,Vi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ya,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ya,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ya,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new ya,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new ya,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new ya;Object(v.a)(this,e),this.planes=[t,n,r,a,i,o]}return Object(g.a)(e,[{key:"set",value:function(e,t,n,r,a,i){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(a),o[5].copy(i),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=this.planes,n=e.elements,r=n[0],a=n[1],i=n[2],o=n[3],s=n[4],c=n[5],u=n[6],l=n[7],d=n[8],h=n[9],f=n[10],p=n[11],m=n[12],v=n[13],g=n[14],b=n[15];return t[0].setComponents(o-r,l-s,p-d,b-m).normalize(),t[1].setComponents(o+r,l+s,p+d,b+m).normalize(),t[2].setComponents(o+a,l+c,p+h,b+v).normalize(),t[3].setComponents(o-a,l-c,p-h,b-v).normalize(),t[4].setComponents(o-i,l-u,p-f,b-g).normalize(),t[5].setComponents(o+i,l+u,p+f,b+g).normalize(),this}},{key:"intersectsObject",value:function(e){var t=e.geometry;return null===t.boundingSphere&&t.computeBoundingSphere(),zi.copy(t.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(zi)}},{key:"intersectsSprite",value:function(e){return zi.center.set(0,0,0),zi.radius=.7071067811865476,zi.applyMatrix4(e.matrixWorld),this.intersectsSphere(zi)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,a=0;a<6;a++){if(t[a].distanceToPoint(n)<r)return!1}return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Hi.x=r.normal.x>0?e.max.x:e.min.x,Hi.y=r.normal.y>0?e.max.y:e.min.y,Hi.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Hi)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function Wi(){var e=null,t=!1,n=null,r=null;function a(t,i){n(t,i),r=e.requestAnimationFrame(a)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(a),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Ji(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,a){if(t.isGLBufferAttribute){var i=r.get(t);(!i||i.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,r){var a=t.array,i=t.usage,o=e.createBuffer();e.bindBuffer(r,o),e.bufferData(r,a,i),t.onUploadCallback();var s=5126;return a instanceof Float32Array?s=5126:a instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):a instanceof Uint16Array?t.isFloat16BufferAttribute?n?s=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):s=5123:a instanceof Int16Array?s=5122:a instanceof Uint32Array?s=5125:a instanceof Int32Array?s=5124:a instanceof Int8Array?s=5120:a instanceof Uint8Array&&(s=5121),{buffer:o,type:s,bytesPerElement:a.BYTES_PER_ELEMENT,version:t.version}}(t,a)):o.version<t.version&&(!function(t,r,a){var i=r.array,o=r.updateRange;e.bindBuffer(a,t),-1===o.count?e.bufferSubData(a,0,i):(n?e.bufferSubData(a,o.offset*i.BYTES_PER_ELEMENT,i,o.offset,o.count):e.bufferSubData(a,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}(o.buffer,t,a),o.version=t.version)}}}}var Xi=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(v.a)(this,n),(e=t.call(this)).type="PlaneGeometry",e.parameters={width:r,height:a,widthSegments:i,heightSegments:o};for(var s=r/2,c=a/2,u=Math.floor(i),l=Math.floor(o),d=u+1,h=l+1,f=r/u,p=a/l,m=[],g=[],b=[],y=[],x=0;x<h;x++)for(var w=x*p-c,O=0;O<d;O++){var A=O*f-s;g.push(A,-w,0),b.push(0,0,1),y.push(O/u),y.push(1-x/l)}for(var _=0;_<l;_++)for(var E=0;E<u;E++){var S=E+d*_,C=E+d*(_+1),T=E+1+d*(_+1),M=E+1+d*_;m.push(S,C,M),m.push(C,T,M)}return e.setIndex(m),e.setAttribute("position",new Za(g,3)),e.setAttribute("normal",new Za(b,3)),e.setAttribute("uv",new Za(y,2)),e}return n}(li),Ki={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},qi={common:{diffuse:{value:new Fa(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new ar},uv2Transform:{value:new ar},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new nr(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Fa(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Fa(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new ar}},sprite:{diffuse:{value:new Fa(15658734)},opacity:{value:1},center:{value:new nr(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new ar}}},Yi={basic:{uniforms:Ii([qi.common,qi.specularmap,qi.envmap,qi.aomap,qi.lightmap,qi.fog]),vertexShader:Ki.meshbasic_vert,fragmentShader:Ki.meshbasic_frag},lambert:{uniforms:Ii([qi.common,qi.specularmap,qi.envmap,qi.aomap,qi.lightmap,qi.emissivemap,qi.fog,qi.lights,{emissive:{value:new Fa(0)}}]),vertexShader:Ki.meshlambert_vert,fragmentShader:Ki.meshlambert_frag},phong:{uniforms:Ii([qi.common,qi.specularmap,qi.envmap,qi.aomap,qi.lightmap,qi.emissivemap,qi.bumpmap,qi.normalmap,qi.displacementmap,qi.fog,qi.lights,{emissive:{value:new Fa(0)},specular:{value:new Fa(1118481)},shininess:{value:30}}]),vertexShader:Ki.meshphong_vert,fragmentShader:Ki.meshphong_frag},standard:{uniforms:Ii([qi.common,qi.envmap,qi.aomap,qi.lightmap,qi.emissivemap,qi.bumpmap,qi.normalmap,qi.displacementmap,qi.roughnessmap,qi.metalnessmap,qi.fog,qi.lights,{emissive:{value:new Fa(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ki.meshphysical_vert,fragmentShader:Ki.meshphysical_frag},toon:{uniforms:Ii([qi.common,qi.aomap,qi.lightmap,qi.emissivemap,qi.bumpmap,qi.normalmap,qi.displacementmap,qi.gradientmap,qi.fog,qi.lights,{emissive:{value:new Fa(0)}}]),vertexShader:Ki.meshtoon_vert,fragmentShader:Ki.meshtoon_frag},matcap:{uniforms:Ii([qi.common,qi.bumpmap,qi.normalmap,qi.displacementmap,qi.fog,{matcap:{value:null}}]),vertexShader:Ki.meshmatcap_vert,fragmentShader:Ki.meshmatcap_frag},points:{uniforms:Ii([qi.points,qi.fog]),vertexShader:Ki.points_vert,fragmentShader:Ki.points_frag},dashed:{uniforms:Ii([qi.common,qi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ki.linedashed_vert,fragmentShader:Ki.linedashed_frag},depth:{uniforms:Ii([qi.common,qi.displacementmap]),vertexShader:Ki.depth_vert,fragmentShader:Ki.depth_frag},normal:{uniforms:Ii([qi.common,qi.bumpmap,qi.normalmap,qi.displacementmap,{opacity:{value:1}}]),vertexShader:Ki.normal_vert,fragmentShader:Ki.normal_frag},sprite:{uniforms:Ii([qi.sprite,qi.fog]),vertexShader:Ki.sprite_vert,fragmentShader:Ki.sprite_frag},background:{uniforms:{uvTransform:{value:new ar},t2D:{value:null}},vertexShader:Ki.background_vert,fragmentShader:Ki.background_frag},cube:{uniforms:Ii([qi.envmap,{opacity:{value:1}}]),vertexShader:Ki.cube_vert,fragmentShader:Ki.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ki.equirect_vert,fragmentShader:Ki.equirect_frag},distanceRGBA:{uniforms:Ii([qi.common,qi.displacementmap,{referencePosition:{value:new fr},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ki.distanceRGBA_vert,fragmentShader:Ki.distanceRGBA_frag},shadow:{uniforms:Ii([qi.lights,qi.fog,{color:{value:new Fa(0)},opacity:{value:1}}]),vertexShader:Ki.shadow_vert,fragmentShader:Ki.shadow_frag}};function Qi(e,t,n,r,a){var i,o,s=new Fa(0),c=0,u=null,l=0,d=null;function h(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,a)}return{getClearColor:function(){return s},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;s.set(e),h(s,c=t)},getClearAlpha:function(){return c},setClearAlpha:function(e){h(s,c=e)},render:function(n,a,f,p){var m=!0===a.isScene?a.background:null;m&&m.isTexture&&(m=t.get(m));var v=e.xr,g=v.getSession&&v.getSession();g&&"additive"===g.environmentBlendMode&&(m=null),null===m?h(s,c):m&&m.isColor&&(h(m,1),p=!0),(e.autoClear||p)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),m&&(m.isCubeTexture||m.mapping===_e)?(void 0===o&&((o=new Ti(new ki(1,1,1),new Bi({name:"BackgroundCubeMaterial",uniforms:Ri(Yi.cube.uniforms),vertexShader:Yi.cube.vertexShader,fragmentShader:Yi.cube.fragmentShader,side:k,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),o.geometry.deleteAttribute("uv"),o.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(o.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(o)),o.material.uniforms.envMap.value=m,o.material.uniforms.flipEnvMap.value=m.isCubeTexture&&m._needsFlipEnvMap?-1:1,u===m&&l===m.version&&d===e.toneMapping||(o.material.needsUpdate=!0,u=m,l=m.version,d=e.toneMapping),n.unshift(o,o.geometry,o.material,0,0,null)):m&&m.isTexture&&(void 0===i&&((i=new Ti(new Xi(2,2),new Bi({name:"BackgroundMaterial",uniforms:Ri(Yi.background.uniforms),vertexShader:Yi.background.vertexShader,fragmentShader:Yi.background.fragmentShader,side:M,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(i.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(i)),i.material.uniforms.t2D.value=m,!0===m.matrixAutoUpdate&&m.updateMatrix(),i.material.uniforms.uvTransform.value.copy(m.matrix),u===m&&l===m.version&&d===e.toneMapping||(i.material.needsUpdate=!0,u=m,l=m.version,d=e.toneMapping),n.unshift(i,i.geometry,i.material,0,0,null))}}}function Zi(e,t,n,r){var a=e.getParameter(34921),i=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==i,s={},c=h(null),u=c;function l(t){return r.isWebGL2?e.bindVertexArray(t):i.bindVertexArrayOES(t)}function d(t){return r.isWebGL2?e.deleteVertexArray(t):i.deleteVertexArrayOES(t)}function h(e){for(var t=[],n=[],r=[],i=0;i<a;i++)t[i]=0,n[i]=0,r[i]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function f(){for(var e=u.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function p(e){m(e,0)}function m(n,a){var i=u.newAttributes,o=u.enabledAttributes,s=u.attributeDivisors;(i[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==a)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,a),s[n]=a)}function v(){for(var t=u.newAttributes,n=u.enabledAttributes,r=0,a=n.length;r<a;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function g(t,n,a,i,o,s){!0!==r.isWebGL2||5124!==a&&5125!==a?e.vertexAttribPointer(t,n,a,i,o,s):e.vertexAttribIPointer(t,n,a,o,s)}function b(){y(),u!==c&&l((u=c).object)}function y(){c.geometry=null,c.program=null,c.wireframe=!1}return{setup:function(a,c,d,b,y){var x=!1;if(o){var w=function(t,n,a){var o=!0===a.wireframe,c=s[t.id];void 0===c&&(c={},s[t.id]=c);var u=c[n.id];void 0===u&&(u={},c[n.id]=u);var l=u[o];void 0===l&&(l=h(r.isWebGL2?e.createVertexArray():i.createVertexArrayOES()),u[o]=l);return l}(b,d,c);u!==w&&l((u=w).object),(x=function(e,t){var n=u.attributes,r=e.attributes,a=0;for(var i in r){var o=n[i],s=r[i];if(void 0===o)return!0;if(o.attribute!==s)return!0;if(o.data!==s.data)return!0;a++}return u.attributesNum!==a||u.index!==t}(b,y))&&function(e,t){var n={},r=e.attributes,a=0;for(var i in r){var o=r[i],s={};s.attribute=o,o.data&&(s.data=o.data),n[i]=s,a++}u.attributes=n,u.attributesNum=a,u.index=t}(b,y)}else{var O=!0===c.wireframe;u.geometry===b.id&&u.program===d.id&&u.wireframe===O||(u.geometry=b.id,u.program=d.id,u.wireframe=O,x=!0)}!0===a.isInstancedMesh&&(x=!0),null!==y&&n.update(y,34963),x&&(!function(a,i,o,s){if(!1===r.isWebGL2&&(a.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;f();var c=s.attributes,u=o.getAttributes(),l=i.defaultAttributeValues;for(var d in u){var h=u[d];if(h>=0){var b=c[d];if(void 0!==b){var y=b.normalized,x=b.itemSize,w=n.get(b);if(void 0===w)continue;var O=w.buffer,A=w.type,_=w.bytesPerElement;if(b.isInterleavedBufferAttribute){var E=b.data,S=E.stride,C=b.offset;E&&E.isInstancedInterleavedBuffer?(m(h,E.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=E.meshPerAttribute*E.count)):p(h),e.bindBuffer(34962,O),g(h,x,A,y,S*_,C*_)}else b.isInstancedBufferAttribute?(m(h,b.meshPerAttribute),void 0===s._maxInstanceCount&&(s._maxInstanceCount=b.meshPerAttribute*b.count)):p(h),e.bindBuffer(34962,O),g(h,x,A,y,0,0)}else if("instanceMatrix"===d){var T=n.get(a.instanceMatrix);if(void 0===T)continue;var M=T.buffer,k=T.type;m(h+0,1),m(h+1,1),m(h+2,1),m(h+3,1),e.bindBuffer(34962,M),e.vertexAttribPointer(h+0,4,k,!1,64,0),e.vertexAttribPointer(h+1,4,k,!1,64,16),e.vertexAttribPointer(h+2,4,k,!1,64,32),e.vertexAttribPointer(h+3,4,k,!1,64,48)}else if("instanceColor"===d){var R=n.get(a.instanceColor);if(void 0===R)continue;var I=R.buffer,j=R.type;m(h,1),e.bindBuffer(34962,I),e.vertexAttribPointer(h,3,j,!1,12,0)}else if(void 0!==l){var B=l[d];if(void 0!==B)switch(B.length){case 2:e.vertexAttrib2fv(h,B);break;case 3:e.vertexAttrib3fv(h,B);break;case 4:e.vertexAttrib4fv(h,B);break;default:e.vertexAttrib1fv(h,B)}}}}v()}(a,c,d,b),null!==y&&e.bindBuffer(34963,n.get(y).buffer))},reset:b,resetDefaultState:y,dispose:function(){for(var e in b(),s){var t=s[e];for(var n in t){var r=t[n];for(var a in r)d(r[a].object),delete r[a];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var a in r)d(r[a].object),delete r[a];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var a in r)d(r[a].object),delete r[a];delete n[e.id]}}},initAttributes:f,enableAttribute:p,disableUnusedAttributes:v}}function $i(e,t,n,r){var a,i=r.isWebGL2;this.setMode=function(e){a=e},this.render=function(t,r){e.drawArrays(a,t,r),n.update(r,a,1)},this.renderInstances=function(r,o,s){if(0!==s){var c,u;if(i)c=e,u="drawArraysInstanced";else if(u="drawArraysInstancedANGLE",null===(c=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");c[u](a,r,o,s),n.update(o,a,s)}}}function eo(e,t,n){var r;function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var i="undefined"!==typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!==typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,o=void 0!==n.precision?n.precision:"highp",s=a(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var c=!0===n.logarithmicDepthBuffer,u=e.getParameter(34930),l=e.getParameter(35660),d=e.getParameter(3379),h=e.getParameter(34076),f=e.getParameter(34921),p=e.getParameter(36347),m=e.getParameter(36348),v=e.getParameter(36349),g=l>0,b=i||t.has("OES_texture_float");return{isWebGL2:i,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:a,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:l,maxTextureSize:d,maxCubemapSize:h,maxAttributes:f,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:v,vertexTextures:g,floatFragmentTextures:b,floatVertexTextures:g&&b,maxSamples:i?e.getParameter(36183):0}}function to(e){var t=this,n=null,r=0,a=!1,i=!1,o=new ya,s=new ar,c={value:null,needsUpdate:!1};function u(){c.value!==n&&(c.value=n,c.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function l(e,n,r,a){var i=null!==e?e.length:0,u=null;if(0!==i){if(u=c.value,!0!==a||null===u){var l=r+4*i,d=n.matrixWorldInverse;s.getNormalMatrix(d),(null===u||u.length<l)&&(u=new Float32Array(l));for(var h=0,f=r;h!==i;++h,f+=4)o.copy(e[h]).applyMatrix4(d,s),o.normal.toArray(u,f),u[f+3]=o.constant}c.value=u,c.needsUpdate=!0}return t.numPlanes=i,t.numIntersection=0,u}this.uniform=c,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,i){var o=0!==e.length||t||0!==r||a;return a=t,n=l(e,i,0),r=e.length,o},this.beginShadows=function(){i=!0,l(null)},this.endShadows=function(){i=!1,u()},this.setState=function(t,o,s){var d=t.clippingPlanes,h=t.clipIntersection,f=t.clipShadows,p=e.get(t);if(!a||null===d||0===d.length||i&&!f)i?l(null):u();else{var m=i?0:r,v=4*m,g=p.clippingState||null;c.value=g,g=l(d,o,v,s);for(var b=0;b!==v;++b)g[b]=n[b];p.clippingState=g,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=m}}}function no(e){var t=new WeakMap;function n(e,t){return t===Oe?e.mapping=xe:t===Ae&&(e.mapping=we),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var a=t.get(n);void 0!==a&&(t.delete(n),a.dispose())}return{get:function(a){if(a&&a.isTexture){var i=a.mapping;if(i===Oe||i===Ae){if(t.has(a))return n(t.get(a).texture,a.mapping);var o=a.image;if(o&&o.height>0){var s=e.getRenderTarget(),c=new Gi(o.height/2);return c.fromEquirectangularTexture(e,a),t.set(a,c),e.setRenderTarget(s),a.addEventListener("dispose",r),n(c.texture,a.mapping)}return null}}return a},dispose:function(){t=new WeakMap}}}function ro(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function ao(e,t,n,r){var a={},i=new WeakMap;function o(e){var s=e.target;for(var c in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[c]);s.removeEventListener("dispose",o),delete a[s.id];var u=i.get(s);u&&(t.remove(u),i.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,a=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var c=0,u=s.length;c<u;c+=3){var l=s[c+0],d=s[c+1],h=s[c+2];n.push(l,d,d,h,h,l)}}else{var f=a.array;o=a.version;for(var p=0,m=f.length/3-1;p<m;p+=3){var v=p+0,g=p+1,b=p+2;n.push(v,g,g,b,b,v)}}var y=new(ei(n)>65535?Ya:Ka)(n,1);y.version=o;var x=i.get(e);x&&t.remove(x),i.set(e,y)}return{get:function(e,t){return!0===a[t.id]||(t.addEventListener("dispose",o),a[t.id]=!0,n.memory.geometries++),t},update:function(e){var n=e.attributes;for(var r in n)t.update(n[r],34962);var a=e.morphAttributes;for(var i in a)for(var o=a[i],s=0,c=o.length;s<c;s++)t.update(o[s],34962)},getWireframeAttribute:function(e){var t=i.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return i.get(e)}}}function io(e,t,n,r){var a,i,o,s=r.isWebGL2;this.setMode=function(e){a=e},this.setIndex=function(e){i=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(a,r,i,t*o),n.update(r,a,1)},this.renderInstances=function(r,c,u){if(0!==u){var l,d;if(s)l=e,d="drawElementsInstanced";else if(d="drawElementsInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[d](a,c,i,r*o,u),n.update(c,a,u)}}}function oo(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function so(e,t){return e[0]-t[0]}function co(e,t){return Math.abs(t[1])-Math.abs(e[1])}function uo(e){for(var t={},n=new Float32Array(8),r=[],a=0;a<8;a++)r[a]=[a,0];return{update:function(a,i,o,s){var c=a.morphTargetInfluences,u=void 0===c?0:c.length,l=t[i.id];if(void 0===l){l=[];for(var d=0;d<u;d++)l[d]=[d,0];t[i.id]=l}for(var h=0;h<u;h++){var f=l[h];f[0]=h,f[1]=c[h]}l.sort(co);for(var p=0;p<8;p++)p<u&&l[p][1]?(r[p][0]=l[p][0],r[p][1]=l[p][1]):(r[p][0]=Number.MAX_SAFE_INTEGER,r[p][1]=0);r.sort(so);for(var m=o.morphTargets&&i.morphAttributes.position,v=o.morphNormals&&i.morphAttributes.normal,g=0,b=0;b<8;b++){var y=r[b],x=y[0],w=y[1];x!==Number.MAX_SAFE_INTEGER&&w?(m&&i.getAttribute("morphTarget"+b)!==m[x]&&i.setAttribute("morphTarget"+b,m[x]),v&&i.getAttribute("morphNormal"+b)!==v[x]&&i.setAttribute("morphNormal"+b,v[x]),n[b]=w,g+=w):(m&&!0===i.hasAttribute("morphTarget"+b)&&i.deleteAttribute("morphTarget"+b),v&&!0===i.hasAttribute("morphNormal"+b)&&i.deleteAttribute("morphNormal"+b),n[b]=0)}var O=i.morphTargetsRelative?1:1-g;s.getUniforms().setValue(e,"morphTargetBaseInfluence",O),s.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function lo(e,t,n,r){var a=new WeakMap;function i(e){var t=e.target;t.removeEventListener("dispose",i),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(e){var o=r.render.frame,s=e.geometry,c=t.get(e,s);return a.get(c)!==o&&(t.update(c),a.set(c,o)),e.isInstancedMesh&&(!1===e.hasEventListener("dispose",i)&&e.addEventListener("dispose",i),n.update(e.instanceMatrix,34962),null!==e.instanceColor&&n.update(e.instanceColor,34962)),c},dispose:function(){a=new WeakMap}}}Yi.physical={uniforms:Ii([Yi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new nr(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Fa(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:Ki.meshphysical_vert,fragmentShader:Ki.meshphysical_frag};var ho=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(v.a)(this,n),(e=t.call(this,null)).image={data:r,width:a,height:i,depth:o},e.magFilter=Me,e.minFilter=Me,e.wrapR=Ce,e.generateMipmaps=!1,e.flipY=!1,e.needsUpdate=!0,e}return n}(sr);ho.prototype.isDataTexture2DArray=!0;var fo=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(v.a)(this,n),(e=t.call(this,null)).image={data:r,width:a,height:i,depth:o},e.magFilter=Me,e.minFilter=Me,e.wrapR=Ce,e.generateMipmaps=!1,e.flipY=!1,e.needsUpdate=!0,e}return n}(sr);fo.prototype.isDataTexture3D=!0;var po=new sr,mo=new ho,vo=new fo,go=new Fi,bo=[],yo=[],xo=new Float32Array(16),wo=new Float32Array(9),Oo=new Float32Array(4);function Ao(e,t,n){var r=e[0];if(r<=0||r>0)return e;var a=t*n,i=bo[a];if(void 0===i&&(i=new Float32Array(a),bo[a]=i),0!==t){r.toArray(i,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(i,s)}return i}function _o(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Eo(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function So(e,t){var n=yo[t];void 0===n&&(n=new Int32Array(t),yo[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Co(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function To(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(_o(n,t))return;e.uniform2fv(this.addr,t),Eo(n,t)}}function Mo(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(_o(n,t))return;e.uniform3fv(this.addr,t),Eo(n,t)}}function ko(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(_o(n,t))return;e.uniform4fv(this.addr,t),Eo(n,t)}}function Ro(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(_o(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Eo(n,t)}else{if(_o(n,r))return;Oo.set(r),e.uniformMatrix2fv(this.addr,!1,Oo),Eo(n,r)}}function Io(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(_o(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Eo(n,t)}else{if(_o(n,r))return;wo.set(r),e.uniformMatrix3fv(this.addr,!1,wo),Eo(n,r)}}function jo(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(_o(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Eo(n,t)}else{if(_o(n,r))return;xo.set(r),e.uniformMatrix4fv(this.addr,!1,xo),Eo(n,r)}}function Bo(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Lo(e,t){var n=this.cache;_o(n,t)||(e.uniform2iv(this.addr,t),Eo(n,t))}function No(e,t){var n=this.cache;_o(n,t)||(e.uniform3iv(this.addr,t),Eo(n,t))}function Do(e,t){var n=this.cache;_o(n,t)||(e.uniform4iv(this.addr,t),Eo(n,t))}function Po(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Fo(e,t){var n=this.cache;_o(n,t)||(e.uniform2uiv(this.addr,t),Eo(n,t))}function Go(e,t){var n=this.cache;_o(n,t)||(e.uniform3uiv(this.addr,t),Eo(n,t))}function Uo(e,t){var n=this.cache;_o(n,t)||(e.uniform4uiv(this.addr,t),Eo(n,t))}function zo(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.safeSetTexture2D(t||po,a)}function Ho(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTexture3D(t||vo,a)}function Vo(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.safeSetTextureCube(t||go,a)}function Wo(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTexture2DArray(t||mo,a)}function Jo(e,t){e.uniform1fv(this.addr,t)}function Xo(e,t){var n=Ao(t,this.size,2);e.uniform2fv(this.addr,n)}function Ko(e,t){var n=Ao(t,this.size,3);e.uniform3fv(this.addr,n)}function qo(e,t){var n=Ao(t,this.size,4);e.uniform4fv(this.addr,n)}function Yo(e,t){var n=Ao(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Qo(e,t){var n=Ao(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Zo(e,t){var n=Ao(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function $o(e,t){e.uniform1iv(this.addr,t)}function es(e,t){e.uniform2iv(this.addr,t)}function ts(e,t){e.uniform3iv(this.addr,t)}function ns(e,t){e.uniform4iv(this.addr,t)}function rs(e,t){e.uniform1uiv(this.addr,t)}function as(e,t){e.uniform2uiv(this.addr,t)}function is(e,t){e.uniform3uiv(this.addr,t)}function os(e,t){e.uniform4uiv(this.addr,t)}function ss(e,t,n){var r=t.length,a=So(n,r);e.uniform1iv(this.addr,a);for(var i=0;i!==r;++i)n.safeSetTexture2D(t[i]||po,a[i])}function cs(e,t,n){var r=t.length,a=So(n,r);e.uniform1iv(this.addr,a);for(var i=0;i!==r;++i)n.safeSetTextureCube(t[i]||go,a[i])}function us(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Co;case 35664:return To;case 35665:return Mo;case 35666:return ko;case 35674:return Ro;case 35675:return Io;case 35676:return jo;case 5124:case 35670:return Bo;case 35667:case 35671:return Lo;case 35668:case 35672:return No;case 35669:case 35673:return Do;case 5125:return Po;case 36294:return Fo;case 36295:return Go;case 36296:return Uo;case 35678:case 36198:case 36298:case 36306:case 35682:return zo;case 35679:case 36299:case 36307:return Ho;case 35680:case 36300:case 36308:case 36293:return Vo;case 36289:case 36303:case 36311:case 36292:return Wo}}(t.type)}function ls(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return Jo;case 35664:return Xo;case 35665:return Ko;case 35666:return qo;case 35674:return Yo;case 35675:return Qo;case 35676:return Zo;case 5124:case 35670:return $o;case 35667:case 35671:return es;case 35668:case 35672:return ts;case 35669:case 35673:return ns;case 5125:return rs;case 36294:return as;case 36295:return is;case 36296:return os;case 35678:case 36198:case 36298:case 36306:case 35682:return ss;case 35680:case 36300:case 36308:case 36293:return cs}}(t.type)}function ds(e){this.id=e,this.seq=[],this.map={}}ls.prototype.updateCache=function(e){var t=this.cache;e instanceof Float32Array&&t.length!==e.length&&(this.cache=new Float32Array(e.length)),Eo(t,e)},ds.prototype.setValue=function(e,t,n){for(var r=this.seq,a=0,i=r.length;a!==i;++a){var o=r[a];o.setValue(e,t[o.id],n)}};var hs=/(\w+)(\])?(\[|\.)?/g;function fs(e,t){e.seq.push(t),e.map[t.id]=t}function ps(e,t,n){var r=e.name,a=r.length;for(hs.lastIndex=0;;){var i=hs.exec(r),o=hs.lastIndex,s=i[1],c="]"===i[2],u=i[3];if(c&&(s|=0),void 0===u||"["===u&&o+2===a){fs(n,void 0===u?new us(s,e,t):new ls(s,e,t));break}var l=n.map[s];void 0===l&&fs(n,l=new ds(s)),n=l}}function ms(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var a=e.getActiveUniform(t,r);ps(a,e.getUniformLocation(t,a.name),this)}}function vs(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}ms.prototype.setValue=function(e,t,n,r){var a=this.map[t];void 0!==a&&a.setValue(e,n,r)},ms.prototype.setOptional=function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)},ms.upload=function(e,t,n,r){for(var a=0,i=t.length;a!==i;++a){var o=t[a],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}},ms.seqWithValue=function(e,t){for(var n=[],r=0,a=e.length;r!==a;++r){var i=e[r];i.id in t&&n.push(i)}return n};var gs=0;function bs(e){switch(e){case hn:return["Linear","( value )"];case fn:return["sRGB","( value )"];case mn:return["RGBE","( value )"];case gn:return["RGBM","( value, 7.0 )"];case bn:return["RGBM","( value, 16.0 )"];case yn:return["RGBD","( value, 256.0 )"];case pn:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case vn:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function ys(e,t,n){var r=e.getShaderParameter(t,35713),a=e.getShaderInfoLog(t).trim();return r&&""===a?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+a+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function xs(e,t){var n=bs(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function ws(e,t){var n=bs(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Os(e,t){var n;switch(t){case pe:n="Linear";break;case me:n="Reinhard";break;case ve:n="OptimizedCineon";break;case ge:n="ACESFilmic";break;case be:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function As(e){return""!==e}function _s(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Es(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Ss=/^[ \t]*#include +<([\w\d./]+)>/gm;function Cs(e){return e.replace(Ss,Ts)}function Ts(e,t){var n=Ki[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return Cs(n)}var Ms=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,ks=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Rs(e){return e.replace(ks,js).replace(Ms,Is)}function Is(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),js(e,t,n,r)}function js(e,t,n,r){for(var a="",i=parseInt(t);i<parseInt(n);i++)a+=r.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return a}function Bs(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Ls(e,t,n,r){var a,i,o=e.getContext(),s=n.defines,c=n.vertexShader,u=n.fragmentShader,l=function(e){var t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===S?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===C?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===T&&(t="SHADOWMAP_TYPE_VSM"),t}(n),d=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case xe:case we:t="ENVMAP_TYPE_CUBE";break;case _e:case Ee:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),h=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case we:case Ee:t="ENVMAP_MODE_REFRACTION"}return t}(n),f=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case le:t="ENVMAP_BLENDING_MULTIPLY";break;case de:t="ENVMAP_BLENDING_MIX";break;case he:t="ENVMAP_BLENDING_ADD"}return t}(n),p=e.gammaFactor>0?e.gammaFactor:1,m=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(As).join("\n")}(n),v=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),g=o.createProgram(),b=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((a=[v].filter(As).join("\n")).length>0&&(a+="\n"),(i=[m,v].filter(As).join("\n")).length>0&&(i+="\n")):(a=[Bs(n),"#define SHADER_NAME "+n.shaderName,v,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+p,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(As).join("\n"),i=[m,Bs(n),"#define SHADER_NAME "+n.shaderName,v,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+p,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.envMap?"#define "+h:"",n.envMap?"#define "+f:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+l:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==fe?"#define TONE_MAPPING":"",n.toneMapping!==fe?Ki.tonemapping_pars_fragment:"",n.toneMapping!==fe?Os("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",Ki.encodings_pars_fragment,n.map?xs("mapTexelToLinear",n.mapEncoding):"",n.matcap?xs("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?xs("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?xs("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?xs("lightMapTexelToLinear",n.lightMapEncoding):"",ws("linearToOutputTexel",n.outputEncoding),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(As).join("\n")),c=Es(c=_s(c=Cs(c),n),n),u=Es(u=_s(u=Cs(u),n),n),c=Rs(c),u=Rs(u),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(b="#version 300 es\n",a=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+a,i=["#define varying in",n.glslVersion===Yn?"":"out highp vec4 pc_fragColor;",n.glslVersion===Yn?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i);var y,x,w=b+i+u,O=vs(o,35633,b+a+c),A=vs(o,35632,w);if(o.attachShader(g,O),o.attachShader(g,A),void 0!==n.index0AttributeName?o.bindAttribLocation(g,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(g,0,"position"),o.linkProgram(g),e.debug.checkShaderErrors){var _=o.getProgramInfoLog(g).trim(),E=o.getShaderInfoLog(O).trim(),M=o.getShaderInfoLog(A).trim(),k=!0,R=!0;if(!1===o.getProgramParameter(g,35714)){k=!1;var I=ys(o,O,"vertex"),j=ys(o,A,"fragment");console.error("THREE.WebGLProgram: shader error: ",o.getError(),"35715",o.getProgramParameter(g,35715),"gl.getProgramInfoLog",_,I,j)}else""!==_?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",_):""!==E&&""!==M||(R=!1);R&&(this.diagnostics={runnable:k,programLog:_,vertexShader:{log:E,prefix:a},fragmentShader:{log:M,prefix:i}})}return o.deleteShader(O),o.deleteShader(A),this.getUniforms=function(){return void 0===y&&(y=new ms(o,g)),y},this.getAttributes=function(){return void 0===x&&(x=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),a=0;a<r;a++){var i=e.getActiveAttrib(t,a).name;n[i]=e.getAttribLocation(t,i)}return n}(o,g)),x},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(g),this.program=void 0},this.name=n.shaderName,this.id=gs++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=O,this.fragmentShader=A,this}function Ns(e,t,n,r,a,i){var o=[],s=r.isWebGL2,c=r.logarithmicDepthBuffer,u=r.floatVertexTextures,l=r.maxVertexUniforms,d=r.vertexTextures,h=r.precision,f={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},p=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function m(e){var t;return e&&e.isTexture?t=e.encoding:e&&e.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),t=e.texture.encoding):t=hn,t}return{getParameters:function(a,o,p,v,g){var b,y,x=v.fog,w=a.isMeshStandardMaterial?v.environment:null,O=t.get(a.envMap||w),A=f[a.type],_=g.isSkinnedMesh?function(e){var t=e.skeleton.bones;if(u)return 1024;var n=l,r=Math.floor((n-20)/4),a=Math.min(r,t.length);return a<t.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+t.length+" bones. This GPU supports "+a+"."),0):a}(g):0;if(null!==a.precision&&(h=r.getMaxPrecision(a.precision))!==a.precision&&console.warn("THREE.WebGLProgram.getParameters:",a.precision,"not supported, using",h,"instead."),A){var E=Yi[A];b=E.vertexShader,y=E.fragmentShader}else b=a.vertexShader,y=a.fragmentShader;var S=e.getRenderTarget();return{isWebGL2:s,shaderID:A,shaderName:a.type,vertexShader:b,fragmentShader:y,defines:a.defines,isRawShaderMaterial:!0===a.isRawShaderMaterial,glslVersion:a.glslVersion,precision:h,instancing:!0===g.isInstancedMesh,instancingColor:!0===g.isInstancedMesh&&null!==g.instanceColor,supportsVertexTextures:d,outputEncoding:null!==S?m(S.texture):e.outputEncoding,map:!!a.map,mapEncoding:m(a.map),matcap:!!a.matcap,matcapEncoding:m(a.matcap),envMap:!!O,envMapMode:O&&O.mapping,envMapEncoding:m(O),envMapCubeUV:!!O&&(O.mapping===_e||O.mapping===Ee),lightMap:!!a.lightMap,lightMapEncoding:m(a.lightMap),aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,emissiveMapEncoding:m(a.emissiveMap),bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,objectSpaceNormalMap:a.normalMapType===An,tangentSpaceNormalMap:a.normalMapType===On,clearcoatMap:!!a.clearcoatMap,clearcoatRoughnessMap:!!a.clearcoatRoughnessMap,clearcoatNormalMap:!!a.clearcoatNormalMap,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,alphaMap:!!a.alphaMap,gradientMap:!!a.gradientMap,sheen:!!a.sheen,transmissionMap:!!a.transmissionMap,combine:a.combine,vertexTangents:a.normalMap&&a.vertexTangents,vertexColors:a.vertexColors,vertexAlphas:!0===a.vertexColors&&g.geometry.attributes.color&&4===g.geometry.attributes.color.itemSize,vertexUvs:!!a.map||!!a.bumpMap||!!a.normalMap||!!a.specularMap||!!a.alphaMap||!!a.emissiveMap||!!a.roughnessMap||!!a.metalnessMap||!!a.clearcoatMap||!!a.clearcoatRoughnessMap||!!a.clearcoatNormalMap||!!a.displacementMap||!!a.transmissionMap,uvsVertexOnly:!(a.map||a.bumpMap||a.normalMap||a.specularMap||a.alphaMap||a.emissiveMap||a.roughnessMap||a.metalnessMap||a.clearcoatNormalMap||a.transmissionMap)&&!!a.displacementMap,fog:!!x,useFog:a.fog,fogExp2:x&&x.isFogExp2,flatShading:!!a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:c,skinning:a.skinning&&_>0,maxBones:_,useVertexTexture:u,morphTargets:a.morphTargets,morphNormals:a.morphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numDirLightShadows:o.directionalShadowMap.length,numPointLightShadows:o.pointShadowMap.length,numSpotLightShadows:o.spotShadowMap.length,numClippingPlanes:i.numPlanes,numClipIntersection:i.numIntersection,dithering:a.dithering,shadowMapEnabled:e.shadowMap.enabled&&p.length>0,shadowMapType:e.shadowMap.type,toneMapping:a.toneMapped?e.toneMapping:fe,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,alphaTest:a.alphaTest,doubleSided:a.side===R,flipSided:a.side===k,depthPacking:void 0!==a.depthPacking&&a.depthPacking,index0AttributeName:a.index0AttributeName,extensionDerivatives:a.extensions&&a.extensions.derivatives,extensionFragDepth:a.extensions&&a.extensions.fragDepth,extensionDrawBuffers:a.extensions&&a.extensions.drawBuffers,extensionShaderTextureLOD:a.extensions&&a.extensions.shaderTextureLOD,rendererExtensionFragDepth:s||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:s||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:s||n.has("EXT_shader_texture_lod"),customProgramCacheKey:a.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var a=0;a<p.length;a++)n.push(t[p[a]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=f[e.type];if(n){var r=Yi[n];t=ji.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,i=0,s=o.length;i<s;i++){var c=o[i];if(c.cacheKey===n){++(r=c).usedTimes;break}}return void 0===r&&(r=new Ls(e,n,t,a),o.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){var t=o.indexOf(e);o[t]=o[o.length-1],o.pop(),e.destroy()}},programs:o}}function Ds(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function Ps(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.program!==t.program?e.program.id-t.program.id:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Fs(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function Gs(e){var t=[],n=0,r=[],a=[],i={id:-1};function o(r,a,o,s,c,u){var l=t[n],d=e.get(o);return void 0===l?(l={id:r.id,object:r,geometry:a,material:o,program:d.program||i,groupOrder:s,renderOrder:r.renderOrder,z:c,group:u},t[n]=l):(l.id=r.id,l.object=r,l.geometry=a,l.material=o,l.program=d.program||i,l.groupOrder=s,l.renderOrder=r.renderOrder,l.z=c,l.group=u),n++,l}return{opaque:r,transparent:a,init:function(){n=0,r.length=0,a.length=0},push:function(e,t,n,i,s,c){var u=o(e,t,n,i,s,c);(!0===n.transparent?a:r).push(u)},unshift:function(e,t,n,i,s,c){var u=o(e,t,n,i,s,c);(!0===n.transparent?a:r).unshift(u)},finish:function(){for(var e=n,r=t.length;e<r;e++){var a=t[e];if(null===a.id)break;a.id=null,a.object=null,a.geometry=null,a.material=null,a.program=null,a.group=null}},sort:function(e,t){r.length>1&&r.sort(e||Ps),a.length>1&&a.sort(t||Fs)}}}function Us(e){var t=new WeakMap;return{get:function(n,r){var a;return!1===t.has(n)?(a=new Gs(e),t.set(n,[a])):r>=t.get(n).length?(a=new Gs(e),t.get(n).push(a)):a=t.get(n)[r],a},dispose:function(){t=new WeakMap}}}function zs(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new fr,color:new Fa};break;case"SpotLight":n={position:new fr,direction:new fr,color:new Fa,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new fr,color:new Fa,distance:0,decay:0};break;case"HemisphereLight":n={direction:new fr,skyColor:new Fa,groundColor:new Fa};break;case"RectAreaLight":n={color:new Fa,position:new fr,halfWidth:new fr,halfHeight:new fr}}return e[t.id]=n,n}}}var Hs=0;function Vs(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function Ws(e,t){for(var n=new zs,r=function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nr};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new nr,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},i=0;i<9;i++)a.probe.push(new fr);var o=new fr,s=new Vr,c=new Vr;return{setup:function(i){for(var o=0,s=0,c=0,u=0;u<9;u++)a.probe[u].set(0,0,0);var l=0,d=0,h=0,f=0,p=0,m=0,v=0,g=0;i.sort(Vs);for(var b=0,y=i.length;b<y;b++){var x=i[b],w=x.color,O=x.intensity,A=x.distance,_=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)o+=w.r*O,s+=w.g*O,c+=w.b*O;else if(x.isLightProbe)for(var E=0;E<9;E++)a.probe[E].addScaledVector(x.sh.coefficients[E],O);else if(x.isDirectionalLight){var S=n.get(x);if(S.color.copy(x.color).multiplyScalar(x.intensity),x.castShadow){var C=x.shadow,T=r.get(x);T.shadowBias=C.bias,T.shadowNormalBias=C.normalBias,T.shadowRadius=C.radius,T.shadowMapSize=C.mapSize,a.directionalShadow[l]=T,a.directionalShadowMap[l]=_,a.directionalShadowMatrix[l]=x.shadow.matrix,m++}a.directional[l]=S,l++}else if(x.isSpotLight){var M=n.get(x);if(M.position.setFromMatrixPosition(x.matrixWorld),M.color.copy(w).multiplyScalar(O),M.distance=A,M.coneCos=Math.cos(x.angle),M.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),M.decay=x.decay,x.castShadow){var k=x.shadow,R=r.get(x);R.shadowBias=k.bias,R.shadowNormalBias=k.normalBias,R.shadowRadius=k.radius,R.shadowMapSize=k.mapSize,a.spotShadow[h]=R,a.spotShadowMap[h]=_,a.spotShadowMatrix[h]=x.shadow.matrix,g++}a.spot[h]=M,h++}else if(x.isRectAreaLight){var I=n.get(x);I.color.copy(w).multiplyScalar(O),I.halfWidth.set(.5*x.width,0,0),I.halfHeight.set(0,.5*x.height,0),a.rectArea[f]=I,f++}else if(x.isPointLight){var j=n.get(x);if(j.color.copy(x.color).multiplyScalar(x.intensity),j.distance=x.distance,j.decay=x.decay,x.castShadow){var B=x.shadow,L=r.get(x);L.shadowBias=B.bias,L.shadowNormalBias=B.normalBias,L.shadowRadius=B.radius,L.shadowMapSize=B.mapSize,L.shadowCameraNear=B.camera.near,L.shadowCameraFar=B.camera.far,a.pointShadow[d]=L,a.pointShadowMap[d]=_,a.pointShadowMatrix[d]=x.shadow.matrix,v++}a.point[d]=j,d++}else if(x.isHemisphereLight){var N=n.get(x);N.skyColor.copy(x.color).multiplyScalar(O),N.groundColor.copy(x.groundColor).multiplyScalar(O),a.hemi[p]=N,p++}}f>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(a.rectAreaLTC1=qi.LTC_FLOAT_1,a.rectAreaLTC2=qi.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(a.rectAreaLTC1=qi.LTC_HALF_1,a.rectAreaLTC2=qi.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=o,a.ambient[1]=s,a.ambient[2]=c;var D=a.hash;D.directionalLength===l&&D.pointLength===d&&D.spotLength===h&&D.rectAreaLength===f&&D.hemiLength===p&&D.numDirectionalShadows===m&&D.numPointShadows===v&&D.numSpotShadows===g||(a.directional.length=l,a.spot.length=h,a.rectArea.length=f,a.point.length=d,a.hemi.length=p,a.directionalShadow.length=m,a.directionalShadowMap.length=m,a.pointShadow.length=v,a.pointShadowMap.length=v,a.spotShadow.length=g,a.spotShadowMap.length=g,a.directionalShadowMatrix.length=m,a.pointShadowMatrix.length=v,a.spotShadowMatrix.length=g,D.directionalLength=l,D.pointLength=d,D.spotLength=h,D.rectAreaLength=f,D.hemiLength=p,D.numDirectionalShadows=m,D.numPointShadows=v,D.numSpotShadows=g,a.version=Hs++)},setupView:function(e,t){for(var n=0,r=0,i=0,u=0,l=0,d=t.matrixWorldInverse,h=0,f=e.length;h<f;h++){var p=e[h];if(p.isDirectionalLight){var m=a.directional[n];m.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),m.direction.sub(o),m.direction.transformDirection(d),n++}else if(p.isSpotLight){var v=a.spot[i];v.position.setFromMatrixPosition(p.matrixWorld),v.position.applyMatrix4(d),v.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),v.direction.sub(o),v.direction.transformDirection(d),i++}else if(p.isRectAreaLight){var g=a.rectArea[u];g.position.setFromMatrixPosition(p.matrixWorld),g.position.applyMatrix4(d),c.identity(),s.copy(p.matrixWorld),s.premultiply(d),c.extractRotation(s),g.halfWidth.set(.5*p.width,0,0),g.halfHeight.set(0,.5*p.height,0),g.halfWidth.applyMatrix4(c),g.halfHeight.applyMatrix4(c),u++}else if(p.isPointLight){var b=a.point[r];b.position.setFromMatrixPosition(p.matrixWorld),b.position.applyMatrix4(d),r++}else if(p.isHemisphereLight){var y=a.hemi[l];y.direction.setFromMatrixPosition(p.matrixWorld),y.direction.transformDirection(d),y.direction.normalize(),l++}}},state:a}}function Js(e,t){var n=new Ws(e,t),r=[],a=[];return{init:function(){r.length=0,a.length=0},state:{lightsArray:r,shadowsArray:a,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){a.push(e)}}}function Xs(e,t){var n=new WeakMap;return{get:function(r){var a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!1===n.has(r)?(a=new Js(e,t),n.set(r,[a])):i>=n.get(r).length?(a=new Js(e,t),n.get(r).push(a)):a=n.get(r)[i],a},dispose:function(){n=new WeakMap}}}var Ks=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="MeshDepthMaterial",r.depthPacking=xn,r.skinning=!1,r.morphTargets=!1,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}]),n}(Ia);Ks.prototype.isMeshDepthMaterial=!0;var qs=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="MeshDistanceMaterial",r.referencePosition=new fr,r.nearDistance=1,r.farDistance=1e3,r.skinning=!1,r.morphTargets=!1,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.fog=!1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}]),n}(Ia);qs.prototype.isMeshDistanceMaterial=!0;function Ys(e,t,n){var r=new Vi,a=new nr,i=new nr,o=new ur,s=[],c=[],u={},l=n.maxTextureSize,d={0:k,1:M,2:R},h=new Bi({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new nr},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),f=h.clone();f.defines.HORIZONTAL_PASS=1;var p=new li;p.setAttribute("position",new Ha(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var m=new Ti(p,h),v=this;function g(n,r){var a=t.update(m);h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,a,h,m,null),f.uniforms.shadow_pass.value=n.mapPass.texture,f.uniforms.resolution.value=n.mapSize,f.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,a,f,m,null)}function b(e,t,n){var r=e<<0|t<<1|n<<2,a=s[r];return void 0===a&&(a=new Ks({depthPacking:wn,morphTargets:e,skinning:t}),s[r]=a),a}function y(e,t,n){var r=e<<0|t<<1|n<<2,a=c[r];return void 0===a&&(a=new qs({morphTargets:e,skinning:t}),c[r]=a),a}function x(t,n,r,a,i,o,s){var c=null,l=b,h=t.customDepthMaterial;if(!0===a.isPointLight&&(l=y,h=t.customDistanceMaterial),void 0===h){var f=!1;!0===r.morphTargets&&(f=n.morphAttributes&&n.morphAttributes.position&&n.morphAttributes.position.length>0);var p=!1;!0===t.isSkinnedMesh&&(!0===r.skinning?p=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",t)),c=l(f,p,!0===t.isInstancedMesh)}else c=h;if(e.localClippingEnabled&&!0===r.clipShadows&&0!==r.clippingPlanes.length){var m=c.uuid,v=r.uuid,g=u[m];void 0===g&&(g={},u[m]=g);var x=g[v];void 0===x&&(x=c.clone(),g[v]=x),c=x}return c.visible=r.visible,c.wireframe=r.wireframe,c.side=s===T?null!==r.shadowSide?r.shadowSide:r.side:null!==r.shadowSide?r.shadowSide:d[r.side],c.clipShadows=r.clipShadows,c.clippingPlanes=r.clippingPlanes,c.clipIntersection=r.clipIntersection,c.wireframeLinewidth=r.wireframeLinewidth,c.linewidth=r.linewidth,!0===a.isPointLight&&!0===c.isMeshDistanceMaterial&&(c.referencePosition.setFromMatrixPosition(a.matrixWorld),c.nearDistance=i,c.farDistance=o),c}function w(n,a,i,o,s){if(!1!==n.visible){if(n.layers.test(a.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&s===T)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,n.matrixWorld);var c=t.update(n),u=n.material;if(Array.isArray(u))for(var l=c.groups,d=0,h=l.length;d<h;d++){var f=l[d],p=u[f.materialIndex];if(p&&p.visible){var m=x(n,c,p,o,i.near,i.far,s);e.renderBufferDirect(i,null,c,m,n,f)}}else if(u.visible){var v=x(n,c,u,o,i.near,i.far,s);e.renderBufferDirect(i,null,c,v,n,null)}}for(var g=n.children,b=0,y=g.length;b<y;b++)w(g[b],a,i,o,s)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=S,this.render=function(t,n,s){if(!1!==v.enabled&&(!1!==v.autoUpdate||!1!==v.needsUpdate)&&0!==t.length){var c=e.getRenderTarget(),u=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(B),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);for(var f=0,p=t.length;f<p;f++){var m=t[f],b=m.shadow;if(void 0!==b){if(!1!==b.autoUpdate||!1!==b.needsUpdate){a.copy(b.mapSize);var y=b.getFrameExtents();if(a.multiply(y),i.copy(b.mapSize),(a.x>l||a.y>l)&&(a.x>l&&(i.x=Math.floor(l/y.x),a.x=i.x*y.x,b.mapSize.x=i.x),a.y>l&&(i.y=Math.floor(l/y.y),a.y=i.y*y.y,b.mapSize.y=i.y)),null===b.map&&!b.isPointLightShadow&&this.type===T){var x={minFilter:Be,magFilter:Be,format:$e};b.map=new lr(a.x,a.y,x),b.map.texture.name=m.name+".shadowMap",b.mapPass=new lr(a.x,a.y,x),b.camera.updateProjectionMatrix()}if(null===b.map){var O={minFilter:Me,magFilter:Me,format:$e};b.map=new lr(a.x,a.y,O),b.map.texture.name=m.name+".shadowMap",b.camera.updateProjectionMatrix()}e.setRenderTarget(b.map),e.clear();for(var A=b.getViewportCount(),_=0;_<A;_++){var E=b.getViewport(_);o.set(i.x*E.x,i.y*E.y,i.x*E.z,i.y*E.w),h.viewport(o),b.updateMatrices(m,_),r=b.getFrustum(),w(n,s,b.camera,m,this.type)}b.isPointLightShadow||this.type!==T||g(b,s),b.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}v.needsUpdate=!1,e.setRenderTarget(c,u,d)}}}function Qs(e,t,n){var r,a,i=n.isWebGL2;var o=new function(){var t=!1,n=new ur,r=null,a=new ur(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,i,o,s){!0===s&&(t*=o,r*=o,i*=o),n.set(t,r,i,o),!1===a.equals(n)&&(e.clearColor(t,r,i,o),a.copy(n))},reset:function(){t=!1,r=null,a.set(-1,0,0,0)}}},s=new function(){var t=!1,n=null,r=null,a=null;return{setTest:function(e){e?ye(2929):xe(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case ne:e.depthFunc(512);break;case re:e.depthFunc(519);break;case ae:e.depthFunc(513);break;case ie:e.depthFunc(515);break;case oe:e.depthFunc(514);break;case se:e.depthFunc(518);break;case ce:e.depthFunc(516);break;case ue:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){a!==t&&(e.clearDepth(t),a=t)},reset:function(){t=!1,n=null,r=null,a=null}}},u=new function(){var t=!1,n=null,r=null,a=null,i=null,o=null,s=null,c=null,u=null;return{setTest:function(e){t||(e?ye(2960):xe(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&a===n&&i===o||(e.stencilFunc(t,n,o),r=t,a=n,i=o)},setOp:function(t,n,r){o===t&&s===n&&c===r||(e.stencilOp(t,n,r),o=t,s=n,c=r)},setLocked:function(e){t=e},setClear:function(t){u!==t&&(e.clearStencil(t),u=t)},reset:function(){t=!1,n=null,r=null,a=null,i=null,o=null,s=null,c=null,u=null}}},l={},d=null,h={},f=null,p=!1,m=null,v=null,g=null,b=null,y=null,x=null,_=null,E=!1,S=null,C=null,T=null,M=null,I=null,j=e.getParameter(35661),le=!1,de=0,he=e.getParameter(7938);-1!==he.indexOf("WebGL")?(de=parseFloat(/^WebGL (\d)/.exec(he)[1]),le=de>=1):-1!==he.indexOf("OpenGL ES")&&(de=parseFloat(/^OpenGL ES (\d)/.exec(he)[1]),le=de>=2);var fe=null,pe={},me=new ur(0,0,e.canvas.width,e.canvas.height),ve=new ur(0,0,e.canvas.width,e.canvas.height);function ge(t,n,r){var a=new Uint8Array(4),i=e.createTexture();e.bindTexture(t,i),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var o=0;o<r;o++)e.texImage2D(n+o,0,6408,1,1,0,6408,5121,a);return i}var be={};function ye(t){!0!==l[t]&&(e.enable(t),l[t]=!0)}function xe(t){!1!==l[t]&&(e.disable(t),l[t]=!1)}be[3553]=ge(3553,3553,1),be[34067]=ge(34067,34069,6),o.setClear(0,0,0,1),s.setClear(1),u.setClear(0),ye(2929),s.setFunc(ie),Ee(!1),Se(O),ye(2884),_e(B);var we=(r={},Object(c.a)(r,G,32774),Object(c.a)(r,U,32778),Object(c.a)(r,z,32779),r);if(i)we[H]=32775,we[V]=32776;else{var Oe=t.get("EXT_blend_minmax");null!==Oe&&(we[H]=Oe.MIN_EXT,we[V]=Oe.MAX_EXT)}var Ae=(a={},Object(c.a)(a,W,0),Object(c.a)(a,J,1),Object(c.a)(a,X,768),Object(c.a)(a,q,770),Object(c.a)(a,te,776),Object(c.a)(a,$,774),Object(c.a)(a,Q,772),Object(c.a)(a,K,769),Object(c.a)(a,Y,771),Object(c.a)(a,ee,775),Object(c.a)(a,Z,773),a);function _e(t,n,r,a,i,o,s,c){if(t!==B){if(!1===p&&(ye(3042),p=!0),t===F)i=i||n,o=o||r,s=s||a,n===v&&i===y||(e.blendEquationSeparate(we[n],we[i]),v=n,y=i),r===g&&a===b&&o===x&&s===_||(e.blendFuncSeparate(Ae[r],Ae[a],Ae[o],Ae[s]),g=r,b=a,x=o,_=s),m=t,E=null;else if(t!==m||c!==E){if(v===G&&y===G||(e.blendEquation(32774),v=G,y=G),c)switch(t){case L:e.blendFuncSeparate(1,771,1,771);break;case N:e.blendFunc(1,1);break;case D:e.blendFuncSeparate(0,0,769,771);break;case P:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case L:e.blendFuncSeparate(770,771,1,771);break;case N:e.blendFunc(770,1);break;case D:e.blendFunc(0,769);break;case P:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}g=null,b=null,x=null,_=null,m=t,E=c}}else!0===p&&(xe(3042),p=!1)}function Ee(t){S!==t&&(t?e.frontFace(2304):e.frontFace(2305),S=t)}function Se(t){t!==w?(ye(2884),t!==C&&(t===O?e.cullFace(1029):t===A?e.cullFace(1028):e.cullFace(1032))):xe(2884),C=t}function Ce(t,n,r){t?(ye(32823),M===n&&I===r||(e.polygonOffset(n,r),M=n,I=r)):xe(32823)}function Te(t){void 0===t&&(t=33984+j-1),fe!==t&&(e.activeTexture(t),fe=t)}return{buffers:{color:o,depth:s,stencil:u},enable:ye,disable:xe,bindFramebuffer:function(t,n){null===n&&null!==d&&(n=d),h[t]!==n&&(e.bindFramebuffer(t,n),h[t]=n)},bindXRFramebuffer:function(t){t!==d&&(e.bindFramebuffer(36160,t),d=t)},useProgram:function(t){return f!==t&&(e.useProgram(t),f=t,!0)},setBlending:_e,setMaterial:function(e,t){e.side===R?xe(2884):ye(2884);var n=e.side===k;t&&(n=!n),Ee(n),e.blending===L&&!1===e.transparent?_e(B):_e(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),s.setFunc(e.depthFunc),s.setTest(e.depthTest),s.setMask(e.depthWrite),o.setMask(e.colorWrite);var r=e.stencilWrite;u.setTest(r),r&&(u.setMask(e.stencilWriteMask),u.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),u.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),Ce(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?ye(32926):xe(32926)},setFlipSided:Ee,setCullFace:Se,setLineWidth:function(t){t!==T&&(le&&e.lineWidth(t),T=t)},setPolygonOffset:Ce,setScissorTest:function(e){e?ye(3089):xe(3089)},activeTexture:Te,bindTexture:function(t,n){null===fe&&Te();var r=pe[fe];void 0===r&&(r={type:void 0,texture:void 0},pe[fe]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||be[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=pe[fe];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===me.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),me.copy(t))},viewport:function(t){!1===ve.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),ve.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===i&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),l={},fe=null,pe={},d=null,h={},f=null,p=!1,m=null,v=null,g=null,b=null,y=null,x=null,_=null,E=!1,S=null,C=null,T=null,M=null,I=null,me.set(0,0,e.canvas.width,e.canvas.height),ve.set(0,0,e.canvas.width,e.canvas.height),o.reset(),s.reset(),u.reset()}}}function Zs(e,t,n,r,a,i,o){var s,u,l,d=a.isWebGL2,h=a.maxTextures,f=a.maxCubemapSize,p=a.maxTextureSize,m=a.maxSamples,v=new WeakMap,g=!1;try{g="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(U){}function b(e,t){return g?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function y(e,t,n,r){var a=1;if((e.width>r||e.height>r)&&(a=r/Math.max(e.width,e.height)),a<1||!0===t){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){var i=t?tr.floorPowerOfTwo:Math.floor,o=i(a*e.width),s=i(a*e.height);void 0===l&&(l=b(o,s));var c=n?b(o,s):l;return c.width=o,c.height=s,c.getContext("2d").drawImage(e,0,0,o,s),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+s+")."),c}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function x(e){return tr.isPowerOfTwo(e.width)&&tr.isPowerOfTwo(e.height)}function w(e,t){return e.generateMipmaps&&t&&e.minFilter!==Me&&e.minFilter!==Be}function O(t,n,a,i){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log2(Math.max(a,i))}function A(n,r,a){if(!1===d)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var i=r;return 6403===r&&(5126===a&&(i=33326),5131===a&&(i=33325),5121===a&&(i=33321)),6407===r&&(5126===a&&(i=34837),5131===a&&(i=34843),5121===a&&(i=32849)),6408===r&&(5126===a&&(i=34836),5131===a&&(i=34842),5121===a&&(i=32856)),33325!==i&&33326!==i&&34842!==i&&34836!==i||t.get("EXT_color_buffer_float"),i}function _(e){return e===Me||e===ke||e===Ie?9728:9729}function E(t){var n=t.target;n.removeEventListener("dispose",E),function(t){var n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&v.delete(n),o.memory.textures--}function S(t){var n=t.target;n.removeEventListener("dispose",S),function(t){var n=t.texture,a=r.get(t),i=r.get(n);if(!t)return;void 0!==i.__webglTexture&&e.deleteTexture(i.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var o=0;o<6;o++)e.deleteFramebuffer(a.__webglFramebuffer[o]),a.__webglDepthbuffer&&e.deleteRenderbuffer(a.__webglDepthbuffer[o]);else e.deleteFramebuffer(a.__webglFramebuffer),a.__webglDepthbuffer&&e.deleteRenderbuffer(a.__webglDepthbuffer),a.__webglMultisampledFramebuffer&&e.deleteFramebuffer(a.__webglMultisampledFramebuffer),a.__webglColorRenderbuffer&&e.deleteRenderbuffer(a.__webglColorRenderbuffer),a.__webglDepthRenderbuffer&&e.deleteRenderbuffer(a.__webglDepthRenderbuffer);r.remove(n),r.remove(t)}(n),o.memory.textures--}var C=0;function T(e,t){var a=r.get(e);if(e.isVideoTexture&&function(e){var t=o.render.frame;v.get(e)!==t&&(v.set(e,t),e.update())}(e),e.version>0&&a.__version!==e.version){var i=e.image;if(void 0===i)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==i.complete)return void B(a,e,t);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+t),n.bindTexture(3553,a.__webglTexture)}function M(t,a){var o=r.get(t);t.version>0&&o.__version!==t.version?function(t,r,a){if(6!==r.image.length)return;j(t,r),n.activeTexture(33984+a),n.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);for(var o=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),s=r.image[0]&&r.image[0].isDataTexture,c=[],u=0;u<6;u++)c[u]=o||s?s?r.image[u].image:r.image[u]:y(r.image[u],!1,!0,f);var l,h=c[0],p=x(h)||d,m=i.convert(r.format),v=i.convert(r.type),g=A(r.internalFormat,m,v);if(I(34067,r,p),o){for(var b=0;b<6;b++){l=c[b].mipmaps;for(var _=0;_<l.length;_++){var E=l[_];r.format!==$e&&r.format!==Ze?null!==m?n.compressedTexImage2D(34069+b,_,g,E.width,E.height,0,E.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+b,_,g,E.width,E.height,0,m,v,E.data)}}t.__maxMipLevel=l.length-1}else{l=r.mipmaps;for(var S=0;S<6;S++)if(s){n.texImage2D(34069+S,0,g,c[S].width,c[S].height,0,m,v,c[S].data);for(var C=0;C<l.length;C++){var T=l[C].image[S].image;n.texImage2D(34069+S,C+1,g,T.width,T.height,0,m,v,T.data)}}else{n.texImage2D(34069+S,0,g,m,v,c[S]);for(var M=0;M<l.length;M++){var k=l[M];n.texImage2D(34069+S,M+1,g,m,v,k.image[S])}}t.__maxMipLevel=l.length}w(r,p)&&O(34067,r,h.width,h.height);t.__version=r.version,r.onUpdate&&r.onUpdate(r)}(o,t,a):(n.activeTexture(33984+a),n.bindTexture(34067,o.__webglTexture))}var k=(s={},Object(c.a)(s,Se,10497),Object(c.a)(s,Ce,33071),Object(c.a)(s,Te,33648),s),R=(u={},Object(c.a)(u,Me,9728),Object(c.a)(u,ke,9984),Object(c.a)(u,Ie,9986),Object(c.a)(u,Be,9729),Object(c.a)(u,Le,9985),Object(c.a)(u,De,9987),u);function I(n,i,o){if(o?(e.texParameteri(n,10242,k[i.wrapS]),e.texParameteri(n,10243,k[i.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,k[i.wrapR]),e.texParameteri(n,10240,R[i.magFilter]),e.texParameteri(n,10241,R[i.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),i.wrapS===Ce&&i.wrapT===Ce||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,_(i.magFilter)),e.texParameteri(n,10241,_(i.minFilter)),i.minFilter!==Me&&i.minFilter!==Be&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(i.type===We&&!1===t.has("OES_texture_float_linear"))return;if(!1===d&&i.type===Je&&!1===t.has("OES_texture_half_float_linear"))return;(i.anisotropy>1||r.get(i).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,a.getMaxAnisotropy())),r.get(i).__currentAnisotropy=i.anisotropy)}}function j(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",E),t.__webglTexture=e.createTexture(),o.memory.textures++)}function B(t,r,a){var o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),j(t,r),n.activeTexture(33984+a),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);var s,c=function(e){return!d&&(e.wrapS!==Ce||e.wrapT!==Ce||e.minFilter!==Me&&e.minFilter!==Be)}(r)&&!1===x(r.image),u=y(r.image,c,!1,p),l=x(u)||d,h=i.convert(r.format),f=i.convert(r.type),m=A(r.internalFormat,h,f);I(o,r,l);var v=r.mipmaps;if(r.isDepthTexture)m=6402,d?m=r.type===We?36012:r.type===Ve?33190:r.type===Ye?35056:33189:r.type===We&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===rt&&6402===m&&r.type!==ze&&r.type!==Ve&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=ze,f=i.convert(r.type)),r.format===at&&6402===m&&(m=34041,r.type!==Ye&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=Ye,f=i.convert(r.type))),n.texImage2D(3553,0,m,u.width,u.height,0,h,f,null);else if(r.isDataTexture)if(v.length>0&&l){for(var g=0,b=v.length;g<b;g++)s=v[g],n.texImage2D(3553,g,m,s.width,s.height,0,h,f,s.data);r.generateMipmaps=!1,t.__maxMipLevel=v.length-1}else n.texImage2D(3553,0,m,u.width,u.height,0,h,f,u.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var _=0,E=v.length;_<E;_++)s=v[_],r.format!==$e&&r.format!==Ze?null!==h?n.compressedTexImage2D(3553,_,m,s.width,s.height,0,s.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,_,m,s.width,s.height,0,h,f,s.data);t.__maxMipLevel=v.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,m,u.width,u.height,u.depth,0,h,f,u.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,m,u.width,u.height,u.depth,0,h,f,u.data),t.__maxMipLevel=0;else if(v.length>0&&l){for(var S=0,C=v.length;S<C;S++)s=v[S],n.texImage2D(3553,S,m,h,f,s);r.generateMipmaps=!1,t.__maxMipLevel=v.length-1}else n.texImage2D(3553,0,m,h,f,u),t.__maxMipLevel=0;w(r,l)&&O(o,r,u.width,u.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function L(t,a,o,s){var c=a.texture,u=i.convert(c.format),l=i.convert(c.type),d=A(c.internalFormat,u,l);32879===s||35866===s?n.texImage3D(s,0,d,a.width,a.height,a.depth,0,u,l,null):n.texImage2D(s,0,d,a.width,a.height,0,u,l,null),n.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,o,s,r.get(c).__webglTexture,0),n.bindFramebuffer(36160,null)}function N(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){var a=33189;if(r){var o=n.depthTexture;o&&o.isDepthTexture&&(o.type===We?a=36012:o.type===Ve&&(a=33190));var s=P(n);e.renderbufferStorageMultisample(36161,s,a,n.width,n.height)}else e.renderbufferStorage(36161,a,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){var c=P(n);e.renderbufferStorageMultisample(36161,c,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var u=n.texture,l=i.convert(u.format),d=i.convert(u.type),h=A(u.internalFormat,l,d);if(r){var f=P(n);e.renderbufferStorageMultisample(36161,f,h,n.width,n.height)}else e.renderbufferStorage(36161,h,n.width,n.height)}e.bindRenderbuffer(36161,null)}function D(t){var a=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,a){if(a&&a.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!a.depthTexture||!a.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(a.depthTexture).__webglTexture&&a.depthTexture.image.width===a.width&&a.depthTexture.image.height===a.height||(a.depthTexture.image.width=a.width,a.depthTexture.image.height=a.height,a.depthTexture.needsUpdate=!0),T(a.depthTexture,0);var i=r.get(a.depthTexture).__webglTexture;if(a.depthTexture.format===rt)e.framebufferTexture2D(36160,36096,3553,i,0);else{if(a.depthTexture.format!==at)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,i,0)}}(a.__webglFramebuffer,t)}else if(i){a.__webglDepthbuffer=[];for(var o=0;o<6;o++)n.bindFramebuffer(36160,a.__webglFramebuffer[o]),a.__webglDepthbuffer[o]=e.createRenderbuffer(),N(a.__webglDepthbuffer[o],t,!1)}else n.bindFramebuffer(36160,a.__webglFramebuffer),a.__webglDepthbuffer=e.createRenderbuffer(),N(a.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function P(e){return d&&e.isWebGLMultisampleRenderTarget?Math.min(m,e.samples):0}var F=!1,G=!1;this.allocateTextureUnit=function(){var e=C;return e>=h&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+h),C+=1,e},this.resetTextureUnits=function(){C=0},this.setTexture2D=T,this.setTexture2DArray=function(e,t){var a=r.get(e);e.version>0&&a.__version!==e.version?B(a,e,t):(n.activeTexture(33984+t),n.bindTexture(35866,a.__webglTexture))},this.setTexture3D=function(e,t){var a=r.get(e);e.version>0&&a.__version!==e.version?B(a,e,t):(n.activeTexture(33984+t),n.bindTexture(32879,a.__webglTexture))},this.setTextureCube=M,this.setupRenderTarget=function(t){var a=t.texture,s=r.get(t),c=r.get(a);t.addEventListener("dispose",S),c.__webglTexture=e.createTexture(),c.__version=a.version,o.memory.textures++;var u=!0===t.isWebGLCubeRenderTarget,l=!0===t.isWebGLMultisampleRenderTarget,h=a.isDataTexture3D||a.isDataTexture2DArray,f=x(t)||d;if(!d||a.format!==Ze||a.type!==We&&a.type!==Je||(a.format=$e,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),u){s.__webglFramebuffer=[];for(var p=0;p<6;p++)s.__webglFramebuffer[p]=e.createFramebuffer()}else if(s.__webglFramebuffer=e.createFramebuffer(),l)if(d){s.__webglMultisampledFramebuffer=e.createFramebuffer(),s.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,s.__webglColorRenderbuffer);var m=i.convert(a.format),v=i.convert(a.type),g=A(a.internalFormat,m,v),b=P(t);e.renderbufferStorageMultisample(36161,b,g,t.width,t.height),n.bindFramebuffer(36160,s.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,s.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(s.__webglDepthRenderbuffer=e.createRenderbuffer(),N(s.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(u){n.bindTexture(34067,c.__webglTexture),I(34067,a,f);for(var y=0;y<6;y++)L(s.__webglFramebuffer[y],t,36064,34069+y);w(a,f)&&O(34067,a,t.width,t.height),n.bindTexture(34067,null)}else{var _=3553;if(h)if(d)_=a.isDataTexture3D?32879:35866;else console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.");n.bindTexture(_,c.__webglTexture),I(_,a,f),L(s.__webglFramebuffer,t,36064,_),w(a,f)&&O(3553,a,t.width,t.height),n.bindTexture(3553,null)}t.depthBuffer&&D(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(w(t,x(e)||d)){var a=e.isWebGLCubeRenderTarget?34067:3553,i=r.get(t).__webglTexture;n.bindTexture(a,i),O(a,t,e.width,e.height),n.bindTexture(a,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(d){var a=r.get(t);n.bindFramebuffer(36008,a.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,a.__webglFramebuffer);var i=t.width,o=t.height,s=16384;t.depthBuffer&&(s|=256),t.stencilBuffer&&(s|=1024),e.blitFramebuffer(0,0,i,o,0,0,i,o,s,9728),n.bindFramebuffer(36160,a.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,t){e&&e.isWebGLRenderTarget&&(!1===F&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),F=!0),e=e.texture),T(e,t)},this.safeSetTextureCube=function(e,t){e&&e.isWebGLCubeRenderTarget&&(!1===G&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),G=!0),e=e.texture),M(e,t)}}function $s(e,t,n){var r=n.isWebGL2;return{convert:function(e){var n;if(e===Fe)return 5121;if(e===Xe)return 32819;if(e===Ke)return 32820;if(e===qe)return 33635;if(e===Ge)return 5120;if(e===Ue)return 5122;if(e===ze)return 5123;if(e===He)return 5124;if(e===Ve)return 5125;if(e===We)return 5126;if(e===Je)return r?5131:null!==(n=t.get("OES_texture_half_float"))?n.HALF_FLOAT_OES:null;if(e===Qe)return 6406;if(e===Ze)return 6407;if(e===$e)return 6408;if(e===et)return 6409;if(e===tt)return 6410;if(e===rt)return 6402;if(e===at)return 34041;if(e===it)return 6403;if(e===ot)return 36244;if(e===st)return 33319;if(e===ct)return 33320;if(e===ut)return 36248;if(e===lt)return 36249;if(e===dt||e===ht||e===ft||e===pt){if(null===(n=t.get("WEBGL_compressed_texture_s3tc")))return null;if(e===dt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(e===ht)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(e===ft)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(e===pt)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(e===mt||e===vt||e===gt||e===bt){if(null===(n=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(e===mt)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(e===vt)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(e===gt)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(e===bt)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(e===yt)return null!==(n=t.get("WEBGL_compressed_texture_etc1"))?n.COMPRESSED_RGB_ETC1_WEBGL:null;if((e===xt||e===wt)&&null!==(n=t.get("WEBGL_compressed_texture_etc"))){if(e===xt)return n.COMPRESSED_RGB8_ETC2;if(e===wt)return n.COMPRESSED_RGBA8_ETC2_EAC}return e===Ot||e===At||e===_t||e===Et||e===St||e===Ct||e===Tt||e===Mt||e===kt||e===Rt||e===It||e===jt||e===Bt||e===Lt||e===Dt||e===Pt||e===Ft||e===Gt||e===Ut||e===zt||e===Ht||e===Vt||e===Wt||e===Jt||e===Xt||e===Kt||e===qt||e===Yt?null!==(n=t.get("WEBGL_compressed_texture_astc"))?e:null:e===Nt?null!==(n=t.get("EXT_texture_compression_bptc"))?e:null:e===Ye?r?34042:null!==(n=t.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}var ec=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(v.a)(this,n),(e=t.call(this)).cameras=r,e}return n}(Ni);ec.prototype.isArrayCamera=!0;var tc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(v.a)(this,n),(e=t.call(this)).type="Group",e}return n}(ma);function nc(){this._targetRay=null,this._grip=null,this._hand=null}function rc(e,t){var n=this,r=e.state,a=null,s=1,c=null,u="local-floor",l=null,d=[],h=new Map,f=new Ni;f.layers.enable(1),f.viewport=new ur;var p=new Ni;p.layers.enable(2),p.viewport=new ur;var m=[f,p],v=new ec;v.layers.enable(1),v.layers.enable(2);var g=null,b=null;function y(e){var t=h.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function x(){h.forEach((function(e,t){e.disconnect(t)})),h.clear(),g=null,b=null,r.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),S.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function w(e){for(var t=a.inputSources,n=0;n<d.length;n++)h.set(t[n],d[n]);for(var r=0;r<e.removed.length;r++){var i=e.removed[r],o=h.get(i);o&&(o.dispatchEvent({type:"disconnected",data:i}),h.delete(i))}for(var s=0;s<e.added.length;s++){var c=e.added[s],u=h.get(c);u&&u.dispatchEvent({type:"connected",data:c})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=d[e];return void 0===t&&(t=new nc,d[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){var t=d[e];return void 0===t&&(t=new nc,d[e]=t),t.getGripSpace()},this.getHand=function(e){var t=d[e];return void 0===t&&(t=new nc,d[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){s=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){u=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return c},this.getSession=function(){return a},this.setSession=function(){var e=Object(o.a)(i.a.mark((function e(r){var o,l,d;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(a=r)){e.next=24;break}if(a.addEventListener("select",y),a.addEventListener("selectstart",y),a.addEventListener("selectend",y),a.addEventListener("squeeze",y),a.addEventListener("squeezestart",y),a.addEventListener("squeezeend",y),a.addEventListener("end",x),a.addEventListener("inputsourceschange",w),!0===(o=t.getContextAttributes()).xrCompatible){e.next=14;break}return e.next=14,t.makeXRCompatible();case 14:return l={antialias:o.antialias,alpha:o.alpha,depth:o.depth,stencil:o.stencil,framebufferScaleFactor:s},d=new XRWebGLLayer(a,t,l),a.updateRenderState({baseLayer:d}),e.next=19,a.requestReferenceSpace(u);case 19:c=e.sent,S.setContext(a),S.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"});case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var O=new fr,A=new fr;function _(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.getCamera=function(e){v.near=p.near=f.near=e.near,v.far=p.far=f.far=e.far,g===v.near&&b===v.far||(a.updateRenderState({depthNear:v.near,depthFar:v.far}),g=v.near,b=v.far);var t=e.parent,n=v.cameras;_(v,t);for(var r=0;r<n.length;r++)_(n[r],t);e.matrixWorld.copy(v.matrixWorld),e.matrix.copy(v.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);for(var i=e.children,o=0,s=i.length;o<s;o++)i[o].updateMatrixWorld(!0);return 2===n.length?function(e,t,n){O.setFromMatrixPosition(t.matrixWorld),A.setFromMatrixPosition(n.matrixWorld);var r=O.distanceTo(A),a=t.projectionMatrix.elements,i=n.projectionMatrix.elements,o=a[14]/(a[10]-1),s=a[14]/(a[10]+1),c=(a[9]+1)/a[5],u=(a[9]-1)/a[5],l=(a[8]-1)/a[0],d=(i[8]+1)/i[0],h=o*l,f=o*d,p=r/(-l+d),m=p*-l;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var v=o+p,g=s+p,b=h-m,y=f+(r-m),x=c*s/g*v,w=u*s/g*v;e.projectionMatrix.makePerspective(b,y,x,w,v,g)}(v,f,p):v.projectionMatrix.copy(f.projectionMatrix),v};var E=null;var S=new Wi;S.setAnimationLoop((function(e,t){if(null!==(l=t.getViewerPose(c))){var n=l.views,i=a.renderState.baseLayer;r.bindXRFramebuffer(i.framebuffer);var o=!1;n.length!==v.cameras.length&&(v.cameras.length=0,o=!0);for(var s=0;s<n.length;s++){var u=n[s],h=i.getViewport(u),f=m[s];f.matrix.fromArray(u.transform.matrix),f.projectionMatrix.fromArray(u.projectionMatrix),f.viewport.set(h.x,h.y,h.width,h.height),0===s&&v.matrix.copy(f.matrix),!0===o&&v.cameras.push(f)}}for(var p=a.inputSources,g=0;g<d.length;g++){var b=d[g],y=p[g];b.update(y,t,c)}E&&E(e,t)})),this.setAnimationLoop=function(e){E=e},this.dispose=function(){}}function ac(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);var r,a,i=e.get(n).envMap;if(i){t.envMap.value=i,t.flipEnvMap.value=i.isCubeTexture&&i._needsFlipEnvMap?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;var o=e.get(i).__maxMipLevel;void 0!==o&&(t.maxMipLevel.value=o)}n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?a=n.aoMap:n.lightMap&&(a=n.lightMap),void 0!==a&&(a.isWebGLRenderTarget&&(a=a.texture),!0===a.matrixAutoUpdate&&a.updateMatrix(),t.uv2Transform.value.copy(a.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,n.side===k&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),n.side===k&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,a,i){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===k&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===k&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===k&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===k&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t){n(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap);t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,t.side===k&&e.clearcoatNormalScale.value.negate());e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap)}(e,r):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===k&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===k&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,t.side===k&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),t.side===k&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var a;t.map?a=t.map:t.alphaMap&&(a=t.alphaMap);void 0!==a&&(!0===a.matrixAutoUpdate&&a.updateMatrix(),e.uvTransform.value.copy(a.matrix))}(e,r,a,i):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function ic(e){var t=void 0!==(e=e||{}).canvas?e.canvas:function(){var e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return e.style.display="block",e}(),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,a=void 0===e.depth||e.depth,i=void 0===e.stencil||e.stencil,o=void 0!==e.antialias&&e.antialias,s=void 0===e.premultipliedAlpha||e.premultipliedAlpha,c=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,u=void 0!==e.powerPreference?e.powerPreference:"default",l=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,d=null,h=null,f=[],p=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=hn,this.physicallyCorrectLights=!1,this.toneMapping=fe,this.toneMappingExposure=1;var m=this,v=!1,g=0,b=0,y=null,x=-1,w=null,O=new ur,A=new ur,_=null,E=t.width,S=t.height,C=1,T=null,M=null,k=new ur(0,0,E,S),R=new ur(0,0,E,S),I=!1,j=new Vi,B=!1,L=!1,N=new Vr,D=new fr,P={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function F(){return null===y?C:1}var G,U,z,H,V,W,J,X,K,q,Y,Q,Z,$,ee,te,ne,re,ae,ie,oe,se,ce=n;function ue(e,n){for(var r=0;r<e.length;r++){var a=e[r],i=t.getContext(a,n);if(null!==i)return i}return null}try{var le={alpha:r,depth:a,stencil:i,antialias:o,premultipliedAlpha:s,preserveDrawingBuffer:c,powerPreference:u,failIfMajorPerformanceCaveat:l};if(t.addEventListener("webglcontextlost",me,!1),t.addEventListener("webglcontextrestored",ve,!1),null===ce){var de=["webgl2","webgl","experimental-webgl"];if(!0===m.isWebGL1Renderer&&de.shift(),null===(ce=ue(de,le)))throw ue(de)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===ce.getShaderPrecisionFormat&&(ce.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Te){throw console.error("THREE.WebGLRenderer: "+Te.message),Te}function he(){G=new ro(ce),U=new eo(ce,G,e),G.init(U),oe=new $s(ce,G,U),z=new Qs(ce,G,U),H=new oo(ce),V=new Ds,W=new Zs(ce,G,z,V,U,oe,H),J=new no(m),X=new Ji(ce,U),se=new Zi(ce,G,X,U),K=new ao(ce,X,H,se),q=new lo(ce,K,X,H),re=new uo(ce),ee=new to(V),Y=new Ns(m,J,G,U,se,ee),Q=new ac(V),Z=new Us(V),$=new Xs(G,U),ne=new Qi(m,J,z,q,s),te=new Ys(m,q,U),ae=new $i(ce,G,H,U),ie=new io(ce,G,H,U),H.programs=Y.programs,m.capabilities=U,m.extensions=G,m.properties=V,m.renderLists=Z,m.shadowMap=te,m.state=z,m.info=H}he();var pe=new rc(m,ce);function me(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),v=!0}function ve(){console.log("THREE.WebGLRenderer: Context Restored."),v=!1;var e=H.autoReset,t=te.enabled,n=te.autoUpdate,r=te.needsUpdate,a=te.type;he(),H.autoReset=e,te.enabled=t,te.autoUpdate=n,te.needsUpdate=r,te.type=a}function ge(e){var t=e.target;t.removeEventListener("dispose",ge),function(e){(function(e){var t=V.get(e).programs;void 0!==t&&t.forEach((function(e){Y.releaseProgram(e)}))})(e),V.remove(e)}(t)}this.xr=pe,this.getContext=function(){return ce},this.getContextAttributes=function(){return ce.getContextAttributes()},this.forceContextLoss=function(){var e=G.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=G.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return C},this.setPixelRatio=function(e){void 0!==e&&(C=e,this.setSize(E,S,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new nr),e.set(E,S)},this.setSize=function(e,n,r){pe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(E=e,S=n,t.width=Math.floor(e*C),t.height=Math.floor(n*C),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new nr),e.set(E*C,S*C).floor()},this.setDrawingBufferSize=function(e,n,r){E=e,S=n,C=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new ur),e.copy(O)},this.getViewport=function(e){return e.copy(k)},this.setViewport=function(e,t,n,r){e.isVector4?k.set(e.x,e.y,e.z,e.w):k.set(e,t,n,r),z.viewport(O.copy(k).multiplyScalar(C).floor())},this.getScissor=function(e){return e.copy(R)},this.setScissor=function(e,t,n,r){e.isVector4?R.set(e.x,e.y,e.z,e.w):R.set(e,t,n,r),z.scissor(A.copy(R).multiplyScalar(C).floor())},this.getScissorTest=function(){return I},this.setScissorTest=function(e){z.setScissorTest(I=e)},this.setOpaqueSort=function(e){T=e},this.setTransparentSort=function(e){M=e},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new Fa),e.copy(ne.getClearColor())},this.setClearColor=function(){ne.setClearColor.apply(ne,arguments)},this.getClearAlpha=function(){return ne.getClearAlpha()},this.setClearAlpha=function(){ne.setClearAlpha.apply(ne,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),ce.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",me,!1),t.removeEventListener("webglcontextrestored",ve,!1),Z.dispose(),$.dispose(),V.dispose(),J.dispose(),q.dispose(),se.dispose(),pe.dispose(),pe.removeEventListener("sessionstart",ye),pe.removeEventListener("sessionend",xe),we.stop()},this.renderBufferImmediate=function(e,t){se.initAttributes();var n=V.get(e);e.hasPositions&&!n.position&&(n.position=ce.createBuffer()),e.hasNormals&&!n.normal&&(n.normal=ce.createBuffer()),e.hasUvs&&!n.uv&&(n.uv=ce.createBuffer()),e.hasColors&&!n.color&&(n.color=ce.createBuffer());var r=t.getAttributes();e.hasPositions&&(ce.bindBuffer(34962,n.position),ce.bufferData(34962,e.positionArray,35048),se.enableAttribute(r.position),ce.vertexAttribPointer(r.position,3,5126,!1,0,0)),e.hasNormals&&(ce.bindBuffer(34962,n.normal),ce.bufferData(34962,e.normalArray,35048),se.enableAttribute(r.normal),ce.vertexAttribPointer(r.normal,3,5126,!1,0,0)),e.hasUvs&&(ce.bindBuffer(34962,n.uv),ce.bufferData(34962,e.uvArray,35048),se.enableAttribute(r.uv),ce.vertexAttribPointer(r.uv,2,5126,!1,0,0)),e.hasColors&&(ce.bindBuffer(34962,n.color),ce.bufferData(34962,e.colorArray,35048),se.enableAttribute(r.color),ce.vertexAttribPointer(r.color,3,5126,!1,0,0)),se.disableUnusedAttributes(),ce.drawArrays(4,0,e.count),e.count=0},this.renderBufferDirect=function(e,t,n,r,a,i){null===t&&(t=P);var o=a.isMesh&&a.matrixWorld.determinant()<0,s=Ce(e,t,r,a);z.setMaterial(r,o);var c=n.index,u=n.attributes.position;if(null===c){if(void 0===u||0===u.count)return}else if(0===c.count)return;var l,d=1;!0===r.wireframe&&(c=K.getWireframeAttribute(n),d=2),(r.morphTargets||r.morphNormals)&&re.update(a,n,r,s),se.setup(a,r,s,n,c);var h=ae;null!==c&&(l=X.get(c),(h=ie).setIndex(l));var f=null!==c?c.count:u.count,p=n.drawRange.start*d,m=n.drawRange.count*d,v=null!==i?i.start*d:0,g=null!==i?i.count*d:1/0,b=Math.max(p,v),y=Math.min(f,p+m,v+g)-1,x=Math.max(0,y-b+1);if(0!==x){if(a.isMesh)!0===r.wireframe?(z.setLineWidth(r.wireframeLinewidth*F()),h.setMode(1)):h.setMode(4);else if(a.isLine){var w=r.linewidth;void 0===w&&(w=1),z.setLineWidth(w*F()),a.isLineSegments?h.setMode(1):a.isLineLoop?h.setMode(2):h.setMode(3)}else a.isPoints?h.setMode(0):a.isSprite&&h.setMode(4);if(a.isInstancedMesh)h.renderInstances(b,x,a.count);else if(n.isInstancedBufferGeometry){var O=Math.min(n.instanceCount,n._maxInstanceCount);h.renderInstances(b,x,O)}else h.render(b,x)}},this.compile=function(e,t){(h=$.get(e)).init(),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(h.pushLight(e),e.castShadow&&h.pushShadow(e))})),h.setupLights(),e.traverse((function(t){var n=t.material;if(n)if(Array.isArray(n))for(var r=0;r<n.length;r++){Ee(n[r],e,t)}else Ee(n,e,t)}))};var be=null;function ye(){we.stop()}function xe(){we.start()}var we=new Wi;function Oe(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)h.pushLight(e),e.castShadow&&h.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||j.intersectsSprite(e)){r&&D.setFromMatrixPosition(e.matrixWorld).applyMatrix4(N);var a=q.update(e),i=e.material;i.visible&&d.push(e,a,i,n,D.z,null)}}else if(e.isImmediateRenderObject)r&&D.setFromMatrixPosition(e.matrixWorld).applyMatrix4(N),d.push(e,null,e.material,n,D.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.frame!==H.render.frame&&(e.skeleton.update(),e.skeleton.frame=H.render.frame),!e.frustumCulled||j.intersectsObject(e))){r&&D.setFromMatrixPosition(e.matrixWorld).applyMatrix4(N);var o=q.update(e),s=e.material;if(Array.isArray(s))for(var c=o.groups,u=0,l=c.length;u<l;u++){var f=c[u],p=s[f.materialIndex];p&&p.visible&&d.push(e,o,p,n,D.z,f)}else s.visible&&d.push(e,o,s,n,D.z,null)}for(var m=e.children,v=0,g=m.length;v<g;v++)Oe(m[v],t,n,r)}}function Ae(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,a=0,i=e.length;a<i;a++){var o=e[a],s=o.object,c=o.geometry,u=null===r?o.material:r,l=o.group;if(n.isArrayCamera)for(var d=n.cameras,f=0,p=d.length;f<p;f++){var m=d[f];s.layers.test(m.layers)&&(z.viewport(O.copy(m.viewport)),h.setupLightsView(m),_e(s,t,m,c,u,l))}else _e(s,t,n,c,u,l)}}function _e(e,t,n,r,a,i){if(e.onBeforeRender(m,t,n,r,a,i),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),e.isImmediateRenderObject){var o=Ce(n,t,a,e);z.setMaterial(a),se.reset(),function(e,t){e.render((function(e){m.renderBufferImmediate(e,t)}))}(e,o)}else m.renderBufferDirect(n,t,r,a,e,i);e.onAfterRender(m,t,n,r,a,i)}function Ee(e,t,n){!0!==t.isScene&&(t=P);var r=V.get(e),a=h.state.lights,i=h.state.shadowsArray,o=a.state.version,s=Y.getParameters(e,a.state,i,t,n),c=Y.getProgramCacheKey(s),u=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=J.get(e.envMap||r.environment),void 0===u&&(e.addEventListener("dispose",ge),u=new Map,r.programs=u);var l=u.get(c);if(void 0!==l){if(r.currentProgram===l&&r.lightsStateVersion===o)return Se(e,s),l}else s.uniforms=Y.getUniforms(e),e.onBeforeCompile(s,m),l=Y.acquireProgram(s,c),u.set(c,l),r.uniforms=s.uniforms;var d=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(d.clippingPlanes=ee.uniform),Se(e,s),r.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),r.lightsStateVersion=o,r.needsLights&&(d.ambientLightColor.value=a.state.ambient,d.lightProbe.value=a.state.probe,d.directionalLights.value=a.state.directional,d.directionalLightShadows.value=a.state.directionalShadow,d.spotLights.value=a.state.spot,d.spotLightShadows.value=a.state.spotShadow,d.rectAreaLights.value=a.state.rectArea,d.ltc_1.value=a.state.rectAreaLTC1,d.ltc_2.value=a.state.rectAreaLTC2,d.pointLights.value=a.state.point,d.pointLightShadows.value=a.state.pointShadow,d.hemisphereLights.value=a.state.hemi,d.directionalShadowMap.value=a.state.directionalShadowMap,d.directionalShadowMatrix.value=a.state.directionalShadowMatrix,d.spotShadowMap.value=a.state.spotShadowMap,d.spotShadowMatrix.value=a.state.spotShadowMatrix,d.pointShadowMap.value=a.state.pointShadowMap,d.pointShadowMatrix.value=a.state.pointShadowMatrix);var f=l.getUniforms(),p=ms.seqWithValue(f.seq,d);return r.currentProgram=l,r.uniformsList=p,l}function Se(e,t){var n=V.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas}function Ce(e,t,n,r){!0!==t.isScene&&(t=P),W.resetTextureUnits();var a=t.fog,i=n.isMeshStandardMaterial?t.environment:null,o=null===y?m.outputEncoding:y.texture.encoding,s=J.get(n.envMap||i),c=!0===n.vertexColors&&r.geometry.attributes.color&&4===r.geometry.attributes.color.itemSize,u=V.get(n),l=h.state.lights;if(!0===B&&(!0===L||e!==w)){var d=e===w&&n.id===x;ee.setState(n,e,d)}var f=!1;n.version===u.__version?u.needsLights&&u.lightsStateVersion!==l.state.version||u.outputEncoding!==o||r.isInstancedMesh&&!1===u.instancing?f=!0:r.isInstancedMesh||!0!==u.instancing?u.envMap!==s||n.fog&&u.fog!==a?f=!0:void 0===u.numClippingPlanes||u.numClippingPlanes===ee.numPlanes&&u.numIntersection===ee.numIntersection?u.vertexAlphas!==c&&(f=!0):f=!0:f=!0:(f=!0,u.__version=n.version);var p=u.currentProgram;!0===f&&(p=Ee(n,t,r));var v,g,b=!1,O=!1,A=!1,_=p.getUniforms(),E=u.uniforms;if(z.useProgram(p.program)&&(b=!0,O=!0,A=!0),n.id!==x&&(x=n.id,O=!0),b||w!==e){if(_.setValue(ce,"projectionMatrix",e.projectionMatrix),U.logarithmicDepthBuffer&&_.setValue(ce,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),w!==e&&(w=e,O=!0,A=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var T=_.map.cameraPosition;void 0!==T&&T.setValue(ce,D.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&_.setValue(ce,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&_.setValue(ce,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){_.setOptional(ce,r,"bindMatrix"),_.setOptional(ce,r,"bindMatrixInverse");var M=r.skeleton;if(M){var k=M.bones;if(U.floatVertexTextures){if(null===M.boneTexture){var R=Math.sqrt(4*k.length);R=tr.ceilPowerOfTwo(R),R=Math.max(R,4);var I=new Float32Array(R*R*4);I.set(M.boneMatrices);var j=new Ui(I,R,R,$e,We);M.boneMatrices=I,M.boneTexture=j,M.boneTextureSize=R}_.setValue(ce,"boneTexture",M.boneTexture,W),_.setValue(ce,"boneTextureSize",M.boneTextureSize)}else _.setOptional(ce,M,"boneMatrices")}}return(O||u.receiveShadow!==r.receiveShadow)&&(u.receiveShadow=r.receiveShadow,_.setValue(ce,"receiveShadow",r.receiveShadow)),O&&(_.setValue(ce,"toneMappingExposure",m.toneMappingExposure),u.needsLights&&(g=A,(v=E).ambientLightColor.needsUpdate=g,v.lightProbe.needsUpdate=g,v.directionalLights.needsUpdate=g,v.directionalLightShadows.needsUpdate=g,v.pointLights.needsUpdate=g,v.pointLightShadows.needsUpdate=g,v.spotLights.needsUpdate=g,v.spotLightShadows.needsUpdate=g,v.rectAreaLights.needsUpdate=g,v.hemisphereLights.needsUpdate=g),a&&n.fog&&Q.refreshFogUniforms(E,a),Q.refreshMaterialUniforms(E,n,C,S),ms.upload(ce,u.uniformsList,E,W)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(ms.upload(ce,u.uniformsList,E,W),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&_.setValue(ce,"center",r.center),_.setValue(ce,"modelViewMatrix",r.modelViewMatrix),_.setValue(ce,"normalMatrix",r.normalMatrix),_.setValue(ce,"modelMatrix",r.matrixWorld),p}we.setAnimationLoop((function(e){be&&be(e)})),"undefined"!==typeof window&&we.setContext(window),this.setAnimationLoop=function(e){be=e,pe.setAnimationLoop(e),null===e?we.stop():we.start()},pe.addEventListener("sessionstart",ye),pe.addEventListener("sessionend",xe),this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0===t||!0===t.isCamera){if(!0!==v){!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===pe.enabled&&!0===pe.isPresenting&&(t=pe.getCamera(t)),!0===e.isScene&&e.onBeforeRender(m,e,t,n||y),(h=$.get(e,p.length)).init(),p.push(h),N.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),j.setFromProjectionMatrix(N),L=this.localClippingEnabled,B=ee.init(this.clippingPlanes,L,t),(d=Z.get(e,f.length)).init(),f.push(d),Oe(e,t,0,m.sortObjects),d.finish(),!0===m.sortObjects&&d.sort(T,M),!0===B&&ee.beginShadows();var a=h.state.shadowsArray;te.render(a,e,t),h.setupLights(),h.setupLightsView(t),!0===B&&ee.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),ne.render(d,e,t,r);var i=d.opaque,o=d.transparent;i.length>0&&Ae(i,e,t),o.length>0&&Ae(o,e,t),null!==y&&(W.updateRenderTargetMipmap(y),W.updateMultisampleRenderTarget(y)),!0===e.isScene&&e.onAfterRender(m,e,t),z.buffers.depth.setTest(!0),z.buffers.depth.setMask(!0),z.buffers.color.setMask(!0),z.setPolygonOffset(!1),se.resetDefaultState(),x=-1,w=null,p.pop(),h=p.length>0?p[p.length-1]:null,f.pop(),d=f.length>0?f[f.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return g},this.getActiveMipmapLevel=function(){return b},this.getRenderTarget=function(){return y},this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;y=e,g=t,b=n,e&&void 0===V.get(e).__webglFramebuffer&&W.setupRenderTarget(e);var r=null,a=!1,i=!1;if(e){var o=e.texture;(o.isDataTexture3D||o.isDataTexture2DArray)&&(i=!0);var s=V.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=s[t],a=!0):r=e.isWebGLMultisampleRenderTarget?V.get(e).__webglMultisampledFramebuffer:s,O.copy(e.viewport),A.copy(e.scissor),_=e.scissorTest}else O.copy(k).multiplyScalar(C).floor(),A.copy(R).multiplyScalar(C).floor(),_=I;if(z.bindFramebuffer(36160,r),z.viewport(O),z.scissor(A),z.setScissorTest(_),a){var c=V.get(e.texture);ce.framebufferTexture2D(36160,36064,34069+t,c.__webglTexture,n)}else if(i){var u=V.get(e.texture),l=t||0;ce.framebufferTextureLayer(36160,36064,u.__webglTexture,n||0,l)}},this.readRenderTargetPixels=function(e,t,n,r,a,i,o){if(e&&e.isWebGLRenderTarget){var s=V.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){z.bindFramebuffer(36160,s);try{var c=e.texture,u=c.format,l=c.type;if(u!==$e&&oe.convert(u)!==ce.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var d=l===Je&&(G.has("EXT_color_buffer_half_float")||U.isWebGL2&&G.has("EXT_color_buffer_float"));if(l!==Fe&&oe.convert(l)!==ce.getParameter(35738)&&(l!==We||!(U.isWebGL2||G.has("OES_texture_float")||G.has("WEBGL_color_buffer_float")))&&!d)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===ce.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-a&&ce.readPixels(t,n,r,a,oe.convert(u),oe.convert(l),i):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{var h=null!==y?V.get(y).__webglFramebuffer:null;z.bindFramebuffer(36160,h)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),a=Math.floor(t.image.width*r),i=Math.floor(t.image.height*r),o=oe.convert(t.format);W.setTexture2D(t,0),ce.copyTexImage2D(3553,n,o,e.x,e.y,a,i,0),z.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=t.image.width,i=t.image.height,o=oe.convert(n.format),s=oe.convert(n.type);W.setTexture2D(n,0),ce.pixelStorei(37440,n.flipY),ce.pixelStorei(37441,n.premultiplyAlpha),ce.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?ce.texSubImage2D(3553,r,e.x,e.y,a,i,o,s,t.image.data):t.isCompressedTexture?ce.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):ce.texSubImage2D(3553,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&ce.generateMipmap(3553),z.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(m.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var i,o=n.image,s=o.width,c=o.height,u=o.data,l=oe.convert(r.format),d=oe.convert(r.type);if(r.isDataTexture3D)W.setTexture3D(r,0),i=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");W.setTexture2DArray(r,0),i=35866}ce.pixelStorei(37440,r.flipY),ce.pixelStorei(37441,r.premultiplyAlpha),ce.pixelStorei(3317,r.unpackAlignment);var h=ce.getParameter(3314),f=ce.getParameter(32878),p=ce.getParameter(3316),v=ce.getParameter(3315),g=ce.getParameter(32877);ce.pixelStorei(3314,s),ce.pixelStorei(32878,c),ce.pixelStorei(3316,e.min.x),ce.pixelStorei(3315,e.min.y),ce.pixelStorei(32877,e.min.z),ce.texSubImage3D(i,a,t.x,t.y,t.z,e.max.x-e.min.x+1,e.max.y-e.min.y+1,e.max.z-e.min.z+1,l,d,u),ce.pixelStorei(3314,h),ce.pixelStorei(32878,f),ce.pixelStorei(3316,p),ce.pixelStorei(3315,v),ce.pixelStorei(32877,g),0===a&&r.generateMipmaps&&ce.generateMipmap(i),z.unbindTexture()}},this.initTexture=function(e){W.setTexture2D(e,0),z.unbindTexture()},this.resetState=function(){g=0,b=0,y=null,z.reset(),se.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}tc.prototype.isGroup=!0,Object.assign(nc.prototype,{constructor:nc,getHandSpace:function(){return null===this._hand&&(this._hand=new tc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new tc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new tc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(e,t,n){var r=null,a=null,i=null,o=this._targetRay,c=this._grip,u=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==o&&null!==(r=t.getPose(e.targetRaySpace,n))&&(o.matrix.fromArray(r.transform.matrix),o.matrix.decompose(o.position,o.rotation,o.scale)),u&&e.hand){i=!0;var l,d=Object(s.a)(e.hand.values());try{for(d.s();!(l=d.n()).done;){var h=l.value,f=t.getJointPose(h,n);if(void 0===u.joints[h.jointName]){var p=new tc;p.matrixAutoUpdate=!1,p.visible=!1,u.joints[h.jointName]=p,u.add(p)}var m=u.joints[h.jointName];null!==f&&(m.matrix.fromArray(f.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.jointRadius=f.radius),m.visible=null!==f}}catch(y){d.e(y)}finally{d.f()}var v=u.joints["index-finger-tip"],g=u.joints["thumb-tip"],b=v.position.distanceTo(g.position);u.inputState.pinching&&b>.025?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!u.inputState.pinching&&b<=.015&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==c&&e.gripSpace&&null!==(a=t.getPose(e.gripSpace,n))&&(c.matrix.fromArray(a.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale));return null!==o&&(o.visible=null!==r),null!==c&&(c.visible=null!==a),null!==u&&(u.visible=null!==i),this}}),Object.assign(rc.prototype,Qn.prototype);var oc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return n}(ic);oc.prototype.isWebGL1Renderer=!0;var sc=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;Object(v.a)(this,e),this.name="",this.color=new Fa(t),this.density=n}return Object(g.a)(e,[{key:"clone",value:function(){return new e(this.color,this.density)}},{key:"toJSON",value:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}]),e}();sc.prototype.isFogExp2=!0;var cc=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;Object(v.a)(this,e),this.name="",this.color=new Fa(t),this.near=n,this.far=r}return Object(g.a)(e,[{key:"clone",value:function(){return new e(this.color,this.near,this.far)}},{key:"toJSON",value:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}]),e}();cc.prototype.isFog=!0;var uc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(v.a)(this,n),(e=t.call(this)).type="Scene",e.background=null,e.environment=null,e.fog=null,e.overrideMaterial=null,e.autoUpdate=!0,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:Object(f.a)(e)})),e}return Object(g.a)(n,[{key:"copy",value:function(e,t){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e,t),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var t=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this,e);return null!==this.background&&(t.object.background=this.background.toJSON(e)),null!==this.environment&&(t.object.environment=this.environment.toJSON(e)),null!==this.fog&&(t.object.fog=this.fog.toJSON()),t}}]),n}(ma);function lc(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=Gn,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=tr.generateUUID()}uc.prototype.isScene=!0,Object.defineProperty(lc.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(lc.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,a=this.stride;r<a;r++)this.array[e+r]=t.array[n+r];return this},set:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this},clone:function(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tr.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var t=new lc(new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),this.stride);return t.setUsage(this.usage),t},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tr.generateUUID()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var dc=new fr;function hc(e,t,n,r){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}Object.defineProperties(hc.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(hc.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)dc.x=this.getX(t),dc.y=this.getY(t),dc.z=this.getZ(t),dc.applyMatrix4(e),this.setXYZ(t,dc.x,dc.y,dc.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)dc.x=this.getX(t),dc.y=this.getY(t),dc.z=this.getZ(t),dc.applyNormalMatrix(e),this.setXYZ(t,dc.x,dc.y,dc.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)dc.x=this.getX(t),dc.y=this.getY(t),dc.z=this.getZ(t),dc.transformDirection(e),this.setXYZ(t,dc.x,dc.y,dc.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,a){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=a,this},clone:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,a=0;a<this.itemSize;a++)t.push(this.data.array[r+a]);return new Ha(new this.array.constructor(t),this.itemSize,this.normalized)}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.clone(e)),new hc(e.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(e){if(void 0===e){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var t=[],n=0;n<this.count;n++)for(var r=n*this.data.stride+this.offset,a=0;a<this.itemSize;a++)t.push(this.data.array[r+a]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});var fc,pc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="SpriteMaterial",r.color=new Fa(16777215),r.map=null,r.alphaMap=null,r.rotation=0,r.sizeAttenuation=!0,r.transparent=!0,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this}}]),n}(Ia);pc.prototype.isSpriteMaterial=!0;var mc=new fr,vc=new fr,gc=new fr,bc=new nr,yc=new nr,xc=new Vr,wc=new fr,Oc=new fr,Ac=new fr,_c=new nr,Ec=new nr,Sc=new nr,Cc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;if(Object(v.a)(this,n),(r=t.call(this)).type="Sprite",void 0===fc){fc=new li;var a=new lc(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);fc.setIndex([0,1,2,0,2,3]),fc.setAttribute("position",new hc(a,3,0,!1)),fc.setAttribute("uv",new hc(a,2,3,!1))}return r.geometry=fc,r.material=void 0!==e?e:new pc,r.center=new nr(.5,.5),r}return Object(g.a)(n,[{key:"raycast",value:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),vc.setFromMatrixScale(this.matrixWorld),xc.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),gc.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&vc.multiplyScalar(-gc.z);var n,r,a=this.material.rotation;0!==a&&(r=Math.cos(a),n=Math.sin(a));var i=this.center;Tc(wc.set(-.5,-.5,0),gc,i,vc,n,r),Tc(Oc.set(.5,-.5,0),gc,i,vc,n,r),Tc(Ac.set(.5,.5,0),gc,i,vc,n,r),_c.set(0,0),Ec.set(1,0),Sc.set(1,1);var o=e.ray.intersectTriangle(wc,Oc,Ac,!1,mc);if(null!==o||(Tc(Oc.set(-.5,.5,0),gc,i,vc,n,r),Ec.set(0,1),null!==(o=e.ray.intersectTriangle(wc,Ac,Oc,!1,mc)))){var s=e.ray.origin.distanceTo(mc);s<e.near||s>e.far||t.push({distance:s,point:mc.clone(),uv:ka.getUV(mc,wc,Oc,Ac,_c,Ec,Sc,new nr),face:null,object:this})}}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}}]),n}(ma);function Tc(e,t,n,r,a,i){bc.subVectors(e,n).addScalar(.5).multiply(r),void 0!==a?(yc.x=i*bc.x-a*bc.y,yc.y=a*bc.x+i*bc.y):yc.copy(bc),e.copy(t),e.x+=yc.x,e.y+=yc.y,e.applyMatrix4(xc)}Cc.prototype.isSprite=!0;var Mc=new fr,kc=new fr,Rc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(v.a)(this,n),(e=t.call(this))._currentLevel=0,e.type="LOD",Object.defineProperties(Object(f.a)(e),{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),e.autoUpdate=!0,e}return Object(g.a)(n,[{key:"copy",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e,!1);for(var t=e.levels,r=0,a=t.length;r<a;r++){var i=t[r];this.addLevel(i.object.clone(),i.distance)}return this.autoUpdate=e.autoUpdate,this}},{key:"addLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t=Math.abs(t);var n,r=this.levels;for(n=0;n<r.length&&!(t<r[n].distance);n++);return r.splice(n,0,{distance:t,object:e}),this.add(e),this}},{key:"getCurrentLevel",value:function(){return this._currentLevel}},{key:"getObjectForDistance",value:function(e){var t=this.levels;if(t.length>0){var n,r;for(n=1,r=t.length;n<r&&!(e<t[n].distance);n++);return t[n-1].object}return null}},{key:"raycast",value:function(e,t){if(this.levels.length>0){Mc.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(Mc);this.getObjectForDistance(n).raycast(e,t)}}},{key:"update",value:function(e){var t=this.levels;if(t.length>1){Mc.setFromMatrixPosition(e.matrixWorld),kc.setFromMatrixPosition(this.matrixWorld);var n,r,a=Mc.distanceTo(kc)/e.zoom;for(t[0].object.visible=!0,n=1,r=t.length;n<r&&a>=t[n].distance;n++)t[n-1].object.visible=!1,t[n].object.visible=!0;for(this._currentLevel=n-1;n<r;n++)t[n].object.visible=!1}}},{key:"toJSON",value:function(e){var t=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this,e);!1===this.autoUpdate&&(t.object.autoUpdate=!1),t.object.levels=[];for(var r=this.levels,a=0,i=r.length;a<i;a++){var o=r[a];t.object.levels.push({object:o.object.uuid,distance:o.distance})}return t}}]),n}(ma),Ic=new fr,jc=new ur,Bc=new ur,Lc=new fr,Nc=new Vr;function Dc(e,t){Ti.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Vr,this.bindMatrixInverse=new Vr}function Pc(){ma.call(this),this.type="Bone"}Dc.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Dc,isSkinnedMesh:!0,copy:function(e){return Ti.prototype.copy.call(this,e),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new ur,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var a=1/e.manhattanLength();a!==1/0?e.multiplyScalar(a):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Ti.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(e,t){var n=this.skeleton,r=this.geometry;jc.fromBufferAttribute(r.attributes.skinIndex,e),Bc.fromBufferAttribute(r.attributes.skinWeight,e),Ic.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var a=0;a<4;a++){var i=Bc.getComponent(a);if(0!==i){var o=jc.getComponent(a);Nc.multiplyMatrices(n.bones[o].matrixWorld,n.boneInverses[o]),t.addScaledVector(Lc.copy(Ic).applyMatrix4(Nc),i)}}return t.applyMatrix4(this.bindMatrixInverse)}}),Pc.prototype=Object.assign(Object.create(ma.prototype),{constructor:Pc,isBone:!0});var Fc=new Vr,Gc=new Vr,Uc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(v.a)(this,e),this.uuid=tr.generateUUID(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}return Object(g.a)(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new Vr)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new Vr;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,a=this.bones.length;r<a;r++){var i=this.bones[r];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,a=0,i=e.length;a<i;a++){var o=e[a]?e[a].matrixWorld:Gc;Fc.multiplyMatrices(o,t[a]),Fc.toArray(n,16*a)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var a=e.bones[n],i=t[a];void 0===i&&(console.warn("THREE.Skeleton: No bone found with UUID:",a),i=new Pc),this.bones.push(i),this.boneInverses.push((new Vr).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var e={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;for(var t=this.bones,n=this.boneInverses,r=0,a=t.length;r<a;r++){var i=t[r];e.bones.push(i.uuid);var o=n[r];e.boneInverses.push(o.toArray())}return e}}]),e}(),zc=new Vr,Hc=new Vr,Vc=[],Wc=new Ti;function Jc(e,t,n){Ti.call(this,e,t),this.instanceMatrix=new Ha(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}Jc.prototype=Object.assign(Object.create(Ti.prototype),{constructor:Jc,isInstancedMesh:!0,copy:function(e){return Ti.prototype.copy.call(this,e),this.instanceMatrix.copy(e.instanceMatrix),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,this},getColorAt:function(e,t){t.fromArray(this.instanceColor.array,3*e)},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,r=this.count;if(Wc.geometry=this.geometry,Wc.material=this.material,void 0!==Wc.material)for(var a=0;a<r;a++){this.getMatrixAt(a,zc),Hc.multiplyMatrices(n,zc),Wc.matrixWorld=Hc,Wc.raycast(e,Vc);for(var i=0,o=Vc.length;i<o;i++){var s=Vc[i];s.instanceId=a,s.object=this,t.push(s)}Vc.length=0}},setColorAt:function(e,t){null===this.instanceColor&&(this.instanceColor=new Ha(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Xc=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="LineBasicMaterial",r.color=new Fa(16777215),r.linewidth=1,r.linecap="round",r.linejoin="round",r.morphTargets=!1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this}}]),n}(Ia);Xc.prototype.isLineBasicMaterial=!0;var Kc=new fr,qc=new fr,Yc=new Vr,Qc=new Hr,Zc=new Lr;function $c(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new li,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Xc;ma.call(this),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}$c.prototype=Object.assign(Object.create(ma.prototype),{constructor:$c,isLine:!0,copy:function(e){return ma.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,a=t.count;r<a;r++)Kc.fromBufferAttribute(t,r-1),qc.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=Kc.distanceTo(qc);e.setAttribute("lineDistance",new Za(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,a=e.params.Line.threshold,i=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Zc.copy(n.boundingSphere),Zc.applyMatrix4(r),Zc.radius+=a,!1!==e.ray.intersectsSphere(Zc)){Yc.copy(r).invert(),Qc.copy(e.ray).applyMatrix4(Yc);var o=a/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o,c=new fr,u=new fr,l=new fr,d=new fr,h=this.isLineSegments?2:1;if(n.isBufferGeometry){var f=n.index,p=n.attributes.position;if(null!==f)for(var m=Math.max(0,i.start),v=Math.min(f.count,i.start+i.count)-1;m<v;m+=h){var g=f.getX(m),b=f.getX(m+1);if(c.fromBufferAttribute(p,g),u.fromBufferAttribute(p,b),!(Qc.distanceSqToSegment(c,u,d,l)>s)){d.applyMatrix4(this.matrixWorld);var y=e.ray.origin.distanceTo(d);y<e.near||y>e.far||t.push({distance:y,point:l.clone().applyMatrix4(this.matrixWorld),index:m,face:null,faceIndex:null,object:this})}}else for(var x=Math.max(0,i.start),w=Math.min(p.count,i.start+i.count)-1;x<w;x+=h){if(c.fromBufferAttribute(p,x),u.fromBufferAttribute(p,x+1),!(Qc.distanceSqToSegment(c,u,d,l)>s)){d.applyMatrix4(this.matrixWorld);var O=e.ray.origin.distanceTo(d);O<e.near||O>e.far||t.push({distance:O,point:l.clone().applyMatrix4(this.matrixWorld),index:x,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var a=0,i=r.length;a<i;a++){var o=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var eu=new fr,tu=new fr;function nu(e,t){$c.call(this,e,t),this.type="LineSegments"}nu.prototype=Object.assign(Object.create($c.prototype),{constructor:nu,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,a=t.count;r<a;r+=2)eu.fromBufferAttribute(t,r),tu.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+eu.distanceTo(tu);e.setAttribute("lineDistance",new Za(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});var ru=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a;return Object(v.a)(this,n),(a=t.call(this,e,r)).type="LineLoop",a}return n}($c);ru.prototype.isLineLoop=!0;var au=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="PointsMaterial",r.color=new Fa(16777215),r.map=null,r.alphaMap=null,r.size=1,r.sizeAttenuation=!0,r.morphTargets=!1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this}}]),n}(Ia);au.prototype.isPointsMaterial=!0;var iu=new Vr,ou=new Hr,su=new Lr,cu=new fr;function uu(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new li,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new au;ma.call(this),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}function lu(e,t,n,r,a,i,o){var s=ou.distanceSqToPoint(e);if(s<n){var c=new fr;ou.closestPointToPoint(e,c),c.applyMatrix4(r);var u=a.ray.origin.distanceTo(c);if(u<a.near||u>a.far)return;i.push({distance:u,distanceToRay:Math.sqrt(s),point:c,index:t,face:null,object:o})}}uu.prototype=Object.assign(Object.create(ma.prototype),{constructor:uu,isPoints:!0,copy:function(e){return ma.prototype.copy.call(this,e),this.material=e.material,this.geometry=e.geometry,this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,a=e.params.Points.threshold,i=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),su.copy(n.boundingSphere),su.applyMatrix4(r),su.radius+=a,!1!==e.ray.intersectsSphere(su)){iu.copy(r).invert(),ou.copy(e.ray).applyMatrix4(iu);var o=a/((this.scale.x+this.scale.y+this.scale.z)/3),s=o*o;if(n.isBufferGeometry){var c=n.index,u=n.attributes.position;if(null!==c)for(var l=Math.max(0,i.start),d=Math.min(c.count,i.start+i.count);l<d;l++){var h=c.getX(l);cu.fromBufferAttribute(u,h),lu(cu,h,s,r,e,t,this)}else for(var f=Math.max(0,i.start),p=Math.min(u.count,i.start+i.count);f<p;f++)cu.fromBufferAttribute(u,f),lu(cu,f,s,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var a=0,i=r.length;a<i;a++){var o=r[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[o]=a}}}}else{var s=e.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var du=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a,i,o,s,c,u,l){var d;Object(v.a)(this,n),(d=t.call(this,e,r,a,i,o,s,c,u,l)).format=void 0!==c?c:Ze,d.minFilter=void 0!==s?s:Be,d.magFilter=void 0!==o?o:Be,d.generateMipmaps=!1;var h=Object(f.a)(d);return"requestVideoFrameCallback"in e&&e.requestVideoFrameCallback((function t(){h.needsUpdate=!0,e.requestVideoFrameCallback(t)})),d}return Object(g.a)(n,[{key:"clone",value:function(){return new this.constructor(this.image).copy(this)}},{key:"update",value:function(){var e=this.image;!1==="requestVideoFrameCallback"in e&&e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}]),n}(sr);du.prototype.isVideoTexture=!0;var hu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a,i,o,s,c,u,l,d,h,f){var p;return Object(v.a)(this,n),(p=t.call(this,null,s,c,u,l,d,i,o,h,f)).image={width:r,height:a},p.mipmaps=e,p.flipY=!1,p.generateMipmaps=!1,p}return n}(sr);hu.prototype.isCompressedTexture=!0;var fu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a,i,o,s,c,u,l){var d;return Object(v.a)(this,n),(d=t.call(this,e,r,a,i,o,s,c,u,l)).needsUpdate=!0,d}return n}(sr);fu.prototype.isCanvasTexture=!0;var pu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a,i,o,s,c,u,l,d){var h;if(Object(v.a)(this,n),(d=void 0!==d?d:rt)!==rt&&d!==at)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===a&&d===rt&&(a=ze),void 0===a&&d===at&&(a=Ye),(h=t.call(this,null,i,o,s,c,u,d,a,l)).image={width:e,height:r},h.magFilter=void 0!==c?c:Me,h.minFilter=void 0!==u?u:Me,h.flipY=!1,h.generateMipmaps=!1,h}return n}(sr);pu.prototype.isDepthTexture=!0;var mu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;Object(v.a)(this,n),(e=t.call(this)).type="CircleGeometry",e.parameters={radius:r,segments:a,thetaStart:i,thetaLength:o},a=Math.max(3,a);var s=[],c=[],u=[],l=[],d=new fr,h=new nr;c.push(0,0,0),u.push(0,0,1),l.push(.5,.5);for(var f=0,p=3;f<=a;f++,p+=3){var m=i+f/a*o;d.x=r*Math.cos(m),d.y=r*Math.sin(m),c.push(d.x,d.y,d.z),u.push(0,0,1),h.x=(c[p]/r+1)/2,h.y=(c[p+1]/r+1)/2,l.push(h.x,h.y)}for(var g=1;g<=a;g++)s.push(g,g+1,0);return e.setIndex(s),e.setAttribute("position",new Za(c,3)),e.setAttribute("normal",new Za(u,3)),e.setAttribute("uv",new Za(l,2)),e}return n}(li),vu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,c=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:2*Math.PI;Object(v.a)(this,n),(e=t.call(this)).type="CylinderGeometry",e.parameters={radiusTop:r,radiusBottom:a,height:i,radialSegments:o,heightSegments:s,openEnded:c,thetaStart:u,thetaLength:l};var d=Object(f.a)(e);o=Math.floor(o),s=Math.floor(s);var h=[],p=[],m=[],g=[],b=0,y=[],x=i/2,w=0;function O(){for(var e=new fr,t=new fr,n=0,c=(a-r)/i,f=0;f<=s;f++){for(var v=[],O=f/s,A=O*(a-r)+r,_=0;_<=o;_++){var E=_/o,S=E*l+u,C=Math.sin(S),T=Math.cos(S);t.x=A*C,t.y=-O*i+x,t.z=A*T,p.push(t.x,t.y,t.z),e.set(C,c,T).normalize(),m.push(e.x,e.y,e.z),g.push(E,1-O),v.push(b++)}y.push(v)}for(var M=0;M<o;M++)for(var k=0;k<s;k++){var R=y[k][M],I=y[k+1][M],j=y[k+1][M+1],B=y[k][M+1];h.push(R,I,B),h.push(I,j,B),n+=6}d.addGroup(w,n,0),w+=n}function A(e){for(var t=b,n=new nr,i=new fr,s=0,c=!0===e?r:a,f=!0===e?1:-1,v=1;v<=o;v++)p.push(0,x*f,0),m.push(0,f,0),g.push(.5,.5),b++;for(var y=b,O=0;O<=o;O++){var A=O/o*l+u,_=Math.cos(A),E=Math.sin(A);i.x=c*E,i.y=x*f,i.z=c*_,p.push(i.x,i.y,i.z),m.push(0,f,0),n.x=.5*_+.5,n.y=.5*E*f+.5,g.push(n.x,n.y),b++}for(var S=0;S<o;S++){var C=t+S,T=y+S;!0===e?h.push(T,T+1,C):h.push(T+1,T,C),s+=3}d.addGroup(w,s,!0===e?1:2),w+=s}return O(),!1===c&&(r>0&&A(!0),a>0&&A(!1)),e.setIndex(h),e.setAttribute("position",new Za(p,3)),e.setAttribute("normal",new Za(m,3)),e.setAttribute("uv",new Za(g,2)),e}return n}(li),gu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2*Math.PI;return Object(v.a)(this,n),(e=t.call(this,0,r,a,i,o,s,c,u)).type="ConeGeometry",e.parameters={radius:r,height:a,radialSegments:i,heightSegments:o,openEnded:s,thetaStart:c,thetaLength:u},e}return n}(vu),bu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(v.a)(this,n),(a=t.call(this)).type="PolyhedronGeometry",a.parameters={vertices:e,indices:r,radius:i,detail:o};var s=[],c=[];function u(e){for(var t=new fr,n=new fr,a=new fr,i=0;i<r.length;i+=3)m(r[i+0],t),m(r[i+1],n),m(r[i+2],a),l(t,n,a,e)}function l(e,t,n,r){for(var a=r+1,i=[],o=0;o<=a;o++){i[o]=[];for(var s=e.clone().lerp(n,o/a),c=t.clone().lerp(n,o/a),u=a-o,l=0;l<=u;l++)i[o][l]=0===l&&o===a?s:s.clone().lerp(c,l/u)}for(var d=0;d<a;d++)for(var h=0;h<2*(a-d)-1;h++){var f=Math.floor(h/2);h%2===0?(p(i[d][f+1]),p(i[d+1][f]),p(i[d][f])):(p(i[d][f+1]),p(i[d+1][f+1]),p(i[d+1][f]))}}function d(e){for(var t=new fr,n=0;n<s.length;n+=3)t.x=s[n+0],t.y=s[n+1],t.z=s[n+2],t.normalize().multiplyScalar(e),s[n+0]=t.x,s[n+1]=t.y,s[n+2]=t.z}function h(){for(var e=new fr,t=0;t<s.length;t+=3){e.x=s[t+0],e.y=s[t+1],e.z=s[t+2];var n=y(e)/2/Math.PI+.5,r=x(e)/Math.PI+.5;c.push(n,1-r)}g(),f()}function f(){for(var e=0;e<c.length;e+=6){var t=c[e+0],n=c[e+2],r=c[e+4],a=Math.max(t,n,r),i=Math.min(t,n,r);a>.9&&i<.1&&(t<.2&&(c[e+0]+=1),n<.2&&(c[e+2]+=1),r<.2&&(c[e+4]+=1))}}function p(e){s.push(e.x,e.y,e.z)}function m(t,n){var r=3*t;n.x=e[r+0],n.y=e[r+1],n.z=e[r+2]}function g(){for(var e=new fr,t=new fr,n=new fr,r=new fr,a=new nr,i=new nr,o=new nr,u=0,l=0;u<s.length;u+=9,l+=6){e.set(s[u+0],s[u+1],s[u+2]),t.set(s[u+3],s[u+4],s[u+5]),n.set(s[u+6],s[u+7],s[u+8]),a.set(c[l+0],c[l+1]),i.set(c[l+2],c[l+3]),o.set(c[l+4],c[l+5]),r.copy(e).add(t).add(n).divideScalar(3);var d=y(r);b(a,l+0,e,d),b(i,l+2,t,d),b(o,l+4,n,d)}}function b(e,t,n,r){r<0&&1===e.x&&(c[t]=e.x-1),0===n.x&&0===n.z&&(c[t]=r/2/Math.PI+.5)}function y(e){return Math.atan2(e.z,-e.x)}function x(e){return Math.atan2(-e.y,Math.sqrt(e.x*e.x+e.z*e.z))}return u(o),d(i),h(),a.setAttribute("position",new Za(s,3)),a.setAttribute("normal",new Za(s.slice(),3)),a.setAttribute("uv",new Za(c,2)),0===o?a.computeVertexNormals():a.normalizeNormals(),a}return n}(li),yu=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(v.a)(this,n);var i=(1+Math.sqrt(5))/2,o=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-i,0,-o,i,0,o,-i,0,o,i,-o,-i,0,-o,i,0,o,-i,0,o,i,0,-i,0,-o,i,0,-o,-i,0,o,i,0,o],c=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];return(e=t.call(this,s,c,r,a)).type="DodecahedronGeometry",e.parameters={radius:r,detail:a},e}return n}(bu),xu=new fr,wu=new fr,Ou=new fr,Au=new ka,_u=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a;if(Object(v.a)(this,n),(a=t.call(this)).type="EdgesGeometry",a.parameters={thresholdAngle:r},r=void 0!==r?r:1,!0===e.isGeometry)return console.error("THREE.EdgesGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Object(l.a)(a);for(var i=Math.pow(10,4),o=Math.cos(tr.DEG2RAD*r),s=e.getIndex(),c=e.getAttribute("position"),u=s?s.count:c.count,d=[0,0,0],h=["a","b","c"],f=new Array(3),p={},m=[],g=0;g<u;g+=3){s?(d[0]=s.getX(g),d[1]=s.getX(g+1),d[2]=s.getX(g+2)):(d[0]=g,d[1]=g+1,d[2]=g+2);var b=Au.a,y=Au.b,x=Au.c;if(b.fromBufferAttribute(c,d[0]),y.fromBufferAttribute(c,d[1]),x.fromBufferAttribute(c,d[2]),Au.getNormal(Ou),f[0]="".concat(Math.round(b.x*i),",").concat(Math.round(b.y*i),",").concat(Math.round(b.z*i)),f[1]="".concat(Math.round(y.x*i),",").concat(Math.round(y.y*i),",").concat(Math.round(y.z*i)),f[2]="".concat(Math.round(x.x*i),",").concat(Math.round(x.y*i),",").concat(Math.round(x.z*i)),f[0]!==f[1]&&f[1]!==f[2]&&f[2]!==f[0])for(var w=0;w<3;w++){var O=(w+1)%3,A=f[w],_=f[O],E=Au[h[w]],S=Au[h[O]],C="".concat(A,"_").concat(_),T="".concat(_,"_").concat(A);T in p&&p[T]?(Ou.dot(p[T].normal)<=o&&(m.push(E.x,E.y,E.z),m.push(S.x,S.y,S.z)),p[T]=null):C in p||(p[C]={index0:d[w],index1:d[O],normal:Ou.clone()})}}for(var M in p)if(p[M]){var k=p[M],R=k.index0,I=k.index1;xu.fromBufferAttribute(c,R),wu.fromBufferAttribute(c,I),m.push(xu.x,xu.y,xu.z),m.push(wu.x,wu.y,wu.z)}return a.setAttribute("position",new Za(m,3)),a}return n}(li),Eu=function(e,t,n){n=n||2;var r,a,i,o,s,c,u,l=t&&t.length,d=l?t[0]*n:e.length,h=Su(e,0,d,n,!0),f=[];if(!h||h.next===h.prev)return f;if(l&&(h=function(e,t,n,r){var a,i,o,s=[];for(a=0,i=t.length;a<i;a++)(o=Su(e,t[a]*r,a<i-1?t[a+1]*r:e.length,r,!1))===o.next&&(o.steiner=!0),s.push(Du(o));for(s.sort(ju),a=0;a<s.length;a++)Bu(s[a],n),n=Cu(n,n.next);return n}(e,t,h,n)),e.length>80*n){r=i=e[0],a=o=e[1];for(var p=n;p<d;p+=n)(s=e[p])<r&&(r=s),(c=e[p+1])<a&&(a=c),s>i&&(i=s),c>o&&(o=c);u=0!==(u=Math.max(i-r,o-a))?1/u:0}return Tu(h,f,n,r,a,u),f};function Su(e,t,n,r,a){var i,o;if(a===function(e,t,n,r){for(var a=0,i=t,o=n-r;i<n;i+=r)a+=(e[o]-e[i])*(e[i+1]+e[o+1]),o=i;return a}(e,t,n,r)>0)for(i=t;i<n;i+=r)o=Xu(i,e[i],e[i+1],o);else for(i=n-r;i>=t;i-=r)o=Xu(i,e[i],e[i+1],o);return o&&Uu(o,o.next)&&(Ku(o),o=o.next),o}function Cu(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!Uu(r,r.next)&&0!==Gu(r.prev,r,r.next))r=r.next;else{if(Ku(r),(r=t=r.prev)===r.next)break;n=!0}}while(n||r!==t);return t}function Tu(e,t,n,r,a,i,o){if(e){!o&&i&&function(e,t,n,r){var a=e;do{null===a.z&&(a.z=Nu(a.x,a.y,t,n,r)),a.prevZ=a.prev,a.nextZ=a.next,a=a.next}while(a!==e);a.prevZ.nextZ=null,a.prevZ=null,function(e){var t,n,r,a,i,o,s,c,u=1;do{for(n=e,e=null,i=null,o=0;n;){for(o++,r=n,s=0,t=0;t<u&&(s++,r=r.nextZ);t++);for(c=u;s>0||c>0&&r;)0!==s&&(0===c||!r||n.z<=r.z)?(a=n,n=n.nextZ,s--):(a=r,r=r.nextZ,c--),i?i.nextZ=a:e=a,a.prevZ=i,i=a;n=r}i.nextZ=null,u*=2}while(o>1)}(a)}(e,r,a,i);for(var s,c,u=e;e.prev!==e.next;)if(s=e.prev,c=e.next,i?ku(e,r,a,i):Mu(e))t.push(s.i/n),t.push(e.i/n),t.push(c.i/n),Ku(e),e=c.next,u=c.next;else if((e=c)===u){o?1===o?Tu(e=Ru(Cu(e),t,n),t,n,r,a,i,2):2===o&&Iu(e,t,n,r,a,i):Tu(Cu(e),t,n,r,a,i,1);break}}}function Mu(e){var t=e.prev,n=e,r=e.next;if(Gu(t,n,r)>=0)return!1;for(var a=e.next.next;a!==e.prev;){if(Pu(t.x,t.y,n.x,n.y,r.x,r.y,a.x,a.y)&&Gu(a.prev,a,a.next)>=0)return!1;a=a.next}return!0}function ku(e,t,n,r){var a=e.prev,i=e,o=e.next;if(Gu(a,i,o)>=0)return!1;for(var s=a.x<i.x?a.x<o.x?a.x:o.x:i.x<o.x?i.x:o.x,c=a.y<i.y?a.y<o.y?a.y:o.y:i.y<o.y?i.y:o.y,u=a.x>i.x?a.x>o.x?a.x:o.x:i.x>o.x?i.x:o.x,l=a.y>i.y?a.y>o.y?a.y:o.y:i.y>o.y?i.y:o.y,d=Nu(s,c,t,n,r),h=Nu(u,l,t,n,r),f=e.prevZ,p=e.nextZ;f&&f.z>=d&&p&&p.z<=h;){if(f!==e.prev&&f!==e.next&&Pu(a.x,a.y,i.x,i.y,o.x,o.y,f.x,f.y)&&Gu(f.prev,f,f.next)>=0)return!1;if(f=f.prevZ,p!==e.prev&&p!==e.next&&Pu(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&Gu(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;f&&f.z>=d;){if(f!==e.prev&&f!==e.next&&Pu(a.x,a.y,i.x,i.y,o.x,o.y,f.x,f.y)&&Gu(f.prev,f,f.next)>=0)return!1;f=f.prevZ}for(;p&&p.z<=h;){if(p!==e.prev&&p!==e.next&&Pu(a.x,a.y,i.x,i.y,o.x,o.y,p.x,p.y)&&Gu(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function Ru(e,t,n){var r=e;do{var a=r.prev,i=r.next.next;!Uu(a,i)&&zu(a,r,r.next,i)&&Wu(a,i)&&Wu(i,a)&&(t.push(a.i/n),t.push(r.i/n),t.push(i.i/n),Ku(r),Ku(r.next),r=e=i),r=r.next}while(r!==e);return Cu(r)}function Iu(e,t,n,r,a,i){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Fu(o,s)){var c=Ju(o,s);return o=Cu(o,o.next),c=Cu(c,c.next),Tu(o,t,n,r,a,i),void Tu(c,t,n,r,a,i)}s=s.next}o=o.next}while(o!==e)}function ju(e,t){return e.x-t.x}function Bu(e,t){if(t=function(e,t){var n,r=t,a=e.x,i=e.y,o=-1/0;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=a&&s>o){if(o=s,s===a){if(i===r.y)return r;if(i===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(a===o)return n;var c,u=n,l=n.x,d=n.y,h=1/0;r=n;do{a>=r.x&&r.x>=l&&a!==r.x&&Pu(i<d?a:o,i,l,d,i<d?o:a,i,r.x,r.y)&&(c=Math.abs(i-r.y)/(a-r.x),Wu(r,e)&&(c<h||c===h&&(r.x>n.x||r.x===n.x&&Lu(n,r)))&&(n=r,h=c)),r=r.next}while(r!==u);return n}(e,t)){var n=Ju(t,e);Cu(t,t.next),Cu(n,n.next)}}function Lu(e,t){return Gu(e.prev,e,t.prev)<0&&Gu(t.next,e,e.next)<0}function Nu(e,t,n,r,a){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*a)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*a)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Du(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function Pu(e,t,n,r,a,i,o,s){return(a-o)*(t-s)-(e-o)*(i-s)>=0&&(e-o)*(r-s)-(n-o)*(t-s)>=0&&(n-o)*(i-s)-(a-o)*(r-s)>=0}function Fu(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&zu(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(Wu(e,t)&&Wu(t,e)&&function(e,t){var n=e,r=!1,a=(e.x+t.x)/2,i=(e.y+t.y)/2;do{n.y>i!==n.next.y>i&&n.next.y!==n.y&&a<(n.next.x-n.x)*(i-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(Gu(e.prev,e,t.prev)||Gu(e,t.prev,t))||Uu(e,t)&&Gu(e.prev,e,e.next)>0&&Gu(t.prev,t,t.next)>0)}function Gu(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function Uu(e,t){return e.x===t.x&&e.y===t.y}function zu(e,t,n,r){var a=Vu(Gu(e,t,n)),i=Vu(Gu(e,t,r)),o=Vu(Gu(n,r,e)),s=Vu(Gu(n,r,t));return a!==i&&o!==s||(!(0!==a||!Hu(e,n,t))||(!(0!==i||!Hu(e,r,t))||(!(0!==o||!Hu(n,e,r))||!(0!==s||!Hu(n,t,r)))))}function Hu(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Vu(e){return e>0?1:e<0?-1:0}function Wu(e,t){return Gu(e.prev,e,e.next)<0?Gu(e,t,e.next)>=0&&Gu(e,e.prev,t)>=0:Gu(e,t,e.prev)<0||Gu(e,e.next,t)<0}function Ju(e,t){var n=new qu(e.i,e.x,e.y),r=new qu(t.i,t.x,t.y),a=e.next,i=t.prev;return e.next=t,t.prev=e,n.next=a,a.prev=n,r.next=n,n.prev=r,i.next=r,r.prev=i,r}function Xu(e,t,n,r){var a=new qu(e,t,n);return r?(a.next=r.next,a.prev=r,r.next.prev=a,r.next=a):(a.prev=a,a.next=a),a}function Ku(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function qu(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var Yu={area:function(e){for(var t=e.length,n=0,r=t-1,a=0;a<t;r=a++)n+=e[r].x*e[a].y-e[a].x*e[r].y;return.5*n},isClockWise:function(e){return Yu.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],a=[];Qu(e),Zu(n,e);var i=e.length;t.forEach(Qu);for(var o=0;o<t.length;o++)r.push(i),i+=t[o].length,Zu(n,t[o]);for(var s=Eu(n,r),c=0;c<s.length;c+=3)a.push(s.slice(c,c+3));return a}};function Qu(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function Zu(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var $u=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a;Object(v.a)(this,n),(a=t.call(this)).type="ExtrudeGeometry",a.parameters={shapes:e,options:r},e=Array.isArray(e)?e:[e];for(var i=Object(f.a)(a),o=[],s=[],c=0,u=e.length;c<u;c++){l(e[c])}function l(e){var t=[],n=void 0!==r.curveSegments?r.curveSegments:12,a=void 0!==r.steps?r.steps:1,c=void 0!==r.depth?r.depth:100,u=void 0===r.bevelEnabled||r.bevelEnabled,l=void 0!==r.bevelThickness?r.bevelThickness:6,d=void 0!==r.bevelSize?r.bevelSize:l-2,h=void 0!==r.bevelOffset?r.bevelOffset:0,f=void 0!==r.bevelSegments?r.bevelSegments:3,p=r.extrudePath,m=void 0!==r.UVGenerator?r.UVGenerator:el;void 0!==r.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),c=r.amount);var v,g,b,y,x,w=!1;p&&(v=p.getSpacedPoints(a),w=!0,u=!1,g=p.computeFrenetFrames(a,!1),b=new fr,y=new fr,x=new fr),u||(f=0,l=0,d=0,h=0);var O=e.extractPoints(n),A=O.shape,_=O.holes;if(!Yu.isClockWise(A)){A=A.reverse();for(var E=0,S=_.length;E<S;E++){var C=_[E];Yu.isClockWise(C)&&(_[E]=C.reverse())}}for(var T=Yu.triangulateShape(A,_),M=A,k=0,R=_.length;k<R;k++){var I=_[k];A=A.concat(I)}function j(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var B=A.length,L=T.length;function N(e,t,n){var r,a,i,o=e.x-t.x,s=e.y-t.y,c=n.x-e.x,u=n.y-e.y,l=o*o+s*s,d=o*u-s*c;if(Math.abs(d)>Number.EPSILON){var h=Math.sqrt(l),f=Math.sqrt(c*c+u*u),p=t.x-s/h,m=t.y+o/h,v=((n.x-u/f-p)*u-(n.y+c/f-m)*c)/(o*u-s*c),g=(r=p+o*v-e.x)*r+(a=m+s*v-e.y)*a;if(g<=2)return new nr(r,a);i=Math.sqrt(g/2)}else{var b=!1;o>Number.EPSILON?c>Number.EPSILON&&(b=!0):o<-Number.EPSILON?c<-Number.EPSILON&&(b=!0):Math.sign(s)===Math.sign(u)&&(b=!0),b?(r=-s,a=o,i=Math.sqrt(l)):(r=o,a=s,i=Math.sqrt(l/2))}return new nr(r/i,a/i)}for(var D=[],P=0,F=M.length,G=F-1,U=P+1;P<F;P++,G++,U++)G===F&&(G=0),U===F&&(U=0),D[P]=N(M[P],M[G],M[U]);for(var z,H=[],V=D.concat(),W=0,J=_.length;W<J;W++){var X=_[W];z=[];for(var K=0,q=X.length,Y=q-1,Q=K+1;K<q;K++,Y++,Q++)Y===q&&(Y=0),Q===q&&(Q=0),z[K]=N(X[K],X[Y],X[Q]);H.push(z),V=V.concat(z)}for(var Z=0;Z<f;Z++){for(var $=Z/f,ee=l*Math.cos($*Math.PI/2),te=d*Math.sin($*Math.PI/2)+h,ne=0,re=M.length;ne<re;ne++){var ae=j(M[ne],D[ne],te);Re(ae.x,ae.y,-ee)}for(var ie=0,oe=_.length;ie<oe;ie++){var se=_[ie];z=H[ie];for(var ce=0,ue=se.length;ce<ue;ce++){var le=j(se[ce],z[ce],te);Re(le.x,le.y,-ee)}}}for(var de=d+h,he=0;he<B;he++){var fe=u?j(A[he],V[he],de):A[he];w?(y.copy(g.normals[0]).multiplyScalar(fe.x),b.copy(g.binormals[0]).multiplyScalar(fe.y),x.copy(v[0]).add(y).add(b),Re(x.x,x.y,x.z)):Re(fe.x,fe.y,0)}for(var pe=1;pe<=a;pe++)for(var me=0;me<B;me++){var ve=u?j(A[me],V[me],de):A[me];w?(y.copy(g.normals[pe]).multiplyScalar(ve.x),b.copy(g.binormals[pe]).multiplyScalar(ve.y),x.copy(v[pe]).add(y).add(b),Re(x.x,x.y,x.z)):Re(ve.x,ve.y,c/a*pe)}for(var ge=f-1;ge>=0;ge--){for(var be=ge/f,ye=l*Math.cos(be*Math.PI/2),xe=d*Math.sin(be*Math.PI/2)+h,we=0,Oe=M.length;we<Oe;we++){var Ae=j(M[we],D[we],xe);Re(Ae.x,Ae.y,c+ye)}for(var _e=0,Ee=_.length;_e<Ee;_e++){var Se=_[_e];z=H[_e];for(var Ce=0,Te=Se.length;Ce<Te;Ce++){var Me=j(Se[Ce],z[Ce],xe);w?Re(Me.x,Me.y+v[a-1].y,v[a-1].x+ye):Re(Me.x,Me.y,c+ye)}}}function ke(e,t){for(var n=e.length;--n>=0;){var r=n,i=n-1;i<0&&(i=e.length-1);for(var o=0,s=a+2*f;o<s;o++){var c=B*o,u=B*(o+1);je(t+r+c,t+i+c,t+i+u,t+r+u)}}}function Re(e,n,r){t.push(e),t.push(n),t.push(r)}function Ie(e,t,n){Be(e),Be(t),Be(n);var r=o.length/3,a=m.generateTopUV(i,o,r-3,r-2,r-1);Le(a[0]),Le(a[1]),Le(a[2])}function je(e,t,n,r){Be(e),Be(t),Be(r),Be(t),Be(n),Be(r);var a=o.length/3,s=m.generateSideWallUV(i,o,a-6,a-3,a-2,a-1);Le(s[0]),Le(s[1]),Le(s[3]),Le(s[1]),Le(s[2]),Le(s[3])}function Be(e){o.push(t[3*e+0]),o.push(t[3*e+1]),o.push(t[3*e+2])}function Le(e){s.push(e.x),s.push(e.y)}!function(){var e=o.length/3;if(u){for(var t=0,n=B*t,r=0;r<L;r++){var s=T[r];Ie(s[2]+n,s[1]+n,s[0]+n)}n=B*(t=a+2*f);for(var c=0;c<L;c++){var l=T[c];Ie(l[0]+n,l[1]+n,l[2]+n)}}else{for(var d=0;d<L;d++){var h=T[d];Ie(h[2],h[1],h[0])}for(var p=0;p<L;p++){var m=T[p];Ie(m[0]+B*a,m[1]+B*a,m[2]+B*a)}}i.addGroup(e,o.length/3-e,0)}(),function(){var e=o.length/3,t=0;ke(M,t),t+=M.length;for(var n=0,r=_.length;n<r;n++){var a=_[n];ke(a,t),t+=a.length}i.addGroup(e,o.length/3-e,1)}()}return a.setAttribute("position",new Za(o,3)),a.setAttribute("uv",new Za(s,2)),a.computeVertexNormals(),a}return Object(g.a)(n,[{key:"toJSON",value:function(){var e=li.prototype.toJSON.call(this);return function(e,t,n){if(n.shapes=[],Array.isArray(e))for(var r=0,a=e.length;r<a;r++){var i=e[r];n.shapes.push(i.uuid)}else n.shapes.push(e.uuid);void 0!==t.extrudePath&&(n.options.extrudePath=t.extrudePath.toJSON());return n}(this.parameters.shapes,this.parameters.options,e)}}]),n}(li),el={generateTopUV:function(e,t,n,r,a){var i=t[3*n],o=t[3*n+1],s=t[3*r],c=t[3*r+1],u=t[3*a],l=t[3*a+1];return[new nr(i,o),new nr(s,c),new nr(u,l)]},generateSideWallUV:function(e,t,n,r,a,i){var o=t[3*n],s=t[3*n+1],c=t[3*n+2],u=t[3*r],l=t[3*r+1],d=t[3*r+2],h=t[3*a],f=t[3*a+1],p=t[3*a+2],m=t[3*i],v=t[3*i+1],g=t[3*i+2];return Math.abs(s-l)<.01?[new nr(o,1-c),new nr(u,1-d),new nr(h,1-p),new nr(m,1-g)]:[new nr(s,1-c),new nr(l,1-d),new nr(f,1-p),new nr(v,1-g)]}};var tl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(v.a)(this,n);var i=(1+Math.sqrt(5))/2,o=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];return(e=t.call(this,o,s,r,a)).type="IcosahedronGeometry",e.parameters={radius:r,detail:a},e}return n}(bu),nl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2*Math.PI;Object(v.a)(this,n),(r=t.call(this)).type="LatheGeometry",r.parameters={points:e,segments:a,phiStart:i,phiLength:o},a=Math.floor(a),o=tr.clamp(o,0,2*Math.PI);for(var s=[],c=[],u=[],l=1/a,d=new fr,h=new nr,f=0;f<=a;f++)for(var p=i+f*l*o,m=Math.sin(p),g=Math.cos(p),b=0;b<=e.length-1;b++)d.x=e[b].x*m,d.y=e[b].y,d.z=e[b].x*g,c.push(d.x,d.y,d.z),h.x=f/a,h.y=b/(e.length-1),u.push(h.x,h.y);for(var y=0;y<a;y++)for(var x=0;x<e.length-1;x++){var w=x+y*e.length,O=w,A=w+e.length,_=w+e.length+1,E=w+1;s.push(O,A,E),s.push(A,_,E)}if(r.setIndex(s),r.setAttribute("position",new Za(c,3)),r.setAttribute("uv",new Za(u,2)),r.computeVertexNormals(),o===2*Math.PI)for(var S=r.attributes.normal.array,C=new fr,T=new fr,M=new fr,k=a*e.length*3,R=0,I=0;R<e.length;R++,I+=3)C.x=S[I+0],C.y=S[I+1],C.z=S[I+2],T.x=S[k+I+0],T.y=S[k+I+1],T.z=S[k+I+2],M.addVectors(C,T).normalize(),S[I+0]=S[k+I+0]=M.x,S[I+1]=S[k+I+1]=M.y,S[I+2]=S[k+I+2]=M.z;return r}return n}(li),rl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(v.a)(this,n);var i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],o=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];return(e=t.call(this,i,o,r,a)).type="OctahedronGeometry",e.parameters={radius:r,detail:a},e}return n}(bu);function al(e,t,n){li.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};var r=[],a=[],i=[],o=[],s=1e-5,c=new fr,u=new fr,l=new fr,d=new fr,h=new fr;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var f=t+1,p=0;p<=n;p++)for(var m=p/n,v=0;v<=t;v++){var g=v/t;e(g,m,u),a.push(u.x,u.y,u.z),g-s>=0?(e(g-s,m,l),d.subVectors(u,l)):(e(g+s,m,l),d.subVectors(l,u)),m-s>=0?(e(g,m-s,l),h.subVectors(u,l)):(e(g,m+s,l),h.subVectors(l,u)),c.crossVectors(d,h).normalize(),i.push(c.x,c.y,c.z),o.push(g,m)}for(var b=0;b<n;b++)for(var y=0;y<t;y++){var x=b*f+y,w=b*f+y+1,O=(b+1)*f+y+1,A=(b+1)*f+y;r.push(x,w,A),r.push(w,O,A)}this.setIndex(r),this.setAttribute("position",new Za(a,3)),this.setAttribute("normal",new Za(i,3)),this.setAttribute("uv",new Za(o,2))}al.prototype=Object.create(li.prototype),al.prototype.constructor=al;var il=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI;Object(v.a)(this,n),(e=t.call(this)).type="RingGeometry",e.parameters={innerRadius:r,outerRadius:a,thetaSegments:i,phiSegments:o,thetaStart:s,thetaLength:c},i=Math.max(3,i);for(var u=[],l=[],d=[],h=[],f=r,p=(a-r)/(o=Math.max(1,o)),m=new fr,g=new nr,b=0;b<=o;b++){for(var y=0;y<=i;y++){var x=s+y/i*c;m.x=f*Math.cos(x),m.y=f*Math.sin(x),l.push(m.x,m.y,m.z),d.push(0,0,1),g.x=(m.x/a+1)/2,g.y=(m.y/a+1)/2,h.push(g.x,g.y)}f+=p}for(var w=0;w<o;w++)for(var O=w*(i+1),A=0;A<i;A++){var _=A+O,E=_,S=_+i+1,C=_+i+2,T=_+1;u.push(E,S,T),u.push(S,C,T)}return e.setIndex(u),e.setAttribute("position",new Za(l,3)),e.setAttribute("normal",new Za(d,3)),e.setAttribute("uv",new Za(h,2)),e}return n}(li),ol=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;Object(v.a)(this,n),(r=t.call(this)).type="ShapeGeometry",r.parameters={shapes:e,curveSegments:a};var i=[],o=[],s=[],c=[],u=0,l=0;if(!1===Array.isArray(e))h(e);else for(var d=0;d<e.length;d++)h(e[d]),r.addGroup(u,l,d),u+=l,l=0;function h(e){var t=o.length/3,n=e.extractPoints(a),r=n.shape,u=n.holes;!1===Yu.isClockWise(r)&&(r=r.reverse());for(var d=0,h=u.length;d<h;d++){var f=u[d];!0===Yu.isClockWise(f)&&(u[d]=f.reverse())}for(var p=Yu.triangulateShape(r,u),m=0,v=u.length;m<v;m++){var g=u[m];r=r.concat(g)}for(var b=0,y=r.length;b<y;b++){var x=r[b];o.push(x.x,x.y,0),s.push(0,0,1),c.push(x.x,x.y)}for(var w=0,O=p.length;w<O;w++){var A=p[w],_=A[0]+t,E=A[1]+t,S=A[2]+t;i.push(_,E,S),l+=3}}return r.setIndex(i),r.setAttribute("position",new Za(o,3)),r.setAttribute("normal",new Za(s,3)),r.setAttribute("uv",new Za(c,2)),r}return Object(g.a)(n,[{key:"toJSON",value:function(){var e=li.prototype.toJSON.call(this);return function(e,t){if(t.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var a=e[n];t.shapes.push(a.uuid)}else t.shapes.push(e.uuid);return t}(this.parameters.shapes,e)}}]),n}(li);var sl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Math.PI;Object(v.a)(this,n),(e=t.call(this)).type="SphereGeometry",e.parameters={radius:r,widthSegments:a,heightSegments:i,phiStart:o,phiLength:s,thetaStart:c,thetaLength:u},a=Math.max(3,Math.floor(a)),i=Math.max(2,Math.floor(i));for(var l=Math.min(c+u,Math.PI),d=0,h=[],f=new fr,p=new fr,m=[],g=[],b=[],y=[],x=0;x<=i;x++){var w=[],O=x/i,A=0;0==x&&0==c?A=.5/a:x==i&&l==Math.PI&&(A=-.5/a);for(var _=0;_<=a;_++){var E=_/a;f.x=-r*Math.cos(o+E*s)*Math.sin(c+O*u),f.y=r*Math.cos(c+O*u),f.z=r*Math.sin(o+E*s)*Math.sin(c+O*u),g.push(f.x,f.y,f.z),p.copy(f).normalize(),b.push(p.x,p.y,p.z),y.push(E+A,1-O),w.push(d++)}h.push(w)}for(var S=0;S<i;S++)for(var C=0;C<a;C++){var T=h[S][C+1],M=h[S][C],k=h[S+1][C],R=h[S+1][C+1];(0!==S||c>0)&&m.push(T,M,R),(S!==i-1||l<Math.PI)&&m.push(M,k,R)}return e.setIndex(m),e.setAttribute("position",new Za(g,3)),e.setAttribute("normal",new Za(b,3)),e.setAttribute("uv",new Za(y,2)),e}return n}(li),cl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(v.a)(this,n);var i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],o=[2,1,0,0,3,2,1,3,0,2,3,1];return(e=t.call(this,i,o,r,a)).type="TetrahedronGeometry",e.parameters={radius:r,detail:a},e}return n}(bu),ul=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(v.a)(this,n);var i=a.font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),Object(l.a)(r,new li);var o=i.generateShapes(e,a.size);return a.depth=void 0!==a.height?a.height:50,void 0===a.bevelThickness&&(a.bevelThickness=10),void 0===a.bevelSize&&(a.bevelSize=8),void 0===a.bevelEnabled&&(a.bevelEnabled=!1),(r=t.call(this,o,a)).type="TextGeometry",r}return n}($u),ll=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2*Math.PI;Object(v.a)(this,n),(e=t.call(this)).type="TorusGeometry",e.parameters={radius:r,tube:a,radialSegments:i,tubularSegments:o,arc:s},i=Math.floor(i),o=Math.floor(o);for(var c=[],u=[],l=[],d=[],h=new fr,f=new fr,p=new fr,m=0;m<=i;m++)for(var g=0;g<=o;g++){var b=g/o*s,y=m/i*Math.PI*2;f.x=(r+a*Math.cos(y))*Math.cos(b),f.y=(r+a*Math.cos(y))*Math.sin(b),f.z=a*Math.sin(y),u.push(f.x,f.y,f.z),h.x=r*Math.cos(b),h.y=r*Math.sin(b),p.subVectors(f,h).normalize(),l.push(p.x,p.y,p.z),d.push(g/o),d.push(m/i)}for(var x=1;x<=i;x++)for(var w=1;w<=o;w++){var O=(o+1)*x+w-1,A=(o+1)*(x-1)+w-1,_=(o+1)*(x-1)+w,E=(o+1)*x+w;c.push(O,A,E),c.push(A,_,E)}return e.setIndex(c),e.setAttribute("position",new Za(u,3)),e.setAttribute("normal",new Za(l,3)),e.setAttribute("uv",new Za(d,2)),e}return n}(li),dl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.4,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:64,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:3;Object(v.a)(this,n),(e=t.call(this)).type="TorusKnotGeometry",e.parameters={radius:r,tube:a,tubularSegments:i,radialSegments:o,p:s,q:c},i=Math.floor(i),o=Math.floor(o);for(var u=[],l=[],d=[],h=[],f=new fr,p=new fr,m=new fr,g=new fr,b=new fr,y=new fr,x=new fr,w=0;w<=i;++w){var O=w/i*s*Math.PI*2;j(O,s,c,r,m),j(O+.01,s,c,r,g),y.subVectors(g,m),x.addVectors(g,m),b.crossVectors(y,x),x.crossVectors(b,y),b.normalize(),x.normalize();for(var A=0;A<=o;++A){var _=A/o*Math.PI*2,E=-a*Math.cos(_),S=a*Math.sin(_);f.x=m.x+(E*x.x+S*b.x),f.y=m.y+(E*x.y+S*b.y),f.z=m.z+(E*x.z+S*b.z),l.push(f.x,f.y,f.z),p.subVectors(f,m).normalize(),d.push(p.x,p.y,p.z),h.push(w/i),h.push(A/o)}}for(var C=1;C<=i;C++)for(var T=1;T<=o;T++){var M=(o+1)*(C-1)+(T-1),k=(o+1)*C+(T-1),R=(o+1)*C+T,I=(o+1)*(C-1)+T;u.push(M,k,I),u.push(k,R,I)}function j(e,t,n,r,a){var i=Math.cos(e),o=Math.sin(e),s=n/t*e,c=Math.cos(s);a.x=r*(2+c)*.5*i,a.y=r*(2+c)*o*.5,a.z=r*Math.sin(s)*.5}return e.setIndex(u),e.setAttribute("position",new Za(l,3)),e.setAttribute("normal",new Za(d,3)),e.setAttribute("uv",new Za(h,2)),e}return n}(li),hl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:64,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(v.a)(this,n),(r=t.call(this)).type="TubeGeometry",r.parameters={path:e,tubularSegments:a,radius:i,radialSegments:o,closed:s};var c=e.computeFrenetFrames(a,s);r.tangents=c.tangents,r.normals=c.normals,r.binormals=c.binormals;var u=new fr,l=new fr,d=new nr,h=new fr,f=[],p=[],m=[],g=[];function b(){for(var e=0;e<a;e++)y(e);y(!1===s?a:0),w(),x()}function y(t){h=e.getPointAt(t/a,h);for(var n=c.normals[t],r=c.binormals[t],s=0;s<=o;s++){var d=s/o*Math.PI*2,m=Math.sin(d),v=-Math.cos(d);l.x=v*n.x+m*r.x,l.y=v*n.y+m*r.y,l.z=v*n.z+m*r.z,l.normalize(),p.push(l.x,l.y,l.z),u.x=h.x+i*l.x,u.y=h.y+i*l.y,u.z=h.z+i*l.z,f.push(u.x,u.y,u.z)}}function x(){for(var e=1;e<=a;e++)for(var t=1;t<=o;t++){var n=(o+1)*(e-1)+(t-1),r=(o+1)*e+(t-1),i=(o+1)*e+t,s=(o+1)*(e-1)+t;g.push(n,r,s),g.push(r,i,s)}}function w(){for(var e=0;e<=a;e++)for(var t=0;t<=o;t++)d.x=e/a,d.y=t/o,m.push(d.x,d.y)}return b(),r.setIndex(g),r.setAttribute("position",new Za(f,3)),r.setAttribute("normal",new Za(p,3)),r.setAttribute("uv",new Za(m,2)),r}return Object(g.a)(n,[{key:"toJSON",value:function(){var e=li.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e}}]),n}(li),fl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;if(Object(v.a)(this,n),(r=t.call(this)).type="WireframeGeometry",!0===e.isGeometry)return console.error("THREE.WireframeGeometry no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Object(l.a)(r);var a=[],i=[0,0],o={},s=new fr;if(null!==e.index){var c=e.attributes.position,u=e.index,d=e.groups;0===d.length&&(d=[{start:0,count:u.count,materialIndex:0}]);for(var h=0,f=d.length;h<f;++h)for(var p=d[h],m=p.start,g=m,b=m+p.count;g<b;g+=3)for(var y=0;y<3;y++){var x=u.getX(g+y),w=u.getX(g+(y+1)%3);i[0]=Math.min(x,w),i[1]=Math.max(x,w);var O=i[0]+","+i[1];void 0===o[O]&&(o[O]={index1:i[0],index2:i[1]})}for(var A in o){var _=o[A];s.fromBufferAttribute(c,_.index1),a.push(s.x,s.y,s.z),s.fromBufferAttribute(c,_.index2),a.push(s.x,s.y,s.z)}}else for(var E=e.attributes.position,S=0,C=E.count/3;S<C;S++)for(var T=0;T<3;T++){var M=3*S+T;s.fromBufferAttribute(E,M),a.push(s.x,s.y,s.z);var k=3*S+(T+1)%3;s.fromBufferAttribute(E,k),a.push(s.x,s.y,s.z)}return r.setAttribute("position",new Za(a,3)),r}return n}(li),pl=Object.freeze({__proto__:null,BoxGeometry:ki,BoxBufferGeometry:ki,CircleGeometry:mu,CircleBufferGeometry:mu,ConeGeometry:gu,ConeBufferGeometry:gu,CylinderGeometry:vu,CylinderBufferGeometry:vu,DodecahedronGeometry:yu,DodecahedronBufferGeometry:yu,EdgesGeometry:_u,ExtrudeGeometry:$u,ExtrudeBufferGeometry:$u,IcosahedronGeometry:tl,IcosahedronBufferGeometry:tl,LatheGeometry:nl,LatheBufferGeometry:nl,OctahedronGeometry:rl,OctahedronBufferGeometry:rl,ParametricGeometry:al,ParametricBufferGeometry:al,PlaneGeometry:Xi,PlaneBufferGeometry:Xi,PolyhedronGeometry:bu,PolyhedronBufferGeometry:bu,RingGeometry:il,RingBufferGeometry:il,ShapeGeometry:ol,ShapeBufferGeometry:ol,SphereGeometry:sl,SphereBufferGeometry:sl,TetrahedronGeometry:cl,TetrahedronBufferGeometry:cl,TextGeometry:ul,TextBufferGeometry:ul,TorusGeometry:ll,TorusBufferGeometry:ll,TorusKnotGeometry:dl,TorusKnotBufferGeometry:dl,TubeGeometry:hl,TubeBufferGeometry:hl,WireframeGeometry:fl}),ml=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="ShadowMaterial",r.color=new Fa(0),r.transparent=!0,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this}}]),n}(Ia);ml.prototype.isShadowMaterial=!0;var vl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this,e)).type="RawShaderMaterial",r}return n}(Bi);function gl(e){Ia.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Fa(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Fa(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=On,this.normalScale=new nr(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(e)}function bl(e){gl.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new nr(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=tr.clamp(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}vl.prototype.isRawShaderMaterial=!0,gl.prototype=Object.create(Ia.prototype),gl.prototype.constructor=gl,gl.prototype.isMeshStandardMaterial=!0,gl.prototype.copy=function(e){return Ia.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this.vertexTangents=e.vertexTangents,this},bl.prototype=Object.create(gl.prototype),bl.prototype.constructor=bl,bl.prototype.isMeshPhysicalMaterial=!0,bl.prototype.copy=function(e){return gl.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,e.sheen?this.sheen=(this.sheen||new Fa).copy(e.sheen):this.sheen=null,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this};var yl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="MeshPhongMaterial",r.color=new Fa(16777215),r.specular=new Fa(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Fa(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=On,r.normalScale=new nr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=le,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(Ia);yl.prototype.isMeshPhongMaterial=!0;var xl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).defines={TOON:""},r.type="MeshToonMaterial",r.color=new Fa(16777215),r.map=null,r.gradientMap=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Fa(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=On,r.normalScale=new nr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}]),n}(Ia);xl.prototype.isMeshToonMaterial=!0;var wl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="MeshNormalMaterial",r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=On,r.normalScale=new nr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(Ia);wl.prototype.isMeshNormalMaterial=!0;var Ol=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="MeshLambertMaterial",r.color=new Fa(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new Fa(0),r.emissiveIntensity=1,r.emissiveMap=null,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=le,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this}}]),n}(Ia);Ol.prototype.isMeshLambertMaterial=!0;var Al=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).defines={MATCAP:""},r.type="MeshMatcapMaterial",r.color=new Fa(16777215),r.matcap=null,r.map=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=On,r.normalScale=new nr(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.flatShading=e.flatShading,this}}]),n}(Ia);Al.prototype.isMeshMatcapMaterial=!0;var _l=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="LineDashedMaterial",r.scale=1,r.dashSize=3,r.gapSize=1,r.setValues(e),r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this}}]),n}(Xc);_l.prototype.isLineDashedMaterial=!0;var El=Object.freeze({__proto__:null,ShadowMaterial:ml,SpriteMaterial:pc,RawShaderMaterial:vl,ShaderMaterial:Bi,PointsMaterial:au,MeshPhysicalMaterial:bl,MeshStandardMaterial:gl,MeshPhongMaterial:yl,MeshToonMaterial:xl,MeshNormalMaterial:wl,MeshLambertMaterial:Ol,MeshDepthMaterial:Ks,MeshDistanceMaterial:qs,MeshBasicMaterial:Ga,MeshMatcapMaterial:Al,LineDashedMaterial:_l,LineBasicMaterial:Xc,Material:Ia}),Sl={arraySlice:function(e,t,n){return Sl.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(t,n){return e[t]-e[n]})),n},sortedArray:function(e,t,n){for(var r=e.length,a=new e.constructor(r),i=0,o=0;o!==r;++i)for(var s=n[i]*t,c=0;c!==t;++c)a[o++]=e[s+c];return a},flattenJSON:function(e,t,n,r){for(var a=1,i=e[0];void 0!==i&&void 0===i[r];)i=e[a++];if(void 0!==i){var o=i[r];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=i[r])&&(t.push(i.time),n.push.apply(n,o)),i=e[a++]}while(void 0!==i);else if(void 0!==o.toArray)do{void 0!==(o=i[r])&&(t.push(i.time),o.toArray(n,n.length)),i=e[a++]}while(void 0!==i);else do{void 0!==(o=i[r])&&(t.push(i.time),n.push(o)),i=e[a++]}while(void 0!==i)}},subclip:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,i=e.clone();i.name=t;for(var o=[],s=0;s<i.tracks.length;++s){for(var c=i.tracks[s],u=c.getValueSize(),l=[],d=[],h=0;h<c.times.length;++h){var f=c.times[h]*a;if(!(f<n||f>=r)){l.push(c.times[h]);for(var p=0;p<u;++p)d.push(c.values[h*u+p])}}0!==l.length&&(c.times=Sl.convertArray(l,c.times.constructor),c.values=Sl.convertArray(d,c.values.constructor),o.push(c))}i.tracks=o;for(var m=1/0,v=0;v<i.tracks.length;++v)m>i.tracks[v].times[0]&&(m=i.tracks[v].times[0]);for(var g=0;g<i.tracks.length;++g)i.tracks[g].shift(-1*m);return i.resetDuration(),i},makeClipAdditive:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);for(var a=n.tracks.length,i=t/r,o=function(t){var r=n.tracks[t],a=r.ValueTypeName;if("bool"===a||"string"===a)return"continue";var o=e.tracks.find((function(e){return e.name===r.name&&e.ValueTypeName===a}));if(void 0===o)return"continue";var s=0,c=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(s=c/3);var u=0,l=o.getValueSize();o.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(u=l/3);var d=r.times.length-1,h=void 0;if(i<=r.times[0]){var f=s,p=c-s;h=Sl.arraySlice(r.values,f,p)}else if(i>=r.times[d]){var m=d*c+s,v=m+c-s;h=Sl.arraySlice(r.values,m,v)}else{var g=r.createInterpolant(),b=s,y=c-s;g.evaluate(i),h=Sl.arraySlice(g.resultBuffer,b,y)}"quaternion"===a&&(new hr).fromArray(h).normalize().conjugate().toArray(h);for(var x=o.times.length,w=0;w<x;++w){var O=w*l+u;if("quaternion"===a)hr.multiplyQuaternionsFlat(o.values,O,h,0,o.values,O);else for(var A=l-2*u,_=0;_<A;++_)o.values[O+_]-=h[_]}},s=0;s<a;++s)o(s);return e.blendMode=cn,e}};function Cl(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Tl(e,t,n,r){Cl.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ml(e,t,n,r){Cl.call(this,e,t,n,r)}function kl(e,t,n,r){Cl.call(this,e,t,n,r)}Object.assign(Cl.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],a=t[n-1];e:{t:{var i;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<a)break r;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,a)}if(n===o)break;if(a=r,e<(r=t[++n]))break t}i=t.length;break n}if(e>=a)break e;var s=t[1];e<s&&(n=2,a=s);for(var c=n-2;;){if(void 0===a)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===c)break;if(r=a,e>=(a=t[--n-1]))break t}i=n,n=0}for(;n<i;){var u=n+i>>>1;e<t[u]?i=u:n=u+1}if(r=t[n],void 0===(a=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,a,e)}this._cachedIndex=n,this.intervalChanged_(n,a,r)}return this.interpolate_(n,a,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,a=e*r,i=0;i!==r;++i)t[i]=n[a+i];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Cl.prototype,{beforeStart_:Cl.prototype.copySampleValue_,afterEnd_:Cl.prototype.copySampleValue_}),Tl.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Tl,DefaultSettings_:{endingStart:rn,endingEnd:rn},intervalChanged_:function(e,t,n){var r=this.parameterPositions,a=e-2,i=e+1,o=r[a],s=r[i];if(void 0===o)switch(this.getSettings_().endingStart){case an:a=e,o=2*t-n;break;case on:o=t+r[a=r.length-2]-r[a+1];break;default:a=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case an:i=e,s=2*n-t;break;case on:i=1,s=n+r[1]-r[0];break;default:i=e-1,s=t}var c=.5*(n-t),u=this.valueSize;this._weightPrev=c/(t-o),this._weightNext=c/(s-n),this._offsetPrev=a*u,this._offsetNext=i*u},interpolate_:function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=e*o,c=s-o,u=this._offsetPrev,l=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,v=-d*m+2*d*p-d*f,g=(1+d)*m+(-1.5-2*d)*p+(-.5+d)*f+1,b=(-1-h)*m+(1.5+h)*p+.5*f,y=h*m-h*p,x=0;x!==o;++x)a[x]=v*i[u+x]+g*i[c+x]+b*i[s+x]+y*i[l+x];return a}}),Ml.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Ml,interpolate_:function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=e*o,c=s-o,u=(n-t)/(r-t),l=1-u,d=0;d!==o;++d)a[d]=i[c+d]*l+i[s+d]*u;return a}}),kl.prototype=Object.assign(Object.create(Cl.prototype),{constructor:kl,interpolate_:function(e){return this.copySampleValue_(e-1)}});var Rl=function(){function e(t,n,r,a){if(Object(v.a)(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Sl.convertArray(n,this.TimeBufferType),this.values=Sl.convertArray(r,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation)}return Object(g.a)(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new kl(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new Ml(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new Tl(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case en:t=this.InterpolantFactoryMethodDiscrete;break;case tn:t=this.InterpolantFactoryMethodLinear;break;case nn:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return en;case this.InterpolantFactoryMethodLinear:return tn;case this.InterpolantFactoryMethodSmooth:return nn}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,a=0,i=r-1;a!==r&&n[a]<e;)++a;for(;-1!==i&&n[i]>t;)--i;if(++i,0!==a||i!==r){a>=i&&(a=(i=Math.max(i,1))-1);var o=this.getValueSize();this.times=Sl.arraySlice(n,a,i),this.values=Sl.arraySlice(this.values,a*o,i*o)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,a=n.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var i=null,o=0;o!==a;o++){var s=n[o];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==i&&i>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,i),e=!1;break}i=s}if(void 0!==r&&Sl.isTypedArray(r))for(var c=0,u=r.length;c!==u;++c){var l=r[c];if(isNaN(l)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,l),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=Sl.arraySlice(this.times),t=Sl.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===nn,a=e.length-1,i=1,o=1;o<a;++o){var s=!1,c=e[o];if(c!==e[o+1]&&(1!==o||c!==e[0]))if(r)s=!0;else for(var u=o*n,l=u-n,d=u+n,h=0;h!==n;++h){var f=t[u+h];if(f!==t[l+h]||f!==t[d+h]){s=!0;break}}if(s){if(o!==i){e[i]=e[o];for(var p=o*n,m=i*n,v=0;v!==n;++v)t[m+v]=t[p+v]}++i}}if(a>0){e[i]=e[a];for(var g=a*n,b=i*n,y=0;y!==n;++y)t[b+y]=t[g+y];++i}return i!==e.length?(this.times=Sl.arraySlice(e,0,i),this.values=Sl.arraySlice(t,0,i*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=Sl.arraySlice(this.times,0),t=Sl.arraySlice(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:Sl.convertArray(e.times,Array),values:Sl.convertArray(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}]),e}();Rl.prototype.TimeBufferType=Float32Array,Rl.prototype.ValueBufferType=Float32Array,Rl.prototype.DefaultInterpolation=tn;var Il=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return n}(Rl);Il.prototype.ValueTypeName="bool",Il.prototype.ValueBufferType=Array,Il.prototype.DefaultInterpolation=en,Il.prototype.InterpolantFactoryMethodLinear=void 0,Il.prototype.InterpolantFactoryMethodSmooth=void 0;var jl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return n}(Rl);jl.prototype.ValueTypeName="color";var Bl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return n}(Rl);function Ll(e,t,n,r){Cl.call(this,e,t,n,r)}Bl.prototype.ValueTypeName="number",Ll.prototype=Object.assign(Object.create(Cl.prototype),{constructor:Ll,interpolate_:function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),c=e*o,u=c+o;c!==u;c+=4)hr.slerpFlat(a,0,i,c-o,i,c,s);return a}});var Nl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return Object(g.a)(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new Ll(this.times,this.values,this.getValueSize(),e)}}]),n}(Rl);Nl.prototype.ValueTypeName="quaternion",Nl.prototype.DefaultInterpolation=tn,Nl.prototype.InterpolantFactoryMethodSmooth=void 0;var Dl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return n}(Rl);Dl.prototype.ValueTypeName="string",Dl.prototype.ValueBufferType=Array,Dl.prototype.DefaultInterpolation=en,Dl.prototype.InterpolantFactoryMethodLinear=void 0,Dl.prototype.InterpolantFactoryMethodSmooth=void 0;var Pl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return n}(Rl);Pl.prototype.ValueTypeName="vector";var Fl=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:sn;Object(v.a)(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=a,this.uuid=tr.generateUUID(),this.duration<0&&this.resetDuration()}return Object(g.a)(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var r=this.tracks[t];e=Math.max(e,r.times[r.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),a=0,i=n.length;a!==i;++a)t.push(Gl(n[a]).scale(r));var o=new this(e.name,e.duration,t,e.blendMode);return o.uuid=e.uuid,o}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},a=0,i=n.length;a!==i;++a)t.push(Rl.toJSON(n[a]));return r}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var a=t.length,i=[],o=0;o<a;o++){var s=[],c=[];s.push((o+a-1)%a,o,(o+1)%a),c.push(0,1,0);var u=Sl.getKeyframeOrder(s);s=Sl.sortedArray(s,1,u),c=Sl.sortedArray(c,1,u),r||0!==s[0]||(s.push(a),c.push(c[0])),i.push(new Bl(".morphTargetInfluences["+t[o].name+"]",s,c).scale(1/n))}return new this(e,-1,i)}},{key:"findByName",value:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var a=0;a<n.length;a++)if(n[a].name===t)return n[a];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},a=/^([\w-]*?)([\d]+)$/,i=0,o=e.length;i<o;i++){var s=e[i],c=s.name.match(a);if(c&&c.length>1){var u=c[1],l=r[u];l||(r[u]=l=[]),l.push(s)}}var d=[];for(var h in r)d.push(this.CreateFromMorphTargetSequence(h,r[h],t,n));return d}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,a){if(0!==n.length){var i=[],o=[];Sl.flattenJSON(n,i,o,r),0!==i.length&&a.push(new e(t,i,o))}},r=[],a=e.name||"default",i=e.fps||30,o=e.blendMode,s=e.length||-1,c=e.hierarchy||[],u=0;u<c.length;u++){var l=c[u].keys;if(l&&0!==l.length)if(l[0].morphTargets){var d={},h=void 0;for(h=0;h<l.length;h++)if(l[h].morphTargets)for(var f=0;f<l[h].morphTargets.length;f++)d[l[h].morphTargets[f]]=-1;for(var p in d){for(var m=[],v=[],g=0;g!==l[h].morphTargets.length;++g){var b=l[h];m.push(b.time),v.push(b.morphTarget===p?1:0)}r.push(new Bl(".morphTargetInfluence["+p+"]",m,v))}s=d.length*(i||1)}else{var y=".bones["+t[u].name+"]";n(Pl,y+".position",l,"pos",r),n(Nl,y+".quaternion",l,"rot",r),n(Pl,y+".scale",l,"scl",r)}}return 0===r.length?null:new this(a,s,r,o)}}]),e}();function Gl(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Bl;case"vector":case"vector2":case"vector3":case"vector4":return Pl;case"color":return jl;case"quaternion":return Nl;case"bool":case"boolean":return Il;case"string":return Dl}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];Sl.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var Ul={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function zl(e,t,n){var r=this,a=!1,i=0,o=0,s=void 0,c=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){o++,!1===a&&void 0!==r.onStart&&r.onStart(e,i,o),a=!0},this.itemEnd=function(e){i++,void 0!==r.onProgress&&r.onProgress(e,i,o),i===o&&(a=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return s?s(e):e},this.setURLModifier=function(e){return s=e,this},this.addHandler=function(e,t){return c.push(e,t),this},this.removeHandler=function(e){var t=c.indexOf(e);return-1!==t&&c.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=c.length;t<n;t+=2){var r=c[t],a=c[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return a}return null}}var Hl=new zl;function Vl(e){this.manager=void 0!==e?e:Hl,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Vl.prototype,{load:function(){},loadAsync:function(e,t){var n=this;return new Promise((function(r,a){n.load(e,r,t,a)}))},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var Wl={};function Jl(e){Vl.call(this,e)}Jl.prototype=Object.assign(Object.create(Vl.prototype),{constructor:Jl,load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=this,i=Ul.get(e);if(void 0!==i)return a.manager.itemStart(e),setTimeout((function(){t&&t(i),a.manager.itemEnd(e)}),0),i;if(void 0===Wl[e]){var o,s=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(s){var c=s[1],u=!!s[2],l=s[3];l=decodeURIComponent(l),u&&(l=atob(l));try{var d,h=(this.responseType||"").toLowerCase();switch(h){case"arraybuffer":case"blob":for(var f=new Uint8Array(l.length),p=0;p<l.length;p++)f[p]=l.charCodeAt(p);d="blob"===h?new Blob([f.buffer],{type:c}):f.buffer;break;case"document":var m=new DOMParser;d=m.parseFromString(l,c);break;case"json":d=JSON.parse(l);break;default:d=l}setTimeout((function(){t&&t(d),a.manager.itemEnd(e)}),0)}catch(g){setTimeout((function(){r&&r(g),a.manager.itemError(e),a.manager.itemEnd(e)}),0)}}else{for(var v in Wl[e]=[],Wl[e].push({onLoad:t,onProgress:n,onError:r}),(o=new XMLHttpRequest).open("GET",e,!0),o.addEventListener("load",(function(t){var n=this.response,r=Wl[e];if(delete Wl[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Ul.add(e,n);for(var i=0,o=r.length;i<o;i++){var s=r[i];s.onLoad&&s.onLoad(n)}a.manager.itemEnd(e)}else{for(var c=0,u=r.length;c<u;c++){var l=r[c];l.onError&&l.onError(t)}a.manager.itemError(e),a.manager.itemEnd(e)}}),!1),o.addEventListener("progress",(function(t){for(var n=Wl[e],r=0,a=n.length;r<a;r++){var i=n[r];i.onProgress&&i.onProgress(t)}}),!1),o.addEventListener("error",(function(t){var n=Wl[e];delete Wl[e];for(var r=0,i=n.length;r<i;r++){var o=n[r];o.onError&&o.onError(t)}a.manager.itemError(e),a.manager.itemEnd(e)}),!1),o.addEventListener("abort",(function(t){var n=Wl[e];delete Wl[e];for(var r=0,i=n.length;r<i;r++){var o=n[r];o.onError&&o.onError(t)}a.manager.itemError(e),a.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(o.responseType=this.responseType),void 0!==this.withCredentials&&(o.withCredentials=this.withCredentials),o.overrideMimeType&&o.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)o.setRequestHeader(v,this.requestHeader[v]);o.send(null)}return a.manager.itemStart(e),o}Wl[e].push({onLoad:t,onProgress:n,onError:r})},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}});var Xl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(v.a)(this,n),t.call(this,e)}return Object(g.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=new Jl(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(function(n){try{t(a.parse(JSON.parse(n)))}catch(i){r?r(i):console.error(i),a.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){for(var t=[],n=0;n<e.length;n++){var r=Fl.parse(e[n]);t.push(r)}return t}}]),n}(Vl);function Kl(e){Vl.call(this,e)}Kl.prototype=Object.assign(Object.create(Vl.prototype),{constructor:Kl,load:function(e,t,n,r){var a=this,i=[],o=new hu,s=new Jl(this.manager);s.setPath(this.path),s.setResponseType("arraybuffer"),s.setRequestHeader(this.requestHeader),s.setWithCredentials(a.withCredentials);var c=0;function u(u){s.load(e[u],(function(e){var n=a.parse(e,!0);i[u]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(c+=1)&&(1===n.mipmapCount&&(o.minFilter=Be),o.image=i,o.format=n.format,o.needsUpdate=!0,t&&t(o))}),n,r)}if(Array.isArray(e))for(var l=0,d=e.length;l<d;++l)u(l);else s.load(e,(function(e){var n=a.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){i[s]={mipmaps:[]};for(var c=0;c<n.mipmapCount;c++)i[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+c]),i[s].format=n.format,i[s].width=n.width,i[s].height=n.height}o.image=i}else o.image.width=n.width,o.image.height=n.height,o.mipmaps=n.mipmaps;1===n.mipmapCount&&(o.minFilter=Be),o.format=n.format,o.needsUpdate=!0,t&&t(o)}),n,r);return o}});var ql=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(v.a)(this,n),t.call(this,e)}return Object(g.a)(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=this,i=Ul.get(e);if(void 0!==i)return a.manager.itemStart(e),setTimeout((function(){t&&t(i),a.manager.itemEnd(e)}),0),i;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");function s(){o.removeEventListener("load",s,!1),o.removeEventListener("error",c,!1),Ul.add(e,this),t&&t(this),a.manager.itemEnd(e)}function c(t){o.removeEventListener("load",s,!1),o.removeEventListener("error",c,!1),r&&r(t),a.manager.itemError(e),a.manager.itemEnd(e)}return o.addEventListener("load",s,!1),o.addEventListener("error",c,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),a.manager.itemStart(e),o.src=e,o}}]),n}(Vl),Yl=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(v.a)(this,n),t.call(this,e)}return Object(g.a)(n,[{key:"load",value:function(e,t,n,r){var a=new Fi,i=new ql(this.manager);i.setCrossOrigin(this.crossOrigin),i.setPath(this.path);var o=0;function s(n){i.load(e[n],(function(e){a.images[n]=e,6===++o&&(a.needsUpdate=!0,t&&t(a))}),void 0,r)}for(var c=0;c<e.length;++c)s(c);return a}}]),n}(Vl);function Ql(e){Vl.call(this,e)}function Zl(e){Vl.call(this,e)}function $l(){this.type="Curve",this.arcLengthDivisions=200}Ql.prototype=Object.assign(Object.create(Vl.prototype),{constructor:Ql,load:function(e,t,n,r){var a=this,i=new Ui,o=new Jl(this.manager);return o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setPath(this.path),o.setWithCredentials(a.withCredentials),o.load(e,(function(e){var n=a.parse(e);n&&(void 0!==n.image?i.image=n.image:void 0!==n.data&&(i.image.width=n.width,i.image.height=n.height,i.image.data=n.data),i.wrapS=void 0!==n.wrapS?n.wrapS:Ce,i.wrapT=void 0!==n.wrapT?n.wrapT:Ce,i.magFilter=void 0!==n.magFilter?n.magFilter:Be,i.minFilter=void 0!==n.minFilter?n.minFilter:Be,i.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(i.encoding=n.encoding),void 0!==n.flipY&&(i.flipY=n.flipY),void 0!==n.format&&(i.format=n.format),void 0!==n.type&&(i.type=n.type),void 0!==n.mipmaps&&(i.mipmaps=n.mipmaps,i.minFilter=De),1===n.mipmapCount&&(i.minFilter=Be),void 0!==n.generateMipmaps&&(i.generateMipmaps=n.generateMipmaps),i.needsUpdate=!0,t&&t(i,n))}),n,r),i}}),Zl.prototype=Object.assign(Object.create(Vl.prototype),{constructor:Zl,load:function(e,t,n,r){var a=new sr,i=new ql(this.manager);return i.setCrossOrigin(this.crossOrigin),i.setPath(this.path),i.load(e,(function(n){a.image=n;var r=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);a.format=r?Ze:$e,a.needsUpdate=!0,void 0!==t&&t(a)}),n,r),a}}),Object.assign($l.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,t){var n=this.getUtoTmapping(e);return this.getPoint(n,t)},getPoints:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),a=0;n.push(0);for(var i=1;i<=e;i++)a+=(t=this.getPoint(i/e)).distanceTo(r),n.push(a),r=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,t){var n,r=this.getLengths(),a=0,i=r.length;n=t||e*r[i-1];for(var o,s=0,c=i-1;s<=c;)if((o=r[a=Math.floor(s+(c-s)/2)]-n)<0)s=a+1;else{if(!(o>0)){c=a;break}c=a-1}if(r[a=c]===n)return a/(i-1);var u=r[a];return(a+(n-u)/(r[a+1]-u))/(i-1)},getTangent:function(e,t){var n=1e-4,r=e-n,a=e+n;r<0&&(r=0),a>1&&(a=1);var i=this.getPoint(r),o=this.getPoint(a),s=t||(i.isVector2?new nr:new fr);return s.copy(o).sub(i).normalize(),s},getTangentAt:function(e,t){var n=this.getUtoTmapping(e);return this.getTangent(n,t)},computeFrenetFrames:function(e,t){for(var n=new fr,r=[],a=[],i=[],o=new fr,s=new Vr,c=0;c<=e;c++){var u=c/e;r[c]=this.getTangentAt(u,new fr),r[c].normalize()}a[0]=new fr,i[0]=new fr;var l=Number.MAX_VALUE,d=Math.abs(r[0].x),h=Math.abs(r[0].y),f=Math.abs(r[0].z);d<=l&&(l=d,n.set(1,0,0)),h<=l&&(l=h,n.set(0,1,0)),f<=l&&n.set(0,0,1),o.crossVectors(r[0],n).normalize(),a[0].crossVectors(r[0],o),i[0].crossVectors(r[0],a[0]);for(var p=1;p<=e;p++){if(a[p]=a[p-1].clone(),i[p]=i[p-1].clone(),o.crossVectors(r[p-1],r[p]),o.length()>Number.EPSILON){o.normalize();var m=Math.acos(tr.clamp(r[p-1].dot(r[p]),-1,1));a[p].applyMatrix4(s.makeRotationAxis(o,m))}i[p].crossVectors(r[p],a[p])}if(!0===t){var v=Math.acos(tr.clamp(a[0].dot(a[e]),-1,1));v/=e,r[0].dot(o.crossVectors(a[0],a[e]))>0&&(v=-v);for(var g=1;g<=e;g++)a[g].applyMatrix4(s.makeRotationAxis(r[g],v*g)),i[g].crossVectors(r[g],a[g])}return{tangents:r,normals:a,binormals:i}},clone:function(){return(new this.constructor).copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});var ed=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,u=arguments.length>6&&void 0!==arguments[6]&&arguments[6],l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return Object(v.a)(this,n),(e=t.call(this)).type="EllipseCurve",e.aX=r,e.aY=a,e.xRadius=i,e.yRadius=o,e.aStartAngle=s,e.aEndAngle=c,e.aClockwise=u,e.aRotation=l,e}return Object(g.a)(n,[{key:"getPoint",value:function(e,t){for(var n=t||new nr,r=2*Math.PI,a=this.aEndAngle-this.aStartAngle,i=Math.abs(a)<Number.EPSILON;a<0;)a+=r;for(;a>r;)a-=r;a<Number.EPSILON&&(a=i?0:r),!0!==this.aClockwise||i||(a===r?a=-r:a-=r);var o=this.aStartAngle+e*a,s=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var u=Math.cos(this.aRotation),l=Math.sin(this.aRotation),d=s-this.aX,h=c-this.aY;s=d*u-h*l+this.aX,c=d*l+h*u+this.aY}return n.set(s,c)}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}},{key:"fromJSON",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),n}($l);ed.prototype.isEllipseCurve=!0;var td=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a,i,o,s){var c;return Object(v.a)(this,n),(c=t.call(this,e,r,a,a,i,o,s)).type="ArcCurve",c}return n}(ed);function nd(){var e=0,t=0,n=0,r=0;function a(a,i,o,s){e=a,t=o,n=-3*a+3*i-2*o-s,r=2*a-2*i+o+s}return{initCatmullRom:function(e,t,n,r,i){a(t,n,i*(n-e),i*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,i,o,s){var c=(t-e)/i-(n-e)/(i+o)+(n-t)/o,u=(n-t)/o-(r-t)/(o+s)+(r-n)/s;a(t,n,c*=o,u*=o)},calc:function(a){var i=a*a;return e+t*a+n*i+r*(i*a)}}}td.prototype.isArcCurve=!0;var rd=new fr,ad=new nd,id=new nd,od=new nd,sd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return Object(v.a)(this,n),(e=t.call(this)).type="CatmullRomCurve3",e.points=r,e.closed=a,e.curveType=i,e.tension=o,e}return Object(g.a)(n,[{key:"getPoint",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr,a=r,i=this.points,o=i.length,s=(o-(this.closed?0:1))*e,c=Math.floor(s),u=s-c;this.closed?c+=c>0?0:(Math.floor(Math.abs(c)/o)+1)*o:0===u&&c===o-1&&(c=o-2,u=1),this.closed||c>0?t=i[(c-1)%o]:(rd.subVectors(i[0],i[1]).add(i[0]),t=rd);var l=i[c%o],d=i[(c+1)%o];if(this.closed||c+2<o?n=i[(c+2)%o]:(rd.subVectors(i[o-1],i[o-2]).add(i[o-1]),n=rd),"centripetal"===this.curveType||"chordal"===this.curveType){var h="chordal"===this.curveType?.5:.25,f=Math.pow(t.distanceToSquared(l),h),p=Math.pow(l.distanceToSquared(d),h),m=Math.pow(d.distanceToSquared(n),h);p<1e-4&&(p=1),f<1e-4&&(f=p),m<1e-4&&(m=p),ad.initNonuniformCatmullRom(t.x,l.x,d.x,n.x,f,p,m),id.initNonuniformCatmullRom(t.y,l.y,d.y,n.y,f,p,m),od.initNonuniformCatmullRom(t.z,l.z,d.z,n.z,f,p,m)}else"catmullrom"===this.curveType&&(ad.initCatmullRom(t.x,l.x,d.x,n.x,this.tension),id.initCatmullRom(t.y,l.y,d.y,n.y,this.tension),od.initCatmullRom(t.z,l.z,d.z,n.z,this.tension));return a.set(ad.calc(u),id.calc(u),od.calc(u)),a}},{key:"copy",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var a=e.points[t];this.points.push(a.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var a=this.points[t];e.points.push(a.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}},{key:"fromJSON",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var a=e.points[t];this.points.push((new fr).fromArray(a))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),n}($l);function cd(e,t,n,r,a){var i=.5*(r-t),o=.5*(a-n),s=e*e;return(2*n-2*r+i+o)*(e*s)+(-3*n+3*r-2*i-o)*s+i*e+n}function ud(e,t,n,r){return function(e,t){var n=1-e;return n*n*t}(e,t)+function(e,t){return 2*(1-e)*e*t}(e,n)+function(e,t){return e*e*t}(e,r)}function ld(e,t,n,r,a){return function(e,t){var n=1-e;return n*n*n*t}(e,t)+function(e,t){var n=1-e;return 3*n*n*e*t}(e,n)+function(e,t){return 3*(1-e)*e*e*t}(e,r)+function(e,t){return e*e*e*t}(e,a)}sd.prototype.isCatmullRomCurve3=!0;var dd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new nr,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new nr;return Object(v.a)(this,n),(e=t.call(this)).type="CubicBezierCurve",e.v0=r,e.v1=a,e.v2=i,e.v3=o,e}return Object(g.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,n=t,r=this.v0,a=this.v1,i=this.v2,o=this.v3;return n.set(ld(e,r.x,a.x,i.x,o.x),ld(e,r.y,a.y,i.y,o.y)),n}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}($l);dd.prototype.isCubicBezierCurve=!0;var hd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new fr,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new fr;return Object(v.a)(this,n),(e=t.call(this)).type="CubicBezierCurve3",e.v0=r,e.v1=a,e.v2=i,e.v3=o,e}return Object(g.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr,n=t,r=this.v0,a=this.v1,i=this.v2,o=this.v3;return n.set(ld(e,r.x,a.x,i.x,o.x),ld(e,r.y,a.y,i.y,o.y),ld(e,r.z,a.z,i.z,o.z)),n}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}},{key:"fromJSON",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}($l);hd.prototype.isCubicBezierCurve3=!0;var fd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr;return Object(v.a)(this,n),(e=t.call(this)).type="LineCurve",e.v1=r,e.v2=a,e}return Object(g.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"getTangent",value:function(e,t){var n=t||new nr;return n.copy(this.v2).sub(this.v1).normalize(),n}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}($l);fd.prototype.isLineCurve=!0;var pd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr;return Object(v.a)(this,n),(e=t.call(this)).type="LineCurve3",e.isLineCurve3=!0,e.v1=r,e.v2=a,e}return Object(g.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(e,t){return this.getPoint(e,t)}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}($l),md=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new nr;return Object(v.a)(this,n),(e=t.call(this)).type="QuadraticBezierCurve",e.v0=r,e.v1=a,e.v2=i,e}return Object(g.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,n=t,r=this.v0,a=this.v1,i=this.v2;return n.set(ud(e,r.x,a.x,i.x),ud(e,r.y,a.y,i.y)),n}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}($l);md.prototype.isQuadraticBezierCurve=!0;var vd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fr,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new fr;return Object(v.a)(this,n),(e=t.call(this)).type="QuadraticBezierCurve3",e.v0=r,e.v1=a,e.v2=i,e}return Object(g.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr,n=t,r=this.v0,a=this.v1,i=this.v2;return n.set(ud(e,r.x,a.x,i.x),ud(e,r.y,a.y,i.y),ud(e,r.z,a.z,i.z)),n}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}},{key:"fromJSON",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}($l);vd.prototype.isQuadraticBezierCurve3=!0;var gd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(v.a)(this,n),(e=t.call(this)).type="SplineCurve",e.points=r,e}return Object(g.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr,n=t,r=this.points,a=(r.length-1)*e,i=Math.floor(a),o=a-i,s=r[0===i?i:i-1],c=r[i],u=r[i>r.length-2?r.length-1:i+1],l=r[i>r.length-3?r.length-1:i+2];return n.set(cd(o,s.x,c.x,u.x,l.x),cd(o,s.y,c.y,u.y,l.y)),n}},{key:"copy",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var a=e.points[t];this.points.push(a.clone())}return this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);e.points=[];for(var t=0,r=this.points.length;t<r;t++){var a=this.points[t];e.points.push(a.toArray())}return e}},{key:"fromJSON",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var a=e.points[t];this.points.push((new nr).fromArray(a))}return this}}]),n}($l);gd.prototype.isSplineCurve=!0;var bd=Object.freeze({__proto__:null,ArcCurve:td,CatmullRomCurve3:sd,CubicBezierCurve:dd,CubicBezierCurve3:hd,EllipseCurve:ed,LineCurve:fd,LineCurve3:pd,QuadraticBezierCurve:md,QuadraticBezierCurve3:vd,SplineCurve:gd}),yd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(v.a)(this,n),(e=t.call(this)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return Object(g.a)(n,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new fd(t,e))}},{key:"getPoint",value:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=t){var a=n[r]-t,i=this.curves[r],o=i.getLength(),s=0===o?0:1-a/o;return i.getPointAt(s)}r++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],r=0,a=this.curves;r<a.length;r++)for(var i=a[r],o=i&&i.isEllipseCurve?2*t:i&&(i.isLineCurve||i.isLineCurve3)?1:i&&i.isSplineCurve?t*i.points.length:t,s=i.getPoints(o),c=0;c<s.length;c++){var u=s[c];e&&e.equals(u)||(n.push(u),e=u)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var a=e.curves[t];this.curves.push(a.clone())}return this.autoClose=e.autoClose,this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);e.autoClose=this.autoClose,e.curves=[];for(var t=0,r=this.curves.length;t<r;t++){var a=this.curves[t];e.curves.push(a.toJSON())}return e}},{key:"fromJSON",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var a=e.curves[t];this.curves.push((new bd[a.type]).fromJSON(a))}return this}}]),n}($l),xd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="Path",r.currentPoint=new nr,e&&r.setFromPoints(e),r}return Object(g.a)(n,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new fd(this.currentPoint.clone(),new nr(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){var a=new md(this.currentPoint.clone(),new nr(e,t),new nr(n,r));return this.curves.push(a),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,a,i){var o=new dd(this.currentPoint.clone(),new nr(e,t),new nr(n,r),new nr(a,i));return this.curves.push(o),this.currentPoint.set(a,i),this}},{key:"splineThru",value:function(e){var t=[this.currentPoint.clone()].concat(e),n=new gd(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,a,i){var o=this.currentPoint.x,s=this.currentPoint.y;return this.absarc(e+o,t+s,n,r,a,i),this}},{key:"absarc",value:function(e,t,n,r,a,i){return this.absellipse(e,t,n,n,r,a,i),this}},{key:"ellipse",value:function(e,t,n,r,a,i,o,s){var c=this.currentPoint.x,u=this.currentPoint.y;return this.absellipse(e+c,t+u,n,r,a,i,o,s),this}},{key:"absellipse",value:function(e,t,n,r,a,i,o,s){var c=new ed(e,t,n,r,a,i,o,s);if(this.curves.length>0){var u=c.getPoint(0);u.equals(this.currentPoint)||this.lineTo(u.x,u.y)}this.curves.push(c);var l=c.getPoint(1);return this.currentPoint.copy(l),this}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.currentPoint.copy(e.currentPoint),this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);return e.currentPoint=this.currentPoint.toArray(),e}},{key:"fromJSON",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),n}(yd),wd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this,e)).uuid=tr.generateUUID(),r.type="Shape",r.holes=[],r}return Object(g.a)(n,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var a=e.holes[t];this.holes.push(a.clone())}return this}},{key:"toJSON",value:function(){var e=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this);e.uuid=this.uuid,e.holes=[];for(var t=0,r=this.holes.length;t<r;t++){var a=this.holes[t];e.holes.push(a.toJSON())}return e}},{key:"fromJSON",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var a=e.holes[t];this.holes.push((new xd).fromJSON(a))}return this}}]),n}(xd),Od=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(v.a)(this,n),(r=t.call(this)).type="Light",r.color=new Fa(e),r.intensity=a,r}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this}},{key:"toJSON",value:function(e){var t=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this,e);return t.object.color=this.color.getHex(),t.object.intensity=this.intensity,void 0!==this.groundColor&&(t.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(t.object.distance=this.distance),void 0!==this.angle&&(t.object.angle=this.angle),void 0!==this.decay&&(t.object.decay=this.decay),void 0!==this.penumbra&&(t.object.penumbra=this.penumbra),void 0!==this.shadow&&(t.object.shadow=this.shadow.toJSON()),t}}]),n}(ma);Od.prototype.isLight=!0;var Ad=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a){var i;return Object(v.a)(this,n),(i=t.call(this,e,a)).type="HemisphereLight",i.position.copy(ma.DefaultUp),i.updateMatrix(),i.groundColor=new Fa(r),i}return Object(g.a)(n,[{key:"copy",value:function(e){return Od.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}]),n}(Od);Ad.prototype.isHemisphereLight=!0;var _d=new Vr,Ed=new fr,Sd=new fr,Cd=function(){function e(t){Object(v.a)(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new nr(512,512),this.map=null,this.mapPass=null,this.matrix=new Vr,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new Vi,this._frameExtents=new nr(1,1),this._viewportCount=1,this._viewports=[new ur(0,0,1,1)]}return Object(g.a)(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;Ed.setFromMatrixPosition(e.matrixWorld),t.position.copy(Ed),Sd.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(Sd),t.updateMatrixWorld(),_d.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(_d),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"copy",value:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var e={};return 0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}]),e}(),Td=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(v.a)(this,n),(e=t.call(this,new Ni(50,1,.5,500))).focus=1,e}return Object(g.a)(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*tr.RAD2DEG*e.angle*this.focus,a=this.mapSize.width/this.mapSize.height,i=e.distance||t.far;r===t.fov&&a===t.aspect&&i===t.far||(t.fov=r,t.aspect=a,t.far=i,t.updateProjectionMatrix()),Object(d.a)(Object(h.a)(n.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.focus=e.focus,this}}]),n}(Cd);Td.prototype.isSpotLightShadow=!0;var Md=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return Object(v.a)(this,n),(a=t.call(this,e,r)).type="SpotLight",a.position.copy(ma.DefaultUp),a.updateMatrix(),a.target=new ma,a.distance=i,a.angle=o,a.penumbra=s,a.decay=c,a.shadow=new Td,a}return Object(g.a)(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(Od);Md.prototype.isSpotLight=!0;var kd=new Vr,Rd=new fr,Id=new fr,jd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(v.a)(this,n),(e=t.call(this,new Ni(90,1,.5,500)))._frameExtents=new nr(4,2),e._viewportCount=6,e._viewports=[new ur(2,1,1,1),new ur(0,1,1,1),new ur(3,1,1,1),new ur(1,1,1,1),new ur(3,0,1,1),new ur(1,0,1,1)],e._cubeDirections=[new fr(1,0,0),new fr(-1,0,0),new fr(0,0,1),new fr(0,0,-1),new fr(0,1,0),new fr(0,-1,0)],e._cubeUps=[new fr(0,1,0),new fr(0,1,0),new fr(0,1,0),new fr(0,1,0),new fr(0,0,1),new fr(0,0,-1)],e}return Object(g.a)(n,[{key:"updateMatrices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix,a=e.distance||n.far;a!==n.far&&(n.far=a,n.updateProjectionMatrix()),Rd.setFromMatrixPosition(e.matrixWorld),n.position.copy(Rd),Id.copy(n.position),Id.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(Id),n.updateMatrixWorld(),r.makeTranslation(-Rd.x,-Rd.y,-Rd.z),kd.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(kd)}}]),n}(Cd);jd.prototype.isPointLightShadow=!0;var Bd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(v.a)(this,n),(a=t.call(this,e,r)).type="PointLight",a.distance=i,a.decay=o,a.shadow=new jd,a}return Object(g.a)(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}]),n}(Od);Bd.prototype.isPointLight=!0;var Ld=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return Object(v.a)(this,n),(e=t.call(this)).type="OrthographicCamera",e.zoom=1,e.view=null,e.left=r,e.right=a,e.top=i,e.bottom=o,e.near=s,e.far=c,e.updateProjectionMatrix(),e}return Object(g.a)(n,[{key:"copy",value:function(e,t){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e,t),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,a,i){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=i,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,a=n-e,i=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var c=(this.right-this.left)/this.view.fullWidth/this.zoom,u=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i=(a+=c*this.view.offsetX)+c*this.view.width,s=(o-=u*this.view.offsetY)-u*this.view.height}this.projectionMatrix.makeOrthographic(a,i,o,s,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var t=ma.prototype.toJSON.call(this,e);return t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,null!==this.view&&(t.object.view=Object.assign({},this.view)),t}}]),n}(Li);Ld.prototype.isOrthographicCamera=!0;var Nd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){return Object(v.a)(this,n),t.call(this,new Ld(-5,5,5,-5,.5,500))}return n}(Cd);Nd.prototype.isDirectionalLightShadow=!0;var Dd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a;return Object(v.a)(this,n),(a=t.call(this,e,r)).type="DirectionalLight",a.position.copy(ma.DefaultUp),a.updateMatrix(),a.target=new ma,a.shadow=new Nd,a}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}]),n}(Od);Dd.prototype.isDirectionalLight=!0;var Pd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a;return Object(v.a)(this,n),(a=t.call(this,e,r)).type="AmbientLight",a}return n}(Od);Pd.prototype.isAmbientLight=!0;var Fd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return Object(v.a)(this,n),(a=t.call(this,e,r)).type="RectAreaLight",a.width=i,a.height=o,a}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.width=e.width,this.height=e.height,this}},{key:"toJSON",value:function(e){var t=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this,e);return t.object.width=this.width,t.object.height=this.height,t}}]),n}(Od);Fd.prototype.isRectAreaLight=!0;var Gd=function(){function e(){Object(v.a)(this,e),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new fr)}return Object(g.a)(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,a=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.282095),t.addScaledVector(i[1],.488603*r),t.addScaledVector(i[2],.488603*a),t.addScaledVector(i[3],.488603*n),t.addScaledVector(i[4],n*r*1.092548),t.addScaledVector(i[5],r*a*1.092548),t.addScaledVector(i[6],.315392*(3*a*a-1)),t.addScaledVector(i[7],n*a*1.092548),t.addScaledVector(i[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,a=e.z,i=this.coefficients;return t.copy(i[0]).multiplyScalar(.886227),t.addScaledVector(i[1],1.023328*r),t.addScaledVector(i[2],1.023328*a),t.addScaledVector(i[3],1.023328*n),t.addScaledVector(i[4],.858086*n*r),t.addScaledVector(i[5],.858086*r*a),t.addScaledVector(i[6],.743125*a*a-.247708),t.addScaledVector(i[7],.858086*n*a),t.addScaledVector(i[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].addScaledVector(e.coefficients[n],t);return this}},{key:"scale",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].multiplyScalar(e);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y,a=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*a,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*a,t[6]=.315392*(3*a*a-1),t[7]=1.092548*n*a,t[8]=.546274*(n*n-r*r)}}]),e}();Gd.prototype.isSphericalHarmonics3=!0;var Ud=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Gd,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(v.a)(this,n),(e=t.call(this,void 0,a)).sh=r,e}return Object(g.a)(n,[{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e),this.sh.copy(e.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(e){var t=Object(d.a)(Object(h.a)(n.prototype),"toJSON",this).call(this,e);return t.object.sh=this.sh.toArray(),t}}]),n}(Od);Ud.prototype.isLightProbe=!0;var zd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this,e)).textures={},r}return Object(g.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=new Jl(a.manager);i.setPath(a.path),i.setRequestHeader(a.requestHeader),i.setWithCredentials(a.withCredentials),i.load(e,(function(n){try{t(a.parse(JSON.parse(n)))}catch(i){r?r(i):console.error(i),a.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t=this.textures;function n(e){return void 0===t[e]&&console.warn("THREE.MaterialLoader: Undefined texture",e),t[e]}var r=new El[e.type];if(void 0!==e.uuid&&(r.uuid=e.uuid),void 0!==e.name&&(r.name=e.name),void 0!==e.color&&void 0!==r.color&&r.color.setHex(e.color),void 0!==e.roughness&&(r.roughness=e.roughness),void 0!==e.metalness&&(r.metalness=e.metalness),void 0!==e.sheen&&(r.sheen=(new Fa).setHex(e.sheen)),void 0!==e.emissive&&void 0!==r.emissive&&r.emissive.setHex(e.emissive),void 0!==e.specular&&void 0!==r.specular&&r.specular.setHex(e.specular),void 0!==e.shininess&&(r.shininess=e.shininess),void 0!==e.clearcoat&&(r.clearcoat=e.clearcoat),void 0!==e.clearcoatRoughness&&(r.clearcoatRoughness=e.clearcoatRoughness),void 0!==e.fog&&(r.fog=e.fog),void 0!==e.flatShading&&(r.flatShading=e.flatShading),void 0!==e.blending&&(r.blending=e.blending),void 0!==e.combine&&(r.combine=e.combine),void 0!==e.side&&(r.side=e.side),void 0!==e.shadowSide&&(r.shadowSide=e.shadowSide),void 0!==e.opacity&&(r.opacity=e.opacity),void 0!==e.transparent&&(r.transparent=e.transparent),void 0!==e.alphaTest&&(r.alphaTest=e.alphaTest),void 0!==e.depthTest&&(r.depthTest=e.depthTest),void 0!==e.depthWrite&&(r.depthWrite=e.depthWrite),void 0!==e.colorWrite&&(r.colorWrite=e.colorWrite),void 0!==e.stencilWrite&&(r.stencilWrite=e.stencilWrite),void 0!==e.stencilWriteMask&&(r.stencilWriteMask=e.stencilWriteMask),void 0!==e.stencilFunc&&(r.stencilFunc=e.stencilFunc),void 0!==e.stencilRef&&(r.stencilRef=e.stencilRef),void 0!==e.stencilFuncMask&&(r.stencilFuncMask=e.stencilFuncMask),void 0!==e.stencilFail&&(r.stencilFail=e.stencilFail),void 0!==e.stencilZFail&&(r.stencilZFail=e.stencilZFail),void 0!==e.stencilZPass&&(r.stencilZPass=e.stencilZPass),void 0!==e.wireframe&&(r.wireframe=e.wireframe),void 0!==e.wireframeLinewidth&&(r.wireframeLinewidth=e.wireframeLinewidth),void 0!==e.wireframeLinecap&&(r.wireframeLinecap=e.wireframeLinecap),void 0!==e.wireframeLinejoin&&(r.wireframeLinejoin=e.wireframeLinejoin),void 0!==e.rotation&&(r.rotation=e.rotation),1!==e.linewidth&&(r.linewidth=e.linewidth),void 0!==e.dashSize&&(r.dashSize=e.dashSize),void 0!==e.gapSize&&(r.gapSize=e.gapSize),void 0!==e.scale&&(r.scale=e.scale),void 0!==e.polygonOffset&&(r.polygonOffset=e.polygonOffset),void 0!==e.polygonOffsetFactor&&(r.polygonOffsetFactor=e.polygonOffsetFactor),void 0!==e.polygonOffsetUnits&&(r.polygonOffsetUnits=e.polygonOffsetUnits),void 0!==e.skinning&&(r.skinning=e.skinning),void 0!==e.morphTargets&&(r.morphTargets=e.morphTargets),void 0!==e.morphNormals&&(r.morphNormals=e.morphNormals),void 0!==e.dithering&&(r.dithering=e.dithering),void 0!==e.alphaToCoverage&&(r.alphaToCoverage=e.alphaToCoverage),void 0!==e.premultipliedAlpha&&(r.premultipliedAlpha=e.premultipliedAlpha),void 0!==e.vertexTangents&&(r.vertexTangents=e.vertexTangents),void 0!==e.visible&&(r.visible=e.visible),void 0!==e.toneMapped&&(r.toneMapped=e.toneMapped),void 0!==e.userData&&(r.userData=e.userData),void 0!==e.vertexColors&&("number"===typeof e.vertexColors?r.vertexColors=e.vertexColors>0:r.vertexColors=e.vertexColors),void 0!==e.uniforms)for(var a in e.uniforms){var i=e.uniforms[a];switch(r.uniforms[a]={},i.type){case"t":r.uniforms[a].value=n(i.value);break;case"c":r.uniforms[a].value=(new Fa).setHex(i.value);break;case"v2":r.uniforms[a].value=(new nr).fromArray(i.value);break;case"v3":r.uniforms[a].value=(new fr).fromArray(i.value);break;case"v4":r.uniforms[a].value=(new ur).fromArray(i.value);break;case"m3":r.uniforms[a].value=(new ar).fromArray(i.value);break;case"m4":r.uniforms[a].value=(new Vr).fromArray(i.value);break;default:r.uniforms[a].value=i.value}}if(void 0!==e.defines&&(r.defines=e.defines),void 0!==e.vertexShader&&(r.vertexShader=e.vertexShader),void 0!==e.fragmentShader&&(r.fragmentShader=e.fragmentShader),void 0!==e.extensions)for(var o in e.extensions)r.extensions[o]=e.extensions[o];if(void 0!==e.shading&&(r.flatShading=1===e.shading),void 0!==e.size&&(r.size=e.size),void 0!==e.sizeAttenuation&&(r.sizeAttenuation=e.sizeAttenuation),void 0!==e.map&&(r.map=n(e.map)),void 0!==e.matcap&&(r.matcap=n(e.matcap)),void 0!==e.alphaMap&&(r.alphaMap=n(e.alphaMap)),void 0!==e.bumpMap&&(r.bumpMap=n(e.bumpMap)),void 0!==e.bumpScale&&(r.bumpScale=e.bumpScale),void 0!==e.normalMap&&(r.normalMap=n(e.normalMap)),void 0!==e.normalMapType&&(r.normalMapType=e.normalMapType),void 0!==e.normalScale){var s=e.normalScale;!1===Array.isArray(s)&&(s=[s,s]),r.normalScale=(new nr).fromArray(s)}return void 0!==e.displacementMap&&(r.displacementMap=n(e.displacementMap)),void 0!==e.displacementScale&&(r.displacementScale=e.displacementScale),void 0!==e.displacementBias&&(r.displacementBias=e.displacementBias),void 0!==e.roughnessMap&&(r.roughnessMap=n(e.roughnessMap)),void 0!==e.metalnessMap&&(r.metalnessMap=n(e.metalnessMap)),void 0!==e.emissiveMap&&(r.emissiveMap=n(e.emissiveMap)),void 0!==e.emissiveIntensity&&(r.emissiveIntensity=e.emissiveIntensity),void 0!==e.specularMap&&(r.specularMap=n(e.specularMap)),void 0!==e.envMap&&(r.envMap=n(e.envMap)),void 0!==e.envMapIntensity&&(r.envMapIntensity=e.envMapIntensity),void 0!==e.reflectivity&&(r.reflectivity=e.reflectivity),void 0!==e.refractionRatio&&(r.refractionRatio=e.refractionRatio),void 0!==e.lightMap&&(r.lightMap=n(e.lightMap)),void 0!==e.lightMapIntensity&&(r.lightMapIntensity=e.lightMapIntensity),void 0!==e.aoMap&&(r.aoMap=n(e.aoMap)),void 0!==e.aoMapIntensity&&(r.aoMapIntensity=e.aoMapIntensity),void 0!==e.gradientMap&&(r.gradientMap=n(e.gradientMap)),void 0!==e.clearcoatMap&&(r.clearcoatMap=n(e.clearcoatMap)),void 0!==e.clearcoatRoughnessMap&&(r.clearcoatRoughnessMap=n(e.clearcoatRoughnessMap)),void 0!==e.clearcoatNormalMap&&(r.clearcoatNormalMap=n(e.clearcoatNormalMap)),void 0!==e.clearcoatNormalScale&&(r.clearcoatNormalScale=(new nr).fromArray(e.clearcoatNormalScale)),void 0!==e.transmission&&(r.transmission=e.transmission),void 0!==e.transmissionMap&&(r.transmissionMap=n(e.transmissionMap)),r}},{key:"setTextures",value:function(e){return this.textures=e,this}}]),n}(Vl),Hd={decodeText:function(e){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(e);for(var t="",n=0,r=e.length;n<r;n++)t+=String.fromCharCode(e[n]);try{return decodeURIComponent(escape(t))}catch(a){return t}},extractUrlBase:function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)}};function Vd(){li.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Wd(e,t,n,r){"number"===typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),Ha.call(this,e,t,n),this.meshPerAttribute=r||1}Vd.prototype=Object.assign(Object.create(li.prototype),{constructor:Vd,isInstancedBufferGeometry:!0,copy:function(e){return li.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var e=li.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),Wd.prototype=Object.assign(Object.create(Ha.prototype),{constructor:Wd,isInstancedBufferAttribute:!0,copy:function(e){return Ha.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=Ha.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}});var Jd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(v.a)(this,n),t.call(this,e)}return Object(g.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=new Jl(a.manager);i.setPath(a.path),i.setRequestHeader(a.requestHeader),i.setWithCredentials(a.withCredentials),i.load(e,(function(n){try{t(a.parse(JSON.parse(n)))}catch(i){r?r(i):console.error(i),a.manager.itemError(e)}}),n,r)}},{key:"parse",value:function(e){var t={},n={};function r(e,r){if(void 0!==t[r])return t[r];var a=e.interleavedBuffers[r],i=function(e,t){if(void 0!==n[t])return n[t];var r=e.arrayBuffers[t],a=new Uint32Array(r).buffer;return n[t]=a,a}(e,a.buffer),o=new lc(ni(a.type,i),a.stride);return o.uuid=a.uuid,t[r]=o,o}var a=e.isInstancedBufferGeometry?new Vd:new li,i=e.data.index;if(void 0!==i){var o=ni(i.type,i.array);a.setIndex(new Ha(o,1))}var s=e.data.attributes;for(var c in s){var u=s[c],l=void 0;if(u.isInterleavedBufferAttribute){l=new hc(r(e.data,u.data),u.itemSize,u.offset,u.normalized)}else{var d=ni(u.type,u.array);l=new(u.isInstancedBufferAttribute?Wd:Ha)(d,u.itemSize,u.normalized)}void 0!==u.name&&(l.name=u.name),void 0!==u.usage&&l.setUsage(u.usage),void 0!==u.updateRange&&(l.updateRange.offset=u.updateRange.offset,l.updateRange.count=u.updateRange.count),a.setAttribute(c,l)}var h=e.data.morphAttributes;if(h)for(var f in h){for(var p=h[f],m=[],v=0,g=p.length;v<g;v++){var b=p[v],y=void 0;if(b.isInterleavedBufferAttribute)y=new hc(r(e.data,b.data),b.itemSize,b.offset,b.normalized);else y=new Ha(ni(b.type,b.array),b.itemSize,b.normalized);void 0!==b.name&&(y.name=b.name),m.push(y)}a.morphAttributes[f]=m}e.data.morphTargetsRelative&&(a.morphTargetsRelative=!0);var x=e.data.groups||e.data.drawcalls||e.data.offsets;if(void 0!==x)for(var w=0,O=x.length;w!==O;++w){var A=x[w];a.addGroup(A.start,A.count,A.materialIndex)}var _=e.data.boundingSphere;if(void 0!==_){var E=new fr;void 0!==_.center&&E.fromArray(_.center),a.boundingSphere=new Lr(E,_.radius)}return e.name&&(a.name=e.name),e.userData&&(a.userData=e.userData),a}}]),n}(Vl),Xd=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(v.a)(this,n),t.call(this,e)}return Object(g.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=""===this.path?Hd.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||i;var o=new Jl(this.manager);o.setPath(this.path),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(n){var i=null;try{i=JSON.parse(n)}catch(s){return void 0!==r&&r(s),void console.error("THREE:ObjectLoader: Can't parse "+e+".",s.message)}var o=i.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?a.parse(i,t):console.error("THREE.ObjectLoader: Can't load "+e)}),n,r)}},{key:"parse",value:function(e,t){var n=this.parseAnimations(e.animations),r=this.parseShapes(e.shapes),a=this.parseGeometries(e.geometries,r),i=this.parseImages(e.images,(function(){void 0!==t&&t(c)})),o=this.parseTextures(e.textures,i),s=this.parseMaterials(e.materials,o),c=this.parseObject(e.object,a,s,n),u=this.parseSkeletons(e.skeletons,c);if(this.bindSkeletons(c,u),void 0!==t){var l=!1;for(var d in i)if(i[d]instanceof HTMLImageElement){l=!0;break}!1===l&&t(c)}return c}},{key:"parseShapes",value:function(e){var t={};if(void 0!==e)for(var n=0,r=e.length;n<r;n++){var a=(new wd).fromJSON(e[n]);t[a.uuid]=a}return t}},{key:"parseSkeletons",value:function(e,t){var n={},r={};if(t.traverse((function(e){e.isBone&&(r[e.uuid]=e)})),void 0!==e)for(var a=0,i=e.length;a<i;a++){var o=(new Uc).fromJSON(e[a],r);n[o.uuid]=o}return n}},{key:"parseGeometries",value:function(e,t){var n,r={};if(void 0!==e)for(var a=new Jd,i=0,o=e.length;i<o;i++){var s=void 0,c=e[i];switch(c.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new pl[c.type](c.width,c.height,c.widthSegments,c.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":s=new pl[c.type](c.width,c.height,c.depth,c.widthSegments,c.heightSegments,c.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new pl[c.type](c.radius,c.segments,c.thetaStart,c.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new pl[c.type](c.radiusTop,c.radiusBottom,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new pl[c.type](c.radius,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new pl[c.type](c.radius,c.widthSegments,c.heightSegments,c.phiStart,c.phiLength,c.thetaStart,c.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new pl[c.type](c.radius,c.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new pl[c.type](c.innerRadius,c.outerRadius,c.thetaSegments,c.phiSegments,c.thetaStart,c.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new pl[c.type](c.radius,c.tube,c.radialSegments,c.tubularSegments,c.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new pl[c.type](c.radius,c.tube,c.tubularSegments,c.radialSegments,c.p,c.q);break;case"TubeGeometry":case"TubeBufferGeometry":s=new pl[c.type]((new bd[c.path.type]).fromJSON(c.path),c.tubularSegments,c.radius,c.radialSegments,c.closed);break;case"LatheGeometry":case"LatheBufferGeometry":s=new pl[c.type](c.points,c.segments,c.phiStart,c.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new pl[c.type](c.vertices,c.indices,c.radius,c.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":n=[];for(var u=0,l=c.shapes.length;u<l;u++){var d=t[c.shapes[u]];n.push(d)}s=new pl[c.type](n,c.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":n=[];for(var h=0,f=c.shapes.length;h<f;h++){var p=t[c.shapes[h]];n.push(p)}var m=c.options.extrudePath;void 0!==m&&(c.options.extrudePath=(new bd[m.type]).fromJSON(m)),s=new pl[c.type](n,c.options);break;case"BufferGeometry":case"InstancedBufferGeometry":s=a.parse(c);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+c.type+'"');continue}s.uuid=c.uuid,void 0!==c.name&&(s.name=c.name),!0===s.isBufferGeometry&&void 0!==c.userData&&(s.userData=c.userData),r[c.uuid]=s}return r}},{key:"parseMaterials",value:function(e,t){var n={},r={};if(void 0!==e){var a=new zd;a.setTextures(t);for(var i=0,o=e.length;i<o;i++){var s=e[i];if("MultiMaterial"===s.type){for(var c=[],u=0;u<s.materials.length;u++){var l=s.materials[u];void 0===n[l.uuid]&&(n[l.uuid]=a.parse(l)),c.push(n[l.uuid])}r[s.uuid]=c}else void 0===n[s.uuid]&&(n[s.uuid]=a.parse(s)),r[s.uuid]=n[s.uuid]}}return r}},{key:"parseAnimations",value:function(e){var t={};if(void 0!==e)for(var n=0;n<e.length;n++){var r=e[n],a=Fl.parse(r);t[a.uuid]=a}return t}},{key:"parseImages",value:function(e,t){var n,r=this,a={};function i(e){if("string"===typeof e){var t=e;return function(e){return r.manager.itemStart(e),n.load(e,(function(){r.manager.itemEnd(e)}),void 0,(function(){r.manager.itemError(e),r.manager.itemEnd(e)}))}(/^(\/\/)|([a-z]+:(\/\/)?)/i.test(t)?t:r.resourcePath+t)}return e.data?{data:ni(e.type,e.data),width:e.width,height:e.height}:null}if(void 0!==e&&e.length>0){var o=new zl(t);(n=new ql(o)).setCrossOrigin(this.crossOrigin);for(var s=0,c=e.length;s<c;s++){var u=e[s],l=u.url;if(Array.isArray(l)){a[u.uuid]=[];for(var d=0,h=l.length;d<h;d++){var f=i(l[d]);null!==f&&(f instanceof HTMLImageElement?a[u.uuid].push(f):a[u.uuid].push(new Ui(f.data,f.width,f.height)))}}else{var p=i(u.url);null!==p&&(a[u.uuid]=p)}}}return a}},{key:"parseTextures",value:function(e,t){function n(e,t){return"number"===typeof e?e:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",e),t[e])}var r={};if(void 0!==e)for(var a=0,i=e.length;a<i;a++){var o=e[a];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===t[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=void 0,c=t[o.image];Array.isArray(c)?(s=new Fi(c),6===c.length&&(s.needsUpdate=!0)):(s=c&&c.data?new Ui(c.data,c.width,c.height):new sr(c),c&&(s.needsUpdate=!0)),s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=n(o.mapping,Kd)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=n(o.wrap[0],qd),s.wrapT=n(o.wrap[1],qd)),void 0!==o.format&&(s.format=o.format),void 0!==o.type&&(s.type=o.type),void 0!==o.encoding&&(s.encoding=o.encoding),void 0!==o.minFilter&&(s.minFilter=n(o.minFilter,Yd)),void 0!==o.magFilter&&(s.magFilter=n(o.magFilter,Yd)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),void 0!==o.premultiplyAlpha&&(s.premultiplyAlpha=o.premultiplyAlpha),void 0!==o.unpackAlignment&&(s.unpackAlignment=o.unpackAlignment),r[o.uuid]=s}return r}},{key:"parseObject",value:function(e,t,n,r){var a,i,o;function s(e){return void 0===t[e]&&console.warn("THREE.ObjectLoader: Undefined geometry",e),t[e]}function c(e){if(void 0!==e){if(Array.isArray(e)){for(var t=[],r=0,a=e.length;r<a;r++){var i=e[r];void 0===n[i]&&console.warn("THREE.ObjectLoader: Undefined material",i),t.push(n[i])}return t}return void 0===n[e]&&console.warn("THREE.ObjectLoader: Undefined material",e),n[e]}}switch(e.type){case"Scene":a=new uc,void 0!==e.background&&Number.isInteger(e.background)&&(a.background=new Fa(e.background)),void 0!==e.fog&&("Fog"===e.fog.type?a.fog=new cc(e.fog.color,e.fog.near,e.fog.far):"FogExp2"===e.fog.type&&(a.fog=new sc(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":a=new Ni(e.fov,e.aspect,e.near,e.far),void 0!==e.focus&&(a.focus=e.focus),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.filmGauge&&(a.filmGauge=e.filmGauge),void 0!==e.filmOffset&&(a.filmOffset=e.filmOffset),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"OrthographicCamera":a=new Ld(e.left,e.right,e.top,e.bottom,e.near,e.far),void 0!==e.zoom&&(a.zoom=e.zoom),void 0!==e.view&&(a.view=Object.assign({},e.view));break;case"AmbientLight":a=new Pd(e.color,e.intensity);break;case"DirectionalLight":a=new Dd(e.color,e.intensity);break;case"PointLight":a=new Bd(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":a=new Fd(e.color,e.intensity,e.width,e.height);break;case"SpotLight":a=new Md(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":a=new Ad(e.color,e.groundColor,e.intensity);break;case"LightProbe":a=(new Ud).fromJSON(e);break;case"SkinnedMesh":a=new Dc(i=s(e.geometry),o=c(e.material)),void 0!==e.bindMode&&(a.bindMode=e.bindMode),void 0!==e.bindMatrix&&a.bindMatrix.fromArray(e.bindMatrix),void 0!==e.skeleton&&(a.skeleton=e.skeleton);break;case"Mesh":a=new Ti(i=s(e.geometry),o=c(e.material));break;case"InstancedMesh":i=s(e.geometry),o=c(e.material);var u=e.count,l=e.instanceMatrix,d=e.instanceColor;(a=new Jc(i,o,u)).instanceMatrix=new Ha(new Float32Array(l.array),16),void 0!==d&&(a.instanceColor=new Ha(new Float32Array(d.array),d.itemSize));break;case"LOD":a=new Rc;break;case"Line":a=new $c(s(e.geometry),c(e.material));break;case"LineLoop":a=new ru(s(e.geometry),c(e.material));break;case"LineSegments":a=new nu(s(e.geometry),c(e.material));break;case"PointCloud":case"Points":a=new uu(s(e.geometry),c(e.material));break;case"Sprite":a=new Cc(c(e.material));break;case"Group":a=new tc;break;case"Bone":a=new Pc;break;default:a=new ma}if(a.uuid=e.uuid,void 0!==e.name&&(a.name=e.name),void 0!==e.matrix?(a.matrix.fromArray(e.matrix),void 0!==e.matrixAutoUpdate&&(a.matrixAutoUpdate=e.matrixAutoUpdate),a.matrixAutoUpdate&&a.matrix.decompose(a.position,a.quaternion,a.scale)):(void 0!==e.position&&a.position.fromArray(e.position),void 0!==e.rotation&&a.rotation.fromArray(e.rotation),void 0!==e.quaternion&&a.quaternion.fromArray(e.quaternion),void 0!==e.scale&&a.scale.fromArray(e.scale)),void 0!==e.castShadow&&(a.castShadow=e.castShadow),void 0!==e.receiveShadow&&(a.receiveShadow=e.receiveShadow),e.shadow&&(void 0!==e.shadow.bias&&(a.shadow.bias=e.shadow.bias),void 0!==e.shadow.normalBias&&(a.shadow.normalBias=e.shadow.normalBias),void 0!==e.shadow.radius&&(a.shadow.radius=e.shadow.radius),void 0!==e.shadow.mapSize&&a.shadow.mapSize.fromArray(e.shadow.mapSize),void 0!==e.shadow.camera&&(a.shadow.camera=this.parseObject(e.shadow.camera))),void 0!==e.visible&&(a.visible=e.visible),void 0!==e.frustumCulled&&(a.frustumCulled=e.frustumCulled),void 0!==e.renderOrder&&(a.renderOrder=e.renderOrder),void 0!==e.userData&&(a.userData=e.userData),void 0!==e.layers&&(a.layers.mask=e.layers),void 0!==e.children)for(var h=e.children,f=0;f<h.length;f++)a.add(this.parseObject(h[f],t,n,r));if(void 0!==e.animations)for(var p=e.animations,m=0;m<p.length;m++){var v=p[m];a.animations.push(r[v])}if("LOD"===e.type){void 0!==e.autoUpdate&&(a.autoUpdate=e.autoUpdate);for(var g=e.levels,b=0;b<g.length;b++){var y=g[b],x=a.getObjectByProperty("uuid",y.object);void 0!==x&&a.addLevel(x,y.distance)}}return a}},{key:"bindSkeletons",value:function(e,t){0!==Object.keys(t).length&&e.traverse((function(e){if(!0===e.isSkinnedMesh&&void 0!==e.skeleton){var n=t[e.skeleton];void 0===n?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",e.skeleton):e.bind(n,e.bindMatrix)}}))}},{key:"setTexturePath",value:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}]),n}(Vl),Kd={UVMapping:ye,CubeReflectionMapping:xe,CubeRefractionMapping:we,EquirectangularReflectionMapping:Oe,EquirectangularRefractionMapping:Ae,CubeUVReflectionMapping:_e,CubeUVRefractionMapping:Ee},qd={RepeatWrapping:Se,ClampToEdgeWrapping:Ce,MirroredRepeatWrapping:Te},Yd={NearestFilter:Me,NearestMipmapNearestFilter:ke,NearestMipmapLinearFilter:Ie,LinearFilter:Be,LinearMipmapNearestFilter:Le,LinearMipmapLinearFilter:De};function Qd(e){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Vl.call(this,e),this.options={premultiplyAlpha:"none"}}Qd.prototype=Object.assign(Object.create(Vl.prototype),{constructor:Qd,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var a=this,i=Ul.get(e);if(void 0!==i)return a.manager.itemStart(e),setTimeout((function(){t&&t(i),a.manager.itemEnd(e)}),0),i;var o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader,fetch(e,o).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(a.options,{colorSpaceConversion:"none"}))})).then((function(n){Ul.add(e,n),t&&t(n),a.manager.itemEnd(e)})).catch((function(t){r&&r(t),a.manager.itemError(e),a.manager.itemEnd(e)})),a.manager.itemStart(e)}});var Zd=function(){function e(){Object(v.a)(this,e),this.type="ShapePath",this.color=new Fa,this.subPaths=[],this.currentPath=null}return Object(g.a)(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new xd,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,a,i){return this.currentPath.bezierCurveTo(e,t,n,r,a,i),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n],i=new wd;i.curves=a.curves,t.push(i)}return t}function r(e,t){for(var n=t.length,r=!1,a=n-1,i=0;i<n;a=i++){var o=t[a],s=t[i],c=s.x-o.x,u=s.y-o.y;if(Math.abs(u)>Number.EPSILON){if(u<0&&(o=t[i],c=-c,s=t[a],u=-u),e.y<o.y||e.y>s.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var l=u*(e.x-o.x)-c*(e.y-o.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(s.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=s.x)return!0}}return r}var a,i,o,s=Yu.isClockWise,c=this.subPaths;if(0===c.length)return[];if(!0===t)return n(c);var u=[];if(1===c.length)return i=c[0],(o=new wd).curves=i.curves,u.push(o),u;var l=!s(c[0].getPoints());l=e?!l:l;var d,h,f=[],p=[],m=[],v=0;p[v]=void 0,m[v]=[];for(var g=0,b=c.length;g<b;g++)a=s(d=(i=c[g]).getPoints()),(a=e?!a:a)?(!l&&p[v]&&v++,p[v]={s:new wd,p:d},p[v].s.curves=i.curves,l&&v++,m[v]=[]):m[v].push({h:i,p:d[0]});if(!p[0])return n(c);if(p.length>1){for(var y=!1,x=[],w=0,O=p.length;w<O;w++)f[w]=[];for(var A=0,_=p.length;A<_;A++)for(var E=m[A],S=0;S<E.length;S++){for(var C=E[S],T=!0,M=0;M<p.length;M++)r(C.p,p[M].p)&&(A!==M&&x.push({froms:A,tos:M,hole:S}),T?(T=!1,f[M].push(C)):y=!0);T&&f[A].push(C)}x.length>0&&(y||(m=f))}for(var k=0,R=p.length;k<R;k++){o=p[k].s,u.push(o);for(var I=0,j=(h=m[k]).length;I<j;I++)o.holes.push(h[I].h)}return u}}]),e}(),$d=function(){function e(t){Object(v.a)(this,e),this.type="Font",this.data=t}return Object(g.a)(e,[{key:"generateShapes",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,n=[],r=eh(e,t,this.data),a=0,i=r.length;a<i;a++)Array.prototype.push.apply(n,r[a].toShapes());return n}}]),e}();function eh(e,t,n){for(var r=Array.from(e),a=t/n.resolution,i=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*a,o=[],s=0,c=0,u=0;u<r.length;u++){var l=r[u];if("\n"===l)s=0,c-=i;else{var d=th(l,a,s,c,n);s+=d.offsetX,o.push(d.path)}}return o}function th(e,t,n,r,a){var i=a.glyphs[e]||a.glyphs["?"];if(i){var o,s,c,u,l,d,h,f,p=new Zd;if(i.o)for(var m=i._cachedOutline||(i._cachedOutline=i.o.split(" ")),v=0,g=m.length;v<g;){switch(m[v++]){case"m":o=m[v++]*t+n,s=m[v++]*t+r,p.moveTo(o,s);break;case"l":o=m[v++]*t+n,s=m[v++]*t+r,p.lineTo(o,s);break;case"q":c=m[v++]*t+n,u=m[v++]*t+r,l=m[v++]*t+n,d=m[v++]*t+r,p.quadraticCurveTo(l,d,c,u);break;case"b":c=m[v++]*t+n,u=m[v++]*t+r,l=m[v++]*t+n,d=m[v++]*t+r,h=m[v++]*t+n,f=m[v++]*t+r,p.bezierCurveTo(l,d,h,f,c,u)}}return{offsetX:i.ha*t,path:p}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+a.familyName+".")}$d.prototype.isFont=!0;var nh,rh=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(v.a)(this,n),t.call(this,e)}return Object(g.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=new Jl(this.manager);i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(a.withCredentials),i.load(e,(function(e){var n;try{n=JSON.parse(e)}catch(i){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(e.substring(65,e.length-2))}var r=a.parse(n);t&&t(r)}),n,r)}},{key:"parse",value:function(e){return new $d(e)}}]),n}(Vl),ah={getContext:function(){return void 0===nh&&(nh=new(window.AudioContext||window.webkitAudioContext)),nh},setContext:function(e){nh=e}},ih=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){return Object(v.a)(this,n),t.call(this,e)}return Object(g.a)(n,[{key:"load",value:function(e,t,n,r){var a=this,i=new Jl(this.manager);i.setResponseType("arraybuffer"),i.setPath(this.path),i.setRequestHeader(this.requestHeader),i.setWithCredentials(this.withCredentials),i.load(e,(function(n){try{var i=n.slice(0);ah.getContext().decodeAudioData(i,(function(e){t(e)}))}catch(o){r?r(o):console.error(o),a.manager.itemError(e)}}),n,r)}}]),n}(Vl),oh=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Object(v.a)(this,n),a=t.call(this,void 0,i);var o=(new Fa).set(e),s=(new Fa).set(r),c=new fr(o.r,o.g,o.b),u=new fr(s.r,s.g,s.b),l=Math.sqrt(Math.PI),d=l*Math.sqrt(.75);return a.sh.coefficients[0].copy(c).add(u).multiplyScalar(l),a.sh.coefficients[1].copy(c).sub(u).multiplyScalar(d),a}return n}(Ud);oh.prototype.isHemisphereLightProbe=!0;var sh=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(v.a)(this,n),r=t.call(this,void 0,a);var i=(new Fa).set(e);return r.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI)),r}return n}(Ud);sh.prototype.isAmbientLightProbe=!0;var ch=new Vr,uh=new Vr,lh=function(){function e(){Object(v.a)(this,e),this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ni,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ni,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}return Object(g.a)(e,[{key:"update",value:function(e){var t=this._cache;if(t.focus!==e.focus||t.fov!==e.fov||t.aspect!==e.aspect*this.aspect||t.near!==e.near||t.far!==e.far||t.zoom!==e.zoom||t.eyeSep!==this.eyeSep){t.focus=e.focus,t.fov=e.fov,t.aspect=e.aspect*this.aspect,t.near=e.near,t.far=e.far,t.zoom=e.zoom,t.eyeSep=this.eyeSep;var n,r,a=e.projectionMatrix.clone(),i=t.eyeSep/2,o=i*t.near/t.focus,s=t.near*Math.tan(tr.DEG2RAD*t.fov*.5)/t.zoom;uh.elements[12]=-i,ch.elements[12]=i,n=-s*t.aspect+o,r=s*t.aspect+o,a.elements[0]=2*t.near/(r-n),a.elements[8]=(r+n)/(r-n),this.cameraL.projectionMatrix.copy(a),n=-s*t.aspect-o,r=s*t.aspect-o,a.elements[0]=2*t.near/(r-n),a.elements[8]=(r+n)/(r-n),this.cameraR.projectionMatrix.copy(a)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(uh),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(ch)}}]),e}(),dh=function(){function e(t){Object(v.a)(this,e),this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}return Object(g.a)(e,[{key:"start",value:function(){this.startTime=hh(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}},{key:"stop",value:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}},{key:"getElapsedTime",value:function(){return this.getDelta(),this.elapsedTime}},{key:"getDelta",value:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var t=hh();e=(t-this.oldTime)/1e3,this.oldTime=t,this.elapsedTime+=e}return e}}]),e}();function hh(){return("undefined"===typeof performance?Date:performance).now()}var fh=new fr,ph=new hr,mh=new fr,vh=new fr,gh=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e;return Object(v.a)(this,n),(e=t.call(this)).type="AudioListener",e.context=ah.getContext(),e.gain=e.context.createGain(),e.gain.connect(e.context.destination),e.filter=null,e.timeDelta=0,e._clock=new dh,e}return Object(g.a)(n,[{key:"getInput",value:function(){return this.gain}},{key:"removeFilter",value:function(){return null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}},{key:"getFilter",value:function(){return this.filter}},{key:"setFilter",value:function(e){return null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}},{key:"getMasterVolume",value:function(){return this.gain.gain.value}},{key:"setMasterVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}},{key:"updateMatrixWorld",value:function(e){Object(d.a)(Object(h.a)(n.prototype),"updateMatrixWorld",this).call(this,e);var t=this.context.listener,r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(fh,ph,mh),vh.set(0,0,-1).applyQuaternion(ph),t.positionX){var a=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(fh.x,a),t.positionY.linearRampToValueAtTime(fh.y,a),t.positionZ.linearRampToValueAtTime(fh.z,a),t.forwardX.linearRampToValueAtTime(vh.x,a),t.forwardY.linearRampToValueAtTime(vh.y,a),t.forwardZ.linearRampToValueAtTime(vh.z,a),t.upX.linearRampToValueAtTime(r.x,a),t.upY.linearRampToValueAtTime(r.y,a),t.upZ.linearRampToValueAtTime(r.z,a)}else t.setPosition(fh.x,fh.y,fh.z),t.setOrientation(vh.x,vh.y,vh.z,r.x,r.y,r.z)}}]),n}(ma),bh=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this)).type="Audio",r.listener=e,r.context=e.context,r.gain=r.context.createGain(),r.gain.connect(e.getInput()),r.autoplay=!1,r.buffer=null,r.detune=0,r.loop=!1,r.loopStart=0,r.loopEnd=0,r.offset=0,r.duration=void 0,r.playbackRate=1,r.isPlaying=!1,r.hasPlaybackControl=!0,r.source=null,r.sourceType="empty",r._startedAt=0,r._progress=0,r._connected=!1,r.filters=[],r}return Object(g.a)(n,[{key:"getOutput",value:function(){return this.gain}},{key:"setNodeSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}},{key:"setMediaElementSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}},{key:"setMediaStreamSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}},{key:"setBuffer",value:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")}},{key:"pause",value:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"stop",value:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"connect",value:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}},{key:"disconnect",value:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}},{key:"setDetune",value:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(e){return this.setFilters(e?[e]:[])}},{key:"setPlaybackRate",value:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}},{key:"setLoop",value:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"setLoopStart",value:function(e){return this.loopStart=e,this}},{key:"setLoopEnd",value:function(e){return this.loopEnd=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}},{key:"setVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}]),n}(ma),yh=new fr,xh=new hr,wh=new fr,Oh=new fr,Ah=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this,e)).panner=r.context.createPanner(),r.panner.panningModel="HRTF",r.panner.connect(r.gain),r}return Object(g.a)(n,[{key:"getOutput",value:function(){return this.panner}},{key:"getRefDistance",value:function(){return this.panner.refDistance}},{key:"setRefDistance",value:function(e){return this.panner.refDistance=e,this}},{key:"getRolloffFactor",value:function(){return this.panner.rolloffFactor}},{key:"setRolloffFactor",value:function(e){return this.panner.rolloffFactor=e,this}},{key:"getDistanceModel",value:function(){return this.panner.distanceModel}},{key:"setDistanceModel",value:function(e){return this.panner.distanceModel=e,this}},{key:"getMaxDistance",value:function(){return this.panner.maxDistance}},{key:"setMaxDistance",value:function(e){return this.panner.maxDistance=e,this}},{key:"setDirectionalCone",value:function(e,t,n){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=t,this.panner.coneOuterGain=n,this}},{key:"updateMatrixWorld",value:function(e){if(Object(d.a)(Object(h.a)(n.prototype),"updateMatrixWorld",this).call(this,e),!0!==this.hasPlaybackControl||!1!==this.isPlaying){this.matrixWorld.decompose(yh,xh,wh),Oh.set(0,0,1).applyQuaternion(xh);var t=this.panner;if(t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(yh.x,r),t.positionY.linearRampToValueAtTime(yh.y,r),t.positionZ.linearRampToValueAtTime(yh.z,r),t.orientationX.linearRampToValueAtTime(Oh.x,r),t.orientationY.linearRampToValueAtTime(Oh.y,r),t.orientationZ.linearRampToValueAtTime(Oh.z,r)}else t.setPosition(yh.x,yh.y,yh.z),t.setOrientation(Oh.x,Oh.y,Oh.z)}}}]),n}(bh),_h=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;Object(v.a)(this,e),this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}return Object(g.a)(e,[{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},{key:"getAverageFrequency",value:function(){for(var e=0,t=this.getFrequencyData(),n=0;n<t.length;n++)e+=t[n];return e/t.length}}]),e}(),Eh=function(){function e(t,n,r){var a,i,o;switch(Object(v.a)(this,e),this.binding=t,this.valueSize=r,n){case"quaternion":a=this._slerp,i=this._slerpAdditive,o=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":a=this._select,i=this._select,o=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:a=this._lerp,i=this._lerpAdditive,o=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=a,this._mixBufferRegionAdditive=i,this._setIdentity=o,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}return Object(g.a)(e,[{key:"accumulate",value:function(e,t){var n=this.buffer,r=this.valueSize,a=e*r+r,i=this.cumulativeWeight;if(0===i){for(var o=0;o!==r;++o)n[a+o]=n[o];i=t}else{var s=t/(i+=t);this._mixBufferRegion(n,a,0,s,r)}this.cumulativeWeight=i}},{key:"accumulateAdditive",value:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}},{key:"apply",value:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,a=this.cumulativeWeight,i=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,a<1){var s=t*this._origIndex;this._mixBufferRegion(n,r,s,1-a,t)}i>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var c=t,u=t+t;c!==u;++c)if(n[c]!==n[c+t]){o.setValue(n,r);break}}},{key:"saveOriginalState",value:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var a=n,i=r;a!==i;++a)t[a]=t[r+a%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}},{key:"restoreOriginalState",value:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}},{key:"_setAdditiveIdentityNumeric",value:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0}},{key:"_setAdditiveIdentityQuaternion",value:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}},{key:"_setAdditiveIdentityOther",value:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}},{key:"_select",value:function(e,t,n,r,a){if(r>=.5)for(var i=0;i!==a;++i)e[t+i]=e[n+i]}},{key:"_slerp",value:function(e,t,n,r){hr.slerpFlat(e,t,e,t,e,n,r)}},{key:"_slerpAdditive",value:function(e,t,n,r,a){var i=this._workIndex*a;hr.multiplyQuaternionsFlat(e,i,e,t,e,n),hr.slerpFlat(e,t,e,t,e,i,r)}},{key:"_lerp",value:function(e,t,n,r,a){for(var i=1-r,o=0;o!==a;++o){var s=t+o;e[s]=e[s]*i+e[n+o]*r}}},{key:"_lerpAdditive",value:function(e,t,n,r,a){for(var i=0;i!==a;++i){var o=t+i;e[o]=e[o]+e[n+i]*r}}}]),e}(),Sh="\\[\\]\\.:\\/",Ch=new RegExp("[\\[\\]\\.:\\/]","g"),Th="[^\\[\\]\\.:\\/]",Mh="[^"+Sh.replace("\\.","")+"]",kh=/((?:WC+[\/:])*)/.source.replace("WC",Th),Rh=/(WCOD+)?/.source.replace("WCOD",Mh),Ih=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Th),jh=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Th),Bh=new RegExp("^"+kh+Rh+Ih+jh+"$"),Lh=["material","materials","bones"];function Nh(e,t,n){var r=n||Dh.parseTrackName(t);this._targetGroup=e,this._bindings=e.subscribe_(t,r)}function Dh(e,t,n){this.path=t,this.parsedPath=n||Dh.parseTrackName(t),this.node=Dh.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(Nh.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,a=n.length;r!==a;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(Dh,{Composite:Nh,create:function(e,t,n){return e&&e.isAnimationObjectGroup?new Dh.Composite(e,t,n):new Dh(e,t,n)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(Ch,"")},parseTrackName:function(e){var t=Bh.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var a=n.nodeName.substring(r+1);-1!==Lh.indexOf(a)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=a)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var a=n[r];if(a.name===t||a.uuid===t)return a;var i=e(a.children);if(i)return i}return null}(e.children);if(r)return r}return null}}),Object.assign(Dh.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)e[t++]=n[r]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,a=t.propertyIndex;if(e||(e=Dh.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var i=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var o=0;o<e.length;o++)if(e[o].name===i){i=o;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==i){if(void 0===e[i])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[i]}}var s=e[r];if(void 0!==s){var c=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[a]&&(a=e.morphTargetDictionary[a])}u=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=a}else void 0!==s.fromArray&&void 0!==s.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(u=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}else{var l=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Dh.prototype,{_getValue_unbound:Dh.prototype.getValue,_setValue_unbound:Dh.prototype.setValue});var Ph=function(){function e(){Object(v.a)(this,e),this.uuid=tr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var a=this;this.stats={objects:{get total(){return a._objects.length},get inUse(){return this.total-a.nCachedObjects_}},get bindingsPerObject(){return a._bindings.length}}}return Object(g.a)(e,[{key:"add",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,a=this._bindings,i=a.length,o=void 0,s=e.length,c=this.nCachedObjects_,u=0,l=arguments.length;u!==l;++u){var d=arguments[u],h=d.uuid,f=t[h];if(void 0===f){f=s++,t[h]=f,e.push(d);for(var p=0,m=i;p!==m;++p)a[p].push(new Dh(d,n[p],r[p]))}else if(f<c){o=e[f];var v=--c,g=e[v];t[g.uuid]=f,e[f]=g,t[h]=v,e[v]=d;for(var b=0,y=i;b!==y;++b){var x=a[b],w=x[v],O=x[f];x[f]=w,void 0===O&&(O=new Dh(d,n[b],r[b])),x[v]=O}}else e[f]!==o&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=c}},{key:"remove",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,a=this.nCachedObjects_,i=0,o=arguments.length;i!==o;++i){var s=arguments[i],c=s.uuid,u=t[c];if(void 0!==u&&u>=a){var l=a++,d=e[l];t[d.uuid]=u,e[u]=d,t[c]=l,e[l]=s;for(var h=0,f=r;h!==f;++h){var p=n[h],m=p[l],v=p[u];p[u]=m,p[l]=v}}}this.nCachedObjects_=a}},{key:"uncache",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,a=this.nCachedObjects_,i=e.length,o=0,s=arguments.length;o!==s;++o){var c=arguments[o],u=c.uuid,l=t[u];if(void 0!==l)if(delete t[u],l<a){var d=--a,h=e[d],f=--i,p=e[f];t[h.uuid]=l,e[l]=h,t[p.uuid]=d,e[d]=p,e.pop();for(var m=0,v=r;m!==v;++m){var g=n[m],b=g[d],y=g[f];g[l]=b,g[d]=y,g.pop()}}else{var x=--i,w=e[x];x>0&&(t[w.uuid]=l),e[l]=w,e.pop();for(var O=0,A=r;O!==A;++O){var _=n[O];_[l]=_[x],_.pop()}}}this.nCachedObjects_=a}},{key:"subscribe_",value:function(e,t){var n=this._bindingsIndicesByPath,r=n[e],a=this._bindings;if(void 0!==r)return a[r];var i=this._paths,o=this._parsedPaths,s=this._objects,c=s.length,u=this.nCachedObjects_,l=new Array(c);r=a.length,n[e]=r,i.push(e),o.push(t),a.push(l);for(var d=u,h=s.length;d!==h;++d){var f=s[d];l[d]=new Dh(f,e,t)}return l}},{key:"unsubscribe_",value:function(e){var t=this._bindingsIndicesByPath,n=t[e];if(void 0!==n){var r=this._paths,a=this._parsedPaths,i=this._bindings,o=i.length-1,s=i[o];t[e[o]]=n,i[n]=s,i.pop(),a[n]=a[o],a.pop(),r[n]=r[o],r.pop()}}}]),e}();Ph.prototype.isAnimationObjectGroup=!0;var Fh=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.blendMode;Object(v.a)(this,e),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=a;for(var i=n.tracks,o=i.length,s=new Array(o),c={endingStart:rn,endingEnd:rn},u=0;u!==o;++u){var l=i[u].createInterpolant(null);s[u]=l,l.settings=c}this._interpolantSettings=c,this._interpolants=s,this._propertyBindings=new Array(o),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Zt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return Object(g.a)(e,[{key:"play",value:function(){return this._mixer._activateAction(this),this}},{key:"stop",value:function(){return this._mixer._deactivateAction(this),this.reset()}},{key:"reset",value:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}},{key:"isRunning",value:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}},{key:"isScheduled",value:function(){return this._mixer._isActiveAction(this)}},{key:"startAt",value:function(e){return this._startTime=e,this}},{key:"setLoop",value:function(e,t){return this.loop=e,this.repetitions=t,this}},{key:"setEffectiveWeight",value:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}},{key:"getEffectiveWeight",value:function(){return this._effectiveWeight}},{key:"fadeIn",value:function(e){return this._scheduleFading(e,0,1)}},{key:"fadeOut",value:function(e){return this._scheduleFading(e,1,0)}},{key:"crossFadeFrom",value:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,a=e._clip.duration,i=a/r,o=r/a;e.warp(1,i,t),this.warp(o,1,t)}return this}},{key:"crossFadeTo",value:function(e,t,n){return e.crossFadeFrom(this,t,n)}},{key:"stopFading",value:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"setEffectiveTimeScale",value:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}},{key:"getEffectiveTimeScale",value:function(){return this._effectiveTimeScale}},{key:"setDuration",value:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}},{key:"syncWith",value:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}},{key:"halt",value:function(e){return this.warp(this._effectiveTimeScale,0,e)}},{key:"warp",value:function(e,t,n){var r=this._mixer,a=r.time,i=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,c=o.sampleValues;return s[0]=a,s[1]=a+n,c[0]=e/i,c[1]=t/i,this}},{key:"stopWarping",value:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"getMixer",value:function(){return this._mixer}},{key:"getClip",value:function(){return this._clip}},{key:"getRoot",value:function(){return this._localRoot||this._mixer._root}},{key:"_update",value:function(e,t,n,r){if(this.enabled){var a=this._startTime;if(null!==a){var i=(e-a)*n;if(i<0||0===n)return;this._startTime=null,t=n*i}t*=this._updateTimeScale(e);var o=this._updateTime(t),s=this._updateWeight(e);if(s>0){var c=this._interpolants,u=this._propertyBindings;switch(this.blendMode){case cn:for(var l=0,d=c.length;l!==d;++l)c[l].evaluate(o),u[l].accumulateAdditive(s);break;case sn:default:for(var h=0,f=c.length;h!==f;++h)c[h].evaluate(o),u[h].accumulate(r,s)}}}else this._updateWeight(e)}},{key:"_updateWeight",value:function(e){var t=0;if(this.enabled){t=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(e)[0];t*=r,e>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=t,t}},{key:"_updateTimeScale",value:function(e){var t=0;if(!this.paused){t=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n)t*=n.evaluate(e)[0],e>n.parameterPositions[1]&&(this.stopWarping(),0===t?this.paused=!0:this.timeScale=t)}return this._effectiveTimeScale=t,t}},{key:"_updateTime",value:function(e){var t=this._clip.duration,n=this.loop,r=this.time+e,a=this._loopCount,i=n===$t;if(0===e)return-1===a?r:i&&1===(1&a)?t-r:r;if(n===Qt){-1===a&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(r>=t)r=t;else{if(!(r<0)){this.time=r;break e}r=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===a&&(e>=0?(a=0,this._setEndings(!0,0===this.repetitions,i)):this._setEndings(0===this.repetitions,!0,i)),r>=t||r<0){var o=Math.floor(r/t);r-=t*o,a+=Math.abs(o);var s=this.repetitions-a;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,r=e>0?t:0,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===s){var c=e<0;this._setEndings(c,!c,i)}else this._setEndings(!1,!1,i);this._loopCount=a,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}else this.time=r;if(i&&1===(1&a))return t-r}return r}},{key:"_setEndings",value:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=an,r.endingEnd=an):(r.endingStart=e?this.zeroSlopeAtStart?an:rn:on,r.endingEnd=t?this.zeroSlopeAtEnd?an:rn:on)}},{key:"_scheduleFading",value:function(e,t,n){var r=this._mixer,a=r.time,i=this._weightInterpolant;null===i&&(i=r._lendControlInterpolant(),this._weightInterpolant=i);var o=i.parameterPositions,s=i.sampleValues;return o[0]=a,s[0]=t,o[1]=a+e,s[1]=n,this}}]),e}(),Gh=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this))._root=e,r._initMemoryManager(),r._accuIndex=0,r.time=0,r.timeScale=1,r}return Object(g.a)(n,[{key:"_bindAction",value:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,a=r.length,i=e._propertyBindings,o=e._interpolants,s=n.uuid,c=this._bindingsByRootAndName,u=c[s];void 0===u&&(u={},c[s]=u);for(var l=0;l!==a;++l){var d=r[l],h=d.name,f=u[h];if(void 0!==f)i[l]=f;else{if(void 0!==(f=i[l])){null===f._cacheIndex&&(++f.referenceCount,this._addInactiveBinding(f,s,h));continue}var p=t&&t._propertyBindings[l].binding.parsedPath;++(f=new Eh(Dh.create(n,h,p),d.ValueTypeName,d.getValueSize())).referenceCount,this._addInactiveBinding(f,s,h),i[l]=f}o[l].resultBuffer=f.buffer}}},{key:"_activateAction",value:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var a=e._propertyBindings,i=0,o=a.length;i!==o;++i){var s=a[i];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(e)}}},{key:"_deactivateAction",value:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var a=t[n];0===--a.useCount&&(a.restoreOriginalState(),this._takeBackBinding(a))}this._takeBackAction(e)}}},{key:"_initMemoryManager",value:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}},{key:"_isActiveAction",value:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions}},{key:"_addInactiveAction",value:function(e,t,n){var r=this._actions,a=this._actionsByClip,i=a[t];if(void 0===i)i={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,a[t]=i;else{var o=i.knownActions;e._byClipCacheIndex=o.length,o.push(e)}e._cacheIndex=r.length,r.push(e),i.actionByRoot[n]=e}},{key:"_removeInactiveAction",value:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var a=e._clip.uuid,i=this._actionsByClip,o=i[a],s=o.knownActions,c=s[s.length-1],u=e._byClipCacheIndex;c._byClipCacheIndex=u,s[u]=c,s.pop(),e._byClipCacheIndex=null,delete o.actionByRoot[(e._localRoot||this._root).uuid],0===s.length&&delete i[a],this._removeInactiveBindingsForAction(e)}},{key:"_removeInactiveBindingsForAction",value:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var a=t[n];0===--a.referenceCount&&this._removeInactiveBinding(a)}}},{key:"_lendAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}},{key:"_takeBackAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}},{key:"_addInactiveBinding",value:function(e,t,n){var r=this._bindingsByRootAndName,a=this._bindings,i=r[t];void 0===i&&(i={},r[t]=i),i[n]=e,e._cacheIndex=a.length,a.push(e)}},{key:"_removeInactiveBinding",value:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,a=n.path,i=this._bindingsByRootAndName,o=i[r],s=t[t.length-1],c=e._cacheIndex;s._cacheIndex=c,t[c]=s,t.pop(),delete o[a],0===Object.keys(o).length&&delete i[r]}},{key:"_lendBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}},{key:"_takeBackBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,a=t[r];e._cacheIndex=r,t[r]=e,a._cacheIndex=n,t[n]=a}},{key:"_lendControlInterpolant",value:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Ml(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n}},{key:"_takeBackControlInterpolant",value:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,a=t[r];e.__cacheIndex=r,t[r]=e,a.__cacheIndex=n,t[n]=a}},{key:"clipAction",value:function(e,t,n){var r=t||this._root,a=r.uuid,i="string"===typeof e?Fl.findByName(r,e):e,o=null!==i?i.uuid:e,s=this._actionsByClip[o],c=null;if(void 0===n&&(n=null!==i?i.blendMode:sn),void 0!==s){var u=s.actionByRoot[a];if(void 0!==u&&u.blendMode===n)return u;c=s.knownActions[0],null===i&&(i=c._clip)}if(null===i)return null;var l=new Fh(this,i,t,n);return this._bindAction(l,c),this._addInactiveAction(l,o,a),l}},{key:"existingAction",value:function(e,t){var n=t||this._root,r=n.uuid,a="string"===typeof e?Fl.findByName(n,e):e,i=a?a.uuid:e,o=this._actionsByClip[i];return void 0!==o&&o.actionByRoot[r]||null}},{key:"stopAllAction",value:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}},{key:"update",value:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,r=this.time+=e,a=Math.sign(e),i=this._accuIndex^=1,o=0;o!==n;++o){t[o]._update(r,e,a,i)}for(var s=this._bindings,c=this._nActiveBindings,u=0;u!==c;++u)s[u].apply(i);return this}},{key:"setTime",value:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}},{key:"getRoot",value:function(){return this._root}},{key:"uncacheClip",value:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,a=r[n];if(void 0!==a){for(var i=a.knownActions,o=0,s=i.length;o!==s;++o){var c=i[o];this._deactivateAction(c);var u=c._cacheIndex,l=t[t.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,l._cacheIndex=u,t[u]=l,t.pop(),this._removeInactiveBindingsForAction(c)}delete r[n]}}},{key:"uncacheRoot",value:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var a=n[r].actionByRoot[t];void 0!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}var i=this._bindingsByRootAndName[t];if(void 0!==i)for(var o in i){var s=i[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}}},{key:"uncacheAction",value:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}]),n}(Qn);Gh.prototype._controlInterpolantsResultBuffer=new Float32Array(1);var Uh=function(){function e(t){Object(v.a)(this,e),"string"===typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}return Object(g.a)(e,[{key:"clone",value:function(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}]),e}();function zh(e,t,n){lc.call(this,e,t),this.meshPerAttribute=n||1}function Hh(e,t,n,r,a){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=a,this.version=0}function Vh(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new Hr(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new ta,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Wh(e,t){return e.distance-t.distance}function Jh(e,t,n,r){if(e.layers.test(t.layers)&&e.raycast(t,n),!0===r)for(var a=e.children,i=0,o=a.length;i<o;i++)Jh(a[i],t,n,!0)}zh.prototype=Object.assign(Object.create(lc.prototype),{constructor:zh,isInstancedInterleavedBuffer:!0,copy:function(e){return lc.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},clone:function(e){var t=lc.prototype.clone.call(this,e);return t.meshPerAttribute=this.meshPerAttribute,t},toJSON:function(e){var t=lc.prototype.toJSON.call(this,e);return t.isInstancedInterleavedBuffer=!0,t.meshPerAttribute=this.meshPerAttribute,t}}),Object.defineProperty(Hh.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Hh.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,t){return this.type=e,this.elementSize=t,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}}),Object.assign(Vh.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)},intersectObject:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Jh(e,this,n,t),n.sort(Wh),n},intersectObjects:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,a=e.length;r<a;r++)Jh(e[r],this,n,t);return n.sort(Wh),n}});var Xh=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(v.a)(this,e),this.radius=t,this.phi=n,this.theta=r,this}return Object(g.a)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(tr.clamp(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Kh=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(v.a)(this,e),this.radius=t,this.theta=n,this.y=r,this}return Object(g.a)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.theta=t,this.y=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+n*n),this.theta=Math.atan2(e,n),this.y=t,this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),qh=new nr,Yh=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new nr(1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new nr(-1/0,-1/0);Object(v.a)(this,e),this.min=t,this.max=n}return Object(g.a)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=qh.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new nr),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new nr),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}},{key:"getParameter",value:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new nr),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"clampPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new nr),t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return qh.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();Yh.prototype.isBox2=!0;var Qh=new fr,Zh=new fr,$h=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fr,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr;Object(v.a)(this,e),this.start=t,this.end=n}return Object(g.a)(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(e){return this.start.copy(e.start),this.end.copy(e.end),this}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new fr),e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new fr),e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new fr),this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){Qh.subVectors(e,this.start),Zh.subVectors(this.end,this.start);var n=Zh.dot(Zh),r=Zh.dot(Qh)/n;return t&&(r=tr.clamp(r,0,1)),r}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new fr),this.delta(n).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function ef(e){ma.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}ef.prototype=Object.create(ma.prototype),ef.prototype.constructor=ef,ef.prototype.isImmediateRenderObject=!0;var tf=new fr,nf=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r){var a;Object(v.a)(this,n),(a=t.call(this)).light=e,a.light.updateMatrixWorld(),a.matrix=e.matrixWorld,a.matrixAutoUpdate=!1,a.color=r;for(var i=new li,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],s=0,c=1;s<32;s++,c++){var u=s/32*Math.PI*2,l=c/32*Math.PI*2;o.push(Math.cos(u),Math.sin(u),1,Math.cos(l),Math.sin(l),1)}i.setAttribute("position",new Za(o,3));var d=new Xc({fog:!1,toneMapped:!1});return a.cone=new nu(i,d),a.add(a.cone),a.update(),a}return Object(g.a)(n,[{key:"dispose",value:function(){this.cone.geometry.dispose(),this.cone.material.dispose()}},{key:"update",value:function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,t=e*Math.tan(this.light.angle);this.cone.scale.set(t,t,e),tf.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(tf),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}]),n}(ma),rf=new fr,af=new Vr,of=new Vr,sf=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;Object(v.a)(this,n);for(var a=cf(e),i=new li,o=[],s=[],c=new Fa(0,0,1),u=new Fa(0,1,0),l=0;l<a.length;l++){var d=a[l];d.parent&&d.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),s.push(c.r,c.g,c.b),s.push(u.r,u.g,u.b))}i.setAttribute("position",new Za(o,3)),i.setAttribute("color",new Za(s,3));var h=new Xc({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(r=t.call(this,i,h)).type="SkeletonHelper",r.isSkeletonHelper=!0,r.root=e,r.bones=a,r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r}return Object(g.a)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.bones,r=this.geometry,a=r.getAttribute("position");of.copy(this.root.matrixWorld).invert();for(var i=0,o=0;i<t.length;i++){var s=t[i];s.parent&&s.parent.isBone&&(af.multiplyMatrices(of,s.matrixWorld),rf.setFromMatrixPosition(af),a.setXYZ(o,rf.x,rf.y,rf.z),af.multiplyMatrices(of,s.parent.matrixWorld),rf.setFromMatrixPosition(af),a.setXYZ(o+1,rf.x,rf.y,rf.z),o+=2)}r.getAttribute("position").needsUpdate=!0,Object(d.a)(Object(h.a)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(nu);function cf(e){var t=[];e&&e.isBone&&t.push(e);for(var n=0;n<e.children.length;n++)t.push.apply(t,cf(e.children[n]));return t}var uf=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a){var i;Object(v.a)(this,n);var o=new sl(r,4,2),s=new Ga({wireframe:!0,fog:!1,toneMapped:!1});return(i=t.call(this,o,s)).light=e,i.light.updateMatrixWorld(),i.color=a,i.type="PointLightHelper",i.matrix=i.light.matrixWorld,i.matrixAutoUpdate=!1,i.update(),i}return Object(g.a)(n,[{key:"dispose",value:function(){this.geometry.dispose(),this.material.dispose()}},{key:"update",value:function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}]),n}(Ti),lf=new fr,df=new Fa,hf=new Fa,ff=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a){var i;Object(v.a)(this,n),(i=t.call(this)).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=a;var o=new rl(r);o.rotateY(.5*Math.PI),i.material=new Ga({wireframe:!0,fog:!1,toneMapped:!1}),void 0===i.color&&(i.material.vertexColors=!0);var s=o.getAttribute("position"),c=new Float32Array(3*s.count);return o.setAttribute("color",new Ha(c,3)),i.add(new Ti(o,i.material)),i.update(),i}return Object(g.a)(n,[{key:"dispose",value:function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}},{key:"update",value:function(){var e=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var t=e.geometry.getAttribute("color");df.copy(this.light.color),hf.copy(this.light.groundColor);for(var n=0,r=t.count;n<r;n++){var a=n<r/2?df:hf;t.setXYZ(n,a.r,a.g,a.b)}t.needsUpdate=!0}e.lookAt(lf.setFromMatrixPosition(this.light.matrixWorld).negate())}}]),n}(ma),pf=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;Object(v.a)(this,n),i=new Fa(i),o=new Fa(o);for(var s=a/2,c=r/a,u=r/2,l=[],d=[],h=0,f=0,p=-u;h<=a;h++,p+=c){l.push(-u,0,p,u,0,p),l.push(p,0,-u,p,0,u);var m=h===s?i:o;m.toArray(d,f),f+=3,m.toArray(d,f),f+=3,m.toArray(d,f),f+=3,m.toArray(d,f),f+=3}var g=new li;g.setAttribute("position",new Za(l,3)),g.setAttribute("color",new Za(d,3));var b=new Xc({vertexColors:!0,toneMapped:!1});return(e=t.call(this,g,b)).type="GridHelper",e}return n}(nu),mf=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:8,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:4473924,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:8947848;Object(v.a)(this,n),s=new Fa(s),c=new Fa(c);for(var u=[],l=[],d=0;d<=a;d++){var h=d/a*(2*Math.PI),f=Math.sin(h)*r,p=Math.cos(h)*r;u.push(0,0,0),u.push(f,0,p);var m=1&d?s:c;l.push(m.r,m.g,m.b),l.push(m.r,m.g,m.b)}for(var g=0;g<=i;g++)for(var b=1&g?s:c,y=r-r/i*g,x=0;x<o;x++){var w=x/o*(2*Math.PI),O=Math.sin(w)*y,A=Math.cos(w)*y;u.push(O,0,A),l.push(b.r,b.g,b.b),w=(x+1)/o*(2*Math.PI),O=Math.sin(w)*y,A=Math.cos(w)*y,u.push(O,0,A),l.push(b.r,b.g,b.b)}var _=new li;_.setAttribute("position",new Za(u,3)),_.setAttribute("color",new Za(l,3));var E=new Xc({vertexColors:!0,toneMapped:!1});return(e=t.call(this,_,E)).type="PolarGridHelper",e}return n}(nu),vf=new fr,gf=new fr,bf=new fr,yf=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e,r,a){var i;Object(v.a)(this,n),(i=t.call(this)).light=e,i.light.updateMatrixWorld(),i.matrix=e.matrixWorld,i.matrixAutoUpdate=!1,i.color=a,void 0===r&&(r=1);var o=new li;o.setAttribute("position",new Za([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3));var s=new Xc({fog:!1,toneMapped:!1});return i.lightPlane=new $c(o,s),i.add(i.lightPlane),(o=new li).setAttribute("position",new Za([0,0,0,0,0,1],3)),i.targetLine=new $c(o,s),i.add(i.targetLine),i.update(),i}return Object(g.a)(n,[{key:"dispose",value:function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}},{key:"update",value:function(){vf.setFromMatrixPosition(this.light.matrixWorld),gf.setFromMatrixPosition(this.light.target.matrixWorld),bf.subVectors(gf,vf),this.lightPlane.lookAt(gf),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(gf),this.targetLine.scale.z=bf.length()}}]),n}(ma),xf=new fr,wf=new Li,Of=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r;Object(v.a)(this,n);var a=new li,i=new Xc({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],s=[],c={},u=new Fa(16755200),l=new Fa(16711680),d=new Fa(43775),h=new Fa(16777215),f=new Fa(3355443);function p(e,t,n){m(e,n),m(t,n)}function m(e,t){o.push(0,0,0),s.push(t.r,t.g,t.b),void 0===c[e]&&(c[e]=[]),c[e].push(o.length/3-1)}return p("n1","n2",u),p("n2","n4",u),p("n4","n3",u),p("n3","n1",u),p("f1","f2",u),p("f2","f4",u),p("f4","f3",u),p("f3","f1",u),p("n1","f1",u),p("n2","f2",u),p("n3","f3",u),p("n4","f4",u),p("p","n1",l),p("p","n2",l),p("p","n3",l),p("p","n4",l),p("u1","u2",d),p("u2","u3",d),p("u3","u1",d),p("c","t",h),p("p","c",f),p("cn1","cn2",f),p("cn3","cn4",f),p("cf1","cf2",f),p("cf3","cf4",f),a.setAttribute("position",new Za(o,3)),a.setAttribute("color",new Za(s,3)),(r=t.call(this,a,i)).type="CameraHelper",r.camera=e,r.camera.updateProjectionMatrix&&r.camera.updateProjectionMatrix(),r.matrix=e.matrixWorld,r.matrixAutoUpdate=!1,r.pointMap=c,r.update(),r}return Object(g.a)(n,[{key:"update",value:function(){var e=this.geometry,t=this.pointMap;wf.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Af("c",t,e,wf,0,0,-1),Af("t",t,e,wf,0,0,1),Af("n1",t,e,wf,-1,-1,-1),Af("n2",t,e,wf,1,-1,-1),Af("n3",t,e,wf,-1,1,-1),Af("n4",t,e,wf,1,1,-1),Af("f1",t,e,wf,-1,-1,1),Af("f2",t,e,wf,1,-1,1),Af("f3",t,e,wf,-1,1,1),Af("f4",t,e,wf,1,1,1),Af("u1",t,e,wf,.7,1.1,-1),Af("u2",t,e,wf,-.7,1.1,-1),Af("u3",t,e,wf,0,2,-1),Af("cf1",t,e,wf,-1,0,1),Af("cf2",t,e,wf,1,0,1),Af("cf3",t,e,wf,0,-1,1),Af("cf4",t,e,wf,0,1,1),Af("cn1",t,e,wf,-1,0,-1),Af("cn2",t,e,wf,1,0,-1),Af("cn3",t,e,wf,0,-1,-1),Af("cn4",t,e,wf,0,1,-1),e.getAttribute("position").needsUpdate=!0}}]),n}(nu);function Af(e,t,n,r,a,i,o){xf.set(a,i,o).unproject(r);var s=t[e];if(void 0!==s)for(var c=n.getAttribute("position"),u=0,l=s.length;u<l;u++)c.setXYZ(s[u],xf.x,xf.y,xf.z)}var _f,Ef,Sf=new vr,Cf=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;Object(v.a)(this,n);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(24),s=new li;return s.setIndex(new Ha(i,1)),s.setAttribute("position",new Ha(o,3)),(r=t.call(this,s,new Xc({color:a,toneMapped:!1}))).object=e,r.type="BoxHelper",r.matrixAutoUpdate=!1,r.update(),r}return Object(g.a)(n,[{key:"update",value:function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&Sf.setFromObject(this.object),!Sf.isEmpty()){var t=Sf.min,n=Sf.max,r=this.geometry.attributes.position,a=r.array;a[0]=n.x,a[1]=n.y,a[2]=n.z,a[3]=t.x,a[4]=n.y,a[5]=n.z,a[6]=t.x,a[7]=t.y,a[8]=n.z,a[9]=n.x,a[10]=t.y,a[11]=n.z,a[12]=n.x,a[13]=n.y,a[14]=t.z,a[15]=t.x,a[16]=n.y,a[17]=t.z,a[18]=t.x,a[19]=t.y,a[20]=t.z,a[21]=n.x,a[22]=t.y,a[23]=t.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}},{key:"setFromObject",value:function(e){return this.object=e,this.update(),this}},{key:"copy",value:function(e){return nu.prototype.copy.call(this,e),this.object=e.object,this}}]),n}(nu),Tf=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16776960;Object(v.a)(this,n);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new li;return s.setIndex(new Ha(i,1)),s.setAttribute("position",new Za(o,3)),(r=t.call(this,s,new Xc({color:a,toneMapped:!1}))).box=e,r.type="Box3Helper",r.geometry.computeBoundingSphere(),r}return Object(g.a)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),Object(d.a)(Object(h.a)(n.prototype),"updateMatrixWorld",this).call(this,e))}}]),n}(nu),Mf=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(e){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16776960;Object(v.a)(this,n);var o=i,s=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],c=new li;c.setAttribute("position",new Za(s,3)),c.computeBoundingSphere(),(r=t.call(this,c,new Xc({color:o,toneMapped:!1}))).type="PlaneHelper",r.plane=e,r.size=a;var u=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],l=new li;return l.setAttribute("position",new Za(u,3)),l.computeBoundingSphere(),r.add(new Ti(l,new Ga({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1}))),r}return Object(g.a)(n,[{key:"updateMatrixWorld",value:function(e){var t=-this.plane.constant;Math.abs(t)<1e-8&&(t=1e-8),this.scale.set(.5*this.size,.5*this.size,t),this.children[0].material.side=t<0?k:M,this.lookAt(this.plane.normal),Object(d.a)(Object(h.a)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}($c),kf=new fr,Rf=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new fr(0,0,1),a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new fr(0,0,0),i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16776960,s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2*i,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:.2*s;return Object(v.a)(this,n),(e=t.call(this)).type="ArrowHelper",void 0===_f&&((_f=new li).setAttribute("position",new Za([0,0,0,0,1,0],3)),(Ef=new vu(0,.5,1,5,1)).translate(0,-.5,0)),e.position.copy(a),e.line=new $c(_f,new Xc({color:o,toneMapped:!1})),e.line.matrixAutoUpdate=!1,e.add(e.line),e.cone=new Ti(Ef,new Ga({color:o,toneMapped:!1})),e.cone.matrixAutoUpdate=!1,e.add(e.cone),e.setDirection(r),e.setLength(i,s,c),e}return Object(g.a)(n,[{key:"setDirection",value:function(e){if(e.y>.99999)this.quaternion.set(0,0,0,1);else if(e.y<-.99999)this.quaternion.set(1,0,0,0);else{kf.set(e.z,0,-e.x).normalize();var t=Math.acos(e.y);this.quaternion.setFromAxisAngle(kf,t)}}},{key:"setLength",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2*e,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2*t;this.line.scale.set(1,Math.max(1e-4,e-t),1),this.line.updateMatrix(),this.cone.scale.set(n,t,n),this.cone.position.y=e,this.cone.updateMatrix()}},{key:"setColor",value:function(e){this.line.material.color.set(e),this.cone.material.color.set(e)}},{key:"copy",value:function(e){return Object(d.a)(Object(h.a)(n.prototype),"copy",this).call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this}}]),n}(ma),If=function(e){Object(p.a)(n,e);var t=Object(m.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Object(v.a)(this,n);var a=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],o=new li;o.setAttribute("position",new Za(a,3)),o.setAttribute("color",new Za(i,3));var s=new Xc({vertexColors:!0,toneMapped:!1});return(e=t.call(this,o,s)).type="AxesHelper",e}return n}(nu),jf=new Float32Array(1),Bf=new Int32Array(jf.buffer),Lf={toHalfFloat:function(e){jf[0]=e;var t=Bf[0],n=t>>16&32768,r=t>>12&2047,a=t>>23&255;return a<103?n:a>142?(n|=31744,n|=(255==a?0:1)&&8388607&t):a<113?n|=((r|=2048)>>114-a)+(r>>113-a&1):(n|=a-112<<10|r>>1,n+=1&r)}},Nf=Math.pow(2,8),Df=[.125,.215,.35,.446,.526,.582],Pf=5+Df.length,Ff=20,Gf=(r={},Object(c.a)(r,hn,0),Object(c.a)(r,fn,1),Object(c.a)(r,mn,2),Object(c.a)(r,gn,3),Object(c.a)(r,bn,4),Object(c.a)(r,yn,5),Object(c.a)(r,pn,6),r),Uf=new Ga({side:k,depthWrite:!1,depthTest:!1}),zf=new Ti(new ki,Uf),Hf=new Ld,Vf=np(),Wf=Vf._lodPlanes,Jf=Vf._sizeLods,Xf=Vf._sigmas,Kf=new Fa,qf=null,Yf=(1+Math.sqrt(5))/2,Qf=1/Yf,Zf=[new fr(1,1,1),new fr(-1,1,1),new fr(1,1,-1),new fr(-1,1,-1),new fr(0,Yf,Qf),new fr(0,Yf,-Qf),new fr(Qf,0,Yf),new fr(-Qf,0,Yf),new fr(Yf,Qf,0),new fr(-Yf,Qf,0)];function $f(e){var t=Math.max(e.r,e.g,e.b),n=Math.min(Math.max(Math.ceil(Math.log2(t)),-128),127);return e.multiplyScalar(Math.pow(2,-n)),(n+128)/255}var ep=function(){function e(t){Object(v.a)(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._blurMaterial=function(e){var t=new Float32Array(e),n=new fr(0,1,0);return new vl({name:"SphericalGaussianBlur",defines:{n:e},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:t},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:n},inputEncoding:{value:Gf[hn]},outputEncoding:{value:Gf[hn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:B,depthTest:!1,depthWrite:!1})}(Ff),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}return Object(g.a)(e,[{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;qf=this._renderer.getRenderTarget();var a=this._allocateTargets();return this._sceneToCubeUV(e,n,r,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}},{key:"fromEquirectangular",value:function(e){return this._fromTexture(e)}},{key:"fromCubemap",value:function(e){return this._fromTexture(e)}},{key:"compileCubemapShader",value:function(){null===this._cubemapShader&&(this._cubemapShader=op(),this._compileMaterial(this._cubemapShader))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectShader&&(this._equirectShader=ip(),this._compileMaterial(this._equirectShader))}},{key:"dispose",value:function(){this._blurMaterial.dispose(),null!==this._cubemapShader&&this._cubemapShader.dispose(),null!==this._equirectShader&&this._equirectShader.dispose();for(var e=0;e<Wf.length;e++)Wf[e].dispose()}},{key:"_cleanup",value:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(qf),e.scissorTest=!1,ap(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e){qf=this._renderer.getRenderTarget();var t=this._allocateTargets(e);return this._textureToCubeUV(e,t),this._applyPMREM(t),this._cleanup(t),t}},{key:"_allocateTargets",value:function(e){var t={magFilter:Me,minFilter:Me,generateMipmaps:!1,type:Fe,format:nt,encoding:tp(e)?e.encoding:mn,depthBuffer:!1},n=rp(t);return n.depthBuffer=!e,this._pingPongRenderTarget=rp(t),n}},{key:"_compileMaterial",value:function(e){var t=new Ti(Wf[0],e);this._renderer.compile(t,Hf)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var a=new Ni(90,1,t,n),i=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,c=s.autoClear,u=s.outputEncoding,l=s.toneMapping;s.getClearColor(Kf),s.toneMapping=fe,s.outputEncoding=hn,s.autoClear=!1;var d=!1,h=e.background;if(h){if(h.isColor){Uf.color.copy(h).convertSRGBToLinear(),e.background=null;var f=$f(Uf.color);Uf.opacity=f,d=!0}}else{Uf.color.copy(Kf).convertSRGBToLinear();var p=$f(Uf.color);Uf.opacity=p,d=!0}for(var m=0;m<6;m++){var v=m%3;0==v?(a.up.set(0,i[m],0),a.lookAt(o[m],0,0)):1==v?(a.up.set(0,0,i[m]),a.lookAt(0,o[m],0)):(a.up.set(0,i[m],0),a.lookAt(0,0,o[m])),ap(r,v*Nf,m>2?Nf:0,Nf,Nf),s.setRenderTarget(r),d&&s.render(zf,a),s.render(e,a)}s.toneMapping=l,s.outputEncoding=u,s.autoClear=c}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer;e.isCubeTexture?null==this._cubemapShader&&(this._cubemapShader=op()):null==this._equirectShader&&(this._equirectShader=ip());var r=e.isCubeTexture?this._cubemapShader:this._equirectShader,a=new Ti(Wf[0],r),i=r.uniforms;i.envMap.value=e,e.isCubeTexture||i.texelSize.value.set(1/e.image.width,1/e.image.height),i.inputEncoding.value=Gf[e.encoding],i.outputEncoding.value=Gf[t.texture.encoding],ap(t,0,0,3*Nf,2*Nf),n.setRenderTarget(t),n.render(a,Hf)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<Pf;r++){var a=Math.sqrt(Xf[r]*Xf[r]-Xf[r-1]*Xf[r-1]),i=Zf[(r-1)%Zf.length];this._blur(e,r-1,r,a,i)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,a){var i=this._pingPongRenderTarget;this._halfBlur(e,i,t,n,r,"latitudinal",a),this._halfBlur(i,e,n,n,r,"longitudinal",a)}},{key:"_halfBlur",value:function(e,t,n,r,a,i,o){var s=this._renderer,c=this._blurMaterial;"latitudinal"!==i&&"longitudinal"!==i&&console.error("blur direction must be either latitudinal or longitudinal!");var u=new Ti(Wf[r],c),l=c.uniforms,d=Jf[n]-1,h=isFinite(a)?Math.PI/(2*d):2*Math.PI/39,f=a/h,p=isFinite(a)?1+Math.floor(3*f):Ff;p>Ff&&console.warn("sigmaRadians, ".concat(a,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(Ff));for(var m=[],v=0,g=0;g<Ff;++g){var b=g/f,y=Math.exp(-b*b/2);m.push(y),0==g?v+=y:g<p&&(v+=2*y)}for(var x=0;x<m.length;x++)m[x]=m[x]/v;l.envMap.value=e.texture,l.samples.value=p,l.weights.value=m,l.latitudinal.value="latitudinal"===i,o&&(l.poleAxis.value=o),l.dTheta.value=h,l.mipInt.value=8-n,l.inputEncoding.value=Gf[e.texture.encoding],l.outputEncoding.value=Gf[e.texture.encoding];var w=Jf[r];ap(t,3*Math.max(0,Nf-2*w),(0===r?0:2*Nf)+2*w*(r>4?r-8+4:0),3*w,2*w),s.setRenderTarget(t),s.render(u,Hf)}}]),e}();function tp(e){return void 0!==e&&e.type===Fe&&(e.encoding===hn||e.encoding===fn||e.encoding===pn)}function np(){for(var e=[],t=[],n=[],r=8,a=0;a<Pf;a++){var i=Math.pow(2,r);t.push(i);var o=1/i;a>4?o=Df[a-8+4-1]:0==a&&(o=0),n.push(o);for(var s=1/(i-1),c=-s/2,u=1+s/2,l=[c,c,u,c,u,u,c,c,u,u,c,u],d=new Float32Array(108),h=new Float32Array(72),f=new Float32Array(36),p=0;p<6;p++){var m=p%3*2/3-1,v=p>2?0:-1,g=[m,v,0,m+2/3,v,0,m+2/3,v+1,0,m,v,0,m+2/3,v+1,0,m,v+1,0];d.set(g,18*p),h.set(l,12*p);var b=[p,p,p,p,p,p];f.set(b,6*p)}var y=new li;y.setAttribute("position",new Ha(d,3)),y.setAttribute("uv",new Ha(h,2)),y.setAttribute("faceIndex",new Ha(f,1)),e.push(y),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}function rp(e){var t=new lr(3*Nf,3*Nf,e);return t.texture.mapping=_e,t.texture.name="PMREM.cubeUv",t.scissorTest=!0,t}function ap(e,t,n,r,a){e.viewport.set(t,n,r,a),e.scissor.set(t,n,r,a)}function ip(){var e=new nr(1,1);return new vl({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:Gf[hn]},outputEncoding:{value:Gf[hn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform vec2 texelSize;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tvec2 f = fract( uv / texelSize - 0.5 );\n\t\t\t\tuv -= f * texelSize;\n\t\t\t\tvec3 tl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x += texelSize.x;\n\t\t\t\tvec3 tr = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.y += texelSize.y;\n\t\t\t\tvec3 br = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\t\t\t\tuv.x -= texelSize.x;\n\t\t\t\tvec3 bl = envMapTexelToLinear( texture2D ( envMap, uv ) ).rgb;\n\n\t\t\t\tvec3 tm = mix( tl, tr, f.x );\n\t\t\t\tvec3 bm = mix( bl, br, f.x );\n\t\t\t\tgl_FragColor.rgb = mix( tm, bm, f.y );\n\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:B,depthTest:!1,depthWrite:!1})}function op(){return new vl({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},inputEncoding:{value:Gf[hn]},outputEncoding:{value:Gf[hn]}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute vec3 position;\n\t\tattribute vec2 uv;\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\t".concat("\n\n\t\tuniform int inputEncoding;\n\t\tuniform int outputEncoding;\n\n\t\t#include <encodings_pars_fragment>\n\n\t\tvec4 inputTexelToLinear( vec4 value ) {\n\n\t\t\tif ( inputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( inputEncoding == 1 ) {\n\n\t\t\t\treturn sRGBToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 2 ) {\n\n\t\t\t\treturn RGBEToLinear( value );\n\n\t\t\t} else if ( inputEncoding == 3 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 7.0 );\n\n\t\t\t} else if ( inputEncoding == 4 ) {\n\n\t\t\t\treturn RGBMToLinear( value, 16.0 );\n\n\t\t\t} else if ( inputEncoding == 5 ) {\n\n\t\t\t\treturn RGBDToLinear( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn GammaToLinear( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 linearToOutputTexel( vec4 value ) {\n\n\t\t\tif ( outputEncoding == 0 ) {\n\n\t\t\t\treturn value;\n\n\t\t\t} else if ( outputEncoding == 1 ) {\n\n\t\t\t\treturn LinearTosRGB( value );\n\n\t\t\t} else if ( outputEncoding == 2 ) {\n\n\t\t\t\treturn LinearToRGBE( value );\n\n\t\t\t} else if ( outputEncoding == 3 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 7.0 );\n\n\t\t\t} else if ( outputEncoding == 4 ) {\n\n\t\t\t\treturn LinearToRGBM( value, 16.0 );\n\n\t\t\t} else if ( outputEncoding == 5 ) {\n\n\t\t\t\treturn LinearToRGBD( value, 256.0 );\n\n\t\t\t} else {\n\n\t\t\t\treturn LinearToGamma( value, 2.2 );\n\n\t\t\t}\n\n\t\t}\n\n\t\tvec4 envMapTexelToLinear( vec4 color ) {\n\n\t\t\treturn inputTexelToLinear( color );\n\n\t\t}\n\t","\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb = envMapTexelToLinear( textureCube( envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ) ) ).rgb;\n\t\t\t\tgl_FragColor = linearToOutputTexel( gl_FragColor );\n\n\t\t\t}\n\t\t"),blending:B,depthTest:!1,depthWrite:!1})}var sp=0,cp=1,up=0,lp=1,dp=2;function hp(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e}function fp(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e}function pp(e,t){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new uu(e,t)}function mp(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Cc(e)}function vp(e,t){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new uu(e,t)}function gp(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new au(e)}function bp(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new au(e)}function yp(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new au(e)}function xp(e,t,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new fr(e,t,n)}function wp(e,t){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Ha(e,t).setUsage(Un)}function Op(e,t){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Va(e,t)}function Ap(e,t){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Wa(e,t)}function _p(e,t){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new Ja(e,t)}function Ep(e,t){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Xa(e,t)}function Sp(e,t){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new Ka(e,t)}function Cp(e,t){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new qa(e,t)}function Tp(e,t){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new Ya(e,t)}function Mp(e,t){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new Za(e,t)}function kp(e,t){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new $a(e,t)}function Rp(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new If(e)}function Ip(e,t){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Cf(e,t)}function jp(e,t){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new nu(new _u(e.geometry),new Xc({color:void 0!==t?t:16777215}))}function Bp(e,t){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new nu(new fl(e.geometry),new Xc({color:void 0!==t?t:16777215}))}function Lp(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Jl(e)}function Np(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Ql(e)}function Dp(e,t,n){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Gi(e,n)}function Pp(){console.error("THREE.CanvasRenderer has been removed")}function Fp(){console.error("THREE.JSONLoader has been removed.")}$l.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create($l.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},xd.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},pf.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},sf.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Vl.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Hd.extractUrlBase(e)},Vl.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Yh.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},Yh.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Yh.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Yh.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},vr.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},vr.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},vr.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},vr.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},vr.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},Lr.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Vi.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},$h.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},tr.random16=function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},tr.nearestPowerOfTwo=function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),tr.floorPowerOfTwo(e)},tr.nextPowerOfTwo=function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),tr.ceilPowerOfTwo(e)},ar.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},ar.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},ar.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},ar.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},ar.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},ar.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},Vr.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},Vr.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Vr.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new fr).setFromMatrixColumn(this,3)},Vr.prototype.setRotationFromQuaternion=function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},Vr.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Vr.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Vr.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Vr.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Vr.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},Vr.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Vr.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Vr.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Vr.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Vr.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Vr.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Vr.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},Vr.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Vr.prototype.makeFrustum=function(e,t,n,r,a,i){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,a,i)},Vr.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},ya.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},hr.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},hr.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Hr.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Hr.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},Hr.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},ka.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},ka.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},ka.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},ka.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},ka.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},ka.barycoordFromPoint=function(e,t,n,r,a){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ka.getBarycoord(e,t,n,r,a)},ka.normal=function(e,t,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ka.getNormal(e,t,n,r)},wd.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},wd.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new $u(this,e)},wd.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ol(this,e)},nr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},nr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},nr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},fr.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},fr.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},fr.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},fr.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},fr.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},fr.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fr.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},fr.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},fr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ur.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},ur.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ma.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},ma.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},ma.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},ma.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},ma.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(ma.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Ti.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Ti.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),un},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Dc.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty($l.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ni.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(Od.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(Ha.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Un},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Un)}}}),Ha.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Un:Gn),this},Ha.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Ha.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},li.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},li.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new Ha(arguments[1],arguments[2])))},li.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},li.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},li.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},li.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},li.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(li.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Vd.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(Vh.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(lc.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===Un},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),lc.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?Un:Gn),this},lc.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},$u.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},$u.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},$u.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},uc.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Uh.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Ia.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Fa}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===I}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(bl.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(Bi.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),ic.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},ic.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},ic.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},ic.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},ic.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},ic.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},ic.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},ic.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},ic.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},ic.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},ic.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},ic.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},ic.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},ic.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},ic.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},ic.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},ic.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},ic.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},ic.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},ic.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},ic.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},ic.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},ic.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},ic.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},ic.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(ic.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?fn:hn}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(Ys.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(lr.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),bh.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new ih).load(e,(function(e){t.setBuffer(e)})),this},_h.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Pi.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},Pi.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},ir.crossOrigin=void 0,ir.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var a=new Zl;a.setCrossOrigin(this.crossOrigin);var i=a.load(e,n,void 0,r);return t&&(i.mapping=t),i},ir.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var a=new Yl;a.setCrossOrigin(this.crossOrigin);var i=a.load(e,n,void 0,r);return t&&(i.mapping=t),i},ir.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},ir.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};var Gp={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function Up(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:b}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=b)},function(e,t,n){"use strict";n.d(t,"a",(function(){return ee})),n.d(t,"b",(function(){return ne})),n.d(t,"c",(function(){return ie})),n.d(t,"d",(function(){return te}));var r=n(69),a=n(43),i=n(68),o=n(231),s=n(12),c=n(65),u=n(6),l=n(161),d=n(180),h=n(1),f=n(76),p=n(419),m=n.n(p),v=n(417),g=n.n(v),b=n(93),y=n(421),x=n.n(y),w=[];function O(e,t,n){var r,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=Object(l.a)(t);try{for(o.s();!(r=o.n()).done;){var s=r.value;if(x()(n,s.args)){if(i)return;if(s.error)throw s.error;if(s.response)return s.response;throw s.promise}}}catch(d){o.e(d)}finally{o.f()}var u={args:n,promise:e.apply(void 0,Object(c.a)(n)).then((function(e){return u.response=null==e||e})).catch((function(e){return u.error=null!=e?e:"unknown error"})).then((function(){a>0&&setTimeout((function(){var e=t.indexOf(u);-1!==e&&t.splice(e,1)}),a)}))};if(t.push(u),!i)throw u.promise}function A(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if(void 0===n||0===n.length)e.splice(0,e.length);else{var a=e.find((function(e){return x()(n,e.args)}));if(a){var i=e.indexOf(a);-1!==i&&e.splice(i,1)}}}function _(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return O(e,w,n,_.lifespan)}_.lifespan=0,_.clear=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return A.apply(void 0,[w].concat(t))},_.preload=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];O(e,w,n,_.lifespan,!0)},_.peek=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;return null==(r=w.find((function(e){return x()(t,e.args)})))?void 0:r.response};var E=n(147),S=n(420);function C(e){Object(h.useEffect)((function(){var t=e;return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[e])}function T(e,t){Object(h.useEffect)((function(){if(t){var n=e;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),function(){window.removeEventListener("scroll",n,!0)}}}),[e,t])}function M(e){var t=[];if(!e||e===document.body)return t;var n=window.getComputedStyle(e);return[n.overflow,n.overflowX,n.overflowY].some((function(e){return"auto"===e||"scroll"===e}))&&t.push(e),[].concat(t,Object(c.a)(M(e.parentElement)))}var k=["x","y","top","bottom","left","right","width","height"],R=function(e,t){return k.every((function(n){return e[n]===t[n]}))},I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{debounce:0,scroll:!1},t=e.debounce,n=e.scroll,r=e.polyfill,a=r||("undefined"===typeof window?function e(){Object(E.a)(this,e)}:window.ResizeObserver);if(!a)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");var i=Object(h.useState)({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),o=Object(s.a)(i,2),c=o[0],u=o[1],l=Object(h.useRef)({element:null,scrollContainers:null,resizeObserver:null,lastBounds:c}),d=t?"number"===typeof t?t:t.scroll:null,f=t?"number"===typeof t?t:t.resize:null,p=Object(h.useRef)(!1);Object(h.useEffect)((function(){return p.current=!0,function(){p.current=!1}}));var m=Object(h.useMemo)((function(){var e=function(){if(l.current.element){var e=l.current.element.getBoundingClientRect(),t={left:e.left,top:e.top,width:e.width,height:e.height,bottom:e.bottom,right:e.right,x:e.x,y:e.y};Object.freeze(t),p.current&&!R(l.current.lastBounds,t)&&u(l.current.lastBounds=t)}};return[e,f?Object(S.debounce)(e,f):e,d?Object(S.debounce)(e,d):e]}),[u,d,f]),v=Object(s.a)(m,3),g=v[0],b=v[1],y=v[2];function x(){l.current.scrollContainers&&(l.current.scrollContainers.forEach((function(e){return e.removeEventListener("scroll",y,!0)})),l.current.scrollContainers=null),l.current.resizeObserver&&(l.current.resizeObserver.disconnect(),l.current.resizeObserver=null)}function w(){l.current.element&&(l.current.resizeObserver=new a(y),l.current.resizeObserver.observe(l.current.element),n&&l.current.scrollContainers&&l.current.scrollContainers.forEach((function(e){return e.addEventListener("scroll",y,{capture:!0,passive:!0})})))}var O=function(e){e&&e!==l.current.element&&(x(),l.current.element=e,l.current.scrollContainers=M(e),w())};return T(y,Boolean(n)),C(b),Object(h.useEffect)((function(){x(),w()}),[n,y,b]),Object(h.useEffect)((function(){return x}),[]),[O,c,g]},j={obj:function(e){return e===Object(e)&&!j.arr(e)&&"function"!==typeof e},fun:function(e){return"function"===typeof e},str:function(e){return"string"===typeof e},num:function(e){return"number"===typeof e},und:function(e){return void 0===e},arr:function(e){return Array.isArray(e)},equ:function(e,t){if(typeof e!==typeof t||!!e!==!!t)return!1;if(j.str(e)||j.num(e)||j.obj(e))return e===t;if(j.arr(e)&&e==t)return!0;var n;for(n in e)if(!(n in t))return!1;for(n in t)if(e[n]!==t[n])return!1;return!j.und(n)||e===t}};function B(e){return(e.eventObject||e.object).uuid+"/"+e.index}function L(e){var t=new d.Vector3;function n(t){var n=e.getState().internal,r=t.offsetX-n.initialClick[0],a=t.offsetY-n.initialClick[1];return Math.round(Math.sqrt(r*r+a*a))}function r(e){return e.filter((function(e){return["Move","Over","Enter","Out","Leave"].some((function(t){var n;return null==(n=e.__r3f.handlers)?void 0:n["onPointer"+t]}))}))}function a(t){var n=e.getState().internal;Array.from(n.hovered.values()).forEach((function(e){if(!t.length||!t.find((function(t){return t.object===e.object&&t.index===e.index}))){var r=e.eventObject.__r3f.handlers;if(n.hovered.delete(B(e)),r){var a=Object(u.a)(Object(u.a)({},e),{},{intersections:t||[]});null==r.onPointerOut||r.onPointerOut(a),null==r.onPointerLeave||r.onPointerLeave(a)}}}))}function i(e,t){t.forEach((function(t){var n;return null==(n=t.__r3f.handlers)||null==n.onPointerMissed?void 0:n.onPointerMissed(e)}))}return{handlePointer:function(o){switch(o){case"onPointerLeave":case"onPointerCancel":return function(){return a([])};case"onLostPointerCapture":return function(){return e.getState().internal.captured=void 0,a([])}}return function(s){var d=e.getState(),h=d.onPointerMissed,f=d.internal;!function(t){var n,r=e.getState(),a=r.raycaster,i=r.mouse,o=r.camera,s=r.size,c=null!=(n=null==a.computeOffsets?void 0:a.computeOffsets(t,r))?n:t,u=c.offsetX,l=c.offsetY,d=s.width,h=s.height;i.set(u/d*2-1,-l/h*2+1),a.setFromCamera(i,o)}(s);var p="onPointerMove"===o,m=function(t,n){var r=e.getState().internal;return r.captured&&"click"!==n.type&&"wheel"!==n.type&&r.captured.forEach((function(e){t.find((function(t){return t.eventObject===e.eventObject}))||t.push(e)})),t}(function(t){var n=e.getState(),r=n.raycaster,a=n.internal;if(!r.enabled)return[];var i=new Set,o=[],s=t?t(a.interaction):a.interaction,c=r.intersectObjects(s,!0).filter((function(e){var t=B(e);return!i.has(t)&&(i.add(t),!0)}));r.filter&&(c=r.filter(c,n));var d,h=Object(l.a)(c);try{for(h.s();!(d=h.n()).done;)for(var f=d.value,p=f.object;p;){var m;(null==(m=p.__r3f)?void 0:m.handlers)&&o.push(Object(u.a)(Object(u.a)({},f),{},{eventObject:p})),p=p.parent}}catch(v){h.e(v)}finally{h.f()}return o}(p?r:void 0),s);p&&a(m),function(r,i,o){var s=e.getState(),d=s.raycaster,h=s.mouse,f=s.camera,p=s.internal;r.length&&function(){var e,s=t.set(h.x,h.y,0).unproject(f),m="click"===i.type?n(i):0,v=function(e){return i.target.releasePointerCapture(e)},g={stopped:!1,captured:!1},b=Object(l.a)(r);try{var y=function(){var t=e.value,n=function(e){g.captured||(g.captured=!0,p.captured=[]),p.captured&&p.captured.push(t),i.target.setPointerCapture(e)},l={};for(var h in Object.getPrototypeOf(i))l[h]=i[h];var b=Object(u.a)(Object(u.a)(Object(u.a)({},t),l),{},{intersections:r,stopped:g.stopped,delta:m,unprojectedPoint:s,ray:d.ray,camera:f,stopPropagation:function(){var e=p.captured;if((!e||e.find((function(e){return e.eventObject.id===t.eventObject.id})))&&(b.stopped=g.stopped=!0,p.hovered.size&&Array.from(p.hovered.values()).find((function(e){return e.eventObject===t.eventObject})))){var n=r.slice(0,r.indexOf(t));a([].concat(Object(c.a)(n),[t]))}},target:Object(u.a)(Object(u.a)({},i.target),{},{setPointerCapture:n,releasePointerCapture:v}),currentTarget:Object(u.a)(Object(u.a)({},i.currentTarget),{},{setPointerCapture:n,releasePointerCapture:v}),sourceEvent:i});if(o(b),!0===g.stopped)return"break"};for(b.s();!(e=b.n()).done&&"break"!==y(););}catch(x){b.e(x)}finally{b.f()}}()}(m,s,(function(e){var t=e.eventObject,n=t.__r3f.handlers;if(n)if(p){if(n.onPointerOver||n.onPointerEnter||n.onPointerOut||n.onPointerLeave){var r=B(e),a=f.hovered.get(r);a?a.stopped&&e.stopPropagation():(f.hovered.set(r,e),null==n.onPointerOver||n.onPointerOver(e),null==n.onPointerEnter||n.onPointerEnter(e))}null==n.onPointerMove||n.onPointerMove(e)}else{var c=null==n?void 0:n[o];c&&("onClick"!==o&&"onContextMenu"!==o&&"onDoubleClick"!==o||f.initialHits.includes(t))&&(c(e),i(s,f.interaction.filter((function(e){return e!==t}))))}})),"onPointerDown"===o&&(f.initialClick=[s.offsetX,s.offsetY],f.initialHits=m.map((function(e){return e.eventObject}))),"onClick"!==o&&"onContextMenu"!==o&&"onDoubleClick"!==o||m.length||n(s)<=2&&(i(s,f.interaction),h&&h())}}}}var N=function(e){return e&&!!e.getState},D=function(e,t){var n,r;return{root:N(e)?e:null!=(n=null==(r=e.__r3f)?void 0:r.root)?n:t.__r3f.root,container:N(e)?e.getState().scene:e}},P="__default",F={},G=["children","key","ref"],U={};function z(e,t){var n=e;return n.__r3f||(n.__r3f=Object(u.a)({root:null,memoizedProps:{},objects:[]},t)),e}var H,V=function(e){return e&&e.isOrthographicCamera},W=h.createContext(null),J=function(e,t,n,r){var a=r.gl,i=r.size,o=r.shadows,s=void 0!==o&&o,l=r.linear,h=void 0!==l&&l,p=r.vr,v=void 0!==p&&p,g=r.orthographic,b=void 0!==g&&g,y=r.frameloop,x=void 0===y?"always":y,w=r.dpr,O=void 0===w?1:w,A=r.performance,_=r.clock,E=void 0===_?new d.Clock:_,S=r.raycaster,C=r.camera,T=r.onPointerMissed;s&&(a.shadowMap.enabled=!0,"object"===typeof s?Object.assign(a.shadowMap,s):a.shadowMap.type=d.PCFSoftShadowMap),h||(a.toneMapping=d.ACESFilmicToneMapping,a.outputEncoding=d.sRGBEncoding);var M=Object(f.a)((function(i,o){var s=new d.Raycaster;e(s,Object(u.a)({enabled:!0},S),{});var l=C instanceof d.Camera,f=l?C:b?new d.OrthographicCamera(0,0,0,0,.1,1e3):new d.PerspectiveCamera(75,0,.1,1e3);function p(e){return Array.isArray(e)?Math.max(Math.min(e[0],window.devicePixelRatio),e[1]):e}l||(f.position.z=5,C&&e(f,C,{}),f.lookAt(0,0,0));var m=p(O),g=new d.Vector3,y=new d.Vector3;function w(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o().camera,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o().size,r=n.width,a=n.height,i=r/a,s=e.getWorldPosition(g).distanceTo(t);if(V(e))return{width:r/e.zoom,height:a/e.zoom,factor:1,distance:s,aspect:i};var c=e.fov*Math.PI/180,u=2*Math.tan(c/2)*s,l=u*(r/a);return{width:l,height:u,factor:r/l,distance:s,aspect:i}}var _=void 0,M=function(e){return i((function(t){return{performance:Object(u.a)(Object(u.a)({},t.performance),{},{current:e})}}))};return{gl:a,set:i,get:o,invalidate:function(){return t(o())},advance:function(e,t){return n(e,t,o())},linear:h,scene:z(new d.Scene),camera:f,raycaster:s,clock:E,mouse:new d.Vector2,vr:v,frameloop:x,onPointerMissed:T,performance:Object(u.a)(Object(u.a)({current:1,min:.5,max:1,debounce:200},A),{},{regress:function(){var e=o();_&&clearTimeout(_),e.performance.current!==e.performance.min&&M(e.performance.min),_=setTimeout((function(){return M(o().performance.max)}),e.performance.debounce)}}),size:{width:0,height:0},viewport:{initialDpr:m,dpr:m,width:0,height:0,aspect:0,distance:0,factor:0,getCurrentViewport:w},setSize:function(e,t){var n={width:e,height:t};i((function(e){return{size:n,viewport:Object(u.a)(Object(u.a)({},e.viewport),w(f,y,n))}}))},setDpr:function(e){return i((function(t){return{viewport:Object(u.a)(Object(u.a)({},t.viewport),{},{dpr:p(e)})}}))},events:{connected:!1},internal:{active:!1,priority:0,frames:0,lastProps:r,interaction:[],hovered:new Map,subscribers:[],captured:void 0,initialClick:[0,0],initialHits:[],subscribe:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return i((function(n){var r=n.internal;return{internal:Object(u.a)(Object(u.a)({},r),{},{priority:r.priority+(t?1:0),subscribers:[].concat(Object(c.a)(r.subscribers),[{ref:e,priority:t}]).sort((function(e,t){return e.priority-t.priority}))})}})),function(){i((function(n){var r=n.internal;return{internal:Object(u.a)(Object(u.a)({},r),{},{priority:r.priority-(t?1:0),subscribers:r.subscribers.filter((function(t){return t.ref!==e}))})}}))}}}}}));M.subscribe((function(){var e=M.getState(),t=e.camera,n=e.size,r=e.viewport;e.internal.lastProps.camera instanceof d.Camera||(V(t)?(t.left=n.width/-2,t.right=n.width/2,t.top=n.height/2,t.bottom=n.height/-2):t.aspect=n.width/n.height,t.updateProjectionMatrix(),t.updateMatrixWorld()),a.setPixelRatio(r.dpr),a.setSize(n.width,n.height)}),(function(e){return[e.viewport.dpr,e.size]}),m.a);var k=M.getState();return i&&k.setSize(i.width,i.height),M.subscribe((function(e){return t(e)})),M};var X=[],K=[],q=[];function Y(e,t){for(H=0;H<e.length;H++)e[H](t)}function Q(e,t){var n=t.clock.getDelta();for(H=0;H<t.internal.subscribers.length;H++)t.internal.subscribers[H].ref.current(t,n);return!t.internal.priority&&t.gl.render&&t.gl.render(t.scene,t.camera),t.internal.frames=Math.max(0,t.internal.frames-1),"always"===t.frameloop?1:t.internal.frames}function Z(e){var t=L(e).handlePointer,n={onClick:"click",onContextMenu:"contextmenu",onDoubleClick:"dblclick",onWheel:"wheel",onPointerDown:"pointerdown",onPointerUp:"pointerup",onPointerLeave:"pointerleave",onPointerMove:"pointermove",onPointerCancel:"pointercancel",onLostPointerCapture:"lostpointercapture"};return{connected:!1,handlers:Object.keys(n).reduce((function(e,n){return Object(u.a)(Object(u.a)({},e),{},Object(i.a)({},n,t(n)))}),{}),connect:function(t){var r,a=e.getState(),i=a.set,o=a.events;null==o.disconnect||o.disconnect(),i((function(e){return{events:Object(u.a)(Object(u.a)({},e.events),{},{connected:t})}})),Object.entries(null!=(r=null==o?void 0:o.handlers)?r:[]).forEach((function(e){var r=Object(s.a)(e,2),a=r[0],i=r[1];return t.addEventListener(n[a],i,{passive:!0})}))},disconnect:function(){var t,r=e.getState(),a=r.set,i=r.events;i.connected&&(Object.entries(null!=(t=i.handlers)?t:[]).forEach((function(e){var t=Object(s.a)(e,2),r=t[0],a=t[1];i&&i.connected instanceof HTMLElement&&i.connected.removeEventListener(n[r],a)})),a((function(e){return{events:Object(u.a)(Object(u.a)({},e.events),{},{connected:!1})}})))}}}var $="undefined"!==typeof window?h.useLayoutEffect:h.useEffect;function ee(e){var t=e.children,n=e.tabIndex,r=e.resize,i=e.id,o=e.style,c=e.className,l=e.events,d=Object(a.a)(e,["children","tabIndex","resize","id","style","className","events"]),f=I(Object(u.a)({scroll:!0,debounce:{scroll:50,resize:0}},r)),p=Object(s.a)(f,2),m=p[0],v=p[1],g=h.useRef(null);return $((function(){v.width>0&&v.height>0&&function(e,t){var n,r,i,o,s,c=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},l=c.gl,d=c.size,f=c.mode,p=void 0===f?se[1]:f,m=c.events,v=c.onCreated,g=Object(a.a)(c,["gl","size","mode","events","onCreated"]);d||(d={width:null!=(r=null==(i=t.parentElement)?void 0:i.clientWidth)?r:0,height:null!=(o=null==(s=t.parentElement)?void 0:s.clientHeight)?o:0});var b=oe.get(t),y=null==b?void 0:b.fiber,x=null==b?void 0:b.store,w=null==(n=x)?void 0:n.getState();if(y&&w){var O=w.internal.lastProps;void 0===g.dpr||j.equ(O.dpr,g.dpr)||w.setDpr(g.dpr),void 0===d||j.equ(O.size,d)||w.setSize(d.width,d.height),g.linear!==O.linear&&(ve(t),y=void 0)}if(!y){var A=pe(l,t);g.vr&&(A.xr.enabled=!0,A.setAnimationLoop((function(e){return le(e,!0)})));var _=(x=J(fe,ue,le,Object(u.a)({gl:A,size:d},g))).getState();_.get,y=he.createContainer(x,se.indexOf(p),!1,null),oe.set(t,{fiber:y,store:x}),m&&_.set({events:m(x)})}if(x&&y)return he.updateContainer(h.createElement(me,{store:x,element:e,onCreated:v,target:t}),y,null,(function(){})),x;throw"Error creating root!"}(t,g.current,Object(u.a)(Object(u.a)({},d),{},{size:v,events:l||Z}))}),[v,t]),h.useEffect((function(){var e=g.current;return function(){return ve(e)}}),[]),h.createElement("div",{ref:m,id:i,className:c,tabIndex:n,style:Object(u.a)({position:"relative",width:"100%",height:"100%",overflow:"hidden"},o)},h.createElement("canvas",{ref:g,style:{display:"block"}}))}function te(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(e){return e},t=arguments.length>1?arguments[1]:void 0,n=h.useContext(W);if(!n)throw"R3F hooks can only be used within the Canvas component!";return n(e,t)}function ne(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=h.useContext(W).getState().internal.subscribe,r=h.useRef(e);return h.useLayoutEffect((function(){r.current=e}),[e]),h.useEffect((function(){var e=n(r,t);return function(){return e()}}),[t,n]),null}function re(e){var t={nodes:{},materials:{}};return e&&e.traverse((function(e){e.name&&(t.nodes[e.name]=e),e.material&&!t.materials[e.material.name]&&(t.materials[e.material.name]=e.material)})),t}function ae(e,t){return function(n){var r=new n;e&&e(r);for(var a=arguments.length,i=new Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return Promise.all(i.map((function(e){return new Promise((function(n,a){return r.load(e,(function(e){e.scene&&Object.assign(e,re(e.scene)),n(e)}),t,(function(t){var n;return a(null!=(n=t.message)?n:"failure loading ".concat(e))}))}))})))}}function ie(e,t,n,r){var a=Array.isArray(t)?t:[t],i=_.apply(void 0,[ae(n,r),e].concat(Object(c.a)(a)));return Array.isArray(t)?i:i[0]}ie.preload=function(e,t,n){var r=Array.isArray(t)?t:[t];return _.preload.apply(_,[ae(n),e].concat(Object(c.a)(r)))};var oe=new Map,se=["legacy","blocking","concurrent"],ce=function(e){var t,n=!1;function r(a){if(n=!0,t=0,Y(X,a),e.forEach((function(e){var n=e.store.getState();n.internal.active&&("always"===n.frameloop||n.internal.frames>0)&&(t+=Q(0,n))})),Y(K,a),t>0)return requestAnimationFrame(r);Y(q,a),n=!1}return{loop:r,invalidate:function t(a){if(!a)return e.forEach((function(e){return t(e.store.getState())}));!a.vr&&a.internal.active&&"never"!==a.frameloop&&(a.internal.frames=Math.min(60,a.internal.frames+1),n||(n=!0,requestAnimationFrame(r)))},advance:function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0;n&&Y(X,t),r?Q(0,r):e.forEach((function(e){return Q(0,e.store.getState())})),n&&Y(K,t)}}}(oe),ue=ce.invalidate,le=ce.advance,de=function(e){function t(e,t){var r,a,h,f=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},p=arguments.length>3&&void 0!==arguments[3]&&arguments[3],m=null!=(r=null==e?void 0:e.__r3f)?r:{},v=m.root,g=null!=(a=null==v||null==v.getState?void 0:v.getState())?a:{},b=[],y=[],x={},w=0;Object.entries(t).forEach((function(e){var t=Object(s.a)(e,2),n=t[0],r=t[1];-1===G.indexOf(n)&&(x[n]=r)})),m.memoizedProps&&m.memoizedProps.args&&(x.args=m.memoizedProps.args),m.memoizedProps&&m.memoizedProps.attach&&(x.attach=m.memoizedProps.attach),e.__r3f&&(e.__r3f.memoizedProps=x);var O=Object.keys(t);for(w=0;w<O.length;w++)j.equ(t[O[w]],f[O[w]])&&b.push(O[w]),j.fun(t[O[w]])&&/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(O[w])&&y.push(O[w]);var A=[];if(p)for(O=Object.keys(f),w=0;w<O.length;w++)t.hasOwnProperty(O[w])||A.push(O[w]);var _=[].concat(b,G);null!=(h=e.__r3f)&&h.instance&&_.push("object");var E=Object(u.a)({},t);for(O=Object.keys(E),w=0;w<O.length;w++)_.indexOf(O[w])>-1&&delete E[O[w]];var S=Object.entries(E);for(w=0;w<A.length;w++)"children"!==A[w]&&S.unshift([A[w],P+"remove"]);if(S.length>0){if(S.forEach((function(t){var r=Object(s.a)(t,2),a=r[0],i=r[1];if(!y.includes(a)){var u,l=e,h=l[a];if(a.includes("-")){var f=a.split("-");if(!(h=f.reduce((function(e,t){return e[t]}),e))||!h.set){var p=f.reverse(),m=Object(o.a)(p),v=m[0];l=m.slice(1).reverse().reduce((function(e,t){return e[t]}),e),a=v}}if(i===P+"remove")if(h&&h.constructor)i=new h.constructor(x.args);else if(l.constructor){var b=new l.constructor(l.__r3f.memoizedProps.args);i=b[h],b.dispose&&b.dispose()}else i=0;if(h&&h.set&&(h.copy||h instanceof d.Layers)){if(Array.isArray(i))if(h.fromArray)h.fromArray(i);else(u=h).set.apply(u,Object(c.a)(i));else if(h.copy&&i&&i.constructor&&h.constructor.name===i.constructor.name)h.copy(i);else if(void 0!==i){var w=h instanceof d.Color;!w&&h.setScalar?h.setScalar(i):h instanceof d.Layers&&i instanceof d.Layers?h.mask=i.mask:h.set(i),!g.linear&&w&&h.convertSRGBToLinear()}}else l[a]=i,!g.linear&&l[a]instanceof d.Texture&&(l[a].encoding=d.sRGBEncoding);n(e)}})),p&&v&&e.raycast&&m.handlers){m.handlers=void 0;var C=g.internal.interaction.indexOf(e);C>-1&&g.internal.interaction.splice(C,1)}y.length&&(p&&v&&e.raycast&&g.internal.interaction.push(e),m.handlers=y.reduce((function(e,n){return Object(u.a)(Object(u.a)({},e),{},Object(i.a)({},n,t[n]))}),{})),e.parent&&l(e)}}function n(e){var t,n,r=null==(t=e.__r3f)||null==(n=t.root)||null==n.getState?void 0:n.getState();r&&0===r.internal.frames&&r.invalidate()}function l(e){null==e.onUpdate||e.onUpdate(e)}function h(e,n,i,o,s){var l,h=n.args,f=void 0===h?[]:h,p=Object(a.a)(n,["args"]),m="".concat(e[0].toUpperCase()).concat(e.slice(1));if(!N(i)&&s){i=function e(t){return t.return?e(t.return):t.stateNode&&t.stateNode.containerInfo}(s)}if(!i||!N(i))throw"No valid root for ".concat(m,"!");if("primitive"===e){if(void 0===p.object)throw"Primitives without 'object' are invalid!";l=z(p.object,{root:i,instance:!0})}else{var v=U[m]||d[m];if(!v)throw"".concat(m," is not part of the THREE namespace! Did you forget to extend? See: https://github.com/pmndrs/react-three-fiber/blob/master/markdown/api.md#using-3rd-party-objects-declaratively");var g=j.arr(f);l=z(g?Object(r.a)(v,Object(c.a)(f)):new v(f),{root:i,memoizedProps:{args:g&&0===f.length?null:f}})}return m.endsWith("Geometry")?p=Object(u.a)({attach:"geometry"},p):m.endsWith("Material")&&(p=Object(u.a)({attach:"material"},p)),t(l,p,{}),l}function f(e,t){t&&(t.isObject3D?e.add(t):(e.__r3f.objects.push(t),t.parent=e,t.attachArray?(j.arr(e[t.attachArray])||(e[t.attachArray]=[]),e[t.attachArray].push(t)):t.attachObject?(j.obj(e[t.attachObject[0]])||(e[t.attachObject[0]]={}),e[t.attachObject[0]][t.attachObject[1]]=t):t.attach&&(e[t.attach]=t)),l(t),n(t))}function p(e,t,r){if(t){if(t.isObject3D){t.parent=e,t.dispatchEvent({type:"added"});var a=e.children.filter((function(e){return e!==t})),i=a.indexOf(r);e.children=[].concat(Object(c.a)(a.slice(0,i)),[t],Object(c.a)(a.slice(i))),l(t)}else f(e,t);n(t)}}function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&Object(c.a)(e).forEach((function(e){return v(t,e,n)}))}function v(e,t,r){if(t){var a,i;if(t.isObject3D)e.remove(t),null!=(i=t.__r3f)&&i.root&&function(e,t){var n=e.getState().internal;n.interaction=n.interaction.filter((function(e){return e!==t})),n.initialHits=n.initialHits.filter((function(e){return e!==t})),n.hovered.forEach((function(e,r){e.eventObject!==t&&e.object!==t||n.hovered.delete(r)}))}(t.__r3f.root,t);else t.parent=null,e.__r3f.objects&&(e.__r3f.objects=e.__r3f.objects.filter((function(e){return e!==t}))),t.attachArray?e[t.attachArray]=e[t.attachArray].filter((function(e){return e!==t})):t.attachObject?delete e[t.attachObject[0]][t.attachObject[1]]:t.attach&&(e[t.attach]=null);var o,s=null==(a=t.__r3f)?void 0:a.instance,c=void 0===r?null!==t.dispose&&!s:r;if(!s)m(null==(o=t.__r3f)?void 0:o.objects,t,c),m(t.children,t,c);t.__r3f&&(delete t.__r3f.root,delete t.__r3f.objects,delete t.__r3f.handlers,delete t.__r3f.memoizedProps,delete t.__r3f),c&&t.dispose&&"Scene"!==t.type&&Object(b.unstable_runWithPriority)(b.unstable_IdlePriority,(function(){return t.dispose()})),n(e)}}function y(e,t,n,r){var a=e.parent;if(a){var i=h(t,n,e.__r3f.root);v(a,e),f(a,i),[r,r.alternate].forEach((function(e){null!==e&&(e.stateNode=i,e.ref&&("function"===typeof e.ref?e.ref(i):e.ref.current=i))}))}}return{reconciler:g()({now:b.unstable_now,createInstance:h,removeChild:v,appendChild:f,appendInitialChild:f,insertBefore:p,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:j.fun(setTimeout)?setTimeout:void 0,cancelTimeout:j.fun(clearTimeout)?clearTimeout:void 0,setTimeout:j.fun(setTimeout)?setTimeout:void 0,clearTimeout:j.fun(clearTimeout)?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:function(e,t){var n=D(e,t),r=n.container,a=n.root;r.__r3f.root=a,f(r,t)},removeChildFromContainer:function(e,t){v(D(e,t).container,t)},insertInContainerBefore:function(e,t,n){p(D(e,t).container,t,n)},commitUpdate:function(e,n,r,i,o,c){if(e.__r3f.instance&&o.object&&o.object!==e)y(e,r,o,c);else{var u=o.args,l=void 0===u?[]:u,d=Object(a.a)(o,["args"]),h=i.args,f=void 0===h?[]:h,p=Object(a.a)(i,["args"]);l.some((function(e,t){return j.obj(e)?Object.entries(e).some((function(e){var n=Object(s.a)(e,2),r=n[0];return n[1]!==f[t][r]})):e!==f[t]}))?y(e,r,o,c):t(e,d,p,!0)}},hideInstance:function(e){e.isObject3D&&(e.visible=!1,n(e))},unhideInstance:function(e,t){(e.isObject3D&&null==t.visible||t.visible)&&(e.visible=!0,n(e))},hideTextInstance:function(){throw new Error("Text is not allowed in the R3F tree.")},getPublicInstance:function(e){return e},getRootHostContext:function(e){return F},getChildHostContext:function(e){return F},createTextInstance:function(){},finalizeInitialChildren:function(e){return!!e.__r3f.handlers},commitMount:function(e){e.raycast&&e.__r3f.handlers&&e.__r3f.root.getState().internal.interaction.push(e)},prepareUpdate:function(){return F},shouldDeprioritizeSubtree:function(){return!1},prepareForCommit:function(){return null},preparePortalMount:function(){},resetAfterCommit:function(){},shouldSetTextContent:function(){return!1},clearContainer:function(){return!1}}),applyProps:t}}(),he=de.reconciler,fe=de.applyProps,pe=function(e,t){return(n=e)&&n.render?e:new d.WebGLRenderer(Object(u.a)({powerPreference:"high-performance",canvas:t,antialias:!0,alpha:!0},e));var n};function me(e){var t=e.store,n=e.element,r=e.onCreated,a=e.target;return h.useEffect((function(){var e=t.getState();e.set((function(e){return{internal:Object(u.a)(Object(u.a)({},e.internal),{},{active:!0})}})),null==e.events.connect||e.events.connect(a),r&&r(e)}),[]),h.createElement(W.Provider,{value:t},n)}function ve(e,t){var n=oe.get(e),r=null==n?void 0:n.fiber;if(r){var a=null==n?void 0:n.store.getState();a&&(a.internal.active=!1),he.updateContainer(null,r,null,(function(){a&&setTimeout((function(){var n,r,i;null==a.events.disconnect||a.events.disconnect(),null==(n=a.gl)||null==(r=n.renderLists)||null==r.dispose||r.dispose(),null==(i=a.gl)||null==i.forceContextLoss||i.forceContextLoss(),function(e){e.dispose&&"Scene"!==e.type&&e.dispose();for(var t in e){var n,r;null==(n=(r=t).dispose)||n.call(r),delete e[t]}}(a),oe.delete(e),t&&t(e)}),500)}))}}he.act,j.fun(Symbol)&&Symbol.for&&Symbol.for("react.portal");he.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:"17.0.2"})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return c}));var r=n(65);function a(e,t,n){var r=function(e,t,n){return function(e,t,n){var r=0,a=e.length,i=0,o=!1;for(;r<a;){var s=n(t,e[i=r+(a-r>>>1)]);s>0?r=i+1:(a=i,o=!s)}return o?r:-r-1}(e,t,n||i)}(e,t,n),a=r<0?-(r+1):r;e.splice(a,0,t)}function i(e,t){return e>t?1:e<t?-1:0}function o(e,t,n,r,a){return u(e,t,n,r,a,0)}function s(e,t,n,r,a,i){return u(e,t,n,r,a,0,!1,i,!0)}function c(e,t,n,r,a,i){return u(e,t,n,r,a,i,!0)}function u(e,t,n,i,o,s){for(var c=arguments.length>6&&void 0!==arguments[6]&&arguments[6],u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],f=arguments.length>8&&void 0!==arguments[8]&&arguments[8],p=[],m=0;m<t.length;m++)t[m]>o&&p.push({score:t[m],boxIndex:m,suppressBeginIndex:0});p.sort(h);for(var v=s>0?-.5/s:0,g=[],b=[];g.length<n&&p.length>0;){var y=p.pop(),x=y.score,w=y.boxIndex,O=y.suppressBeginIndex;if(x<o)break;for(var A=!1,_=g.length-1;_>=O;--_){var E=l(e,w,g[_]);if(E>=i){A=!0;break}if(y.score=y.score*d(i,v,E),y.score<=o)break}y.suppressBeginIndex=g.length,A||(y.score===x?(g.push(w),b.push(y.score)):y.score>o&&a(p,y,h))}var S=g.length,C=n-S;u&&C>0&&(g.push.apply(g,Object(r.a)(new Array(C).fill(0))),b.push.apply(b,Object(r.a)(new Array(C).fill(0))));var T={selectedIndices:g};return c&&(T.selectedScores=b),f&&(T.validOutputs=S),T}function l(e,t,n){var r=e.subarray(4*t,4*t+4),a=e.subarray(4*n,4*n+4),i=Math.min(r[0],r[2]),o=Math.min(r[1],r[3]),s=Math.max(r[0],r[2]),c=Math.max(r[1],r[3]),u=Math.min(a[0],a[2]),l=Math.min(a[1],a[3]),d=Math.max(a[0],a[2]),h=Math.max(a[1],a[3]),f=(s-i)*(c-o),p=(d-u)*(h-l);if(f<=0||p<=0)return 0;var m=Math.max(i,u),v=Math.max(o,l),g=Math.min(s,d),b=Math.min(c,h),y=Math.max(g-m,0)*Math.max(b-v,0);return y/(f+p-y)}function d(e,t,n){var r=Math.exp(t*n*n);return n<=e?r:0}function h(e,t){return e.score-t.score||e.score===t.score&&t.boxIndex-e.boxIndex}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({clone_:function(e){var t={x:Object(i.a)(e,"x","clone","string_or_numeric")};return r.a.runKernel(a.nb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(144),a=n(202),i=n(191);function o(e,t){Object(a.d)(e);var n=Object(r.c)(e,t);if(1!==n.length)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Object(i.a)(e,null,n,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({abs_:function(e){var t=Object(i.a)(e,"x","abs");if("complex64"===t.dtype){var n={x:t};return r.a.runKernel(a.z,n)}var o={x:t};return r.a.runKernel(a.a,o)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({neg_:function(e){var t={x:Object(i.a)(e,"x","neg")};return r.a.runKernel(a.Rb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({exp_:function(e){var t={x:Object(i.a)(e,"x","exp")};return r.a.runKernel(a.W,t)}})},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";(function(e){n(145);var t=n(222),r=n(153),a=Object(r.b)();a.registerFlag("DEBUG",(function(){return!1}),(function(e){e&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")})),a.registerFlag("IS_BROWSER",(function(){return t.isBrowser()})),a.registerFlag("IS_NODE",(function(){return"undefined"!==typeof e&&"undefined"!==typeof e.versions&&"undefined"!==typeof e.versions.node})),a.registerFlag("IS_CHROME",(function(){return"undefined"!==typeof navigator&&null!=navigator&&null!=navigator.userAgent&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)})),a.registerFlag("PROD",(function(){return!1})),a.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",(function(){return a.getBool("DEBUG")})),a.registerFlag("DEPRECATION_WARNINGS_ENABLED",(function(){return!0})),a.registerFlag("IS_TEST",(function(){return!1})),a.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",(function(){return!0})),a.registerFlag("WRAP_TO_IMAGEBITMAP",(function(){return!1}))}).call(this,n(92))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(145),a=n(202),i=n(148);function o(e,t,n,o){if(null==o&&(o=Object(a.r)(e)),"complex64"===o)throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!Object(a.A)(e)&&!Array.isArray(e)&&"number"!==typeof e&&"boolean"!==typeof e&&"string"!==typeof e)throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(null!=t){Object(a.c)(t);var s=Object(a.O)(t),c=Object(a.O)(n);Object(a.b)(s===c,(function(){return"Based on the provided shape, [".concat(t,"], the tensor should have ")+"".concat(s," values but has ").concat(c)}));for(var u=0;u<n.length;++u){var l=n[u],d=u!==n.length-1||l!==Object(a.O)(t.slice(u));Object(a.b)(n[u]===t[u]||!d,(function(){return"Error creating a new Tensor. Inferred shape "+"(".concat(n,") does not match the provided ")+"shape (".concat(t,"). ")}))}}return Object(a.A)(e)||Array.isArray(e)||(e=[e]),t=t||n,e="string"!==o?Object(i.toTypedArray)(e,o):Object(a.m)(e,[],!0),r.a.makeTensor(e,t,o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({stack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.b)(e,"tensors","stack","string_or_numeric");o.b(n.length>=1,(function(){return"Pass at least one tensor to tf.stack"})),n.length>0&&o.b(t<=n[0].rank,(function(){return"Axis must be <= rank of the tensor"}));var s=n,c={axis:t};return r.a.runKernel(a.Yb,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(145),a=n(202),i=n(174);function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=o(e,"float32"),s=o(e,"float32");return Object(i.a)(n,s)}var c=Object(a.F)(Object(a.O)(e),t);return r.a.makeTensor(c,e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(236),c=n(154),u=n(143);var l=Object(u.a)({where_:function(e,t,n){var u=Object(i.a)(t,"a","where"),l=Object(i.a)(n,"b","where"),d=Object(i.a)(e,"condition","where","bool"),h=Object(c.a)(u.shape,l.shape),f=Object(s.a)(u,h),p=Object(s.a)(l,h);1===d.rank&&Object(o.b)(d.shape[0]===u.shape[0],(function(){return"The first dimension of `a` must match the size of `condition`."})),1!==d.rank&&Object(o.e)(d.shape,p.shape,"Error in where: ");var m={condition:d,t:f,e:p};return r.a.runKernel(a.tc,m)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return d}));var r=n(202);function a(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function i(e,t,n){for(var r=e.length+t.length,a=[],i=0,o=0,s=0;s<r;s++)-1===n.indexOf(s)?a.push(e[i++]):a.push(t[o++]);return a}function o(e,t){for(var n=[],r=e.length,a=0;a<r;a++)-1===t.indexOf(a)&&n.push(e[a]);return[n,t.map((function(t){return e[t]}))]}function s(e,t){return i(e,t.map((function(e){return 1})),t)}function c(e,t,n){r.b(a(t,n),(function(){return"".concat(e," supports only inner-most axes for now. ")+"Got axes ".concat(t," and rank-").concat(n," input.")}))}function u(e,t){if(a(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach((function(e){return n.push(e)})),n}function l(e){return e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})).map((function(e){return e[0]}))}function d(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({max_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","max"),s={x:o},c={reductionIndices:t,keepDims:n};return r.a.runKernel(a.Db,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({relu_:function(e){var t={x:Object(i.a)(e,"x","relu")};return r.a.runKernel(a.hc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({log_:function(e){var t={x:Object(i.a)(e,"x","log")};return r.a.runKernel(a.yb,t)}})},function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return s}));var r=n(65),a=n(202);function i(e,t,n){var r=t.rank>1?t.shape[t.rank-1]:1,a=t.rank>1?t.rank-1:1,i="Must have updates.shape = indices.shape[:batchDim] + "+"shape[sliceDim:], got updates.shape: ".concat(n.shape)+", indices.shape: ".concat(t.shape,", shape: ").concat(e)+", sliceDim: ".concat(r,", and batchDim: ").concat(a,".");if(n.rank<a)throw new Error(i+" update.rank < ".concat(a,". "));if(e.length<r+(n.rank-a))throw new Error(i+" Output shape length < ".concat(r+(n.rank-a)));if(n.rank!==a+e.length-r)throw new Error(i+" update.rank != ".concat(a+e.length-r));for(var o=0;o<a;++o)if(n.shape[o]!==t.shape[o])throw new Error(i+" updates.shape[".concat(o,"] (").concat(n.shape[o],") != indices.shape[").concat(o,"] (").concat(t.shape[o],")."));for(var s=0;s<n.rank-a;++s)if(n.shape[s+a]!==e[s+r])throw new Error(i+" updates.shape[".concat(s+a,"] (").concat(n.shape[s+a],") != shape[").concat(s+a,"] (").concat(e[s+a],")"))}function o(e,t,n){if(t.rank<1)throw new Error("tf.scatterND() expects the indices to be rank 1 or higher,"+" but the rank was ".concat(t.rank,"."));if(e.rank<1)throw new Error("tf.scatterND() expects the updates to be rank 1 or higher,"+" but the rank was ".concat(e.rank,"."));if("int32"!==t.dtype)throw new Error("The dtype of 'indices' should be int32, but got dtype: ".concat(t.dtype));if(n.length<1)throw new Error("Output rank must be greater or equal to 1, but got shape: ".concat(n));if(0===n.length){if(0===t.size)throw new Error("Indices specified for empty output. indices shape: ".concat(t.shape));if(0===e.size)throw new Error("Updates specified for empty output. updates shape: ".concat(e.shape))}i(n,t,e)}function s(e,t,n){for(var i=t.shape.length,o=i>1?t.shape[i-1]:1,s=n.length,c=1,u=o;u<s;++u)c*=n[u];var l=o<1?1:o;return{sliceRank:o,numUpdates:Object(a.O)(t.shape)/l,sliceSize:c,strides:[].concat(Object(r.a)(Object(a.j)(n.slice(0,o))),[1]),outputSize:Object(a.O)(n)}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r={};function a(e){return r[e]}},,function(e,t,n){"use strict";function r(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function a(e,t){if(e.length!==t.length)throw new Error("Array sizes must match to be shuffled together "+"First array length was ".concat(e.length)+"Second array length was ".concat(t.length));for(var n,r,a=e.length,i=0;a>0;)i=Math.random()*a|0,n=e[--a],r=t[a],e[a]=e[i],t[a]=t[i],e[i]=n,t[i]=r}function i(e,t,n){return Math.max(e,Math.min(t,n))}function o(e){return e%2===0?e:e+1}function s(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t}function c(e,t){var n=Math.random();return t*n+(1-n)*e}function u(e,t){for(var n=0,r=0;r<e.length;r++){var a=Number(e[r])-Number(t[r]);n+=a*a}return n}function l(e,t){if(!e)throw new Error("string"===typeof t?t:t())}function d(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";l(v(e,t),(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}function h(e){l(null!=e,(function(){return"The input to the tensor constructor must be a non-null value."}))}function f(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t&&(t=[]),Array.isArray(e)||R(e)&&!n)for(var r=0;r<e.length;++r)f(e[r],t,n);else t.push(e);return t}function p(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t}function m(e){return 0===e.length}function v(e,t){if(e===t)return!0;if(null==e||null==t)return!1;if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function g(e){return e%1===0}function b(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)}function y(e){var t=Math.ceil(Math.sqrt(e));return[t,Math.ceil(e/t)]}function x(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return r(t),t}function w(e,t){return t<=e.length?e:e+" ".repeat(t-e.length)}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return 0},n=arguments.length>2?arguments[2]:void 0;return new Promise((function(r,a){var i=0;!function o(){if(e())r();else{i++;var s=t(i);null!=n&&i>=n?a():setTimeout(o,s)}}()}))}function A(e,t){for(var n=1,r=-1,a=0;a<e.length;++a)if(e[a]>=0)n*=e[a];else if(-1===e[a]){if(-1!==r)throw Error("Shapes can only have 1 implicit size. "+"Found -1 at dim ".concat(r," and dim ").concat(a));r=a}else if(e[a]<0)throw Error("Shapes can not be < 0. Found ".concat(e[a]," at dim ").concat(a));if(-1===r){if(t>0&&t!==n)throw Error("Size(".concat(t,") must match the product of shape ").concat(e));return e}if(0===n)throw Error("Cannot infer the missing size in [".concat(e,"] when ")+"there are 0 elements");if(t%n!==0)throw Error("The implicit shape can't be a fractional number. "+"Got ".concat(t," / ").concat(n));var i=e.slice();return i[r]=t/n,i}function _(e,t){var n=t.length;return l((e=null==e?t.map((function(e,t){return t})):[].concat(e)).every((function(e){return e>=-n&&e<n})),(function(){return"All values in axis param must be in range [-".concat(n,", ").concat(n,") but ")+"got axis ".concat(e)})),l(e.every((function(e){return g(e)})),(function(){return"All values in axis param must be integers but "+"got axis ".concat(e)})),e.map((function(e){return e<0?n+e:e}))}function E(e,t){for(var n=[],r=[],a=null!=t&&Array.isArray(t)&&0===t.length,i=null==t||a?null:_(t,e).sort(),o=0,s=0;s<e.length;++s){if(null!=i){if(i[o]===s&&1!==e[s])throw new Error("Can't squeeze axis ".concat(s," since its dim '").concat(e[s],"' is not 1"));(null==i[o]||i[o]>s)&&1===e[s]&&(n.push(e[s]),r.push(s)),i[o]<=s&&o++}1!==e[s]&&(n.push(e[s]),r.push(s))}return{newShape:n,keptDims:r}}function S(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else{if("bool"!==e)throw new Error("Unknown data type ".concat(e));n=new Uint8Array(t)}return n}function C(e,t){var n=null;if(null==e||"float32"===e)n=new Float32Array(t);else if("int32"===e)n=new Int32Array(t);else if("bool"===e)n=new Uint8Array(t);else{if("string"!==e)throw new Error("Unknown data type ".concat(e));n=new Array(t)}return n}function T(e,t){for(var n=0;n<e.length;n++){var r=e[n];if(isNaN(r)||!isFinite(r))throw Error("A tensor of type ".concat(t," being uploaded contains ").concat(r,"."))}}function M(e){return"bool"===e||"complex64"===e||"float32"===e||"int32"===e||"string"===e}function k(e,t){return"complex64"!==t&&(("float32"!==t||"complex64"===e)&&(("int32"!==t||"float32"===e||"complex64"===e)&&("bool"!==t||"bool"!==e)))}function R(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}function I(e){if("float32"===e||"int32"===e)return 4;if("complex64"===e)return 8;if("bool"===e)return 1;throw new Error("Unknown dtype ".concat(e))}function j(e){if(null==e)return 0;var t=0;return e.forEach((function(e){return t+=e.length})),t}function B(e){return"string"===typeof e||e instanceof String}function L(e){return"boolean"===typeof e}function N(e){return"number"===typeof e}function D(e){return Array.isArray(e)?D(e[0]):e instanceof Float32Array?"float32":e instanceof Int32Array||e instanceof Uint8Array?"int32":N(e)?"float32":B(e)?"string":L(e)?"bool":"float32"}function P(e){return!!(e&&e.constructor&&e.call&&e.apply)}function F(e,t){for(var n=t;n<e;++n)if(e%n===0)return n;return e}function G(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}function U(e,t,n){var r=new Array;if(1===t.length)for(var a=t[0],i=0;i<a;i++)r[i]=n[e+i];else for(var o=t[0],s=t.slice(1),c=s.reduce((function(e,t){return e*t})),u=0;u<o;u++)r[u]=U(e+u*c,s,n);return r}function z(e,t){if(0===e.length)return t[0];var n=e.reduce((function(e,t){return e*t}));if(0===n)return[];if(n!==t.length)throw new Error("[".concat(e,"] does not match the input size ").concat(t.length,"."));return U(0,e,t)}function H(e,t){for(var n=V(e,t),r=0;r<n.length;r++)n[r]=1;return n}function V(e,t){if(null==t||"float32"===t||"complex64"===t)return new Float32Array(e);if("int32"===t)return new Int32Array(e);if("bool"===t)return new Uint8Array(e);throw new Error("Unknown data type ".concat(t))}function W(e,t){var n=e.reduce((function(e,t){return e*t}),1);if(null==t||"float32"===t)return z(e,new Float32Array(n));if("int32"===t)return z(e,new Int32Array(n));if("bool"===t)return z(e,new Uint8Array(n));throw new Error("Unknown data type ".concat(t))}function J(e){e.forEach((function(t){l(Number.isInteger(t)&&t>=0,(function(){return"Tensor must have a shape comprised of positive integers but got "+"shape [".concat(e,"].")}))}))}function X(e,t,n){if(0===t)return 0;if(1===t)return e[0];for(var r=e[e.length-1],a=0;a<e.length-1;++a)r+=n[a]*e[a];return r}function K(e,t,n){if(0===t)return[];if(1===t)return[e];for(var r=new Array(t),a=0;a<r.length-1;++a)r[a]=Math.floor(e/n[a]),e-=r[a]*n[a];return r[r.length-1]=e,r}function q(e){return e&&e.then&&"function"===typeof e.then}n.d(t,"M",(function(){return r})),n.d(t,"N",(function(){return a})),n.d(t,"i",(function(){return i})),n.d(t,"H",(function(){return o})),n.d(t,"R",(function(){return s})),n.d(t,"J",(function(){return c})),n.d(t,"l",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"e",(function(){return d})),n.d(t,"d",(function(){return h})),n.d(t,"m",(function(){return f})),n.d(t,"O",(function(){return p})),n.d(t,"y",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"v",(function(){return g})),n.d(t,"S",(function(){return b})),n.d(t,"P",(function(){return y})),n.d(t,"k",(function(){return x})),n.d(t,"L",(function(){return w})),n.d(t,"K",(function(){return O})),n.d(t,"s",(function(){return A})),n.d(t,"I",(function(){return _})),n.d(t,"Q",(function(){return E})),n.d(t,"o",(function(){return S})),n.d(t,"n",(function(){return C})),n.d(t,"h",(function(){return T})),n.d(t,"B",(function(){return M})),n.d(t,"p",(function(){return k})),n.d(t,"A",(function(){return R})),n.d(t,"g",(function(){return I})),n.d(t,"f",(function(){return j})),n.d(t,"z",(function(){return B})),n.d(t,"t",(function(){return L})),n.d(t,"w",(function(){return N})),n.d(t,"r",(function(){return D})),n.d(t,"u",(function(){return P})),n.d(t,"G",(function(){return F})),n.d(t,"j",(function(){return G})),n.d(t,"T",(function(){return z})),n.d(t,"D",(function(){return H})),n.d(t,"F",(function(){return V})),n.d(t,"E",(function(){return W})),n.d(t,"c",(function(){return J})),n.d(t,"C",(function(){return X})),n.d(t,"q",(function(){return K})),n.d(t,"x",(function(){return q}))},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"a",(function(){return c})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return l}));var r=n(12),a=(n(153),n(221)),i=Object(a.a)("kernelRegistry",(function(){return new Map})),o=Object(a.a)("gradRegistry",(function(){return new Map}));function s(e,t){var n=d(e,t);return i.get(n)}function c(e){return o.get(e)}function u(e){for(var t=i.entries(),n=[];;){var a=t.next(),o=a.done,s=a.value;if(o)break;var c=Object(r.a)(s,2),u=c[0],l=c[1],d=u.split("_");Object(r.a)(d,1)[0]===e&&n.push(l)}return n}function l(e){var t=e.kernelName,n=e.backendName,r=d(t,n);i.has(r)&&console.warn("The kernel '".concat(t,"' for backend ")+"'".concat(n,"' is already registered")),i.set(r,e)}function d(e,t){return"".concat(t,"_").concat(e)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(147),a=n(149),i=function(){function e(t,n){Object(r.a)(this,e),this.backend=t,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}return Object(a.a)(e,[{key:"get",value:function(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}},{key:"set",value:function(e,t){this.dataIdsCount++,this.data.set(e,t)}},{key:"has",value:function(e){return this.data.has(e)}},{key:"delete",value:function(e){return this.dataIdsCount--,this.data.delete(e)}},{key:"numDataIds",value:function(){return this.dataIdsCount}}]),e}(),o=function(){function e(){Object(r.a)(this,e)}return Object(a.a)(e,[{key:"refCount",value:function(e){return s("refCount")}},{key:"incRef",value:function(e){return s("incRef")}},{key:"timerAvailable",value:function(){return!0}},{key:"time",value:function(e){return s("time")}},{key:"read",value:function(e){return s("read")}},{key:"readSync",value:function(e){return s("readSync")}},{key:"numDataIds",value:function(){return s("numDataIds")}},{key:"disposeData",value:function(e,t){return s("disposeData")}},{key:"write",value:function(e,t,n){return s("write")}},{key:"move",value:function(e,t,n,r,a){return s("move")}},{key:"memory",value:function(){return s("memory")}},{key:"floatPrecision",value:function(){return s("floatPrecision")}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"dispose",value:function(){return s("dispose")}}]),e}();function s(e){throw new Error("'".concat(e,"' not yet implemented or not found in the registry. ")+"This kernel may not be supported by the tfjs backend you have chosen")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({unstack_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","unstack","string_or_numeric");o.b(t>=-n.shape.length&&t<n.shape.length,(function(){return"Axis = ".concat(t," is not in [-").concat(n.shape.length,", ").concat(n.shape.length,")")}));var s={value:n},c={axis:t};return r.a.runKernel(a.Tc,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(202),o=n(143);var s=Object(o.a)({fft_:function(e){Object(i.b)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.fft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.a.runKernel(a.Z,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(202),o=n(143);var s=Object(o.a)({ifft_:function(e){Object(i.b)("complex64"===e.dtype,(function(){return"The dtype for tf.spectral.ifft() must be complex64 "+"but got ".concat(e.dtype,".")}));var t={input:e};return r.a.runKernel(a.mb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(202),a=n(174),i=n(170),o=n(211),s=n(143),c=n(210),u=n(150),l=n(177),d=n(212),h=n(193),f=n(209),p=n(206);var m=Object(s.a)({rfft_:function(e,t){Object(r.b)("float32"===e.dtype,(function(){return"The dtype for rfft() must be real value but got ".concat(e.dtype)}));var n,s=e.shape[e.shape.length-1],m=e.size/s;if(null!=t&&t<s){var v=e.shape.map((function(e){return 0})),g=e.shape.map((function(e){return e}));g[e.shape.length-1]=t,n=Object(l.a)(e,v,g),s=t}else if(null!=t&&t>s){var b=e.shape.map((function(e){return e}));b[e.shape.length-1]=t-s,n=Object(i.a)([e,Object(h.a)(b)],e.shape.length-1),s=t}else n=e;var y=Object(f.a)(n),x=Object(u.a)(Object(a.a)(n,y),[m,s]),w=Object(p.a)(x),O=Math.floor(s/2)+1,A=Object(c.a)(w),_=Object(o.a)(w),E=Object(d.a)(A,[O,s-O],A.shape.length-1),S=Object(d.a)(_,[O,s-O],_.shape.length-1),C=n.shape.slice();return C[n.shape.length-1]=O,Object(u.a)(Object(a.a)(E[0],S[0]),C)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({zerosLike_:function(e){var t={x:Object(i.a)(e,"x","zerosLike")};return r.a.runKernel(a.Vc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({real_:function(e){var t={input:Object(i.a)(e,"input","real")};return r.a.runKernel(a.ec,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({imag_:function(e){var t={input:Object(i.a)(e,"input","imag")};return r.a.runKernel(a.ob,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({split_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=Object(i.a)(e,"x","split"),s={x:o},c={numOrSizeSplits:t,axis:n};return r.a.runKernel(a.Ec,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(145),a=n(144),i=n(143);var o=Object(i.a)({square_:function(e){var t=Object(a.a)(e,"x","square");return r.a.runKernel("Square",{x:t},{})}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(143);var u=Object(c.a)({matMul_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],c=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=Object(s.a)(e,"a","matMul"),l=Object(s.a)(t,"b","matMul"),d=Object(o.b)(u,l),h=Object(r.a)(d,2),f={a:u=h[0],b:l=h[1]},p={transposeA:n,transposeB:c};return a.a.runKernel(i.s,f,p)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(168),c=n(143),u=n(150);var l=Object(c.a)({conv2d_:function(e,t,n,c){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],h=arguments.length>6?arguments[6]:void 0,f=Object(i.a)(e,"x","conv2d"),p=Object(i.a)(t,"filter","conv2d"),m=f,v=!1;3===f.rank&&(v=!0,m=Object(u.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]])),o.b(4===m.rank,(function(){return"Error in conv2d: input must be rank 4, but got rank ".concat(m.rank,".")})),o.b(4===p.rank,(function(){return"Error in conv2d: filter must be rank 4, but got rank "+"".concat(p.rank,".")})),null!=h&&o.b(o.v(c),(function(){return"Error in conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(h," but got pad ").concat(c,".")}));var g="NHWC"===l?m.shape[3]:m.shape[1];o.b(g===p.shape[2],(function(){return"Error in conv2d: depth of input (".concat(g,") must match ")+"input depth for filter ".concat(p.shape[2],".")})),o.b(s.h(n,d),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(d,"'")}));var b={x:m,filter:p},y={strides:n,pad:c,dataFormat:l,dilations:d,dimRoundingMode:h},x=r.a.runKernel(a.B,b,y);return v?Object(u.a)(x,[x.shape[1],x.shape[2],x.shape[3]]):x}})},,,,function(e,t,n){"use strict";function r(e){return(r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,"a",(function(){return i}));var a=n(67);function i(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?Object(a.a)(e):t}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(66);function a(e,t,n){return(a="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Object(r.a)(e)););return e}(e,t);if(a){var i=Object.getOwnPropertyDescriptor(a,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}},function(e,t,n){"use strict";(function(e,r){var a;function i(){if(null==a){var t;if("undefined"!==typeof window)t=window;else if("undefined"!==typeof e)t=e;else if("undefined"!==typeof r)t=r;else{if("undefined"===typeof self)throw new Error("Could not find a global object");t=self}a=t}return a}function o(e,t){var n=function(){var e=i();return null==e._tfGlobals&&(e._tfGlobals=new Map),e._tfGlobals}();if(n.has(e))return n.get(e);var r=t();return n.set(e,r),n.get(e)}n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o}))}).call(this,n(94),n(92))},function(e,t,n){"use strict";function r(){if("undefined"!==typeof navigator&&null!=navigator){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function a(){return"undefined"!==typeof window&&null!=window.document||"undefined"!==typeof WorkerGlobalScope}n.r(t),n.d(t,"isMobile",(function(){return r})),n.d(t,"isBrowser",(function(){return a}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(144),a=n(191);function i(e,t,n){var i=Object(r.c)(e,n);return Object(a.a)(e,t,i,n)}},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(e.toString(t))}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(143);var u=Object(c.a)({floorDiv_:function(e,t){var n=Object(s.a)(e,"a","floorDiv"),c=Object(s.a)(t,"b","floorDiv"),u=Object(o.b)(n,c),l=Object(r.a)(u,2),d={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.db,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({expandDims_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","expandDims","string_or_numeric");o.b(t<=n.rank,(function(){return"Axis must be <= rank of the tensor"}));var s={input:n},c={dim:t};return r.a.runKernel(a.X,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(144),a=n(202),i=n(143),o=n(150);var s=Object(i.a)({squeeze_:function(e,t){var n=Object(r.a)(e,"x","squeeze");return Object(o.a)(n,Object(a.Q)(n.shape,t).newShape)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(174),a=n(170),i=n(211),o=n(156),s=n(143),c=n(210),u=n(150),l=n(229),d=n(159),h=n(177),f=n(207);var p=Object(s.a)({irfft_:function(e){var t,n=e.shape[e.shape.length-1],s=e.size/n;if(n<=2){var p=Object(u.a)(e,[s,n]);t=Object(f.a)(p)}else{var m=[s,2*(n-1)],v=Object(u.a)(Object(c.a)(e),[s,n]),g=Object(u.a)(Object(i.a)(e),[s,n]),b=Object(l.a)(Object(h.a)(v,[0,1],[s,n-2]),1),y=Object(o.a)(Object(l.a)(Object(h.a)(g,[0,1],[s,n-2]),1),Object(d.a)(-1)),x=Object(a.a)([v,b],1),w=Object(a.a)([g,y],1),O=Object(u.a)(Object(r.a)(x,w),[m[0],m[1]]);t=Object(f.a)(O)}if(t=Object(c.a)(t),3===e.rank&&0!==e.shape[0]){var A=t,_=e.shape[0];t=Object(u.a)(t,[_,t.shape[0]/_,t.shape[1]]),A.dispose()}return t}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({reverse_:function(e,t){var n={x:Object(i.a)(e,"x","reverse")},o={dims:t};return r.a.runKernel(a.oc,n,o)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(145),a=n(146);function i(e,t,n){var i={shape:e,value:t,dtype:n};return r.a.runKernel(a.ab,{},i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(74),a=n(77),i=n(38),o=n(75);function s(e){return Object(r.a)(e)||Object(a.a)(e)||Object(i.a)(e)||Object(o.a)()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(145),a=n(146);function i(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";if(0===n)throw new Error("Cannot have a step of zero");var o={start:e,stop:t,step:n,dtype:i};return r.a.runKernel(a.dc,{},o)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(154),s=n(143);var c=Object(s.a)({logicalAnd_:function(e,t){var n=Object(i.a)(e,"a","logicalAnd","bool"),s=Object(i.a)(t,"b","logicalAnd","bool");Object(o.a)(n.shape,s.shape);var c={a:n,b:s};return r.a.runKernel(a.Ab,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(154),u=n(143);var l=Object(u.a)({lessEqual_:function(e,t){var n=Object(s.a)(e,"a","lessEqual"),u=Object(s.a)(t,"b","lessEqual"),l=Object(o.b)(n,u),d=Object(r.a)(l,2);n=d[0],u=d[1],Object(c.a)(n.shape,u.shape);var h={a:n,b:u};return a.a.runKernel(i.wb,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(154),u=n(143);var l=Object(u.a)({greaterEqual_:function(e,t){var n=Object(s.a)(e,"a","greaterEqual"),u=Object(s.a)(t,"b","greaterEqual"),l=Object(o.b)(n,u),d=Object(r.a)(l,2);n=d[0],u=d[1],Object(c.a)(n.shape,u.shape);var h={a:n,b:u};return a.a.runKernel(i.lb,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(145),a=n(146),i=n(144),o=n(184),s=n(143),c=n(150);var u=Object(s.a)({broadcastTo_:function(e,t){var n=Object(i.a)(e,"broadcastTo","x"),s=n.shape;if(t.some((function(e){return!(e>0)||e%1!==0})))throw new Error("broadcastTo(): Invalid broadcast shape [".concat(t,"]."));if(t.length<n.rank)throw new Error("broadcastTo(): shape.length=".concat(t.length," < input.rank=").concat(n.rank,"."));if(t.length>n.rank){for(var u=n.shape.slice();u.length<t.length;)u.unshift(1);n=Object(c.a)(n,u)}for(var l=n.shape,d=Array.from(t),h=t.length-1;h>=0;h--)if(l[h]===t[h])d[h]=1;else if(1!==n.shape[h])throw new Error("broadcastTo(): [".concat(s,"] cannot be broadcast to [").concat(t,"]."));if(0===d.map((function(e,t){return e>1?t:-1})).filter((function(e){return e>=0})).length)return Object(o.a)(n);var f={x:n},p={reps:d};return r.a.runKernel(a.Oc,f,p)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({min_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","min"),s={x:o},c={axis:t,keepDims:n};return r.a.runKernel(a.Lb,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({sqrt_:function(e){var t={x:Object(i.a)(e,"x","sqrt")};return r.a.runKernel(a.Fc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(143);var u=Object(c.a)({pow_:function(e,t){var n=Object(s.a)(e,"base","pow"),c=Object(s.a)(t,"exp","pow"),u=Object(o.b)(n,c),l=Object(r.a)(u,2),d={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.ac,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({tile_:function(e,t){var n=Object(i.a)(e,"x","tile","string_or_numeric");o.b(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of reps ".concat(t,".")}));var s={x:n},c={reps:t};return r.a.runKernel(a.Oc,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(154),u=n(143);var l=Object(u.a)({greater_:function(e,t){var n=Object(s.a)(e,"a","greater"),u=Object(s.a)(t,"b","greater"),l=Object(o.b)(n,u),d=Object(r.a)(l,2);n=d[0],u=d[1],Object(c.a)(n.shape,u.shape);var h={a:n,b:u};return a.a.runKernel(i.kb,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({transpose_:function(e,t){var n=Object(i.a)(e,"x","transpose");if(null==t&&(t=n.shape.map((function(e,t){return t})).reverse()),o.b(n.rank===t.length,(function(){return"Error in transpose: rank of input ".concat(n.rank," ")+"must match length of perm ".concat(t,".")})),t.forEach((function(e){o.b(e>=0&&e<n.rank,(function(){return"All entries in 'perm' must be between 0 and ".concat(n.rank-1)+" but got ".concat(t)}))})),n.rank<=1)return n.clone();var s={x:n},c={perm:t};return r.a.runKernel(a.Rc,s,c)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return d})),n.d(t,"e",(function(){return h}));var r=n(145),a=n(153),i=n(160),o=n(151);function s(){return r.a}function c(e,t){return r.a.tidy(e,t)}function u(e){Object(o.a)(e).forEach((function(e){return e.dispose()}))}function l(e){return r.a.keep(e)}function d(){return r.a.backendName}function h(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return r.a.registerBackend(e,t,n)}Object(i.d)((function(e){Object(a.b)().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(e+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({mean_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","mean"),s={x:o},c={axis:t,keepDims:n};return r.a.runKernel(a.Kb,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(202),i=n(174),o=n(193);function s(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"float32";if("complex64"===t){var n=s(e,"float32"),c=Object(o.a)(e,"float32");return Object(i.a)(n,c)}var u=Object(a.D)(Object(a.O)(e),t);return r.a.makeTensor(u,e,t)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(154),u=n(143);var l=Object(u.a)({notEqual_:function(e,t){var n=Object(s.a)(e,"a","notEqual"),u=Object(s.a)(t,"b","notEqual"),l=Object(o.b)(n,u),d=Object(r.a)(l,2);n=d[0],u=d[1],Object(c.a)(n.shape,u.shape);var h={a:n,b:u};return a.a.runKernel(i.Vb,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(154),u=n(157),l=n(143);var d=Object(l.a)({minimum_:function(e,t){var n=Object(s.a)(e,"a","minimum"),l=Object(s.a)(t,"b","minimum"),d=Object(o.b)(n,l),h=Object(r.a)(d,2);n=h[0],l=h[1],"bool"===n.dtype&&(n=Object(u.a)(n,"int32"),l=Object(u.a)(l,"int32")),Object(c.a)(n.shape,l.shape);var f={a:n,b:l};return a.a.runKernel(i.Mb,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(154),u=n(143);var l=Object(u.a)({squaredDifference_:function(e,t){var n=Object(s.a)(e,"a","squaredDifference"),u=Object(s.a)(t,"b","squaredDifference"),l=Object(o.b)(n,u),d=Object(r.a)(l,2);n=d[0],u=d[1],Object(c.a)(n.shape,u.shape);var h={a:n,b:u};return a.a.runKernel(i.Hc,h,{})}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({log1p_:function(e){var t={x:Object(i.a)(e,"x","log1p")};return r.a.runKernel(a.zb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({step_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","step"),o={x:n},s={alpha:t};return r.a.runKernel(a.Ic,o,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({elu_:function(e){var t={x:Object(i.a)(e,"x","elu")};return r.a.runKernel(a.S,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({relu6_:function(e){var t={x:Object(i.a)(e,"x","relu6")};return r.a.runKernel(a.ic,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({prelu_:function(e,t){var n={x:Object(i.a)(e,"x","prelu"),alpha:Object(i.a)(t,"alpha","prelu")};return r.a.runKernel(a.bc,n)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({leakyRelu_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,n=Object(i.a)(e,"x","leakyRelu"),o={x:n},s={alpha:t};return r.a.runKernel(a.ub,o,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143),c=n(150);var u=Object(s.a)({depthwiseConv2d_:function(e,t,n,s){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NHWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],d=arguments.length>6?arguments[6]:void 0,h=Object(i.a)(e,"x","depthwiseConv2d"),f=Object(i.a)(t,"filter","depthwiseConv2d"),p=h,m=!1;3===h.rank&&(m=!0,p=Object(c.a)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.b(4===p.rank,(function(){return"Error in depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(p.rank,".")})),o.b(4===f.rank,(function(){return"Error in depthwiseConv2d: filter must be rank 4, but got rank "+"".concat(f.rank,".")})),o.b(p.shape[3]===f.shape[2],(function(){return"Error in depthwiseConv2d: number of input channels "+"(".concat(p.shape[3],") must match the inChannels dimension in ")+"filter ".concat(f.shape[2],".")})),null!=d&&o.b(o.v(s),(function(){return"Error in depthwiseConv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(d," but got pad ").concat(s,".")}));var v={x:p,filter:f},g={strides:n,pad:s,dataFormat:u,dilations:l,dimRoundingMode:d},b=r.a.runKernel(a.N,v,g);return m?Object(c.a)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(144),a=n(202),i=n(191);function o(e,t,n){if(Object(a.d)(e),null!=t&&3!==t.length)throw new Error("tensor3d() requires shape to have three numbers");var o=Object(r.c)(e,n);if(3!==o.length&&1!==o.length)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(1===o.length&&null==t)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Object(i.a)(e,t,o,n)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(175);function a(e,t){for(var n=[],a=0;a<t.length;a++)t[a]&&n.push(a);for(var i=Object(r.a)(e,"int32"),o=Object(r.a)([n.length,e.length],"int32"),s=0;s<n.length;s++){var c=i.indexToLoc(n[s]),u=s*e.length;o.values.set(c,u)}return o.toTensor()}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(154),u=n(143);var l=Object(u.a)({equal_:function(e,t){var n=Object(s.a)(e,"a","equal"),u=Object(s.a)(t,"b","equal"),l=Object(o.b)(n,u),d=Object(r.a)(l,2);n=d[0],u=d[1],Object(c.a)(n.shape,u.shape);var h={a:n,b:u};return a.a.runKernel(i.U,h)}})},function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return i}));var r=n(145);n(144),n(202),n(148);function a(){return 32===r.a.backend.floatPrecision()?.001:.1}function i(e,t,n){if(null==n&&(n=a()),!o(e,t,n))throw new Error("Numbers differ: actual === ".concat(e,", expected === ").concat(t))}function o(e,t,n){return!isFinite(e)&&!isFinite(t)||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}},function(e,t,n){"use strict";var r=n(1);t.a=function(e){void 0===e&&(e={});var t=e.onResize,n=Object(r.useRef)(void 0);n.current=t;var a=Object(r.useRef)(),i=Object(r.useState)({width:void 0,height:void 0}),o=i[0],s=i[1],c=Object(r.useRef)(!1);Object(r.useEffect)((function(){return function(){c.current=!0}}),[]);var u=Object(r.useRef)({width:void 0,height:void 0}),l=function(e,t){var n,a=null,i=Object(r.useRef)(null),o=Object(r.useRef)(null),s=Object(r.useCallback)((function(e){o.current=e,l()}),[]),c=Object(r.useRef)(null),u=Object(r.useRef)(),l=function(){var n=null;o.current?n=o.current:i.current?n=i.current:t instanceof HTMLElement&&(n=t),c.current!==n&&(u.current&&(u.current(),u.current=null),c.current=n,n&&(u.current=e(n)))};return!t||t instanceof HTMLElement||(a=t),Object(r.useEffect)((function(){a&&(i.current=a.current),l()}),[a,null==(n=a)?void 0:n.current,t]),s}((function(e){return a.current||(a.current=new ResizeObserver((function(e){if(Array.isArray(e)&&e.length){var t=e[0],r=Math.round(t.contentRect.width),a=Math.round(t.contentRect.height);if(u.current.width!==r||u.current.height!==a){var i={width:r,height:a};n.current?n.current(i):(u.current.width=r,u.current.height=a,c.current||s(i))}}}))),a.current.observe(e),function(){a.current&&a.current.unobserve(e)}}),e.ref);return Object(r.useMemo)((function(){return{ref:l,width:o.width,height:o.height}}),[l,o?o.width:null,o?o.height:null])}},,,,function(e,t,n){"use strict";(function(e){var r=n(411),a=n(412),i=n(413);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!c.TYPED_ARRAY_SUPPORT&&!(this instanceof c))return new c(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return u(this,e,t,n)}function u(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t);return e}(e,t,n,r):"string"===typeof t?function(e,t,n){"string"===typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|p(t,n),a=(e=s(e,r)).write(t,n);a!==r&&(e=e.slice(0,a));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|f(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||(r=t.length)!==r?s(e,0):h(e,t);if("Buffer"===t.type&&i(t.data))return h(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(l(t),e=s(e,t<0?0:0|f(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|f(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function f(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function p(e,t){if(c.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return z(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function m(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return M(this,t,n);case"base64":return E(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function g(e,t,n,r,a){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"===typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,a);if("number"===typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,a);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,a){var i,o=1,s=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,c/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(a){var l=-1;for(i=n;i<s;i++)if(u(e,i)===u(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*o}else-1!==l&&(i-=i-l),l=-1}else for(n+c>s&&(n=s-c),i=n;i>=0;i--){for(var d=!0,h=0;h<c;h++)if(u(e,i+h)!==u(t,h)){d=!1;break}if(d)return i}return-1}function y(e,t,n,r){n=Number(n)||0;var a=e.length-n;r?(r=Number(r))>a&&(r=a):r=a;var i=t.length;if(i%2!==0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function x(e,t,n,r){return H(U(t,e.length-n),e,n,r)}function w(e,t,n,r){return H(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function O(e,t,n,r){return w(e,t,n,r)}function A(e,t,n,r){return H(z(t),e,n,r)}function _(e,t,n,r){return H(function(e,t){for(var n,r,a,i=[],o=0;o<e.length&&!((t-=2)<0);++o)r=(n=e.charCodeAt(o))>>8,a=n%256,i.push(a),i.push(r);return i}(t,e.length-n),e,n,r)}function E(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function S(e,t,n){n=Math.min(e.length,n);for(var r=[],a=t;a<n;){var i,o,s,c,u=e[a],l=null,d=u>239?4:u>223?3:u>191?2:1;if(a+d<=n)switch(d){case 1:u<128&&(l=u);break;case 2:128===(192&(i=e[a+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=e[a+1],o=e[a+2],128===(192&i)&&128===(192&o)&&(c=(15&u)<<12|(63&i)<<6|63&o)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[a+1],o=e[a+2],s=e[a+3],128===(192&i)&&128===(192&o)&&128===(192&s)&&(c=(15&u)<<18|(63&i)<<12|(63&o)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),a+=d}return function(e){var t=e.length;if(t<=C)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=C));return n}(r)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=o(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return u(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"===typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return d(null,e)},c.allocUnsafeSlow=function(e){return d(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,a=0,i=Math.min(n,r);a<i;++a)if(e[a]!==t[a]){n=e[a],r=t[a];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!i(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=c.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var o=e[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,a),a+=o.length}return r},c.byteLength=p,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?S(this,0,e):m.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,r,a){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===a&&(a=this.length),t<0||n>e.length||r<0||a>this.length)throw new RangeError("out of range index");if(r>=a&&t>=n)return 0;if(r>=a)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(a>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(i,o),u=this.slice(r,a),l=e.slice(t,n),d=0;d<s;++d)if(u[d]!==l[d]){i=u[d],o=l[d];break}return i<o?-1:o<i?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return g(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return g(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return x(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return O(this,e,t,n);case"base64":return A(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var C=4096;function T(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(127&e[a]);return r}function M(e,t,n){var r="";n=Math.min(e.length,n);for(var a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}function k(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var a="",i=t;i<n;++i)a+=G(e[i]);return a}function R(e,t,n){for(var r=e.slice(t,n),a="",i=0;i<r.length;i+=2)a+=String.fromCharCode(r[i]+256*r[i+1]);return a}function I(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function j(e,t,n,r,a,i){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function B(e,t,n,r){t<0&&(t=65535+t+1);for(var a=0,i=Math.min(e.length-n,2);a<i;++a)e[n+a]=(t&255<<8*(r?a:1-a))>>>8*(r?a:1-a)}function L(e,t,n,r){t<0&&(t=4294967295+t+1);for(var a=0,i=Math.min(e.length-n,4);a<i;++a)e[n+a]=t>>>8*(r?a:3-a)&255}function N(e,t,n,r,a,i){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function D(e,t,n,r,i){return i||N(e,0,n,4),a.write(e,t,n,r,23,4),n+4}function P(e,t,n,r,i){return i||N(e,0,n,8),a.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var a=t-e;n=new c(a,void 0);for(var i=0;i<a;++i)n[i]=this[i+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e+--t],a=1;t>0&&(a*=256);)r+=this[e+--t]*a;return r},c.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=this[e],a=1,i=0;++i<t&&(a*=256);)r+=this[e+i]*a;return r>=(a*=128)&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||I(e,t,this.length);for(var r=t,a=1,i=this[e+--r];r>0&&(a*=256);)i+=this[e+--r]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),a.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),a.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),a.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),a.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||j(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,i=0;for(this[t]=255&e;++i<n&&(a*=256);)this[t+i]=e/a&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||j(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):L(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);j(this,e,t,n,a-1,-a)}var i=0,o=1,s=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var a=Math.pow(2,8*n-1);j(this,e,t,n,a-1,-a)}var i=n-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):B(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):B(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):L(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||j(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):L(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return D(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return D(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return P(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return P(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var a,i=r-n;if(this===e&&n<t&&t<r)for(a=i-1;a>=0;--a)e[a+t]=this[a+n];else if(i<1e3||!c.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},c.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(i=t;i<n;++i)this[i]=e;else{var o=c.isBuffer(e)?e:U(new c(e,r).toString()),s=o.length;for(i=0;i<n-t;++i)this[i+t]=o[i%s]}return this};var F=/[^+\/0-9A-Za-z-_]/g;function G(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,a=null,i=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function z(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(F,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function H(e,t,n,r){for(var a=0;a<r&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}}).call(this,n(94))},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8}},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({sigmoid_:function(e){var t={x:Object(i.a)(e,"x","sigmoid")};return r.a.runKernel(a.vc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(202),o=n(143),s=n(150);var c=Object(o.a)({conv2DBackpropInput_:function(e,t,n,o,c){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",l=arguments.length>6?arguments[6]:void 0;i.b(e.length===t.rank,(function(){return"Length of inShape "+"(".concat(e.length,") and rank of dy (").concat(t.rank,") must match")}));var d=e,h=t,f=!1;3===t.rank&&(f=!0,h=Object(s.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]),d=[1,e[0],e[1],e[2]]),i.b(4===d.length,(function(){return"Error in conv2dDerInput: inShape must be length 4, but got length "+"".concat(d.length,".")})),i.b(4===h.rank,(function(){return"Error in conv2dDerInput: dy must be rank 4, but got "+"rank ".concat(h.rank)})),i.b(4===n.rank,(function(){return"Error in conv2dDerInput: filter must be rank 4, but got "+"rank ".concat(n.rank)}));var p="NHWC"===u?d[3]:d[1],m="NHWC"===u?h.shape[3]:h.shape[1];i.b(p===n.shape[2],(function(){return"Error in conv2dDerInput: depth of input (".concat(p,") must ")+"match input depth for filter ".concat(n.shape[2],".")})),i.b(m===n.shape[3],(function(){return"Error in conv2dDerInput: depth of output (".concat(m,") must ")+"match output depth for filter ".concat(n.shape[3],".")})),null!=l&&i.b(i.v(c),(function(){return"Error in conv2dDerInput: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(c,".")}));var v={dy:h,filter:n},g={strides:o,pad:c,dataFormat:u,dimRoundingMode:l,inputShape:d},b=r.a.runKernel(a.D,v,g);return f?Object(s.a)(b,[b.shape[1],b.shape[2],b.shape[3]]):b}})},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return T})),n.d(t,"i",(function(){return k})),n.d(t,"c",(function(){return R})),n.d(t,"f",(function(){return I})),n.d(t,"e",(function(){return L})),n.d(t,"d",(function(){return N})),n.d(t,"k",(function(){return P})),n.d(t,"g",(function(){return F})),n.d(t,"h",(function(){return G})),n.d(t,"j",(function(){return U})),n.d(t,"b",(function(){return z}));var r=n(12),a=n(65),i=n(147),o=n(149),s=n(142),c=n(422),u=n(200),l=n(152),d=n(423),h=n(424),f=n(425),p=n(426),m=n(427),v=n(428),g=n(429),b=n(430),y=n(431),x=n(432),w=n(433),O=n(434),A=n(435),_=n(436),E=n(437),S=n(438),C=n(439),T=function(){function e(){var t;Object(i.a)(this,e);var n=[d,h,f,p,m,v,g,w,x,b,O,A,_,E,S,C,y],r=(t=[]).concat.apply(t,Object(a.a)(n.map((function(e){return e.json}))));this.opMappers=r.reduce((function(e,t){return e[t.tfOpName]=t,e}),{})}return Object(o.a)(e,[{key:"transformGraph",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=e.node,i=[],o=[],s=[],c=a.reduce((function(e,n){return e[n.name]=t.mapNode(n),n.op.startsWith("Placeholder")?i.push(e[n.name]):"Const"===n.op?o.push(e[n.name]):null!=n.input&&0!==n.input.length||s.push(e[n.name]),e}),{}),u=[],d=[],h={},f={};null!=n&&(h=this.mapSignatureEntries(n.inputs),f=this.mapSignatureEntries(n.outputs));var p=Object.keys(c);p.forEach((function(e){var t=c[e];t.inputNames.forEach((function(e){var n=Object(l.b)(e),a=Object(r.a)(n,1)[0];t.inputs.push(c[a]),c[a].children.push(t)}))})),0===Object.keys(f).length?p.forEach((function(e){var t=c[e];0===t.children.length&&d.push(t)})):Object.keys(f).forEach((function(e){var t=Object(l.b)(e),n=Object(r.a)(t,1)[0],a=c[n];null!=a&&(a.signatureKey=f[e],d.push(a))})),Object.keys(h).length>0?Object.keys(h).forEach((function(e){var t=Object(l.b)(e),n=Object(r.a)(t,1)[0],a=c[n];a&&(a.signatureKey=h[e],u.push(a))})):u=i;var m={};null!=e.library&&null!=e.library.function&&(m=e.library.function.reduce((function(e,n){return e[n.signature.name]=t.mapFunction(n),e}),{}));var v={nodes:c,inputs:u,outputs:d,weights:o,placeholders:i,signature:n,functions:m};return s.length>0&&(v.initNodes=s),v}},{key:"mapSignatureEntries",value:function(e){return Object.keys(e||{}).reduce((function(t,n){return t[e[n].name]=n,t}),{})}},{key:"mapNode",value:function(e){var t=Object(u.a)(e.op)||this.opMappers[e.op]||{};null==e.attr&&(e.attr={});var n={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map((function(e){return e.startsWith("^")?e.substr(1):e})),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr};return null!=t.inputs&&(n.inputParams=t.inputs.reduce((function(e,t){return e[t.name]={type:t.type,inputIndexStart:t.start,inputIndexEnd:t.end},e}),{})),null!=t.attrs&&(n.attrParams=t.attrs.reduce((function(t,n){var r=n.type,a=void 0;switch(n.type){case"string":void 0===(a=k(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=k(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"string[]":void 0===(a=G(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=G(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number":void 0===(a=I(e.attr,n.tfName,n.defaultValue||0))&&n.tfDeprecatedName&&(a=I(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"number[]":void 0===(a=F(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=F(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool":void 0===(a=R(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=R(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"bool[]":void 0===(a=z(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=z(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape":void 0===(a=P(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=P(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"shape[]":void 0===(a=U(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=U(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype":void 0===(a=L(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=L(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"dtype[]":void 0===(a=N(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=N(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"func":void 0===(a=B(e.attr,n.tfName,n.defaultValue))&&n.tfDeprecatedName&&(a=B(e.attr,n.tfDeprecatedName,n.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error("Unsupported param type: ".concat(n.type," for op: ").concat(e.op))}return t[n.name]={value:a,type:r},t}),{})),n}},{key:"mapFunction",value:function(e){var t=this,n=e.nodeDef,a=[],i={};null!=n&&(i=n.reduce((function(e,n){return e[n.name]=t.mapNode(n),"Const"===n.op&&a.push(e[n.name]),e}),{}));var o=[],s=[];e.signature.inputArg.forEach((function(e){var t=Object(l.b)(e.name),n=Object(r.a)(t,1)[0],a={name:n,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:j(e.type),type:"dtype"}},children:[]};a.signatureKey=e.name,o.push(a),i[n]=a})),Object.keys(i).forEach((function(e){var t=i[e];t.inputNames.forEach((function(e){var n=Object(l.b)(e),a=Object(r.a)(n,1)[0];t.inputs.push(i[a]),i[a].children.push(t)}))}));var c=e.ret;e.signature.outputArg.forEach((function(e){var t=Object(l.b)(c[e.name]),n=Object(r.a)(t,2),a=n[0],o=n[1],u=i[a];null!=u&&(u.defaultOutput=o,s.push(u))}));var u=this.mapArgsToSignature(e);return{nodes:i,inputs:o,outputs:s,weights:a,placeholders:[],signature:u}}},{key:"mapArgsToSignature",value:function(e){var t=this;return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((function(e,n){return e[n.name]=t.mapArgToTensorInfo(n),e}),{}),outputs:e.signature.outputArg.reduce((function(n,r){return n[r.name]=t.mapArgToTensorInfo(r,e.ret),n}),{})}}},{key:"mapArgToTensorInfo",value:function(e,t){var n=e.name;return null!=t&&(n=t[n]),{name:n,dtype:e.type}}}],[{key:"Instance",get:function(){return this._instance||(this._instance=new this)}}]),e}();function M(t,n){var r=Array.isArray(t)?String.fromCharCode.apply(null,t):function(t){var n=Object(s.md)().global;if("undefined"!==typeof n.atob)return n.atob(t);if("undefined"!==typeof e)return new e(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}(t);return n?r:r.toLowerCase()}function k(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return null!=a?M(a.s,r):n}function R(e,t,n){var r=e[t];return r?r.b:n}function I(e,t,n){var r=e[t]||{},a=null!=r.i?r.i:null!=r.f?r.f:n;return"number"===typeof a?a:parseInt(a,10)}function j(e){switch("string"===typeof e&&(e=c.a[e]),e){case c.a.DT_FLOAT:return"float32";case c.a.DT_INT32:case c.a.DT_INT64:case c.a.DT_INT8:case c.a.DT_UINT8:return"int32";case c.a.DT_BOOL:return"bool";case c.a.DT_DOUBLE:return"float32";case c.a.DT_STRING:return"string";default:return null}}function B(e,t,n){var r=e[t];return r&&r.func?r.func.name:n}function L(e,t,n){var r=e[t];return r&&r.type?j(r.type):n}function N(e,t,n){var r=e[t];return r&&r.list&&r.list.type?r.list.type.map((function(e){return j(e)})):n}function D(e){if(!e.unknownRank)return null!=e.dim?e.dim.map((function(e){return"number"===typeof e.size?e.size:parseInt(e.size,10)})):[]}function P(e,t,n){var r=e[t];return r&&r.shape?D(r.shape):n}function F(e,t,n){var r=e[t];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map((function(e){return"number"===typeof e?e:parseInt(e,10)})):n}function G(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e[t];return a&&a.list&&a.list.s?a.list.s.map((function(e){return M(e,r)})):n}function U(e,t,n){var r=e[t];return r&&r.list&&r.list.shape?r.list.shape.map((function(e){return D(e)})):n}function z(e,t,n){var r=e[t];return r&&r.list&&r.list.b?r.list.b:n}}).call(this,n(265).Buffer)},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({addN_:function(e){o.b(Array.isArray(e),(function(){return"The argument passed to tf.addN() must be a list of tensors"})),o.b(e.length>=1,(function(){return"Must pass at least one tensor to tf.addN(), but got "+"".concat(e.length)}));var t=e.map((function(e,t){return Object(i.a)(e,"tensors".concat(t),"addN")})),n=t[0];t.forEach((function(e){if(e.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")})),t.forEach((function(e){if(!o.a(e.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")}));var s=t;return r.a.runKernel(a.e,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(143);var u=Object(c.a)({mod_:function(e,t){var n=Object(s.a)(e,"a","mod"),c=Object(s.a)(t,"b","mod"),u=Object(o.b)(n,c),l=Object(r.a)(u,2),d={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.Ob,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(12),a=n(151),i=n(144),o=n(176),s=n(259),c=n(143),u=n(194),l=n(209);var d=Object(c.a)({divNoNan_:function(e,t){var n=Object(i.a)(e,"a","div"),c=Object(i.a)(t,"b","div"),d=Object(a.b)(n,c),h=Object(r.a)(d,2);n=h[0],c=h[1];var f=Object(o.a)(n,c),p=Object(l.a)(f),m=Object(s.a)(c,p);return Object(u.a)(m,p,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(154),u=n(157),l=n(143);var d=Object(l.a)({maximum_:function(e,t){var n=Object(s.a)(e,"a","maximum"),l=Object(s.a)(t,"b","maximum"),d=Object(o.b)(n,l),h=Object(r.a)(d,2);n=h[0],l=h[1],"bool"===n.dtype&&(n=Object(u.a)(n,"int32"),l=Object(u.a)(l,"int32")),Object(c.a)(n.shape,l.shape);var f={a:n,b:l};return a.a.runKernel(i.Jb,f)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({acos_:function(e){var t={x:Object(i.a)(e,"x","acos")};return r.a.runKernel(a.b,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({acosh_:function(e){var t={x:Object(i.a)(e,"x","acosh")};return r.a.runKernel(a.c,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({asin_:function(e){var t={x:Object(i.a)(e,"x","asin")};return r.a.runKernel(a.j,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({asinh_:function(e){var t={x:Object(i.a)(e,"x","asinh")};return r.a.runKernel(a.k,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({atan_:function(e){var t={x:Object(i.a)(e,"x","atan")};return r.a.runKernel(a.l,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(143);var u=Object(c.a)({atan2_:function(e,t){var n=Object(s.a)(e,"a","atan2"),c=Object(s.a)(t,"b","atan2"),u=Object(o.b)(n,c),l=Object(r.a)(u,2),d={a:n=l[0],b:c=l[1]};return a.a.runKernel(i.m,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({atanh_:function(e){var t={x:Object(i.a)(e,"x","atanh")};return r.a.runKernel(a.n,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({ceil_:function(e){var t={x:Object(i.a)(e,"x","ceil")};return r.a.runKernel(a.w,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({cos_:function(e){var t={x:Object(i.a)(e,"x","cos")};return r.a.runKernel(a.H,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({cosh_:function(e){var t={x:Object(i.a)(e,"x","cosh")};return r.a.runKernel(a.I,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(157),c=n(143);var u=Object(c.a)({erf_:function(e){var t=Object(i.a)(e,"x","erf");o.b("int32"===t.dtype||"float32"===t.dtype,(function(){return"Input dtype must be `int32` or `float32`."})),"int32"===t.dtype&&(t=Object(s.a)(t,"float32"));var n={x:t};return r.a.runKernel(a.V,n)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({expm1_:function(e){var t={x:Object(i.a)(e,"x","expm1")};return r.a.runKernel(a.Y,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({floor_:function(e){var t={x:Object(i.a)(e,"x","floor")};return r.a.runKernel(a.cb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({reciprocal_:function(e){var t={x:Object(i.a)(e,"x","reciprocal")};return r.a.runKernel(a.gc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({round_:function(e){var t={x:Object(i.a)(e,"x","round")};return r.a.runKernel(a.qc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({selu_:function(e){var t={x:Object(i.a)(e,"x","selu")};return r.a.runKernel(a.uc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({sin_:function(e){var t={x:Object(i.a)(e,"x","sin")};return r.a.runKernel(a.xc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({sign_:function(e){var t={x:Object(i.a)(e,"x","sign")};return r.a.runKernel(a.wc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({sinh_:function(e){var t={x:Object(i.a)(e,"x","sinh")};return r.a.runKernel(a.yc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({softplus_:function(e){var t={x:Object(i.a)(e,"x","softplus")};return r.a.runKernel(a.Bc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({tanh_:function(e){var t={x:Object(i.a)(e,"x","tanh")};return r.a.runKernel(a.Nc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({tan_:function(e){var t={x:Object(i.a)(e,"x","tan")};return r.a.runKernel(a.Mc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({clipByValue_:function(e,t,n){var s=Object(i.a)(e,"x","clipByValue");o.b(t<=n,(function(){return"Error in clip: min (".concat(t,") must be ")+"less than or equal to max (".concat(n,").")}));var c={x:s},u={clipValueMin:t,clipValueMax:n};return r.a.runKernel(a.x,c,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({rsqrt_:function(e){var t={x:Object(i.a)(e,"x","rsqrt")};return r.a.runKernel(a.rc,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(157),s=n(143);var c=Object(s.a)({prod_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=Object(i.a)(e,"x","prod");"bool"===s.dtype&&(s=Object(o.a)(s,"int32"));var c={x:s},u={axis:t,keepDims:n};return r.a.runKernel(a.cc,c,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(144),a=n(202),i=n(215),o=n(168),s=n(143),c=n(150);var u=Object(s.a)({conv1d_:function(e,t,n,s){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NWC",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1,d=arguments.length>6?arguments[6]:void 0,h=Object(r.a)(e,"x","conv1d"),f=Object(r.a)(t,"filter","conv1d"),p=h,m=!1;2===h.rank&&(m=!0,p=Object(c.a)(h,[1,h.shape[0],h.shape[1]])),a.b(3===p.rank,(function(){return"Error in conv1d: input must be rank 3, but got rank ".concat(p.rank,".")})),a.b(3===f.rank,(function(){return"Error in conv1d: filter must be rank 3, but got rank "+"".concat(f.rank,".")})),null!=d&&a.b(a.v(s),(function(){return"Error in conv1d: pad must be an integer when using, "+"dimRoundingMode ".concat(d," but got pad ").concat(s,".")})),a.b(p.shape[2]===f.shape[1],(function(){return"Error in conv1d: depth of input (".concat(p.shape[2],") must match ")+"input depth for filter ".concat(f.shape[1],".")})),a.b(o.h(n,l),(function(){return"Error in conv1D: Either stride or dilation must be 1. "+"Got stride ".concat(n," and dilation '").concat(l,"'")})),a.b("NWC"===u,(function(){return"Error in conv1d: got dataFormat of ".concat(u," but only NWC is currently supported.")}));var v=Object(c.a)(f,[1,f.shape[0],f.shape[1],f.shape[2]]),g=Object(c.a)(p,[p.shape[0],1,p.shape[1],p.shape[2]]),b=[1,n],y=[1,l],x="NHWC",w=Object(i.a)(g,v,b,s,x,y,d);return m?Object(c.a)(w,[w.shape[2],w.shape[3]]):Object(c.a)(w,[w.shape[0],w.shape[2],w.shape[3]])}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(144),a=n(268),i=n(143);var o=Object(i.a)({conv2dTranspose_:function(e,t,n,i,o,s){var c=Object(r.a)(e,"x","conv2dTranspose"),u=Object(r.a)(t,"filter","conv2dTranspose");return Object(a.a)(n,c,u,i,o,"NHWC",s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(168),c=n(143),u=n(150);var l=Object(c.a)({conv3d_:function(e,t,n,c){var l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"NDHWC",d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1,1],h=Object(i.a)(e,"x","conv3d"),f=Object(i.a)(t,"filter","conv3d"),p=h,m=!1;4===h.rank&&(m=!0,p=Object(u.a)(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),o.b(5===p.rank,(function(){return"Error in conv3d: input must be rank 5, but got rank ".concat(p.rank,".")})),o.b(5===f.rank,(function(){return"Error in conv3d: filter must be rank 5, but got rank "+"".concat(f.rank,".")})),o.b(p.shape[4]===f.shape[3],(function(){return"Error in conv3d: depth of input (".concat(p.shape[4],") must match ")+"input depth for filter ".concat(f.shape[3],".")})),o.b(Object(s.h)(n,d),(function(){return"Error in conv3D: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(d,"'")})),o.b("NDHWC"===l,(function(){return"Error in conv3d: got dataFormat of ".concat(l," but only NDHWC is currently supported.")}));var v={x:p,filter:f},g={strides:n,pad:c,dataFormat:l,dilations:d},b=r.a.runKernel(a.E,v,g);return m?Object(u.a)(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(157),c=n(168),u=n(143),l=n(150);var d=Object(u.a)({avgPool_:function(e,t,n,u,d){var h=Object(i.a)(e,"x","avgPool","float32");o.b(c.h(n,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")}));var f=h,p=!1;3===h.rank&&(p=!0,f=Object(l.a)(h,[1,h.shape[0],h.shape[1],h.shape[2]])),o.b(4===f.rank,(function(){return"Error in avgPool: x must be rank 4 but got rank ".concat(f.rank,".")})),null!=d&&o.b(o.v(u),(function(){return"Error in avgPool: pad must be an integer when using, "+"dimRoundingMode ".concat(d," but got pad ").concat(u,".")}));var m={x:f},v={filterSize:t,strides:n,pad:u,dimRoundingMode:d},g=r.a.runKernel(a.o,m,v);return g=Object(s.a)(g,h.dtype),p?Object(l.a)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(168),c=n(143),u=n(150);var l=Object(c.a)({maxPool_:function(e,t,n,c,l){var d=Object(i.a)(e,"x","maxPool"),h=d,f=!1;3===d.rank&&(f=!0,h=Object(u.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]])),o.b(4===h.rank,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(h.rank,".")})),o.b(s.h(n,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(n," and dilations '").concat(1,"'")})),null!=l&&o.b(o.v(c),(function(){return"Error in maxPool: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(c,".")}));var p={x:h},m={filterSize:t,strides:n,pad:c,dimRoundingMode:l},v=r.a.runKernel(a.Eb,p,m);return f?Object(u.a)(v,[v.shape[1],v.shape[2],v.shape[3]]):v}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({maxPoolWithArgmax_:function(e,t,n,o){var s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=Object(i.a)(e,"x","maxPoolWithArgmax"),u={x:c},l={filterSize:t,strides:n,pad:o,includeBatchInIndex:s},d=r.a.runKernel(a.Ib,u,l);return{result:d[0],indexes:d[1]}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(157),c=n(143),u=n(150);var l=Object(c.a)({avgPool3d_:function(e,t,n,c,l){var d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",h=Object(i.a)(e,"x","avgPool3d","float32"),f=h,p=!1;4===h.rank&&(p=!0,f=Object(u.a)(h,[1,h.shape[0],h.shape[1],h.shape[2],h.shape[3]])),o.b(5===f.rank,(function(){return"Error in avgPool3d: x must be rank 5 but got rank ".concat(f.rank,".")})),o.b("NDHWC"===d,(function(){return"Error in avgPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(d)})),null!=l&&o.b(o.v(c),(function(){return"Error in avgPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(c,".")}));var m={x:f},v={filterSize:t,strides:n,pad:c,dimRoundingMode:l,dataFormat:d},g=r.a.runKernel(a.p,m,v);return g=Object(s.a)(g,f.dtype),p?Object(u.a)(g,[g.shape[1],g.shape[2],g.shape[3],g.shape[4]]):g}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143),c=n(150);var u=Object(s.a)({maxPool3d_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1],n=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,u=arguments.length>4?arguments[4]:void 0,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NDHWC",d=Object(i.a)(e,"x","maxPool3d"),h=d,f=!1;4===d.rank&&(f=!0,h=Object(c.a)(d,[1,d.shape[0],d.shape[1],d.shape[2],d.shape[3]])),o.b(5===h.rank,(function(){return"Error in maxPool3d: x must be rank 5 but got rank ".concat(h.rank,".")})),o.b("NDHWC"===l,(function(){return"Error in maxPool3d: Only NDHWC is currently supported, "+"but got dataFormat of ".concat(l)})),null!=u&&o.b(o.v(s),(function(){return"Error in maxPool3d: pad must be an integer when using, "+"dimRoundingMode ".concat(u," but got pad ").concat(s,".")}));var p={x:h},m={filterSize:t,strides:n,pad:s,dimRoundingMode:u,dataFormat:l},v=r.a.runKernel(a.Fb,p,m);return f?Object(c.a)(v,[v.shape[1],v.shape[2],v.shape[3],v.shape[4]]):v}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143),c=n(150);var u=Object(s.a)({dilation2d_:function(e,t,n,s){var u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[1,1],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",d=Object(i.a)(e,"x","dilation2d"),h=Object(i.a)(t,"filter","dilation2d");o.b(3===d.rank||4===d.rank,(function(){return"Error in dilation2d: input must be rank 3 or 4, but got rank "+"".concat(d.rank,".")})),o.b(3===h.rank,(function(){return"Error in dilation2d: filter must be rank 3, but got rank "+"".concat(h.rank,".")})),o.b("NHWC"===l,(function(){return"Error in dilation2d: Only NHWC is currently supported, "+"but got dataFormat of ".concat(l)}));var f=d,p=!1;3===d.rank&&(f=Object(c.a)(d,[1,d.shape[0],d.shape[1],d.shape[2]]),p=!0);var m={x:f,filter:h},v={strides:n,pad:s,dilations:u},g=r.a.runKernel(a.R,m,v);return p?Object(c.a)(g,[g.shape[1],g.shape[2],g.shape[3]]):g}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(145),a=n(146);function i(e,t,n){if(n<=0)throw new Error("The number of values should be positive.");var i={start:e,stop:t,num:n};return r.a.runKernel(a.xb,{},i)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(143),s=n(150);var c=Object(o.a)({multinomial_:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(i.a)(e,"logits","multinomial"),u=c.size,l=c.rank;if(u<2)throw new Error("Error in multinomial: you need at least 2 outcomes, but got "+"".concat(u,"."));if(l>2)throw new Error("Rank of probabilities must be 1 or 2, but is ".concat(l));n=n||Math.random();var d=1===l?Object(s.a)(c,[1,-1]):c,h={logits:d},f={numSamples:t,seed:n,normalized:o},p=r.a.runKernel(a.Pb,h,f);return 1===l?Object(s.a)(p,[p.size]):p}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({oneHot_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(t<2)throw new Error("Error in oneHot: depth must be >=2, but it is ".concat(t));var s=Object(i.a)(e,"indices","oneHot","int32"),c={indices:s},u={depth:t,onValue:n,offValue:o};return r.a.runKernel(a.Wb,c,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({onesLike_:function(e){var t={x:Object(i.a)(e,"x","onesLike")};return r.a.runKernel(a.Xb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(175),a=n(143),i=n(313);var o=Object(a.a)({randomUniform_:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32",o=arguments.length>4?arguments[4]:void 0,s=Object(r.a)(e,a),c=new i.b(t,n,null,o),u=0;u<s.values.length;u++)s.values[u]=c.nextValue();return s.toTensor()}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s}));var r=n(147),a=n(149),i=n(440),o=(n(260),function(){function e(t,n,a,o,s){Object(r.a)(this,e),this.mean=t,this.stdDev=n,this.dtype=a,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var c=s||Math.random();this.random=i.alea(c.toString())}return Object(a.a)(e,[{key:"nextValue",value:function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var a=void 0,i=void 0,o=void 0;do{o=(a=2*this.random()-1)*a+(i=2*this.random()-1)*i}while(o>=1||0===o);var s=Math.sqrt(-2*Math.log(o)/o);t=this.mean+this.stdDev*a*s,n=this.mean+this.stdDev*i*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)}},{key:"convertValue",value:function(e){return null==this.dtype||"float32"===this.dtype?e:Math.round(e)}},{key:"isValidTruncated",value:function(e){return e<=this.upper&&e>=this.lower}}]),e}()),s=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;if(Object(r.a)(this,e),this.canReturnFloat=function(){return null==t.dtype||"float32"===t.dtype},this.min=n,this.range=a-n,this.dtype=o,null==s&&(s=Math.random()),"number"===typeof s&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error("The difference between ".concat(n," - ").concat(a," <= 1 and dtype is not float"));this.random=i.alea(s)}return Object(a.a)(e,[{key:"convertValue",value:function(e){return this.canReturnFloat()?e:Math.round(e)}},{key:"nextValue",value:function(){return this.convertValue(this.min+this.range*this.random())}}]),e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(175),a=n(143),i=n(313);var o=Object(a.a)({truncatedNormal_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;if(null!=a&&"bool"===a)throw new Error("Unsupported data type $ { dtype }");for(var s=new i.a(t,n,a,!0,o),c=Object(r.a)(e,a),u=0;u<c.values.length;u++)c.values[u]=s.nextValue();return c.toTensor()}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(13),a=n.n(r),i=n(20),o=n(257),s=n(144);function c(){return(c=Object(i.a)(a.a.mark((function e(t){var n,r,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Object(s.a)(t,"condition","whereAsync","bool"),e.next=3,n.data();case 3:return r=e.sent,i=Object(o.a)(n.shape,r),t!==n&&n.dispose(),e.abrupt("return",i);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var u=function(e){return c.apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(13),a=n.n(r),i=n(20),o=n(160),s=n(144),c=n(202);function u(){return(u=Object(i.a)(a.a.mark((function e(t,n){var r,i,u,l,d,h,f,p,m,v,g;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(s.a)(t,"x","setdiff1d"),i=Object(s.a)(n,"y","setdiff1d"),c.b(r.dtype===i.dtype,(function(){return"x and y should have the same dtype, but got x (".concat(r.dtype,") and y (").concat(i.dtype,").")})),c.b(1===r.rank,(function(){return"x should be 1D tensor, but got x (".concat(r.shape,").")})),c.b(1===i.rank,(function(){return"y should be 1D tensor, but got y (".concat(i.shape,").")})),e.next=7,r.data();case 7:return u=e.sent,e.next=10,i.data();case 10:for(l=e.sent,d=new Set(l),h=0,f=0;f<u.length;f++)d.has(u[f])||h++;for(p=new o.b([h],r.dtype),m=new o.b([h],"int32"),v=0,g=0;v<u.length;v++)d.has(u[v])||(p.values[g]=u[v],m.values[g]=v,g++);return e.abrupt("return",[p.toTensor(),m.toTensor()]);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var l=function(e,t){return u.apply(this,arguments)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(12),a=n(145),i=n(146),o=n(144),s=n(143);var c=Object(s.a)({topk_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=Object(o.a)(e,"x","topk");if(0===s.rank)throw new Error("topk() expects the input to be of rank 1 or higher");var c=s.shape[s.shape.length-1];if(t>c)throw new Error("'k' passed to topk() must be <= the last dimension (".concat(c,") ")+"but got ".concat(t));var u={x:s},l={k:t,sorted:n},d=a.a.runKernel(i.Pc,u,l),h=Object(r.a)(d,2),f=h[0],p=h[1];return{values:f,indices:p}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(12),a=n(145),i=n(146),o=n(144),s=n(202),c=n(143);var u=Object(c.a)({unique_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(o.a)(e,"x","unique","string_or_numeric");Object(s.b)(n.rank>0,(function(){return"The input tensor must be at least 1D"}));var c={x:n},u={axis:t},l=a.a.runKernel(i.Sc,c,u),d=Object(r.a)(l,2),h=d[0],f=d[1];return{values:h,indices:f}}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(12),a=n(145),i=n(146),o=n(151),s=n(144),c=n(154),u=n(143);var l=Object(u.a)({less_:function(e,t){var n=Object(s.a)(e,"a","less"),u=Object(s.a)(t,"b","less"),l=Object(o.b)(n,u),d=Object(r.a)(l,2);n=d[0],u=d[1],Object(c.a)(n.shape,u.shape);var h={a:n,b:u};return a.a.runKernel(i.vb,h)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({logicalNot_:function(e){var t={x:Object(i.a)(e,"x","logicalNot","bool")};return r.a.runKernel(a.Bb,t)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(154),s=n(143);var c=Object(s.a)({logicalOr_:function(e,t){var n=Object(i.a)(e,"a","logicalOr","bool"),s=Object(i.a)(t,"b","logicalOr","bool");Object(o.a)(n.shape,s.shape);var c={a:n,b:s};return r.a.runKernel(a.Cb,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143),c=n(150);var u=Object(s.a)({localResponseNormalization_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.5,l=Object(i.a)(e,"x","localResponseNormalization");o.b(4===l.rank||3===l.rank,(function(){return"Error in localResponseNormalization: x must be rank 3 or 4 but got\n               rank ".concat(l.rank,".")})),o.b(o.v(t),(function(){return"Error in localResponseNormalization: depthRadius must be an "+"integer but got depthRadius ".concat(t,".")}));var d=l,h=!1;3===l.rank&&(h=!0,d=Object(c.a)(l,[1,l.shape[0],l.shape[1],l.shape[2]]));var f={x:d},p={depthRadius:t,bias:n,alpha:s,beta:u},m=r.a.runKernel(a.sb,f,p);return h?Object(c.a)(m,[m.shape[1],m.shape[2],m.shape[3]]):m}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({softmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(i.a)(e,"logits","softmax","float32");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and dim was ").concat(t));var o={logits:n},s={dim:t};return r.a.runKernel(a.Ac,o,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));var r=n(12),a=n(162),i=n(144),o=n(157),s=n(188),c=n(198),u=n(196),l=n(156),d=n(143),h=n(158),f=n(167);var p=Object(d.a)({logSoftmax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,n=Object(i.a)(e,"logits","logSoftmax");if(-1===t&&(t=n.rank-1),t!==n.rank-1)throw Error("Log Softmax along a non-last dimension is not yet supported. "+"Logits was rank ".concat(n.rank," and axis was ").concat(t));var d=Object(a.a)((function(e,n){var a=Object(u.a)(e,t,!0),i=Object(h.a)(e,a),d=Object(h.a)(Object(o.a)(i,"float32"),Object(c.a)(Object(f.a)(Object(s.a)(i),t,!0)));n([d]);return{value:d,gradFunc:function(e,n){var a=Object(r.a)(n,1)[0],i=Object(s.a)(a);return Object(h.a)(e,Object(l.a)(Object(f.a)(e,t,!0),i))}}}));return d(n)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({all_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","all","bool"),s={x:o},c={axis:t,keepDims:n};return r.a.runKernel(a.f,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({any_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=Object(i.a)(e,"x","any","bool"),s={x:o},c={axis:t,keepDims:n};return r.a.runKernel(a.g,s,c)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({argMax_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","argMax"),o={x:n},s={axis:t};return r.a.runKernel(a.h,o,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({argMin_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=Object(i.a)(e,"x","argMin"),o={x:n},s={axis:t};return r.a.runKernel(a.i,o,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({cumsum_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=Object(i.a)(e,"x","cumsum"),c={x:s},u={axis:t,exclusive:n,reverse:o};return r.a.runKernel(a.K,c,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({bincount_:function(e,t,n){var s=Object(i.a)(e,"x","bincount"),c=Object(i.a)(t,"weights","bincount");o.b("int32"===s.dtype,(function(){return"Error in bincount: input "+"dtype must be int32, but got ".concat(s.dtype)})),o.b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),o.b(c.size===s.size||0===c.size,(function(){return"Error in bincount: weights must have the same size as input or"+"0-length, but got input shape: ".concat(s.shape,", weights shape: ")+"".concat(c.shape,".")}));var u={x:s,weights:c},l={size:n};return r.a.runKernel(a.u,u,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({denseBincount_:function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=Object(i.a)(e,"x","denseBincount"),u=Object(i.a)(t,"weights","denseBincount");o.b("int32"===c.dtype,(function(){return"Error in denseBincount: input "+"dtype must be int32, but got ".concat(c.dtype)})),o.b(c.rank<=2,(function(){return"Error in denseBincount: input must be at most rank 2, but got "+"rank ".concat(c.rank,".")})),o.b(n>=0,(function(){return"size must be non-negative, but got ".concat(n,".")})),o.b(u.size===c.size||0===u.size,(function(){return"Error in denseBincount: weights must have the same shape as x or "+"0-length, but got x shape: ".concat(c.shape,", weights shape: ")+"".concat(u.shape,".")}));var l={x:c,weights:u},d={size:n,binaryOutput:s};return r.a.runKernel(a.L,l,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({gather_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,s=Object(i.a)(e,"x","gather"),c=Object(i.a)(t,"indices","gather","int32"),u={x:s,indices:c},l={axis:n,batchDims:o};return r.a.runKernel(a.jb,u,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({stridedSlice_:function(e,t,n,o){var s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,d=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,h=Object(i.a)(e,"x","stridedSlice"),f={x:h},p={begin:t,end:n,strides:o,beginMask:s,endMask:c,ellipsisMask:u,newAxisMask:l,shrinkAxisMask:d};return r.a.runKernel(a.Jc,f,p)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(143),s=n(199);var c=Object(o.a)({scatterND_:function(e,t,n){var o=Object(i.a)(e,"indices","scatterND","int32"),c=Object(i.a)(t,"updates","scatterND");s.b(c,o,n);var u={indices:o,updates:c},l={shape:n};return r.a.runKernel(a.sc,u,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({gatherND_:function(e,t){var n=Object(i.a)(t,"indices","gatherND","int32"),o={params:Object(i.a)(e,"x","gatherND"),indices:n};return r.a.runKernel(a.ib,o)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({mirrorPad_:function(e,t,n){o.b("reflect"===n||"symmetric"===n,(function(){return"Invalid mode. Mode must be either reflect or symmetric. "+"Got ".concat(n,".")}));var s=Object(i.a)(e,"x","mirrorPad");if(0===s.rank)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");o.b(t.length===s.rank,(function(){return"Padding doesn't match input. Must be ".concat(s.rank,". ")+"Got ".concat(t.length,".")}));for(var c="reflect"===n?1:0,u=function(e){o.b(2===t[e].length,(function(){return"Invalid number of paddings. Must be length of 2 each."})),o.b(t[e][0]>=0&&t[e][0]<=s.shape[e]-c&&t[e][1]>=0&&t[e][1]<=s.shape[e]-c,(function(){return"Padding in dimension ".concat(e," cannot be greater than or equal ")+"to ".concat(s.shape[e]-c," or less than 0 for input of ")+"shape ".concat(s.shape)}))},l=0;l<s.rank;l++)u(l);var d={paddings:t,mode:n},h={x:s};return r.a.runKernel(a.Nb,h,d)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));var r=n(145),a=n(146),i=n(144),o=n(143);var s=Object(o.a)({pad_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=Object(i.a)(e,"x","pad");if(0===o.rank)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");var s={paddings:t,constantValue:n},c={x:o};return r.a.runKernel(a.Zb,c,s)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({spaceToBatchND_:function(e,t,n){var s=Object(i.a)(e,"x","spaceToBatchND");o.b(s.rank>=1+t.length,(function(){return"input rank ".concat(s.rank," should be > than [blockShape] ").concat(t.length)})),o.b(n.length===t.length,(function(){return"paddings.shape[0] ".concat(n.length," must be equal to [blockShape] ").concat(t.length)})),o.b(s.shape.reduce((function(e,r,a){return a>0&&a<=t.length?e&&(r+n[a-1][0]+n[a-1][1])%t[a-1]===0:e}),!0),(function(){return"input spatial dimensions ".concat(s.shape.slice(1)," with paddings ").concat(n.toString()," must be divisible by blockShapes ").concat(t.toString())}));var c={x:s},u={blockShape:t,paddings:n};return r.a.runKernel(a.Cc,c,u)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({batchToSpaceND_:function(e,t,n){var s=Object(i.a)(e,"x","batchToSpaceND"),c=t.reduce((function(e,t){return e*t}));o.b(s.rank>=1+t.length,(function(){return"input rank is ".concat(s.rank," but should be > than blockShape.length ").concat(t.length)})),o.b(n.length===t.length,(function(){return"crops.length is ".concat(n.length," but should be equal to blockShape.length  ").concat(t.length)})),o.b(s.shape[0]%c===0,(function(){return"input tensor batch is ".concat(s.shape[0]," but is not divisible by the product of ")+"the elements of blockShape ".concat(t.join(" * ")," === ").concat(c)}));var u={x:s},l={blockShape:t,crops:n};return r.a.runKernel(a.t,u,l)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(143);var c=Object(s.a)({depthToSpace_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"NHWC",s=Object(i.a)(e,"x","depthToSpace"),c="NHWC"===n?s.shape[1]:s.shape[2],u="NHWC"===n?s.shape[2]:s.shape[3],l="NHWC"===n?s.shape[3]:s.shape[1];o.b(c*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(c," and ").concat(t,"  for depthToSpace with input shape\n    ").concat(s.shape)})),o.b(u*t>=0,(function(){return"Negative dimension size caused by overflow when multiplying\n    ".concat(u," and ").concat(t," for depthToSpace with input shape\n        ").concat(s.shape)})),o.b(l%(t*t)===0,(function(){return"Dimension size must be evenly divisible by ".concat(t*t," but is ").concat(l," for depthToSpace with input shape ").concat(s.shape)}));var d={x:s},h={blockSize:t,dataFormat:n};return r.a.runKernel(a.M,d,h)}})},,,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return a.a})),n.d(t,"b",(function(){return i.a})),n.d(t,"c",(function(){return o.a})),n.d(t,"d",(function(){return s.a})),n.d(t,"e",(function(){return c.a})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return d.a})),n.d(t,"h",(function(){return h.a})),n.d(t,"k",(function(){return f.a})),n.d(t,"l",(function(){return p.a})),n.d(t,"m",(function(){return m.a})),n.d(t,"n",(function(){return v.a})),n.d(t,"o",(function(){return g.a})),n.d(t,"p",(function(){return b.a})),n.d(t,"q",(function(){return y.a})),n.d(t,"r",(function(){return x.a})),n.d(t,"s",(function(){return w.a})),n.d(t,"t",(function(){return O.a})),n.d(t,"u",(function(){return S})),n.d(t,"v",(function(){return C.a})),n.d(t,"w",(function(){return T.a})),n.d(t,"j",(function(){return ot})),n.d(t,"i",(function(){return r}));var r={};n.r(r),n.d(r,"conv2d",(function(){return V})),n.d(r,"depthwiseConv2d",(function(){return K})),n.d(r,"matMul",(function(){return Y}));var a=n(166),i=n(175),o=n(157),s=n(184),c=n(170),u=n(143);var l=Object(u.a)({concat2d_:function(e,t){return Object(c.a)(e,t)}}),d=n(176),h=n(226),f=n(156),p=n(150),m=n(159),v=n(267),g=n(177),b=n(227),y=n(192),x=n(158),w=n(223),O=n(185),A=n(144),_=n(202),E=n(191);function S(e,t,n){if(Object(_.d)(e),null!=t&&2!==t.length)throw new Error("tensor2d() requires shape to have two numbers");var r=Object(A.c)(e,n);if(2!==r.length&&1!==r.length)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(1===r.length&&null==t)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Object(E.a)(e,t,r,n)}var C=n(205),T=n(193),M=n(208),k=n(206),R=n(207),I=n(228),j=n(12),B=n(145),L=n(162),N=n(146),D=n(151),P=n(154),F=n(215);var G=Object(u.a)({conv2DBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"NHWC",o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=Object(p.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var c=t;3===c.rank&&(c=Object(p.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]])),_.b(4===s.rank,(function(){return"Error in conv2dDerFilter: input must be rank 4, but got shape "+"".concat(s.shape,".")})),_.b(4===c.rank,(function(){return"Error in conv2dDerFilter: dy must be rank 4, but got shape "+"".concat(c.shape,".")})),_.b(4===n.length,(function(){return"Error in conv2dDerFilter: filterShape must be length 4, but got "+"".concat(n,".")}));var u="NHWC"===i?s.shape[3]:s.shape[1],l="NHWC"===i?c.shape[3]:c.shape[1];_.b(u===n[2],(function(){return"Error in conv2dDerFilter: depth of input ".concat(u,") must ")+"match input depth in filter (".concat(n[2],".")})),_.b(l===n[3],(function(){return"Error in conv2dDerFilter: depth of dy (".concat(l,") must ")+"match output depth for filter (".concat(n[3],").")})),null!=o&&_.b(_.v(a),(function(){return"Error in conv2dDerFilter: pad must be an integer when using, "+"dimRoundingMode ".concat(o," but got pad ").concat(a,".")}));var d={x:s,dy:c},h={strides:r,pad:a,dataFormat:i,dimRoundingMode:o,filterShape:n};return B.a.runKernel(N.C,d,h)}}),U=n(268),z=n(168),H=n(178);var V=Object(u.a)({fusedConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,o=e.dataFormat,s=void 0===o?"NHWC":o,c=e.dilations,u=void 0===c?[1,1]:c,l=e.dimRoundingMode,d=e.bias,h=e.activation,f=void 0===h?"linear":h,m=e.preluActivationWeights,v=e.leakyreluAlpha;if(f=f||"linear",!1===Object(H.d)(B.a.state.gradientDepth,f)){var g=Object(F.a)(t,n,r,i,s,u,l);return null!=d&&(g=Object(a.a)(g,d)),Object(H.a)(g,f,m,v)}var b=Object(A.a)(t,"x","conv2d"),y=Object(A.a)(n,"filter","conv2d"),x=b,w=!1;3===b.rank&&(w=!0,x=Object(p.a)(b,[1,b.shape[0],b.shape[1],b.shape[2]])),_.b(4===x.rank,(function(){return"Error in fused conv2d: input must be rank 4, but got rank "+"".concat(x.rank,".")})),_.b(4===y.rank,(function(){return"Error in fused conv2d: filter must be rank 4, but got rank "+"".concat(y.rank,".")})),null!=l&&_.b(_.v(i),(function(){return"Error in fused conv2d: pad must be an integer when using, "+"dimRoundingMode ".concat(l," but got pad ").concat(i,".")})),_.b(x.shape[3]===y.shape[2],(function(){return"Error in conv2d: depth of input (".concat(x.shape[3],") must match ")+"input depth for filter ".concat(y.shape[2],".")})),_.b(z.h(r,u),(function(){return"Error in conv2D: Either strides or dilations must be 1. "+"Got strides ".concat(r," and dilations '").concat(u,"'")})),_.b("NHWC"===s,(function(){return"Error in conv2d: got dataFormat of ".concat(s," but only NHWC is currently supported.")}));var O,E,S=z.a(x.shape,y.shape,r,u,i,l);if(null!=d){O=Object(A.a)(d,"bias","fused conv2d");var C=Object(D.b)(O,b);O=Object(j.a)(C,1)[0],P.a(S.outShape,O.shape)}null!=m&&(E=Object(A.a)(m,"prelu weights","fused conv2d"));var T=function(e,t){var n=Object(j.a)(t,4),a=n[0],o=n[1],s=n[2],c=n[3],l=Object(H.c)(e,s,f);_.b(z.i(u),(function(){return"Error in gradient of fused conv2D: dilation rates greater than 1 "+"are not yet supported in gradients. Got dilations '".concat(u,"'")}));var d=[Object(U.a)(o.shape,l,a,r,i),G(o,l,a.shape,r,i)];if(null!=c){var h=Object(H.b)(c,l);d.push(h)}return d},M={x:x,filter:y,bias:O,preluActivationWeights:E},k={strides:r,pad:i,dataFormat:s,dilations:u,dimRoundingMode:l,activation:f,leakyreluAlpha:v};return null==d?Object(L.a)((function(e,t,n){var r=B.a.runKernel(N.gb,M,k);return n([t,e,r]),w&&(r=Object(p.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:T}}))(x,y):Object(L.a)((function(e,t,n,r){var a=B.a.runKernel(N.gb,M,k);return r([t,e,a,n]),w&&(a=Object(p.a)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:T}}))(x,y,O)}}),W=n(255);var J=Object(u.a)({depthwiseConv2dNativeBackpropFilter_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=e;3===e.rank&&(s=Object(p.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]));var c=t;3===c.rank&&(c=Object(p.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u={x:s,dy:c},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,filterShape:n};return B.a.runKernel(N.O,u,l)}});var X=Object(u.a)({depthwiseConv2dNativeBackpropInput_:function(e,t,n,r,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[1,1],o=arguments.length>6?arguments[6]:void 0,s=t,c=!1;3===t.rank&&(c=!0,s=Object(p.a)(t,[1,t.shape[0],t.shape[1],t.shape[2]]));var u={dy:s,filter:n},l={strides:r,pad:a,dimRoundingMode:o,dilations:i,inputShape:e},d=B.a.runKernel(N.P,u,l);return c?Object(p.a)(d,[d.shape[1],d.shape[2],d.shape[3]]):d}});var K=Object(u.a)({fusedDepthwiseConv2d_:function(e){var t=e.x,n=e.filter,r=e.strides,i=e.pad,o=e.dataFormat,s=void 0===o?"NHWC":o,c=e.dilations,u=void 0===c?[1,1]:c,l=e.dimRoundingMode,d=e.bias,h=e.activation,f=void 0===h?"linear":h,m=e.preluActivationWeights,v=e.leakyreluAlpha;if(!1===Object(H.d)(B.a.state.gradientDepth,f)){var g=Object(W.a)(t,n,r,i,s,u,l);return null!=d&&(g=Object(a.a)(g,d)),Object(H.a)(g,f,m,v)}var b=Object(A.a)(t,"x","depthwiseConv2d"),y=Object(A.a)(n,"filter","depthwiseConv2d"),x=b,w=!1;3===b.rank&&(w=!0,x=Object(p.a)(b,[1,b.shape[0],b.shape[1],b.shape[2]])),_.b(4===x.rank,(function(){return"Error in fused depthwiseConv2d: input must be rank 4, but got "+"rank ".concat(x.rank,".")})),_.b(4===y.rank,(function(){return"Error in fused depthwiseConv2d: filter must be rank 4, "+"but got rank ".concat(y.rank,".")})),_.b(x.shape[3]===y.shape[2],(function(){return"Error in fused depthwiseConv2d: number of input channels "+"(".concat(x.shape[3],") must match the inChannels dimension in ")+"filter ".concat(y.shape[2],".")})),null==u&&(u=[1,1]),_.b(z.h(r,u),(function(){return"Error in fused depthwiseConv2d: Either strides or dilations must "+"be 1. Got strides ".concat(r," and dilations '").concat(u,"'")})),null!=l&&_.b(_.v(i),(function(){return"Error in fused depthwiseConv2d: pad must be an integer when "+"using dimRoundingMode ".concat(l," but got pad ").concat(i,".")}));var O,E,S=z.a(x.shape,y.shape,r,u,i,l,!0);if(null!=d){O=Object(A.a)(d,"bias","fused conv2d");var C=Object(D.b)(O,b),T=Object(j.a)(C,1);O=T[0],P.a(S.outShape,O.shape)}null!=m&&(E=Object(A.a)(m,"prelu weights","fused depthwiseConv2d"));var M=function(e,t){_.b(z.i(u),(function(){return"Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations "+"'".concat(u,"'")}));var n=Object(j.a)(t,4),a=n[0],o=n[1],s=n[2],c=n[3],d=Object(H.c)(e,s,f),h=X(o.shape,d,a,r,i,u,l),p=J(o,d,a.shape,r,i,u,l);return null!=c?[h,p,Object(H.b)(O,d)]:[h,p]},k={x:x,filter:y,bias:O,preluActivationWeights:E},R={strides:r,pad:i,dataFormat:s,dilations:u,dimRoundingMode:l,activation:f,leakyreluAlpha:v};return null==d?Object(L.a)((function(e,t,n){var r=B.a.runKernel(N.hb,k,R);return n([t,e,r]),w&&(r=Object(p.a)(r,[r.shape[1],r.shape[2],r.shape[3]])),{value:r,gradFunc:M}}))(x,y):Object(L.a)((function(e,t,n,r){var a=B.a.runKernel(N.hb,k,R);return r([t,e,a,n]),w&&(a=Object(p.a)(a,[a.shape[1],a.shape[2],a.shape[3]])),{value:a,gradFunc:M}}))(x,y,O)}}),q=n(214);var Y=Object(u.a)({fusedMatMul_:function(e){var t=e.a,n=e.b,r=e.transposeA,i=void 0!==r&&r,o=e.transposeB,s=void 0!==o&&o,c=e.bias,u=e.activation,l=void 0===u?"linear":u,d=e.preluActivationWeights,h=e.leakyreluAlpha;if(!1===Object(H.d)(B.a.state.gradientDepth,l)){var f=Object(q.a)(t,n,i,s);return null!=c&&(f=Object(a.a)(f,c)),Object(H.a)(f,l,d,h)}var m=Object(A.a)(t,"a","fused matMul"),v=Object(A.a)(n,"b","fused matMul"),g=Object(D.b)(m,v),b=Object(j.a)(g,2);m=b[0],v=b[1];var y=i?m.shape[m.rank-2]:m.shape[m.rank-1],x=s?v.shape[v.rank-1]:v.shape[v.rank-2],w=i?m.shape[m.rank-1]:m.shape[m.rank-2],O=s?v.shape[v.rank-2]:v.shape[v.rank-1],E=m.shape.slice(0,-2),S=v.shape.slice(0,-2),C=_.O(E),T=_.O(S);_.b(m.rank>=2&&v.rank>=2&&m.rank===v.rank,(function(){return"Error in fused matMul: inputs must have the same rank of at "+"least 2, got ranks ".concat(m.rank," and ").concat(v.rank,".")})),_.b(_.a(E,S),(function(){return"Error in fused matMul: outer dimensions (".concat(E,") and (")+"".concat(S,") of Tensors with shapes ").concat(m.shape," and ")+"".concat(v.shape," must match.")})),_.b(y===x,(function(){return"Error in fused matMul: inner shapes (".concat(y,") and (")+"".concat(x,") of Tensors with shapes ").concat(m.shape," and ")+"".concat(v.shape," and transposeA=").concat(i)+" and transposeB=".concat(s," must match.")}));var M,k,R=m.shape.slice(0,-2).concat([w,O]),I=i?Object(p.a)(m,[C,y,w]):Object(p.a)(m,[C,w,y]),F=s?Object(p.a)(v,[T,O,x]):Object(p.a)(v,[T,x,O]);if(null!=c){M=Object(A.a)(c,"bias","fused matMul");var G=Object(D.b)(M,m);M=Object(j.a)(G,1)[0],P.a(R,M.shape)}null!=d&&(k=Object(A.a)(d,"prelu weights","fused matMul"));var U=function(e,t){var n,r,a=Object(j.a)(t,4),o=a[0],u=a[1],d=a[2],h=a[3],f=Object(H.c)(Object(p.a)(e,d.shape),d,l);return i||s?!i&&s?(n=Object(q.a)(f,u,!1,!1),r=Object(q.a)(f,o,!0,!1)):i&&!s?(n=Object(q.a)(u,f,!1,!0),r=Object(q.a)(o,f,!1,!1)):(n=Object(q.a)(u,f,!0,!0),r=Object(q.a)(f,o,!0,!0)):(n=Object(q.a)(f,u,!1,!0),r=Object(q.a)(o,f,!0,!1)),null!=c?[n,r,Object(H.b)(h,f)]:[n,r]},z={a:I,b:F,bias:M,preluActivationWeights:k},V={transposeA:i,transposeB:s,activation:l,leakyreluAlpha:h};return null==c?Object(L.a)((function(e,t,n){var r=B.a.runKernel(N.Wc,z,V);return n([e,t,r]),{value:Object(p.a)(r,R),gradFunc:U}}))(I,F):Object(L.a)((function(e,t,n,r){var a=B.a.runKernel(N.Wc,z,V);return r([e,t,a,n]),{value:Object(p.a)(a,R),gradFunc:U}}))(I,F,M)}});function Q(e){return Math.floor(Math.pow(2,Math.ceil(Math.log(e)/Math.log(2))))}function Z(e,t,n){for(var r=1-e%2,a=new Float32Array(e),i=0;i<e;++i){var o=2*Math.PI*i/(e+r-1);a[i]=t-n*Math.cos(o)}return Object(O.a)(a,"float32")}Object(u.a)({hammingWindow_:function(e){return Z(e,.54,.46)}});var $=Object(u.a)({hannWindow_:function(e){return Z(e,.5,.5)}}),ee=n(230);var te=Object(u.a)({frame_:function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=0,o=[];i+t<=e.size;)o.push(Object(g.a)(e,i,t)),i+=n;if(r)for(;i<e.size;){var s=i+t-e.size,u=Object(c.a)([Object(g.a)(e,i,t-s),Object(ee.a)([s],a)]);o.push(u),i+=n}return 0===o.length?S([],[0,t]):Object(p.a)(Object(c.a)(o),[o.length,t])}});Object(u.a)({stft_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:$;null==r&&(r=Q(t));for(var i=te(e,t,n),o=Object(f.a)(i,a(t)),s=[],u=0;u<i.shape[0];u++)s.push(Object(M.a)(Object(g.a)(o,[u,0],[1,t]),r));return Object(c.a)(s)}});var ne=Object(u.a)({cropAndResize_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"bilinear",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Object(A.a)(e,"image","cropAndResize"),s=Object(A.a)(t,"boxes","cropAndResize","float32"),c=Object(A.a)(n,"boxInd","cropAndResize","int32"),u=s.shape[0];_.b(4===o.rank,(function(){return"Error in cropAndResize: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),_.b(2===s.rank&&4===s.shape[1],(function(){return"Error in cropAndResize: boxes must be have size [".concat(u,",4] ")+"but had shape ".concat(s.shape,".")})),_.b(1===c.rank&&c.shape[0]===u,(function(){return"Error in cropAndResize: boxInd must be have size [".concat(u,"] ")+"but had shape ".concat(s.shape,".")})),_.b(2===r.length,(function(){return"Error in cropAndResize: cropSize must be of length 2, but got "+"length ".concat(r.length,".")})),_.b(r[0]>=1&&r[1]>=1,(function(){return"cropSize must be atleast [1,1], but was ".concat(r)})),_.b("bilinear"===a||"nearest"===a,(function(){return"method must be bilinear or nearest, but was ".concat(a)}));var l={image:o,boxes:s,boxInd:c},d={method:a,extrapolationValue:i,cropSize:r},h=B.a.runKernel(N.J,l,d);return h}});var re=Object(u.a)({flipLeftRight_:function(e){var t=Object(A.a)(e,"image","flipLeftRight","float32");_.b(4===t.rank,(function(){return"Error in flipLeftRight: image must be rank 4,"+"but got rank ".concat(t.rank,".")}));var n={image:t};return B.a.runKernel(N.bb,n,{})}});var ae=Object(u.a)({rotateWithOffset_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=Object(A.a)(e,"image","rotateWithOffset","float32");_.b(4===a.rank,(function(){return"Error in rotateWithOffset: image must be rank 4,"+"but got rank ".concat(a.rank,".")}));var i={image:a},o={radians:t,fillValue:n,center:r},s=B.a.runKernel(N.pc,i,o);return s}});function ie(e,t,n,r,a,i){null==r&&(r=.5),null==a&&(a=Number.NEGATIVE_INFINITY),null==i&&(i=0);var o=e.shape[0];return n=Math.min(n,o),_.b(0<=r&&r<=1,(function(){return"iouThreshold must be in [0, 1], but was '".concat(r,"'")})),_.b(2===e.rank,(function(){return"boxes must be a 2D tensor, but was of rank '".concat(e.rank,"'")})),_.b(4===e.shape[1],(function(){return"boxes must have 4 columns, but 2nd dimension was ".concat(e.shape[1])})),_.b(1===t.rank,(function(){return"scores must be a 1D tensor"})),_.b(t.shape[0]===o,(function(){return"scores has incompatible shape with boxes. Expected ".concat(o,", ")+"but was ".concat(t.shape[0])})),_.b(0<=i&&i<=1,(function(){return"softNmsSigma must be in [0, 1], but was '".concat(i,"'")})),{maxOutputSize:n,iouThreshold:r,scoreThreshold:a,softNmsSigma:i}}var oe=Object(u.a)({nonMaxSuppression_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=Object(A.a)(e,"boxes","nonMaxSuppression"),o=Object(A.a)(t,"scores","nonMaxSuppression"),s=ie(i,o,n,r,a),c={maxOutputSize:n=s.maxOutputSize,iouThreshold:r=s.iouThreshold,scoreThreshold:a=s.scoreThreshold};return B.a.runKernel(N.Sb,{boxes:i,scores:o},c)}}),se=n(13),ce=n.n(se),ue=n(20),le=n(182);function de(){return(de=Object(ue.a)(ce.a.mark((function e(t,n,r){var a,i,o,s,c,u,l,d,h,f,p=arguments;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=p.length>3&&void 0!==p[3]?p[3]:.5,i=p.length>4&&void 0!==p[4]?p[4]:Number.NEGATIVE_INFINITY,o=Object(A.a)(t,"boxes","nonMaxSuppressionAsync"),s=Object(A.a)(n,"scores","nonMaxSuppressionAsync"),c=ie(o,s,r,a,i),r=c.maxOutputSize,a=c.iouThreshold,i=c.scoreThreshold,e.next=10,Promise.all([o.data(),s.data()]);case 10:return u=e.sent,l=u[0],d=u[1],h=Object(le.a)(l,d,r,a,i),f=h.selectedIndices,o!==t&&o.dispose(),s!==n&&s.dispose(),e.abrupt("return",Object(O.a)(f,"int32"));case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var he=function(e,t,n){return de.apply(this,arguments)};var fe=Object(u.a)({nonMaxSuppressionWithScore_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=Object(A.a)(e,"boxes","nonMaxSuppression"),s=Object(A.a)(t,"scores","nonMaxSuppression"),c=ie(o,s,n,r,a,i),u={boxes:o,scores:s},l={maxOutputSize:n=c.maxOutputSize,iouThreshold:r=c.iouThreshold,scoreThreshold:a=c.scoreThreshold,softNmsSigma:i=c.softNmsSigma},d=B.a.runKernel(N.Ub,u,l);return{selectedIndices:d[0],selectedScores:d[1]}}});function pe(){return(pe=Object(ue.a)(ce.a.mark((function e(t,n,r){var a,i,o,s,c,u,l,d,h,f,p,m,v=arguments;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.length>3&&void 0!==v[3]?v[3]:.5,i=v.length>4&&void 0!==v[4]?v[4]:Number.NEGATIVE_INFINITY,o=v.length>5&&void 0!==v[5]?v[5]:0,s=Object(A.a)(t,"boxes","nonMaxSuppressionAsync"),c=Object(A.a)(n,"scores","nonMaxSuppressionAsync"),u=ie(s,c,r,a,i,o),r=u.maxOutputSize,a=u.iouThreshold,i=u.scoreThreshold,o=u.softNmsSigma,e.next=12,Promise.all([s.data(),c.data()]);case 12:return l=e.sent,d=l[0],h=l[1],f=Object(le.c)(d,h,r,a,i,o),p=f.selectedIndices,m=f.selectedScores,s!==t&&s.dispose(),c!==n&&c.dispose(),e.abrupt("return",{selectedIndices:Object(O.a)(p,"int32"),selectedScores:Object(O.a)(m)});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var me=function(e,t,n){return pe.apply(this,arguments)};var ve=Object(u.a)({nonMaxSuppressionPadded_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Number.NEGATIVE_INFINITY,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],o=Object(A.a)(e,"boxes","nonMaxSuppression"),s=Object(A.a)(t,"scores","nonMaxSuppression"),c=ie(o,s,n,r,a,null),u=c.maxOutputSize,l=c.iouThreshold,d=c.scoreThreshold,h={boxes:o,scores:s},f={maxOutputSize:u,iouThreshold:l,scoreThreshold:d,padToMaxOutputSize:i},p=B.a.runKernel(N.Tb,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}});function ge(){return(ge=Object(ue.a)(ce.a.mark((function e(t,n,r){var a,i,o,s,c,u,l,d,h,f,p,v,g,b,y,x,w=arguments;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=w.length>3&&void 0!==w[3]?w[3]:.5,i=w.length>4&&void 0!==w[4]?w[4]:Number.NEGATIVE_INFINITY,o=w.length>5&&void 0!==w[5]&&w[5],s=Object(A.a)(t,"boxes","nonMaxSuppressionAsync"),c=Object(A.a)(n,"scores","nonMaxSuppressionAsync"),u=ie(s,c,r,a,i,null),l=u.maxOutputSize,d=u.iouThreshold,h=u.scoreThreshold,e.next=11,Promise.all([s.data(),c.data()]);case 11:return f=e.sent,p=Object(j.a)(f,2),v=p[0],g=p[1],b=Object(le.b)(v,g,l,d,h,o),y=b.selectedIndices,x=b.validOutputs,s!==t&&s.dispose(),c!==n&&c.dispose(),e.abrupt("return",{selectedIndices:Object(O.a)(y,"int32"),validOutputs:Object(m.a)(x,"int32")});case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var be=function(e,t,n){return ge.apply(this,arguments)},ye=n(231);var xe=Object(u.a)({resizeBilinear_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Object(A.a)(e,"images","resizeBilinear");_.b(3===a.rank||4===a.rank,(function(){return"Error in resizeBilinear: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),_.b(2===t.length,(function(){return"Error in resizeBilinear: new shape must 2D, but got shape "+"".concat(t,".")})),_.b(!1===r||!1===n,(function(){return"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=Object(p.a)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Object(ye.a)(t);var s={images:i},c={alignCorners:n,halfPixelCenters:r,size:t},u=B.a.runKernel(N.kc,s,c);return o?Object(p.a)(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});var we=Object(u.a)({resizeNearestNeighbor_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Object(A.a)(e,"images","resizeNearestNeighbor");_.b(3===a.rank||4===a.rank,(function(){return"Error in resizeNearestNeighbor: x must be rank 3 or 4, but got "+"rank ".concat(a.rank,".")})),_.b(2===t.length,(function(){return"Error in resizeNearestNeighbor: new shape must 2D, but got shape "+"".concat(t,".")})),_.b("float32"===a.dtype||"int32"===a.dtype,(function(){return"`images` must have `int32` or `float32` as dtype"})),_.b(!1===r||!1===n,(function(){return"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false."}));var i=a,o=!1;3===a.rank&&(o=!0,i=Object(p.a)(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Object(ye.a)(t);var s={images:i},c={alignCorners:n,halfPixelCenters:r,size:t},u=B.a.runKernel(N.mc,s,c);return o?Object(p.a)(u,[u.shape[1],u.shape[2],u.shape[3]]):u}});var Oe=Object(u.a)({transform_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"nearest",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"constant",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5?arguments[5]:void 0,o=Object(A.a)(e,"image","transform","float32"),s=Object(A.a)(t,"transforms","transform","float32");_.b(4===o.rank,(function(){return"Error in transform: image must be rank 4,"+"but got rank ".concat(o.rank,".")})),_.b(2===s.rank&&(s.shape[0]===o.shape[0]||1===s.shape[0])&&8===s.shape[1],(function(){return"Error in transform: Input transform should be batch x 8 or 1 x 8"})),_.b(null==i||2===i.length,(function(){return"Error in transform: outputShape must be [height, width] or null, "+"but got ".concat(i,".")}));var c={image:o,transforms:s},u={interpolation:n,fillMode:r,fillValue:a,outputShape:i};return B.a.runKernel(N.Qc,c,u)}}),Ae=n(235),_e=n(234),Ee=n(233),Se=n(232),Ce=n(194);Object(u.a)({bandPart_:function(e,t,n){Object(_.b)(t%1===0,(function(){return"bandPart(): numLower must be an integer, got ".concat(t,".")})),Object(_.b)(n%1===0,(function(){return"bandPart(): numUpper must be an integer, got ".concat(n,".")}));var r=Object(A.a)(e,"a","bandPart");Object(_.b)(r.rank>=2,(function(){return"bandPart(): Rank must be at least 2, got ".concat(r.rank,".")}));var a=r.shape,i=r.shape.slice(-2),o=Object(j.a)(i,2),s=o[0],c=o[1];if(!(t<=s))throw new Error("bandPart(): numLower (".concat(t,")")+" must not be greater than the number of rows (".concat(s,")."));if(!(n<=c))throw new Error("bandPart(): numUpper (".concat(n,")")+" must not be greater than the number of columns (".concat(c,")."));t<0&&(t=s),n<0&&(n=c);var u=Object(p.a)(Object(Se.a)(0,s,1,"int32"),[-1,1]),l=Object(Se.a)(0,c,1,"int32"),d=Object(x.a)(u,l),h=Object(Ee.a)(Object(_e.a)(d,Object(m.a)(+t,"int32")),Object(Ae.a)(d,Object(m.a)(-n,"int32"))),f=Object(T.a)([s,c],r.dtype);return Object(p.a)(Object(y.a)(Object(C.a)(Object(p.a)(r,[-1,s,c])).map((function(e){return Object(Ce.a)(h,e,f)}))),a)}});var Te=n(186),Me=n(195),ke=n(196),Re=n(237),Ie=n(239),je=n(238),Be=n(213),Le=n(167);function Ne(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(0===e.rank)return Object(Te.a)(e);if(1!==e.rank&&null===n)return Ne(Object(p.a)(e,[-1]),t,n);if(1===e.rank||"number"===typeof n||Array.isArray(n)&&1===n.length){if(1===t)return Object(Le.a)(Object(Te.a)(e),n);if(t===1/0)return Object(ke.a)(Object(Te.a)(e),n);if(t===-1/0)return Object(Re.a)(Object(Te.a)(e),n);if("euclidean"===t||2===t)return Object(je.a)(Object(Le.a)(Object(Ie.a)(Object(Te.a)(e),Object(m.a)(2,"int32")),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}if(Array.isArray(n)&&2===n.length){if(1===t)return Object(ke.a)(Object(Le.a)(Object(Te.a)(e),n[0]),n[1]-1);if(t===1/0)return Object(ke.a)(Object(Le.a)(Object(Te.a)(e),n[1]),n[0]);if(t===-1/0)return Object(Re.a)(Object(Le.a)(Object(Te.a)(e),n[1]),n[0]);if("fro"===t||"euclidean"===t)return Object(je.a)(Object(Le.a)(Object(Be.a)(e),n));throw new Error("Error in norm: invalid ord value: ".concat(t))}throw new Error("Error in norm: invalid axis: ".concat(n))}var De=Object(u.a)({norm_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"euclidean",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=Ne(e=Object(A.a)(e,"x","norm"),t,n),i=a.shape;if(r){var o=Object(_.I)(n,e.shape);i=Me.e(a.shape,o)}return Object(p.a)(a,i)}}),Pe=n(212);Object(u.a)({gramSchmidt_:function(e){var t;Array.isArray(e)?function(){t=!1,Object(_.b)(null!=e&&e.length>0,(function(){return"Gram-Schmidt process: input must not be null, undefined, or empty"}));for(var n=e[0].shape[0],r=function(t){Object(_.b)(e[t].shape[0]===n,(function(){return"Gram-Schmidt: Non-unique lengths found in the input vectors: "+"(".concat(e[t].shape[0]," vs. ").concat(n,")")}))},a=1;a<e.length;++a)r(a)}():(t=!0,e=Object(Pe.a)(e,e.shape[0],0).map((function(e){return Object(b.a)(e,[0])}))),Object(_.b)(e.length<=e[0].shape[0],(function(){return"Gram-Schmidt: Number of vectors (".concat(e.length,") exceeds ")+"number of dimensions (".concat(e[0].shape[0],").")}));for(var n=[],r=e,a=function(e){n.push(B.a.tidy((function(){var t=r[e];if(e>0)for(var a=0;a<e;++a){var i=Object(f.a)(Object(Le.a)(Object(f.a)(n[a],t)),n[a]);t=Object(x.a)(t,i)}return Object(d.a)(t,De(t,"euclidean"))})))},i=0;i<e.length;++i)a(i);return t?Object(y.a)(n,0):n}});var Fe=n(243),Ge=n(240);var Ue=Object(u.a)({eye_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"float32";null==t&&(t=e);for(var a=Object(i.a)([e,t],r),o=e<=t?e:t,s=0;s<o;++s)a.set(1,s,s);var c=Object(p.a)(a.toTensor(),[e,t]);if(null==n)return c;if(1===n.length)return Object(Ge.a)(Object(h.a)(c,0),[n[0],1,1]);if(2===n.length)return Object(Ge.a)(Object(h.a)(Object(h.a)(c,0),0),[n[0],n[1],1,1]);if(3===n.length)return Object(Ge.a)(Object(h.a)(Object(h.a)(Object(h.a)(c,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error("eye() currently supports only 1D and 2D "+"batchShapes, but received ".concat(n.length,"D."))}}),ze=n(241),He=n(187),Ve=n(242);function We(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return B.a.tidy((function(){Object(_.b)(2===e.shape.length,(function(){return"qr2d() requires a 2D Tensor, but got a ".concat(e.shape.length,"D Tensor.")}));for(var n=e.shape[0],r=e.shape[1],a=Ue(n),i=Object(s.a)(e),o=S([[1]],[1,1]),u=Object(s.a)(o),l=n>=r?r:n,h=function(e){var t=i,l=u,h=a,p=B.a.tidy((function(){var t=Object(g.a)(i,[e,e],[n-e,1]),l=De(t),h=Object(g.a)(i,[e,e],[1,1]),p=Object(Ce.a)(Object(ze.a)(h,0),S([[-1]]),S([[1]])),m=Object(x.a)(h,Object(f.a)(p,l)),v=Object(d.a)(t,m);u=1===v.shape[0]?Object(s.a)(o):Object(c.a)([o,Object(g.a)(v,[1,0],[v.shape[0]-1,v.shape[1]])],0);var b=Object(He.a)(Object(d.a)(Object(q.a)(p,m),l)),y=Object(g.a)(i,[e,0],[n-e,r]),w=Object(f.a)(b,u),O=Object(Ve.a)(u);if(0===e)i=Object(x.a)(y,Object(q.a)(w,Object(q.a)(O,y)));else{var A=Object(x.a)(y,Object(q.a)(w,Object(q.a)(O,y)));i=Object(c.a)([Object(g.a)(i,[0,0],[e,r]),A],0)}var _=Object(Ve.a)(w),E=Object(g.a)(a,[0,e],[n,a.shape[1]-e]);if(0===e)a=Object(x.a)(E,Object(q.a)(Object(q.a)(E,u),_));else{var C=Object(x.a)(E,Object(q.a)(Object(q.a)(E,u),_));a=Object(c.a)([Object(g.a)(a,[0,0],[n,e]),C],1)}return[u,i,a]})),m=Object(j.a)(p,3);u=m[0],i=m[1],a=m[2],Object(Fe.a)([t,l,h])},p=0;p<l;++p)h(p);return!t&&n>r&&(a=Object(g.a)(a,[0,0],[n,r]),i=Object(g.a)(i,[0,0],[r,r])),[a,i]}))}Object(u.a)({qr_:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Object(_.b)(e.rank>=2,(function(){return"qr() requires input tensor to have a rank >= 2, but got rank ".concat(e.rank)})),2===e.rank)return We(e,t);var n=e.shape.slice(0,e.shape.length-2).reduce((function(e,t){return e*t})),r=Object(C.a)(Object(p.a)(e,[n,e.shape[e.shape.length-2],e.shape[e.shape.length-1]]),0),a=[],i=[];r.forEach((function(e){var n=We(e,t),r=Object(j.a)(n,2),o=r[0],s=r[1];a.push(o),i.push(s)}));var o=Object(p.a)(Object(y.a)(a,0),e.shape),s=Object(p.a)(Object(y.a)(i,0),e.shape);return[o,s]}});var Je=n(164),Xe=n(244),Ke=n(246),qe=n(245);var Ye=Object(u.a)({computeWeightedLoss_:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Je.a.SUM_BY_NONZERO_WEIGHTS,r=Object(A.a)(e,"losses","computeWeightedLoss"),a=null;null!=t&&(a=Object(A.a)(t,"weights","computeWeightedLoss"));var i=null==a?r:Object(f.a)(r,a);if(n===Je.a.NONE)return i;if(n===Je.a.SUM)return Object(Le.a)(i);if(n===Je.a.MEAN){if(null==a)return Object(Xe.a)(i);var s=r.size/a.size,c=Object(d.a)(Object(Le.a)(i),Object(Le.a)(a));return s>1?Object(d.a)(c,Object(m.a)(s)):c}if(n===Je.a.SUM_BY_NONZERO_WEIGHTS){if(null==a)return Object(d.a)(Object(Le.a)(i),Object(m.a)(r.size));var u=Object(f.a)(a,Object(qe.a)(r.shape)),l=Object(o.a)(Object(Le.a)(Object(Ke.a)(u,Object(m.a)(0))),"float32");return Object(d.a)(Object(Le.a)(i),l)}throw Error("Unknown reduction: ".concat(n))}});Object(u.a)({absoluteDifference_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Je.a.SUM_BY_NONZERO_WEIGHTS,a=Object(A.a)(e,"labels","absoluteDifference"),i=Object(A.a)(t,"predictions","absoluteDifference"),o=null;null!=n&&(o=Object(A.a)(n,"weights","absoluteDifference")),Object(_.e)(a.shape,i.shape,"Error in absoluteDifference: ");var s=Object(Te.a)(Object(x.a)(a,i));return Ye(s,o,r)}});Object(u.a)({cosineDistance_:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Je.a.SUM_BY_NONZERO_WEIGHTS,i=Object(A.a)(e,"labels","cosineDistance"),o=Object(A.a)(t,"predictions","cosineDistance"),s=null;null!=r&&(s=Object(A.a)(r,"weights","cosineDistance")),Object(_.e)(i.shape,o.shape,"Error in cosineDistance: ");var c=Object(m.a)(1),u=Object(x.a)(c,Object(Le.a)(Object(f.a)(i,o),n,!0));return Ye(u,s,a)}});var Qe=n(197);Object(u.a)({hingeLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Je.a.SUM_BY_NONZERO_WEIGHTS,a=Object(A.a)(e,"labels","hingeLoss"),i=Object(A.a)(t,"predictions","hingeLoss"),o=null;null!=n&&(o=Object(A.a)(n,"weights","hingeLoss")),Object(_.e)(a.shape,i.shape,"Error in hingeLoss: ");var s=Object(m.a)(1);a=Object(x.a)(Object(f.a)(Object(m.a)(2),a),s);var c=Object(Qe.a)(Object(x.a)(s,Object(f.a)(a,i)));return Ye(c,o,r)}});var Ze=n(247);Object(u.a)({huberLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Je.a.SUM_BY_NONZERO_WEIGHTS,o=Object(A.a)(e,"labels","huberLoss"),s=Object(A.a)(t,"predictions","huberLoss"),c=null;null!=n&&(c=Object(A.a)(n,"weights","huberLoss")),Object(_.e)(o.shape,s.shape,"Error in huberLoss: ");var u=Object(m.a)(r),l=Object(Te.a)(Object(x.a)(s,o)),d=Object(Ze.a)(l,u),h=Object(x.a)(l,d),p=Object(a.a)(Object(f.a)(Object(m.a)(.5),Object(Be.a)(d)),Object(f.a)(u,h));return Ye(p,c,i)}});var $e=n(198);Object(u.a)({logLoss_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e-7,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Je.a.SUM_BY_NONZERO_WEIGHTS,o=Object(A.a)(e,"labels","logLoss"),s=Object(A.a)(t,"predictions","logLoss"),c=null;null!=n&&(c=Object(A.a)(n,"weights","logLoss")),Object(_.e)(o.shape,s.shape,"Error in logLoss: ");var u=Object(m.a)(1),l=Object(m.a)(r),d=Object(He.a)(Object(f.a)(o,Object($e.a)(Object(a.a)(s,l)))),h=Object(f.a)(Object(x.a)(u,o),Object($e.a)(Object(a.a)(Object(x.a)(u,s),l))),p=Object(x.a)(d,h);return Ye(p,c,i)}});var et=n(248);Object(u.a)({meanSquaredError_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Je.a.SUM_BY_NONZERO_WEIGHTS,a=Object(A.a)(e,"labels","meanSquaredError"),i=Object(A.a)(t,"predictions","meanSquaredError"),o=null;null!=n&&(o=Object(A.a)(n,"weights","meanSquaredError")),Object(_.e)(a.shape,i.shape,"Error in meanSquaredError: ");var s=Object(et.a)(a,i);return Ye(s,o,r)}});var tt=n(188),nt=n(249);function rt(e,t){var n=Object(A.a)(e,"labels","sigmoidCrossEntropyWithLogits"),r=Object(A.a)(t,"logits","sigmoidCrossEntropyWithLogits");Object(_.e)(n.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");var i=Object(Qe.a)(r),o=Object(f.a)(r,n),s=Object(nt.a)(Object(tt.a)(Object(He.a)(Object(Te.a)(r))));return Object(a.a)(Object(x.a)(i,o),s)}Object(u.a)({sigmoidCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Je.a.SUM_BY_NONZERO_WEIGHTS,o=Object(A.a)(e,"multiClassLabels","sigmoidCrossEntropy"),s=Object(A.a)(t,"logits","sigmoidCrossEntropy"),c=null;if(null!=n&&(c=Object(A.a)(n,"weights","sigmoidCrossEntropy")),Object(_.e)(o.shape,s.shape,"Error in sigmoidCrossEntropy: "),r>0){var u=Object(m.a)(r),l=Object(m.a)(1),d=Object(m.a)(.5);o=Object(a.a)(Object(f.a)(o,Object(x.a)(l,u)),Object(f.a)(d,u))}var h=rt(o,s);return Ye(h,c,i)}});var at=Object(u.a)({logSumExp_:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=Object(A.a)(e,"x","logSumExp"),i=Object(_.I)(t,r.shape),o=Object(ke.a)(r,i,!0),s=Object(x.a)(r,o),c=Object(tt.a)(s),u=Object(Le.a)(c,i),l=Object($e.a)(u),d=Object(a.a)(Object(p.a)(o,l.shape),l);if(n){var h=Object(Me.e)(d.shape,i);return Object(p.a)(d,h)}return d}});function it(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error("Softmax cross entropy along a non-last dimension is not yet "+"supported. Labels / logits was rank ".concat(t.rank," ")+"and dim was ".concat(n));var r=Object(L.a)((function(e,t,r){var a=at(t,[n],!0),i=Object(x.a)(Object(o.a)(t,"float32"),a);r([e,i]);var s=Object(He.a)(Object(f.a)(i,e));return{value:Object(Le.a)(s,[n]),gradFunc:function(e,t){var r=Object(j.a)(t,2),a=r[0],i=r[1],s=Object(Me.e)(e.shape,[n]);return[Object(f.a)(Object(p.a)(e,s),Object(x.a)(Object(o.a)(a,"float32"),Object(tt.a)(i))),Object(f.a)(Object(p.a)(e,s),Object(x.a)(Object(tt.a)(i),Object(o.a)(a,"float32")))]}}}));return r(e,t)}Object(u.a)({softmaxCrossEntropy_:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:Je.a.SUM_BY_NONZERO_WEIGHTS,o=Object(A.a)(e,"onehotLabels","softmaxCrossEntropy"),s=Object(A.a)(t,"logits","softmaxCrossEntropy"),c=null;if(null!=n&&(c=Object(A.a)(n,"weights","softmaxCrossEntropy")),Object(_.e)(o.shape,s.shape,"Error in softmaxCrossEntropy: "),r>0){var u=Object(m.a)(r),l=Object(m.a)(1),h=Object(m.a)(o.shape[1]);o=Object(a.a)(Object(f.a)(o,Object(x.a)(l,u)),Object(d.a)(u,h))}var p=it(o,s);return Ye(p,c,i)}}),k.a,R.a,M.a,I.a;var ot={flipLeftRight:re,resizeNearestNeighbor:we,resizeBilinear:xe,rotateWithOffset:ae,cropAndResize:ne,nonMaxSuppression:oe,nonMaxSuppressionAsync:he,nonMaxSuppressionWithScore:fe,nonMaxSuppressionWithScoreAsync:me,nonMaxSuppressionPadded:ve,nonMaxSuppressionPaddedAsync:be,transform:Oe}},,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(145),a=n(146),i=n(144),o=n(202),s=n(150);var c=n(143);var u=Object(c.a)({batchNorm_:function(e,t,n,c,u,l){null==l&&(l=.001);var d,h,f=Object(i.a)(e,"x","batchNorm"),p=Object(i.a)(t,"mean","batchNorm"),m=Object(i.a)(n,"variance","batchNorm");null!=u&&(d=Object(i.a)(u,"scale","batchNorm")),null!=c&&(h=Object(i.a)(c,"offset","batchNorm")),o.b(p.rank===m.rank,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),o.b(null==h||p.rank===h.rank,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),o.b(null==d||p.rank===d.rank,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var v={x:function(e){return 0===e.rank||1===e.rank?Object(s.a)(e,[1,1,1,e.size]):2===e.rank?Object(s.a)(e,[1,1,e.shape[0],e.shape[1]]):3===e.rank?Object(s.a)(e,[1,e.shape[0],e.shape[1],e.shape[2]]):e}(f),scale:d,offset:h,mean:p,variance:m},g={varianceEpsilon:l},b=r.a.runKernel(a.fb,v,g);return Object(s.a)(b,f.shape)}})},function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(145),a=n(146);function i(e,t,n,r){if("int32"!==e.dtype)throw new Error("tf.sparseToDense() expects the indices to be int32 type,"+" but the dtype was ".concat(e.dtype,"."));if(e.rank>2)throw new Error("sparseIndices should be a scalar, vector, or matrix,"+" but got shape ".concat(e.shape,"."));var a=e.rank>0?e.shape[0]:1,i=e.rank>1?e.shape[1]:1;if(n.length!==i)throw new Error("outputShape has incorrect number of elements:,"+" ".concat(n.length,", should be: ").concat(i,"."));var o=t.size;if(0!==t.rank&&(1!==t.rank||o!==a))throw new Error("sparseValues has incorrect shape "+"".concat(t.shape,", should be [] or [").concat(a,"]"));if(t.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}var o=n(144),s=n(143);var c=Object(s.a)({sparseToDense_:function(e,t,n){var s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=Object(o.a)(e,"sparseIndices","sparseToDense","int32"),u=Object(o.a)(t,"sparseValues","sparseToDense"),l=Object(o.a)(s,"defaultValue","sparseToDense",u.dtype);i(c,u,n,l);var d={sparseIndices:c,sparseValues:u,defaultValue:l},h={outputShape:n};return r.a.runKernel(a.Dc,d,h)}})},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";t.byteLength=function(e){var t=u(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=u(e),o=r[0],s=r[1],c=new i(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),l=0,d=s>0?o-4:o;for(n=0;n<d;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;2===s&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,c[l++]=255&t);1===s&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,a=n%3,i=[],o=16383,s=0,c=n-a;s<c;s+=o)i.push(l(e,s,s+o>c?c:s+o));1===a?(t=e[n-1],i.push(r[t>>2]+r[t<<4&63]+"==")):2===a&&(t=(e[n-2]<<8)+e[n-1],i.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return i.join("")};for(var r=[],a=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=o.length;s<c;++s)r[s]=o[s],a[o.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var a,i,o=[],s=t;s<n;s+=3)a=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[(i=a)>>18&63]+r[i>>12&63]+r[i>>6&63]+r[63&i]);return o.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,a){var i,o,s=8*a-r-1,c=(1<<s)-1,u=c>>1,l=-7,d=n?a-1:0,h=n?-1:1,f=e[t+d];for(d+=h,i=f&(1<<-l)-1,f>>=-l,l+=s;l>0;i=256*i+e[t+d],d+=h,l-=8);for(o=i&(1<<-l)-1,i>>=-l,l+=r;l>0;o=256*o+e[t+d],d+=h,l-=8);if(0===i)i=1-u;else{if(i===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),i-=u}return(f?-1:1)*o*Math.pow(2,i-r)},t.write=function(e,t,n,r,a,i){var o,s,c,u=8*i-a-1,l=(1<<u)-1,d=l>>1,h=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:i-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+d>=1?h/c:h*Math.pow(2,1-d))*c>=2&&(o++,c/=2),o+d>=l?(s=0,o=l):o+d>=1?(s=(t*c-1)*Math.pow(2,a),o+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,a),o=0));a>=8;e[n+f]=255&s,f+=p,s/=256,a-=8);for(o=o<<a|s,u+=a;u>0;e[n+f]=255&o,f+=p,o/=256,u-=8);e[n+f-p]|=128*m}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){"use strict";(function(e){var t,r=n(147),a=n(149),i=n(153),o=function(){return n(415)};var s=function(){function s(){Object(r.a)(this,s),this.util=n(416),this.textEncoder=new this.util.TextEncoder}return Object(a.a)(s,[{key:"fetch",value:function(e,n){return null!=Object(i.b)().global.fetch?Object(i.b)().global.fetch(e,n):(null==t&&(t=o()),t(e,n))}},{key:"now",value:function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}},{key:"encode",value:function(e,t){if("utf-8"!==t&&"utf8"!==t)throw new Error("Node built-in encoder only supports utf-8, but got ".concat(t));return this.textEncoder.encode(e)}},{key:"decode",value:function(e,t){return 0===e.length?"":new this.util.TextDecoder(t).decode(e)}}]),s}();Object(i.b)().get("IS_NODE")&&Object(i.b)().setPlatform("node",new s)}).call(this,n(92))},,,function(e,t,n){"use strict";e.exports=n(418)},function(e,t,n){(function(e){e.exports=function(t){var r={},a=n(46),i=n(1),o=n(93);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var c=i.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,u=60103,l=60106,d=60107,h=60108,f=60114,p=60109,m=60110,v=60112,g=60113,b=60120,y=60115,x=60116,w=60121,O=60129,A=60130,_=60131;if("function"===typeof Symbol&&Symbol.for){var E=Symbol.for;u=E("react.element"),l=E("react.portal"),d=E("react.fragment"),h=E("react.strict_mode"),f=E("react.profiler"),p=E("react.provider"),m=E("react.context"),v=E("react.forward_ref"),g=E("react.suspense"),b=E("react.suspense_list"),y=E("react.memo"),x=E("react.lazy"),w=E("react.block"),E("react.scope"),O=E("react.debug_trace_mode"),A=E("react.offscreen"),_=E("react.legacy_hidden")}var S="function"===typeof Symbol&&Symbol.iterator;function C(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=S&&e[S]||e["@@iterator"])?e:null}function T(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case d:return"Fragment";case l:return"Portal";case f:return"Profiler";case h:return"StrictMode";case g:return"Suspense";case b:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case m:return(e.displayName||"Context")+".Consumer";case p:return(e._context.displayName||"Context")+".Provider";case v:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case y:return T(e.type);case w:return T(e._render);case x:t=e._payload,e=e._init;try{return T(e(t))}catch(n){}}return null}function M(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function k(e){if(M(e)!==e)throw Error(s(188))}function R(e){var t=e.alternate;if(!t){if(null===(t=M(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var a=n.return;if(null===a)break;var i=a.alternate;if(null===i){if(null!==(r=a.return)){n=r;continue}break}if(a.child===i.child){for(i=a.child;i;){if(i===n)return k(a),e;if(i===r)return k(a),t;i=i.sibling}throw Error(s(188))}if(n.return!==r.return)n=a,r=i;else{for(var o=!1,c=a.child;c;){if(c===n){o=!0,n=a,r=i;break}if(c===r){o=!0,r=a,n=i;break}c=c.sibling}if(!o){for(c=i.child;c;){if(c===n){o=!0,n=i,r=a;break}if(c===r){o=!0,r=i,n=a;break}c=c.sibling}if(!o)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}function I(e){if(!(e=R(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function j(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var B,L=t.getPublicInstance,N=t.getRootHostContext,D=t.getChildHostContext,P=t.prepareForCommit,F=t.resetAfterCommit,G=t.createInstance,U=t.appendInitialChild,z=t.finalizeInitialChildren,H=t.prepareUpdate,V=t.shouldSetTextContent,W=t.createTextInstance,J=t.scheduleTimeout,X=t.cancelTimeout,K=t.noTimeout,q=t.isPrimaryRenderer,Y=t.supportsMutation,Q=t.supportsPersistence,Z=t.supportsHydration,$=t.getInstanceFromNode,ee=t.makeOpaqueHydratingObject,te=t.makeClientId,ne=t.beforeActiveInstanceBlur,re=t.afterActiveInstanceBlur,ae=t.preparePortalMount,ie=t.supportsTestSelectors,oe=t.findFiberRoot,se=t.getBoundingRect,ce=t.getTextContent,ue=t.isHiddenSubtree,le=t.matchAccessibilityRole,de=t.setFocusIfFocusable,he=t.setupIntersectionObserver,fe=t.appendChild,pe=t.appendChildToContainer,me=t.commitTextUpdate,ve=t.commitMount,ge=t.commitUpdate,be=t.insertBefore,ye=t.insertInContainerBefore,xe=t.removeChild,we=t.removeChildFromContainer,Oe=t.resetTextContent,Ae=t.hideInstance,_e=t.hideTextInstance,Ee=t.unhideInstance,Se=t.unhideTextInstance,Ce=t.clearContainer,Te=t.cloneInstance,Me=t.createContainerChildSet,ke=t.appendChildToContainerChildSet,Re=t.finalizeContainerChildren,Ie=t.replaceContainerChildren,je=t.cloneHiddenInstance,Be=t.cloneHiddenTextInstance,Le=t.canHydrateInstance,Ne=t.canHydrateTextInstance,De=t.isSuspenseInstancePending,Pe=t.isSuspenseInstanceFallback,Fe=t.getNextHydratableSibling,Ge=t.getFirstHydratableChild,Ue=t.hydrateInstance,ze=t.hydrateTextInstance,He=t.getNextHydratableInstanceAfterSuspenseInstance,Ve=t.commitHydratedContainer,We=t.commitHydratedSuspenseInstance;function Je(e){if(void 0===B)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);B=t&&t[1]||""}return"\n"+B+e}var Xe=!1;function Ke(e,t){if(!e||Xe)return"";Xe=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var a=c.stack.split("\n"),i=r.stack.split("\n"),o=a.length-1,s=i.length-1;1<=o&&0<=s&&a[o]!==i[s];)s--;for(;1<=o&&0<=s;o--,s--)if(a[o]!==i[s]){if(1!==o||1!==s)do{if(o--,0>--s||a[o]!==i[s])return"\n"+a[o].replace(" at new "," at ")}while(1<=o&&0<=s);break}}}finally{Xe=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Je(e):""}var qe=[],Ye=-1;function Qe(e){return{current:e}}function Ze(e){0>Ye||(e.current=qe[Ye],qe[Ye]=null,Ye--)}function $e(e,t){Ye++,qe[Ye]=e.current,e.current=t}var et={},tt=Qe(et),nt=Qe(!1),rt=et;function at(e,t){var n=e.type.contextTypes;if(!n)return et;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var a,i={};for(a in n)i[a]=t[a];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function it(e){return null!==(e=e.childContextTypes)&&void 0!==e}function ot(){Ze(nt),Ze(tt)}function st(e,t,n){if(tt.current!==et)throw Error(s(168));$e(tt,t),$e(nt,n)}function ct(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in e))throw Error(s(108,T(t)||"Unknown",i));return a({},n,r)}function ut(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||et,rt=tt.current,$e(tt,e),$e(nt,nt.current),!0}function lt(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=ct(e,t,rt),r.__reactInternalMemoizedMergedChildContext=e,Ze(nt),Ze(tt),$e(tt,e)):Ze(nt),$e(nt,n)}var dt=null,ht=null;(0,o.unstable_now)();var ft=0,pt=8;function mt(e){if(0!==(1&e))return pt=15,1;if(0!==(2&e))return pt=14,2;if(0!==(4&e))return pt=13,4;var t=24&e;return 0!==t?(pt=12,t):0!==(32&e)?(pt=11,32):0!==(t=192&e)?(pt=10,t):0!==(256&e)?(pt=9,256):0!==(t=3584&e)?(pt=8,t):0!==(4096&e)?(pt=7,4096):0!==(t=4186112&e)?(pt=6,t):0!==(t=62914560&e)?(pt=5,t):67108864&e?(pt=4,67108864):0!==(134217728&e)?(pt=3,134217728):0!==(t=805306368&e)?(pt=2,t):0!==(1073741824&e)?(pt=1,1073741824):(pt=8,e)}function vt(e,t){var n=e.pendingLanes;if(0===n)return pt=0;var r=0,a=0,i=e.expiredLanes,o=e.suspendedLanes,s=e.pingedLanes;if(0!==i)r=i,a=pt=15;else if(0!==(i=134217727&n)){var c=i&~o;0!==c?(r=mt(c),a=pt):0!==(s&=i)&&(r=mt(s),a=pt)}else 0!==(i=n&~o)?(r=mt(i),a=pt):0!==s&&(r=mt(s),a=pt);if(0===r)return 0;if(r=n&((0>(r=31-Ot(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&o)){if(mt(t),a<=pt)return t;pt=a}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)a=1<<(n=31-Ot(t)),r|=e[n],t&=~a;return r}function gt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function bt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=yt(24&~t))?bt(10,t):e;case 10:return 0===(e=yt(192&~t))?bt(8,t):e;case 8:return 0===(e=yt(3584&~t))&&(0===(e=yt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=yt(805306368&~t))&&(t=268435456),t}throw Error(s(358,e))}function yt(e){return e&-e}function xt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function wt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-Ot(t)]=n}var Ot=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(At(e)/_t|0)|0},At=Math.log,_t=Math.LN2;var Et=o.unstable_runWithPriority,St=o.unstable_scheduleCallback,Ct=o.unstable_cancelCallback,Tt=o.unstable_shouldYield,Mt=o.unstable_requestPaint,kt=o.unstable_now,Rt=o.unstable_getCurrentPriorityLevel,It=o.unstable_ImmediatePriority,jt=o.unstable_UserBlockingPriority,Bt=o.unstable_NormalPriority,Lt=o.unstable_LowPriority,Nt=o.unstable_IdlePriority,Dt={},Pt=void 0!==Mt?Mt:function(){},Ft=null,Gt=null,Ut=!1,zt=kt(),Ht=1e4>zt?kt:function(){return kt()-zt};function Vt(){switch(Rt()){case It:return 99;case jt:return 98;case Bt:return 97;case Lt:return 96;case Nt:return 95;default:throw Error(s(332))}}function Wt(e){switch(e){case 99:return It;case 98:return jt;case 97:return Bt;case 96:return Lt;case 95:return Nt;default:throw Error(s(332))}}function Jt(e,t){return e=Wt(e),Et(e,t)}function Xt(e,t,n){return e=Wt(e),St(e,t,n)}function Kt(){if(null!==Gt){var e=Gt;Gt=null,Ct(e)}qt()}function qt(){if(!Ut&&null!==Ft){Ut=!0;var e=0;try{var t=Ft;Jt(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Ft=null}catch(n){throw null!==Ft&&(Ft=Ft.slice(e+1)),St(It,Kt),n}finally{Ut=!1}}}var Yt=c.ReactCurrentBatchConfig;var Qt="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Zt=Object.prototype.hasOwnProperty;function $t(e,t){if(Qt(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Zt.call(t,n[r])||!Qt(e[n[r]],t[n[r]]))return!1;return!0}function en(e){switch(e.tag){case 5:return Je(e.type);case 16:return Je("Lazy");case 13:return Je("Suspense");case 19:return Je("SuspenseList");case 0:case 2:case 15:return e=Ke(e.type,!1);case 11:return e=Ke(e.type.render,!1);case 22:return e=Ke(e.type._render,!1);case 1:return e=Ke(e.type,!0);default:return""}}function tn(e,t){if(e&&e.defaultProps){for(var n in t=a({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var nn=Qe(null),rn=null,an=null,on=null;function sn(){on=an=rn=null}function cn(e,t){e=e.type._context,q?($e(nn,e._currentValue),e._currentValue=t):($e(nn,e._currentValue2),e._currentValue2=t)}function un(e){var t=nn.current;Ze(nn),e=e.type._context,q?e._currentValue=t:e._currentValue2=t}function ln(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function dn(e,t){rn=e,on=an=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(zr=!0),e.firstContext=null)}function hn(e,t){if(on!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(on=e,t=1073741823),t={context:e,observedBits:t,next:null},null===an){if(null===rn)throw Error(s(308));an=t,rn.dependencies={lanes:0,firstContext:t,responders:null}}else an=an.next=t;return q?e._currentValue:e._currentValue2}var fn=!1;function pn(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function mn(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function vn(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function gn(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function bn(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var a=null,i=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===i?a=i=o:i=i.next=o,n=n.next}while(null!==n);null===i?a=i=t:i=i.next=t}else a=i=t;return n={baseState:r.baseState,firstBaseUpdate:a,lastBaseUpdate:i,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function yn(e,t,n,r){var i=e.updateQueue;fn=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,c=i.shared.pending;if(null!==c){i.shared.pending=null;var u=c,l=u.next;u.next=null,null===s?o=l:s.next=l,s=u;var d=e.alternate;if(null!==d){var h=(d=d.updateQueue).lastBaseUpdate;h!==s&&(null===h?d.firstBaseUpdate=l:h.next=l,d.lastBaseUpdate=u)}}if(null!==o){for(h=i.baseState,s=0,d=l=u=null;;){c=o.lane;var f=o.eventTime;if((r&c)===c){null!==d&&(d=d.next={eventTime:f,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var p=e,m=o;switch(c=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,c);break e}h=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(c="function"===typeof(p=m.payload)?p.call(f,h,c):p)||void 0===c)break e;h=a({},h,c);break e;case 2:fn=!0}}null!==o.callback&&(e.flags|=32,null===(c=i.effects)?i.effects=[o]:c.push(o))}else f={eventTime:f,lane:c,tag:o.tag,payload:o.payload,callback:o.callback,next:null},null===d?(l=d=f,u=h):d=d.next=f,s|=c;if(null===(o=o.next)){if(null===(c=i.shared.pending))break;o=c.next,c.next=null,i.lastBaseUpdate=c,i.shared.pending=null}}null===d&&(u=h),i.baseState=u,i.firstBaseUpdate=l,i.lastBaseUpdate=d,di|=s,e.lanes=s,e.memoizedState=h}}function xn(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],a=r.callback;if(null!==a){if(r.callback=null,r=n,"function"!==typeof a)throw Error(s(191,a));a.call(r)}}}var wn=(new i.Component).refs;function On(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:a({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var An={isMounted:function(e){return!!(e=e._reactInternals)&&M(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Ni(),a=Di(e),i=vn(r,a);i.payload=t,void 0!==n&&null!==n&&(i.callback=n),gn(e,i),Pi(e,a,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Ni(),a=Di(e),i=vn(r,a);i.tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),gn(e,i),Pi(e,a,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Ni(),r=Di(e),a=vn(n,r);a.tag=2,void 0!==t&&null!==t&&(a.callback=t),gn(e,a),Pi(e,r,n)}};function _n(e,t,n,r,a,i,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!$t(n,r)||!$t(a,i))}function En(e,t,n){var r=!1,a=et,i=t.contextType;return"object"===typeof i&&null!==i?i=hn(i):(a=it(t)?rt:tt.current,i=(r=null!==(r=t.contextTypes)&&void 0!==r)?at(e,a):et),t=new t(n,i),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=An,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=i),t}function Sn(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&An.enqueueReplaceState(t,t.state,null)}function Cn(e,t,n,r){var a=e.stateNode;a.props=n,a.state=e.memoizedState,a.refs=wn,pn(e);var i=t.contextType;"object"===typeof i&&null!==i?a.context=hn(i):(i=it(t)?rt:tt.current,a.context=at(e,i)),yn(e,n,a,r),a.state=e.memoizedState,"function"===typeof(i=t.getDerivedStateFromProps)&&(On(e,t,i,n),a.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||(t=a.state,"function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount(),t!==a.state&&An.enqueueReplaceState(a,a.state,null),yn(e,n,a,r),a.state=e.memoizedState),"function"===typeof a.componentDidMount&&(e.flags|=4)}var Tn=Array.isArray;function Mn(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var a=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===a?t.ref:((t=function(e){var t=r.refs;t===wn&&(t=r.refs={}),null===e?delete t[a]:t[a]=e})._stringRef=a,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function kn(e,t){if("textarea"!==e.type)throw Error(s(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Rn(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function a(e,t){return(e=_o(e,t)).index=0,e.sibling=null,e}function i(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function o(t){return e&&null===t.alternate&&(t.flags=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=To(n,e.mode,r)).return=e,t):((t=a(t,n)).return=e,t)}function h(e,t,n,r){return null!==t&&t.elementType===n.type?((r=a(t,n.props)).ref=Mn(e,t,n),r.return=e,r):((r=Eo(n.type,n.key,n.props,null,e.mode,r)).ref=Mn(e,t,n),r.return=e,r)}function f(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Mo(n,e.mode,r)).return=e,t):((t=a(t,n.children||[])).return=e,t)}function p(e,t,n,r,i){return null===t||7!==t.tag?((t=So(n,e.mode,r,i)).return=e,t):((t=a(t,n)).return=e,t)}function m(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=To(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case u:return(n=Eo(t.type,t.key,t.props,null,e.mode,n)).ref=Mn(e,null,t),n.return=e,n;case l:return(t=Mo(t,e.mode,n)).return=e,t}if(Tn(t)||C(t))return(t=So(t,e.mode,n,null)).return=e,t;kn(e,t)}return null}function v(e,t,n,r){var a=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==a?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case u:return n.key===a?n.type===d?p(e,t,n.props.children,r,a):h(e,t,n,r):null;case l:return n.key===a?f(e,t,n,r):null}if(Tn(n)||C(n))return null!==a?null:p(e,t,n,r,null);kn(e,n)}return null}function g(e,t,n,r,a){if("string"===typeof r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,a);if("object"===typeof r&&null!==r){switch(r.$$typeof){case u:return e=e.get(null===r.key?n:r.key)||null,r.type===d?p(t,e,r.props.children,a,r.key):h(t,e,r,a);case l:return f(t,e=e.get(null===r.key?n:r.key)||null,r,a)}if(Tn(r)||C(r))return p(t,e=e.get(n)||null,r,a,null);kn(t,r)}return null}function b(a,o,s,c){for(var u=null,l=null,d=o,h=o=0,f=null;null!==d&&h<s.length;h++){d.index>h?(f=d,d=null):f=d.sibling;var p=v(a,d,s[h],c);if(null===p){null===d&&(d=f);break}e&&d&&null===p.alternate&&t(a,d),o=i(p,o,h),null===l?u=p:l.sibling=p,l=p,d=f}if(h===s.length)return n(a,d),u;if(null===d){for(;h<s.length;h++)null!==(d=m(a,s[h],c))&&(o=i(d,o,h),null===l?u=d:l.sibling=d,l=d);return u}for(d=r(a,d);h<s.length;h++)null!==(f=g(d,a,h,s[h],c))&&(e&&null!==f.alternate&&d.delete(null===f.key?h:f.key),o=i(f,o,h),null===l?u=f:l.sibling=f,l=f);return e&&d.forEach((function(e){return t(a,e)})),u}function y(a,o,c,u){var l=C(c);if("function"!==typeof l)throw Error(s(150));if(null==(c=l.call(c)))throw Error(s(151));for(var d=l=null,h=o,f=o=0,p=null,b=c.next();null!==h&&!b.done;f++,b=c.next()){h.index>f?(p=h,h=null):p=h.sibling;var y=v(a,h,b.value,u);if(null===y){null===h&&(h=p);break}e&&h&&null===y.alternate&&t(a,h),o=i(y,o,f),null===d?l=y:d.sibling=y,d=y,h=p}if(b.done)return n(a,h),l;if(null===h){for(;!b.done;f++,b=c.next())null!==(b=m(a,b.value,u))&&(o=i(b,o,f),null===d?l=b:d.sibling=b,d=b);return l}for(h=r(a,h);!b.done;f++,b=c.next())null!==(b=g(h,a,f,b.value,u))&&(e&&null!==b.alternate&&h.delete(null===b.key?f:b.key),o=i(b,o,f),null===d?l=b:d.sibling=b,d=b);return e&&h.forEach((function(e){return t(a,e)})),l}return function(e,r,i,c){var h="object"===typeof i&&null!==i&&i.type===d&&null===i.key;h&&(i=i.props.children);var f="object"===typeof i&&null!==i;if(f)switch(i.$$typeof){case u:e:{for(f=i.key,h=r;null!==h;){if(h.key===f){switch(h.tag){case 7:if(i.type===d){n(e,h.sibling),(r=a(h,i.props.children)).return=e,e=r;break e}break;default:if(h.elementType===i.type){n(e,h.sibling),(r=a(h,i.props)).ref=Mn(e,h,i),r.return=e,e=r;break e}}n(e,h);break}t(e,h),h=h.sibling}i.type===d?((r=So(i.props.children,e.mode,c,i.key)).return=e,e=r):((c=Eo(i.type,i.key,i.props,null,e.mode,c)).ref=Mn(e,r,i),c.return=e,e=c)}return o(e);case l:e:{for(h=i.key;null!==r;){if(r.key===h){if(4===r.tag&&r.stateNode.containerInfo===i.containerInfo&&r.stateNode.implementation===i.implementation){n(e,r.sibling),(r=a(r,i.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Mo(i,e.mode,c)).return=e,e=r}return o(e)}if("string"===typeof i||"number"===typeof i)return i=""+i,null!==r&&6===r.tag?(n(e,r.sibling),(r=a(r,i)).return=e,e=r):(n(e,r),(r=To(i,e.mode,c)).return=e,e=r),o(e);if(Tn(i))return b(e,r,i,c);if(C(i))return y(e,r,i,c);if(f&&kn(e,i),"undefined"===typeof i&&!h)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(s(152,T(e.type)||"Component"))}return n(e,r)}}var In=Rn(!0),jn=Rn(!1),Bn={},Ln=Qe(Bn),Nn=Qe(Bn),Dn=Qe(Bn);function Pn(e){if(e===Bn)throw Error(s(174));return e}function Fn(e,t){$e(Dn,t),$e(Nn,e),$e(Ln,Bn),e=N(t),Ze(Ln),$e(Ln,e)}function Gn(){Ze(Ln),Ze(Nn),Ze(Dn)}function Un(e){var t=Pn(Dn.current),n=Pn(Ln.current);n!==(t=D(n,e.type,t))&&($e(Nn,e),$e(Ln,t))}function zn(e){Nn.current===e&&(Ze(Ln),Ze(Nn))}var Hn=Qe(0);function Vn(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||De(n)||Pe(n)))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Wn=null,Jn=null,Xn=!1;function Kn(e,t){var n=Oo(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function qn(e,t){switch(e.tag){case 5:return null!==(t=Le(t,e.type,e.pendingProps))&&(e.stateNode=t,!0);case 6:return null!==(t=Ne(t,e.pendingProps))&&(e.stateNode=t,!0);case 13:default:return!1}}function Yn(e){if(Xn){var t=Jn;if(t){var n=t;if(!qn(e,t)){if(!(t=Fe(n))||!qn(e,t))return e.flags=-1025&e.flags|2,Xn=!1,void(Wn=e);Kn(Wn,n)}Wn=e,Jn=Ge(t)}else e.flags=-1025&e.flags|2,Xn=!1,Wn=e}}function Qn(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Wn=e}function Zn(e){if(!Z||e!==Wn)return!1;if(!Xn)return Qn(e),Xn=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!V(t,e.memoizedProps))for(t=Jn;t;)Kn(e,t),t=Fe(t);if(Qn(e),13===e.tag){if(!Z)throw Error(s(316));if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));Jn=He(e)}else Jn=Wn?Fe(e.stateNode):null;return!0}function $n(){Z&&(Jn=Wn=null,Xn=!1)}var er=[];function tr(){for(var e=0;e<er.length;e++){var t=er[e];q?t._workInProgressVersionPrimary=null:t._workInProgressVersionSecondary=null}er.length=0}var nr=c.ReactCurrentDispatcher,rr=c.ReactCurrentBatchConfig,ar=0,ir=null,or=null,sr=null,cr=!1,ur=!1;function lr(){throw Error(s(321))}function dr(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Qt(e[n],t[n]))return!1;return!0}function hr(e,t,n,r,a,i){if(ar=i,ir=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,nr.current=null===e||null===e.memoizedState?Pr:Fr,e=n(r,a),ur){i=0;do{if(ur=!1,!(25>i))throw Error(s(301));i+=1,sr=or=null,t.updateQueue=null,nr.current=Gr,e=n(r,a)}while(ur)}if(nr.current=Dr,t=null!==or&&null!==or.next,ar=0,sr=or=ir=null,cr=!1,t)throw Error(s(300));return e}function fr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===sr?ir.memoizedState=sr=e:sr=sr.next=e,sr}function pr(){if(null===or){var e=ir.alternate;e=null!==e?e.memoizedState:null}else e=or.next;var t=null===sr?ir.memoizedState:sr.next;if(null!==t)sr=t,or=e;else{if(null===e)throw Error(s(310));e={memoizedState:(or=e).memoizedState,baseState:or.baseState,baseQueue:or.baseQueue,queue:or.queue,next:null},null===sr?ir.memoizedState=sr=e:sr=sr.next=e}return sr}function mr(e,t){return"function"===typeof t?t(e):t}function vr(e){var t=pr(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=or,a=r.baseQueue,i=n.pending;if(null!==i){if(null!==a){var o=a.next;a.next=i.next,i.next=o}r.baseQueue=a=i,n.pending=null}if(null!==a){a=a.next,r=r.baseState;var c=o=i=null,u=a;do{var l=u.lane;if((ar&l)===l)null!==c&&(c=c.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===e?u.eagerState:e(r,u.action);else{var d={lane:l,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===c?(o=c=d,i=r):c=c.next=d,ir.lanes|=l,di|=l}u=u.next}while(null!==u&&u!==a);null===c?i=r:c.next=o,Qt(r,t.memoizedState)||(zr=!0),t.memoizedState=r,t.baseState=i,t.baseQueue=c,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function gr(e){var t=pr(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,a=n.pending,i=t.memoizedState;if(null!==a){n.pending=null;var o=a=a.next;do{i=e(i,o.action),o=o.next}while(o!==a);Qt(i,t.memoizedState)||(zr=!0),t.memoizedState=i,null===t.baseQueue&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function br(e,t,n){var r=t._getVersion;r=r(t._source);var a=q?t._workInProgressVersionPrimary:t._workInProgressVersionSecondary;if(null!==a?e=a===r:(e=e.mutableReadLanes,(e=(ar&e)===e)&&(q?t._workInProgressVersionPrimary=r:t._workInProgressVersionSecondary=r,er.push(t))),e)return n(t._source);throw er.push(t),Error(s(350))}function yr(e,t,n,r){var a=ri;if(null===a)throw Error(s(349));var i=t._getVersion,o=i(t._source),c=nr.current,u=c.useState((function(){return br(a,t,n)})),l=u[1],d=u[0];u=sr;var h=e.memoizedState,f=h.refs,p=f.getSnapshot,m=h.source;h=h.subscribe;var v=ir;return e.memoizedState={refs:f,source:t,subscribe:r},c.useEffect((function(){f.getSnapshot=n,f.setSnapshot=l;var e=i(t._source);if(!Qt(o,e)){e=n(t._source),Qt(d,e)||(l(e),e=Di(v),a.mutableReadLanes|=e&a.pendingLanes),e=a.mutableReadLanes,a.entangledLanes|=e;for(var r=a.entanglements,s=e;0<s;){var c=31-Ot(s),u=1<<c;r[c]|=e,s&=~u}}}),[n,t,r]),c.useEffect((function(){return r(t._source,(function(){var e=f.getSnapshot,n=f.setSnapshot;try{n(e(t._source));var r=Di(v);a.mutableReadLanes|=r&a.pendingLanes}catch(i){n((function(){throw i}))}}))}),[t,r]),Qt(p,n)&&Qt(m,t)&&Qt(h,r)||((e={pending:null,dispatch:null,lastRenderedReducer:mr,lastRenderedState:d}).dispatch=l=Nr.bind(null,ir,e),u.queue=e,u.baseQueue=null,d=br(a,t,n),u.memoizedState=u.baseState=d),d}function xr(e,t,n){return yr(pr(),e,t,n)}function wr(e){var t=fr();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:mr,lastRenderedState:e}).dispatch=Nr.bind(null,ir,e),[t.memoizedState,e]}function Or(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=ir.updateQueue)?(t={lastEffect:null},ir.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Ar(e){return e={current:e},fr().memoizedState=e}function _r(){return pr().memoizedState}function Er(e,t,n,r){var a=fr();ir.flags|=e,a.memoizedState=Or(1|t,n,void 0,void 0===r?null:r)}function Sr(e,t,n,r){var a=pr();r=void 0===r?null:r;var i=void 0;if(null!==or){var o=or.memoizedState;if(i=o.destroy,null!==r&&dr(r,o.deps))return void Or(t,n,i,r)}ir.flags|=e,a.memoizedState=Or(1|t,n,i,r)}function Cr(e,t){return Er(516,4,e,t)}function Tr(e,t){return Sr(516,4,e,t)}function Mr(e,t){return Sr(4,2,e,t)}function kr(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Rr(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Sr(4,2,kr.bind(null,t,e),n)}function Ir(){}function jr(e,t){var n=pr();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&dr(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Br(e,t){var n=pr();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&dr(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Lr(e,t){var n=Vt();Jt(98>n?98:n,(function(){e(!0)})),Jt(97<n?97:n,(function(){var n=rr.transition;rr.transition=1;try{e(!1),t()}finally{rr.transition=n}}))}function Nr(e,t,n){var r=Ni(),a=Di(e),i={lane:a,action:n,eagerReducer:null,eagerState:null,next:null},o=t.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),t.pending=i,o=e.alternate,e===ir||null!==o&&o===ir)ur=cr=!0;else{if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var s=t.lastRenderedState,c=o(s,n);if(i.eagerReducer=o,i.eagerState=c,Qt(c,s))return}catch(u){}Pi(e,a,r)}}var Dr={readContext:hn,useCallback:lr,useContext:lr,useEffect:lr,useImperativeHandle:lr,useLayoutEffect:lr,useMemo:lr,useReducer:lr,useRef:lr,useState:lr,useDebugValue:lr,useDeferredValue:lr,useTransition:lr,useMutableSource:lr,useOpaqueIdentifier:lr,unstable_isNewReconciler:!1},Pr={readContext:hn,useCallback:function(e,t){return fr().memoizedState=[e,void 0===t?null:t],e},useContext:hn,useEffect:Cr,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Er(4,2,kr.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Er(4,2,e,t)},useMemo:function(e,t){var n=fr();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=fr();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Nr.bind(null,ir,e),[r.memoizedState,e]},useRef:Ar,useState:wr,useDebugValue:Ir,useDeferredValue:function(e){var t=wr(e),n=t[0],r=t[1];return Cr((function(){var t=rr.transition;rr.transition=1;try{r(e)}finally{rr.transition=t}}),[e]),n},useTransition:function(){var e=wr(!1),t=e[0];return Ar(e=Lr.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=fr();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},yr(r,e,t,n)},useOpaqueIdentifier:function(){if(Xn){var e=!1,t=ee((function(){throw e||(e=!0,n(te())),Error(s(355))})),n=wr(t)[1];return 0===(2&ir.mode)&&(ir.flags|=516,Or(5,(function(){n(te())}),void 0,null)),t}return wr(t=te()),t},unstable_isNewReconciler:!1},Fr={readContext:hn,useCallback:jr,useContext:hn,useEffect:Tr,useImperativeHandle:Rr,useLayoutEffect:Mr,useMemo:Br,useReducer:vr,useRef:_r,useState:function(){return vr(mr)},useDebugValue:Ir,useDeferredValue:function(e){var t=vr(mr),n=t[0],r=t[1];return Tr((function(){var t=rr.transition;rr.transition=1;try{r(e)}finally{rr.transition=t}}),[e]),n},useTransition:function(){var e=vr(mr)[0];return[_r().current,e]},useMutableSource:xr,useOpaqueIdentifier:function(){return vr(mr)[0]},unstable_isNewReconciler:!1},Gr={readContext:hn,useCallback:jr,useContext:hn,useEffect:Tr,useImperativeHandle:Rr,useLayoutEffect:Mr,useMemo:Br,useReducer:gr,useRef:_r,useState:function(){return gr(mr)},useDebugValue:Ir,useDeferredValue:function(e){var t=gr(mr),n=t[0],r=t[1];return Tr((function(){var t=rr.transition;rr.transition=1;try{r(e)}finally{rr.transition=t}}),[e]),n},useTransition:function(){var e=gr(mr)[0];return[_r().current,e]},useMutableSource:xr,useOpaqueIdentifier:function(){return gr(mr)[0]},unstable_isNewReconciler:!1},Ur=c.ReactCurrentOwner,zr=!1;function Hr(e,t,n,r){t.child=null===e?jn(t,null,n,r):In(t,e.child,n,r)}function Vr(e,t,n,r,a){n=n.render;var i=t.ref;return dn(t,a),r=hr(e,t,n,r,i,a),null===e||zr?(t.flags|=1,Hr(e,t,r,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,da(e,t,a))}function Wr(e,t,n,r,a,i){if(null===e){var o=n.type;return"function"!==typeof o||Ao(o)||void 0!==o.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Eo(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Jr(e,t,o,r,a,i))}return o=e.child,0===(a&i)&&(a=o.memoizedProps,(n=null!==(n=n.compare)?n:$t)(a,r)&&e.ref===t.ref)?da(e,t,i):(t.flags|=1,(e=_o(o,r)).ref=t.ref,e.return=t,t.child=e)}function Jr(e,t,n,r,a,i){if(null!==e&&$t(e.memoizedProps,r)&&e.ref===t.ref){if(zr=!1,0===(i&a))return t.lanes=e.lanes,da(e,t,i);0!==(16384&e.flags)&&(zr=!0)}return qr(e,t,n,r,i)}function Xr(e,t,n){var r=t.pendingProps,a=r.children,i=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},Ji(t,n);else{if(0===(1073741824&n))return e=null!==i?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},Ji(t,e),null;t.memoizedState={baseLanes:0},Ji(t,null!==i?i.baseLanes:n)}else null!==i?(r=i.baseLanes|n,t.memoizedState=null):r=n,Ji(t,r);return Hr(e,t,a,n),t.child}function Kr(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function qr(e,t,n,r,a){var i=it(n)?rt:tt.current;return i=at(t,i),dn(t,a),n=hr(e,t,n,r,i,a),null===e||zr?(t.flags|=1,Hr(e,t,n,a),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~a,da(e,t,a))}function Yr(e,t,n,r,a){if(it(n)){var i=!0;ut(t)}else i=!1;if(dn(t,a),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),En(t,n,r),Cn(t,n,r,a),r=!0;else if(null===e){var o=t.stateNode,s=t.memoizedProps;o.props=s;var c=o.context,u=n.contextType;"object"===typeof u&&null!==u?u=hn(u):u=at(t,u=it(n)?rt:tt.current);var l=n.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof o.getSnapshotBeforeUpdate;d||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==r||c!==u)&&Sn(t,o,r,u),fn=!1;var h=t.memoizedState;o.state=h,yn(t,r,o,a),c=t.memoizedState,s!==r||h!==c||nt.current||fn?("function"===typeof l&&(On(t,n,l,r),c=t.memoizedState),(s=fn||_n(t,n,s,r,h,c,u))?(d||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4)):("function"===typeof o.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=s):("function"===typeof o.componentDidMount&&(t.flags|=4),r=!1)}else{o=t.stateNode,mn(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:tn(t.type,s),o.props=u,d=t.pendingProps,h=o.context,"object"===typeof(c=n.contextType)&&null!==c?c=hn(c):c=at(t,c=it(n)?rt:tt.current);var f=n.getDerivedStateFromProps;(l="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s!==d||h!==c)&&Sn(t,o,r,c),fn=!1,h=t.memoizedState,o.state=h,yn(t,r,o,a);var p=t.memoizedState;s!==d||h!==p||nt.current||fn?("function"===typeof f&&(On(t,n,f,r),p=t.memoizedState),(u=fn||_n(t,n,u,r,h,p,c))?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=c,r=u):("function"!==typeof o.componentDidUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||s===e.memoizedProps&&h===e.memoizedState||(t.flags|=256),r=!1)}return Qr(e,t,n,r,i,a)}function Qr(e,t,n,r,a,i){Kr(e,t);var o=0!==(64&t.flags);if(!r&&!o)return a&&lt(t,n,!1),da(e,t,i);r=t.stateNode,Ur.current=t;var s=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=In(t,e.child,null,i),t.child=In(t,null,s,i)):Hr(e,t,s,i),t.memoizedState=r.state,a&&lt(t,n,!0),t.child}function Zr(e){var t=e.stateNode;t.pendingContext?st(0,t.pendingContext,t.pendingContext!==t.context):t.context&&st(0,t.context,!1),Fn(e,t.containerInfo)}var $r,ea,ta,na,ra={dehydrated:null,retryLane:0};function aa(e,t,n){var r,a=t.pendingProps,i=Hn.current,o=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&i)),r?(o=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===a.fallback||!0===a.unstable_avoidThisFallback||(i|=1),$e(Hn,1&i),null===e?(void 0!==a.fallback&&Yn(t),e=a.children,i=a.fallback,o?(e=ia(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=ra,e):"number"===typeof a.unstable_expectedLoadTime?(e=ia(t,e,i,n),t.child.memoizedState={baseLanes:n},t.memoizedState=ra,t.lanes=33554432,e):((n=Co({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,o?(a=sa(e,t,a.children,a.fallback,n),o=t.child,i=e.child.memoizedState,o.memoizedState=null===i?{baseLanes:n}:{baseLanes:i.baseLanes|n},o.childLanes=e.childLanes&~n,t.memoizedState=ra,a):(n=oa(e,t,a.children,n),t.memoizedState=null,n))}function ia(e,t,n,r){var a=e.mode,i=e.child;return t={mode:"hidden",children:t},0===(2&a)&&null!==i?(i.childLanes=0,i.pendingProps=t):i=Co(t,a,0,null),n=So(n,a,r,null),i.return=e,n.return=e,i.sibling=n,e.child=i,n}function oa(e,t,n,r){var a=e.child;return e=a.sibling,n=_o(a,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function sa(e,t,n,r,a){var i=t.mode,o=e.child;e=o.sibling;var s={mode:"hidden",children:n};return 0===(2&i)&&t.child!==o?((n=t.child).childLanes=0,n.pendingProps=s,null!==(o=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=o,o.nextEffect=null):t.firstEffect=t.lastEffect=null):n=_o(o,s),null!==e?r=_o(e,r):(r=So(r,i,a,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function ca(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),ln(e.return,t)}function ua(e,t,n,r,a,i){var o=e.memoizedState;null===o?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:a,lastEffect:i}:(o.isBackwards=t,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=n,o.tailMode=a,o.lastEffect=i)}function la(e,t,n){var r=t.pendingProps,a=r.revealOrder,i=r.tail;if(Hr(e,t,r.children,n),0!==(2&(r=Hn.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ca(e,n);else if(19===e.tag)ca(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if($e(Hn,r),0===(2&t.mode))t.memoizedState=null;else switch(a){case"forwards":for(n=t.child,a=null;null!==n;)null!==(e=n.alternate)&&null===Vn(e)&&(a=n),n=n.sibling;null===(n=a)?(a=t.child,t.child=null):(a=n.sibling,n.sibling=null),ua(t,!1,a,n,i,t.lastEffect);break;case"backwards":for(n=null,a=t.child,t.child=null;null!==a;){if(null!==(e=a.alternate)&&null===Vn(e)){t.child=a;break}e=a.sibling,a.sibling=n,n=a,a=e}ua(t,!0,n,null,i,t.lastEffect);break;case"together":ua(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function da(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),di|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=_o(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=_o(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function ha(e){e.flags|=4}if(Y)$r=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)U(e,n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},ea=function(){},ta=function(e,t,n,r,a){if((e=e.memoizedProps)!==r){var i=t.stateNode,o=Pn(Ln.current);n=H(i,n,e,r,a,o),(t.updateQueue=n)&&ha(t)}},na=function(e,t,n,r){n!==r&&ha(t)};else if(Q){$r=function(e,t,n,r){for(var a=t.child;null!==a;){if(5===a.tag){var i=a.stateNode;n&&r&&(i=je(i,a.type,a.memoizedProps,a)),U(e,i)}else if(6===a.tag)i=a.stateNode,n&&r&&(i=Be(i,a.memoizedProps,a)),U(e,i);else if(4!==a.tag){if(13===a.tag&&0!==(4&a.flags)&&(i=null!==a.memoizedState)){var o=a.child;if(null!==o&&(null!==o.child&&(o.child.return=o,$r(e,o,!0,i)),null!==(i=o.sibling))){i.return=a,a=i;continue}}if(null!==a.child){a.child.return=a,a=a.child;continue}}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};var fa=function e(t,n,r,a){for(var i=n.child;null!==i;){if(5===i.tag){var o=i.stateNode;r&&a&&(o=je(o,i.type,i.memoizedProps,i)),ke(t,o)}else if(6===i.tag)o=i.stateNode,r&&a&&(o=Be(o,i.memoizedProps,i)),ke(t,o);else if(4!==i.tag){if(13===i.tag&&0!==(4&i.flags)&&(o=null!==i.memoizedState)){var s=i.child;if(null!==s&&(null!==s.child&&(s.child.return=s,e(t,s,!0,o)),null!==(o=s.sibling))){o.return=i,i=o;continue}}if(null!==i.child){i.child.return=i,i=i.child;continue}}if(i===n)break;for(;null===i.sibling;){if(null===i.return||i.return===n)return;i=i.return}i.sibling.return=i.return,i=i.sibling}};ea=function(e){var t=e.stateNode;if(null!==e.firstEffect){var n=t.containerInfo,r=Me(n);fa(r,e,!1,!1),t.pendingChildren=r,ha(e),Re(n,r)}},ta=function(e,t,n,r,a){var i=e.stateNode,o=e.memoizedProps;if((e=null===t.firstEffect)&&o===r)t.stateNode=i;else{var s=t.stateNode,c=Pn(Ln.current),u=null;o!==r&&(u=H(s,n,o,r,a,c)),e&&null===u?t.stateNode=i:(i=Te(i,u,n,o,r,t,e,s),z(i,n,r,a,c)&&ha(t),t.stateNode=i,e?ha(t):$r(i,t,!1,!1))}},na=function(e,t,n,r){n!==r?(e=Pn(Dn.current),n=Pn(Ln.current),t.stateNode=W(r,e,n,t),ha(t)):t.stateNode=e.stateNode}}else ea=function(){},ta=function(){},na=function(){};function pa(e,t){if(!Xn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ma(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return it(t.type)&&ot(),null;case 3:return Gn(),Ze(nt),Ze(tt),tr(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(Zn(t)?ha(t):r.hydrate||(t.flags|=256)),ea(t),null;case 5:zn(t);var a=Pn(Dn.current);if(n=t.type,null!==e&&null!=t.stateNode)ta(e,t,n,r,a),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(s(166));return null}if(e=Pn(Ln.current),Zn(t)){if(!Z)throw Error(s(175));e=Ue(t.stateNode,t.type,t.memoizedProps,a,e,t),t.updateQueue=e,null!==e&&ha(t)}else{var i=G(n,r,a,e,t);$r(i,t,!1,!1),t.stateNode=i,z(i,n,r,a,e)&&ha(t)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)na(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(e=Pn(Dn.current),a=Pn(Ln.current),Zn(t)){if(!Z)throw Error(s(176));ze(t.stateNode,t.memoizedProps,t)&&ha(t)}else t.stateNode=W(r,e,a,t)}return null;case 13:return Ze(Hn),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,a=!1,null===e?void 0!==t.memoizedProps.fallback&&Zn(t):a=null!==e.memoizedState,r&&!a&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Hn.current)?0===ci&&(ci=3):(0!==ci&&3!==ci||(ci=4),null===ri||0===(134217727&di)&&0===(134217727&hi)||zi(ri,ii))),Q&&r&&(t.flags|=4),Y&&(r||a)&&(t.flags|=4),null);case 4:return Gn(),ea(t),null===e&&ae(t.stateNode.containerInfo),null;case 10:return un(t),null;case 17:return it(t.type)&&ot(),null;case 19:if(Ze(Hn),null===(r=t.memoizedState))return null;if(a=0!==(64&t.flags),null===(i=r.rendering))if(a)pa(r,!1);else{if(0!==ci||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(i=Vn(e))){for(t.flags|=64,pa(r,!1),null!==(e=i.updateQueue)&&(t.updateQueue=e,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,e=n,r=t.child;null!==r;)n=e,(a=r).flags&=2,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null,null===(i=a.alternate)?(a.childLanes=0,a.lanes=n,a.child=null,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null):(a.childLanes=i.childLanes,a.lanes=i.lanes,a.child=i.child,a.memoizedProps=i.memoizedProps,a.memoizedState=i.memoizedState,a.updateQueue=i.updateQueue,a.type=i.type,n=i.dependencies,a.dependencies=null===n?null:{lanes:n.lanes,firstContext:n.firstContext}),r=r.sibling;return $e(Hn,1&Hn.current|2),t.child}e=e.sibling}null!==r.tail&&Ht()>vi&&(t.flags|=64,a=!0,pa(r,!1),t.lanes=33554432)}else{if(!a)if(null!==(e=Vn(i))){if(t.flags|=64,a=!0,null!==(e=e.updateQueue)&&(t.updateQueue=e,t.flags|=4),pa(r,!0),null===r.tail&&"hidden"===r.tailMode&&!i.alternate&&!Xn)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Ht()-r.renderingStartTime>vi&&1073741824!==n&&(t.flags|=64,a=!0,pa(r,!1),t.lanes=33554432);r.isBackwards?(i.sibling=t.child,t.child=i):(null!==(e=r.last)?e.sibling=i:t.child=i,r.last=i)}return null!==r.tail?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Ht(),e.sibling=null,t=Hn.current,$e(Hn,a?1&t|2:1&t),e):null;case 23:case 24:return Xi(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(s(156,t.tag))}function va(e){switch(e.tag){case 1:it(e.type)&&ot();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Gn(),Ze(nt),Ze(tt),tr(),0!==(64&(t=e.flags)))throw Error(s(285));return e.flags=-4097&t|64,e;case 5:return zn(e),null;case 13:return Ze(Hn),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return Ze(Hn),null;case 4:return Gn(),null;case 10:return un(e),null;case 23:case 24:return Xi(),null;default:return null}}function ga(e,t){try{var n="",r=t;do{n+=en(r),r=r.return}while(r);var a=n}catch(i){a="\nError generating stack: "+i.message+"\n"+i.stack}return{value:e,source:t,stack:a}}function ba(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ya="function"===typeof WeakMap?WeakMap:Map;function xa(e,t,n){(n=vn(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){xi||(xi=!0,wi=r),ba(0,t)},n}function wa(e,t,n){(n=vn(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var a=t.value;n.payload=function(){return ba(0,t),r(a)}}var i=e.stateNode;return null!==i&&"function"===typeof i.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Oi?Oi=new Set([this]):Oi.add(this),ba(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var Oa="function"===typeof WeakSet?WeakSet:Set;function Aa(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){lo(e,n)}else t.current=null}function _a(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:tn(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(Y&&256&t.flags&&Ce(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(s(163))}function Ea(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==t)}}function Sa(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var a=e;r=a.next,0!==(4&(a=a.tag))&&0!==(1&a)&&(so(n,e),oo(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:tn(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&xn(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=L(n.child.stateNode);break;case 1:e=n.child.stateNode}xn(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&ve(e,n.type,n.memoizedProps,n));case 6:case 4:case 12:return;case 13:return void(Z&&null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&We(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(s(163))}function Ca(e,t){if(Y)for(var n=e;;){if(5===n.tag){var r=n.stateNode;t?Ae(r):Ee(n.stateNode,n.memoizedProps)}else if(6===n.tag)r=n.stateNode,t?_e(r):Se(r,n.memoizedProps);else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function Ta(e,t){if(ht&&"function"===typeof ht.onCommitFiberUnmount)try{ht.onCommitFiberUnmount(dt,t)}catch(i){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,a=r.destroy;if(r=r.tag,void 0!==a)if(0!==(4&r))so(t,n);else{r=t;try{a()}catch(i){lo(r,i)}}n=n.next}while(n!==e)}break;case 1:if(Aa(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(i){lo(t,i)}break;case 5:Aa(t);break;case 4:Y?La(e,t):Q&&Q&&(t=t.stateNode.containerInfo,e=Me(t),Ie(t,e))}}function Ma(e,t){for(var n=t;;)if(Ta(e,n),null===n.child||Y&&4===n.tag){if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}else n.child.return=n,n=n.child}function ka(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Ra(e){return 5===e.tag||3===e.tag||4===e.tag}function Ia(e){if(Y){e:{for(var t=e.return;null!==t;){if(Ra(t))break e;t=t.return}throw Error(s(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(s(161))}16&n.flags&&(Oe(t),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||Ra(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?ja(e,n,t):Ba(e,n,t)}}function ja(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?ye(n,e,t):pe(n,e);else if(4!==r&&null!==(e=e.child))for(ja(e,t,n),e=e.sibling;null!==e;)ja(e,t,n),e=e.sibling}function Ba(e,t,n){var r=e.tag,a=5===r||6===r;if(a)e=a?e.stateNode:e.stateNode.instance,t?be(n,e,t):fe(n,e);else if(4!==r&&null!==(e=e.child))for(Ba(e,t,n),e=e.sibling;null!==e;)Ba(e,t,n),e=e.sibling}function La(e,t){for(var n,r,a=t,i=!1;;){if(!i){i=a.return;e:for(;;){if(null===i)throw Error(s(160));switch(n=i.stateNode,i.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}i=i.return}i=!0}if(5===a.tag||6===a.tag)Ma(e,a),r?we(n,a.stateNode):xe(n,a.stateNode);else if(4===a.tag){if(null!==a.child){n=a.stateNode.containerInfo,r=!0,a.child.return=a,a=a.child;continue}}else if(Ta(e,a),null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;4===(a=a.return).tag&&(i=!1)}a.sibling.return=a.return,a=a.sibling}}function Na(e,t){if(Y){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void Ea(3,t);case 1:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps;e=null!==e?e.memoizedProps:r;var a=t.type,i=t.updateQueue;t.updateQueue=null,null!==i&&ge(n,i,a,e,r,t)}return;case 6:if(null===t.stateNode)throw Error(s(162));return n=t.memoizedProps,void me(t.stateNode,null!==e?e.memoizedProps:n,n);case 3:return void(Z&&(t=t.stateNode,t.hydrate&&(t.hydrate=!1,Ve(t.containerInfo))));case 12:return;case 13:return Da(t),void Pa(t);case 19:return void Pa(t);case 17:return;case 23:case 24:return void Ca(t,null!==t.memoizedState)}throw Error(s(163))}switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void Ea(3,t);case 12:return;case 13:return Da(t),void Pa(t);case 19:return void Pa(t);case 3:Z&&((n=t.stateNode).hydrate&&(n.hydrate=!1,Ve(n.containerInfo)));break;case 23:case 24:return}e:if(Q){switch(t.tag){case 1:case 5:case 6:case 20:break e;case 3:case 4:t=t.stateNode,Ie(t.containerInfo,t.pendingChildren);break e}throw Error(s(163))}}function Da(e){null!==e.memoizedState&&(mi=Ht(),Y&&Ca(e.child,!0))}function Pa(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Oa),t.forEach((function(t){var r=fo.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Fa(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Ga=0,Ua=1,za=2,Ha=3,Va=4;if("function"===typeof Symbol&&Symbol.for){var Wa=Symbol.for;Ga=Wa("selector.component"),Ua=Wa("selector.has_pseudo_class"),za=Wa("selector.role"),Ha=Wa("selector.test_id"),Va=Wa("selector.text")}function Ja(e){var t=$(e);if(null!=t){if("string"!==typeof t.memoizedProps["data-testname"])throw Error(s(364));return t}if(null===(e=oe(e)))throw Error(s(362));return e.stateNode.current}function Xa(e,t){switch(t.$$typeof){case Ga:if(e.type===t.value)return!0;break;case Ua:e:{t=t.value,e=[e,0];for(var n=0;n<e.length;){var r=e[n++],a=e[n++],i=t[a];if(5!==r.tag||!ue(r)){for(;null!=i&&Xa(r,i);)i=t[++a];if(a===t.length){t=!0;break e}for(r=r.child;null!==r;)e.push(r,a),r=r.sibling}}t=!1}return t;case za:if(5===e.tag&&le(e.stateNode,t.value))return!0;break;case Va:if((5===e.tag||6===e.tag)&&(null!==(e=ce(e))&&0<=e.indexOf(t.value)))return!0;break;case Ha:if(5===e.tag&&("string"===typeof(e=e.memoizedProps["data-testname"])&&e.toLowerCase()===t.value.toLowerCase()))return!0;break;default:throw Error(s(365,t))}return!1}function Ka(e){switch(e.$$typeof){case Ga:return"<"+(T(e.value)||"Unknown")+">";case Ua:return":has("+(Ka(e)||"")+")";case za:return'[role="'+e.value+'"]';case Va:return'"'+e.value+'"';case Ha:return'[data-testname="'+e.value+'"]';default:throw Error(s(365,e))}}function qa(e,t){var n=[];e=[e,0];for(var r=0;r<e.length;){var a=e[r++],i=e[r++],o=t[i];if(5!==a.tag||!ue(a)){for(;null!=o&&Xa(a,o);)o=t[++i];if(i===t.length)n.push(a);else for(a=a.child;null!==a;)e.push(a,i),a=a.sibling}}return n}function Ya(e,t){if(!ie)throw Error(s(363));e=qa(e=Ja(e),t),t=[],e=Array.from(e);for(var n=0;n<e.length;){var r=e[n++];if(5===r.tag)ue(r)||t.push(r.stateNode);else for(r=r.child;null!==r;)e.push(r),r=r.sibling}return t}var Qa=null;var Za=Math.ceil,$a=c.ReactCurrentDispatcher,ei=c.ReactCurrentOwner,ti=c.IsSomeRendererActing,ni=0,ri=null,ai=null,ii=0,oi=0,si=Qe(0),ci=0,ui=null,li=0,di=0,hi=0,fi=0,pi=null,mi=0,vi=1/0;function gi(){vi=Ht()+500}var bi,yi=null,xi=!1,wi=null,Oi=null,Ai=!1,_i=null,Ei=90,Si=[],Ci=[],Ti=null,Mi=0,ki=null,Ri=-1,Ii=0,ji=0,Bi=null,Li=!1;function Ni(){return 0!==(48&ni)?Ht():-1!==Ri?Ri:Ri=Ht()}function Di(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Vt()?1:2;if(0===Ii&&(Ii=li),0!==Yt.transition){0!==ji&&(ji=null!==pi?pi.pendingLanes:0),e=Ii;var t=4186112&~ji;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Vt(),0!==(4&ni)&&98===e?e=bt(12,Ii):e=bt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),Ii),e}function Pi(e,t,n){if(50<Mi)throw Mi=0,ki=null,Error(s(185));if(null===(e=Fi(e,t)))return null;wt(e,t,n),e===ri&&(hi|=t,4===ci&&zi(e,ii));var r=Vt();1===t?0!==(8&ni)&&0===(48&ni)?Hi(e):(Gi(e,n),0===ni&&(gi(),Kt())):(0===(4&ni)||98!==r&&99!==r||(null===Ti?Ti=new Set([e]):Ti.add(e)),Gi(e,n)),pi=e}function Fi(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function Gi(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,a=e.pingedLanes,i=e.expirationTimes,o=e.pendingLanes;0<o;){var c=31-Ot(o),u=1<<c,l=i[c];if(-1===l){if(0===(u&r)||0!==(u&a)){l=t,mt(u);var d=pt;i[c]=10<=d?l+250:6<=d?l+5e3:-1}}else l<=t&&(e.expiredLanes|=u);o&=~u}if(r=vt(e,e===ri?ii:0),t=pt,0===r)null!==n&&(n!==Dt&&Ct(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==Dt&&Ct(n)}15===t?(n=Hi.bind(null,e),null===Ft?(Ft=[n],Gt=St(It,qt)):Ft.push(n),n=Dt):14===t?n=Xt(99,Hi.bind(null,e)):n=Xt(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(s(358,e))}}(t),Ui.bind(null,e)),e.callbackPriority=t,e.callbackNode=n}}function Ui(e){if(Ri=-1,ji=Ii=0,0!==(48&ni))throw Error(s(327));var t=e.callbackNode;if(io()&&e.callbackNode!==t)return null;var n=vt(e,e===ri?ii:0);if(0===n)return null;var r=n,a=ni;ni|=16;var i=Yi();for(ri===e&&ii===r||(gi(),Ki(e,r));;)try{$i();break}catch(c){qi(e,c)}if(sn(),$a.current=i,ni=a,null!==ai?r=0:(ri=null,ii=0,r=ci),0!==(li&hi))Ki(e,0);else if(0!==r){if(2===r&&(ni|=64,e.hydrate&&(e.hydrate=!1,Ce(e.containerInfo)),0!==(n=gt(e))&&(r=Qi(e,n))),1===r)throw t=ui,Ki(e,0),zi(e,n),Gi(e,Ht()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(s(345));case 2:no(e);break;case 3:if(zi(e,n),(62914560&n)===n&&10<(r=mi+500-Ht())){if(0!==vt(e,0))break;if(((a=e.suspendedLanes)&n)!==n){Ni(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=J(no.bind(null,e),r);break}no(e);break;case 4:if(zi(e,n),(4186112&n)===n)break;for(r=e.eventTimes,a=-1;0<n;){var o=31-Ot(n);i=1<<o,(o=r[o])>a&&(a=o),n&=~i}if(n=a,10<(n=(120>(n=Ht()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Za(n/1960))-n)){e.timeoutHandle=J(no.bind(null,e),n);break}no(e);break;case 5:no(e);break;default:throw Error(s(329))}}return Gi(e,Ht()),e.callbackNode===t?Ui.bind(null,e):null}function zi(e,t){for(t&=~fi,t&=~hi,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Ot(t),r=1<<n;e[n]=-1,t&=~r}}function Hi(e){if(0!==(48&ni))throw Error(s(327));if(io(),e===ri&&0!==(e.expiredLanes&ii)){var t=ii,n=Qi(e,t);0!==(li&hi)&&(n=Qi(e,t=vt(e,t)))}else n=Qi(e,t=vt(e,0));if(0!==e.tag&&2===n&&(ni|=64,e.hydrate&&(e.hydrate=!1,Ce(e.containerInfo)),0!==(t=gt(e))&&(n=Qi(e,t))),1===n)throw n=ui,Ki(e,0),zi(e,t),Gi(e,Ht()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,no(e),Gi(e,Ht()),null}function Vi(e,t){var n=ni;ni|=1;try{return e(t)}finally{0===(ni=n)&&(gi(),Kt())}}function Wi(e,t){var n=ni;if(0!==(48&n))return e(t);ni|=1;try{if(e)return Jt(99,e.bind(null,t))}finally{ni=n,Kt()}}function Ji(e,t){$e(si,oi),oi|=t,li|=t}function Xi(){oi=si.current,Ze(si)}function Ki(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==K&&(e.timeoutHandle=K,X(n)),null!==ai)for(n=ai.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&ot();break;case 3:Gn(),Ze(nt),Ze(tt),tr();break;case 5:zn(r);break;case 4:Gn();break;case 13:case 19:Ze(Hn);break;case 10:un(r);break;case 23:case 24:Xi()}n=n.return}ri=e,ai=_o(e.current,null),ii=oi=li=t,ci=0,ui=null,fi=hi=di=0}function qi(e,t){for(;;){var n=ai;try{if(sn(),nr.current=Dr,cr){for(var r=ir.memoizedState;null!==r;){var a=r.queue;null!==a&&(a.pending=null),r=r.next}cr=!1}if(ar=0,sr=or=ir=null,ur=!1,ei.current=null,null===n||null===n.return){ci=1,ui=t,ai=null;break}e:{var i=e,o=n.return,s=n,c=t;if(t=ii,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c;if(0===(2&s.mode)){var l=s.alternate;l?(s.updateQueue=l.updateQueue,s.memoizedState=l.memoizedState,s.lanes=l.lanes):(s.updateQueue=null,s.memoizedState=null)}var d=0!==(1&Hn.current),h=o;do{var f;if(f=13===h.tag){var p=h.memoizedState;if(null!==p)f=null!==p.dehydrated;else{var m=h.memoizedProps;f=void 0!==m.fallback&&(!0!==m.unstable_avoidThisFallback||!d)}}if(f){var v=h.updateQueue;if(null===v){var g=new Set;g.add(u),h.updateQueue=g}else v.add(u);if(0===(2&h.mode)){if(h.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var b=vn(-1,1);b.tag=2,gn(s,b)}s.lanes|=1;break e}c=void 0,s=t;var y=i.pingCache;if(null===y?(y=i.pingCache=new ya,c=new Set,y.set(u,c)):void 0===(c=y.get(u))&&(c=new Set,y.set(u,c)),!c.has(s)){c.add(s);var x=ho.bind(null,i,u,s);u.then(x,x)}h.flags|=4096,h.lanes=t;break e}h=h.return}while(null!==h);c=Error((T(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==ci&&(ci=2),c=ga(c,s),h=o;do{switch(h.tag){case 3:i=c,h.flags|=4096,t&=-t,h.lanes|=t,bn(h,xa(0,i,t));break e;case 1:i=c;var w=h.type,O=h.stateNode;if(0===(64&h.flags)&&("function"===typeof w.getDerivedStateFromError||null!==O&&"function"===typeof O.componentDidCatch&&(null===Oi||!Oi.has(O)))){h.flags|=4096,t&=-t,h.lanes|=t,bn(h,wa(h,i,t));break e}}h=h.return}while(null!==h)}to(n)}catch(A){t=A,ai===n&&null!==n&&(ai=n=n.return);continue}break}}function Yi(){var e=$a.current;return $a.current=Dr,null===e?Dr:e}function Qi(e,t){var n=ni;ni|=16;var r=Yi();for(ri===e&&ii===t||Ki(e,t);;)try{Zi();break}catch(a){qi(e,a)}if(sn(),ni=n,$a.current=r,null!==ai)throw Error(s(261));return ri=null,ii=0,ci}function Zi(){for(;null!==ai;)eo(ai)}function $i(){for(;null!==ai&&!Tt();)eo(ai)}function eo(e){var t=bi(e.alternate,e,oi);e.memoizedProps=e.pendingProps,null===t?to(e):ai=t,ei.current=null}function to(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=ma(n,t,oi)))return void(ai=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&oi)||0===(4&n.mode)){for(var r=0,a=n.child;null!==a;)r|=a.lanes|a.childLanes,a=a.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=va(t)))return n.flags&=2047,void(ai=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(ai=t);ai=t=e}while(null!==t);0===ci&&(ci=5)}function no(e){var t=Vt();return Jt(99,ro.bind(null,e,t)),null}function ro(e,t){do{io()}while(null!==_i);if(0!==(48&ni))throw Error(s(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null;var r=n.lanes|n.childLanes,a=r,i=e.pendingLanes&~a;e.pendingLanes=a,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=a,e.mutableReadLanes&=a,e.entangledLanes&=a,a=e.entanglements;for(var o=e.eventTimes,c=e.expirationTimes;0<i;){var u=31-Ot(i),l=1<<u;a[u]=0,o[u]=-1,c[u]=-1,i&=~l}if(null!==Ti&&0===(24&r)&&Ti.has(e)&&Ti.delete(e),e===ri&&(ai=ri=null,ii=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){a=ni,ni|=32,ei.current=null,Bi=P(e.containerInfo),Li=!1,yi=r;do{try{ao()}catch(b){if(null===yi)throw Error(s(330));lo(yi,b),yi=yi.nextEffect}}while(null!==yi);Bi=null,yi=r;do{try{for(o=e;null!==yi;){var d=yi.flags;if(16&d&&Y&&Oe(yi.stateNode),128&d){var h=yi.alternate;if(null!==h){var f=h.ref;null!==f&&("function"===typeof f?f(null):f.current=null)}}switch(1038&d){case 2:Ia(yi),yi.flags&=-3;break;case 6:Ia(yi),yi.flags&=-3,Na(yi.alternate,yi);break;case 1024:yi.flags&=-1025;break;case 1028:yi.flags&=-1025,Na(yi.alternate,yi);break;case 4:Na(yi.alternate,yi);break;case 8:c=o,i=yi,Y?La(c,i):Ma(c,i);var p=i.alternate;ka(i),null!==p&&ka(p)}yi=yi.nextEffect}}catch(b){if(null===yi)throw Error(s(330));lo(yi,b),yi=yi.nextEffect}}while(null!==yi);Li&&re(),F(e.containerInfo),e.current=n,yi=r;do{try{for(d=e;null!==yi;){var m=yi.flags;if(36&m&&Sa(d,yi.alternate,yi),128&m){h=void 0;var v=yi.ref;if(null!==v){var g=yi.stateNode;switch(yi.tag){case 5:h=L(g);break;default:h=g}"function"===typeof v?v(h):v.current=h}}yi=yi.nextEffect}}catch(b){if(null===yi)throw Error(s(330));lo(yi,b),yi=yi.nextEffect}}while(null!==yi);yi=null,Pt(),ni=a}else e.current=n;if(Ai)Ai=!1,_i=e,Ei=t;else for(yi=r;null!==yi;)t=yi.nextEffect,yi.nextEffect=null,8&yi.flags&&((m=yi).sibling=null,m.stateNode=null),yi=t;if(0===(r=e.pendingLanes)&&(Oi=null),1===r?e===ki?Mi++:(Mi=0,ki=e):Mi=0,n=n.stateNode,ht&&"function"===typeof ht.onCommitFiberRoot)try{ht.onCommitFiberRoot(dt,n,void 0,64===(64&n.current.flags))}catch(b){}if(Gi(e,Ht()),xi)throw xi=!1,e=wi,wi=null,e;return 0!==(8&ni)||Kt(),null}function ao(){for(;null!==yi;){var e=yi.alternate;Li||null===Bi||(0!==(8&yi.flags)?j(yi,Bi)&&(Li=!0,ne()):13===yi.tag&&Fa(e,yi)&&j(yi,Bi)&&(Li=!0,ne()));var t=yi.flags;0!==(256&t)&&_a(e,yi),0===(512&t)||Ai||(Ai=!0,Xt(97,(function(){return io(),null}))),yi=yi.nextEffect}}function io(){if(90!==Ei){var e=97<Ei?97:Ei;return Ei=90,Jt(e,co)}return!1}function oo(e,t){Si.push(t,e),Ai||(Ai=!0,Xt(97,(function(){return io(),null})))}function so(e,t){Ci.push(t,e),Ai||(Ai=!0,Xt(97,(function(){return io(),null})))}function co(){if(null===_i)return!1;var e=_i;if(_i=null,0!==(48&ni))throw Error(s(331));var t=ni;ni|=32;var n=Ci;Ci=[];for(var r=0;r<n.length;r+=2){var a=n[r],i=n[r+1],o=a.destroy;if(a.destroy=void 0,"function"===typeof o)try{o()}catch(u){if(null===i)throw Error(s(330));lo(i,u)}}for(n=Si,Si=[],r=0;r<n.length;r+=2){a=n[r],i=n[r+1];try{var c=a.create;a.destroy=c()}catch(u){if(null===i)throw Error(s(330));lo(i,u)}}for(c=e.current.firstEffect;null!==c;)e=c.nextEffect,c.nextEffect=null,8&c.flags&&(c.sibling=null,c.stateNode=null),c=e;return ni=t,Kt(),!0}function uo(e,t,n){gn(e,t=xa(0,t=ga(n,t),1)),t=Ni(),null!==(e=Fi(e,1))&&(wt(e,1,t),Gi(e,t))}function lo(e,t){if(3===e.tag)uo(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){uo(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Oi||!Oi.has(r))){var a=wa(n,e=ga(t,e),1);if(gn(n,a),a=Ni(),null!==(n=Fi(n,1)))wt(n,1,a),Gi(n,a);else if("function"===typeof r.componentDidCatch&&(null===Oi||!Oi.has(r)))try{r.componentDidCatch(t,e)}catch(i){}break}}n=n.return}}function ho(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=Ni(),e.pingedLanes|=e.suspendedLanes&n,ri===e&&(ii&n)===n&&(4===ci||3===ci&&(62914560&ii)===ii&&500>Ht()-mi?Ki(e,0):fi|=n),Gi(e,t)}function fo(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Vt()?1:2:(0===Ii&&(Ii=li),0===(t=yt(62914560&~Ii))&&(t=4194304))),n=Ni(),null!==(e=Fi(e,t))&&(wt(e,t,n),Gi(e,n))}bi=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||nt.current)zr=!0;else{if(0===(n&r)){switch(zr=!1,t.tag){case 3:Zr(t),$n();break;case 5:Un(t);break;case 1:it(t.type)&&ut(t);break;case 4:Fn(t,t.stateNode.containerInfo);break;case 10:cn(t,t.memoizedProps.value);break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?aa(e,t,n):($e(Hn,1&Hn.current),null!==(t=da(e,t,n))?t.sibling:null);$e(Hn,1&Hn.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return la(e,t,n);t.flags|=64}var a=t.memoizedState;if(null!==a&&(a.rendering=null,a.tail=null,a.lastEffect=null),$e(Hn,Hn.current),r)break;return null;case 23:case 24:return t.lanes=0,Xr(e,t,n)}return da(e,t,n)}zr=0!==(16384&e.flags)}else zr=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=at(t,tt.current),dn(t,n),a=hr(null,t,r,e,a,n),t.flags|=1,"object"===typeof a&&null!==a&&"function"===typeof a.render&&void 0===a.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,it(r)){var i=!0;ut(t)}else i=!1;t.memoizedState=null!==a.state&&void 0!==a.state?a.state:null,pn(t);var o=r.getDerivedStateFromProps;"function"===typeof o&&On(t,r,o,e),a.updater=An,t.stateNode=a,a._reactInternals=t,Cn(t,r,e,n),t=Qr(null,t,r,!0,i,n)}else t.tag=0,Hr(null,t,a,n),t=t.child;return t;case 16:a=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,a=(i=a._init)(a._payload),t.type=a,i=t.tag=function(e){if("function"===typeof e)return Ao(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===v)return 11;if(e===y)return 14}return 2}(a),e=tn(a,e),i){case 0:t=qr(null,t,a,e,n);break e;case 1:t=Yr(null,t,a,e,n);break e;case 11:t=Vr(null,t,a,e,n);break e;case 14:t=Wr(null,t,a,tn(a.type,e),r,n);break e}throw Error(s(306,a,""))}return t;case 0:return r=t.type,a=t.pendingProps,qr(e,t,r,a=t.elementType===r?a:tn(r,a),n);case 1:return r=t.type,a=t.pendingProps,Yr(e,t,r,a=t.elementType===r?a:tn(r,a),n);case 3:if(Zr(t),r=t.updateQueue,null===e||null===r)throw Error(s(282));if(r=t.pendingProps,a=null!==(a=t.memoizedState)?a.element:null,mn(e,t),yn(t,r,null,n),(r=t.memoizedState.element)===a)$n(),t=da(e,t,n);else{if((i=(a=t.stateNode).hydrate)&&(Z?(Jn=Ge(t.stateNode.containerInfo),Wn=t,i=Xn=!0):i=!1),i){if(Z&&null!=(e=a.mutableSourceEagerHydrationData))for(a=0;a<e.length;a+=2)i=e[a],o=e[a+1],q?i._workInProgressVersionPrimary=o:i._workInProgressVersionSecondary=o,er.push(i);for(n=jn(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else Hr(e,t,r,n),$n();t=t.child}return t;case 5:return Un(t),null===e&&Yn(t),r=t.type,a=t.pendingProps,i=null!==e?e.memoizedProps:null,o=a.children,V(r,a)?o=null:null!==i&&V(r,i)&&(t.flags|=16),Kr(e,t),Hr(e,t,o,n),t.child;case 6:return null===e&&Yn(t),null;case 13:return aa(e,t,n);case 4:return Fn(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=In(t,null,r,n):Hr(e,t,r,n),t.child;case 11:return r=t.type,a=t.pendingProps,Vr(e,t,r,a=t.elementType===r?a:tn(r,a),n);case 7:return Hr(e,t,t.pendingProps,n),t.child;case 8:case 12:return Hr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,a=t.pendingProps,o=t.memoizedProps,cn(t,i=a.value),null!==o){var c=o.value;if(0===(i=Qt(c,i)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(c,i):1073741823))){if(o.children===a.children&&!nt.current){t=da(e,t,n);break e}}else for(null!==(c=t.child)&&(c.return=t);null!==c;){var u=c.dependencies;if(null!==u){o=c.child;for(var l=u.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&i)){1===c.tag&&((l=vn(-1,n&-n)).tag=2,gn(c,l)),c.lanes|=n,null!==(l=c.alternate)&&(l.lanes|=n),ln(c.return,n),u.lanes|=n;break}l=l.next}}else o=10===c.tag&&c.type===t.type?null:c.child;if(null!==o)o.return=c;else for(o=c;null!==o;){if(o===t){o=null;break}if(null!==(c=o.sibling)){c.return=o.return,o=c;break}o=o.return}c=o}}Hr(e,t,a.children,n),t=t.child}return t;case 9:return a=t.type,r=(i=t.pendingProps).children,dn(t,n),r=r(a=hn(a,i.unstable_observedBits)),t.flags|=1,Hr(e,t,r,n),t.child;case 14:return i=tn(a=t.type,t.pendingProps),Wr(e,t,a,i=tn(a.type,i),r,n);case 15:return Jr(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,a=t.pendingProps,a=t.elementType===r?a:tn(r,a),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,it(r)?(e=!0,ut(t)):e=!1,dn(t,n),En(t,r,a),Cn(t,r,a,n),Qr(null,t,r,!0,e,n);case 19:return la(e,t,n);case 23:case 24:return Xr(e,t,n)}throw Error(s(156,t.tag))};var po={current:!1},mo=o.unstable_flushAllWithoutAsserting,vo="function"===typeof mo;function go(){if(void 0!==mo)return mo();for(var e=!1;io();)e=!0;return e}function bo(t){try{go(),function(t){if(null===Qa)try{var n=("require"+Math.random()).slice(0,7);Qa=(e&&e[n]).call(e,"timers").setImmediate}catch(r){Qa=function(e){var t=new MessageChannel;t.port1.onmessage=e,t.port2.postMessage(void 0)}}Qa(t)}((function(){go()?bo(t):t()}))}catch(n){t(n)}}var yo=0,xo=!1;function wo(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Oo(e,t,n,r){return new wo(e,t,n,r)}function Ao(e){return!(!(e=e.prototype)||!e.isReactComponent)}function _o(e,t){var n=e.alternate;return null===n?((n=Oo(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Eo(e,t,n,r,a,i){var o=2;if(r=e,"function"===typeof e)Ao(e)&&(o=1);else if("string"===typeof e)o=5;else e:switch(e){case d:return So(n.children,a,i,t);case O:o=8,a|=16;break;case h:o=8,a|=1;break;case f:return(e=Oo(12,n,t,8|a)).elementType=f,e.type=f,e.lanes=i,e;case g:return(e=Oo(13,n,t,a)).type=g,e.elementType=g,e.lanes=i,e;case b:return(e=Oo(19,n,t,a)).elementType=b,e.lanes=i,e;case A:return Co(n,a,i,t);case _:return(e=Oo(24,n,t,a)).elementType=_,e.lanes=i,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case p:o=10;break e;case m:o=9;break e;case v:o=11;break e;case y:o=14;break e;case x:o=16,r=null;break e;case w:o=22;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Oo(o,n,t,a)).elementType=e,t.type=r,t.lanes=i,t}function So(e,t,n,r){return(e=Oo(7,e,r,t)).lanes=n,e}function Co(e,t,n,r){return(e=Oo(23,e,r,t)).elementType=A,e.lanes=n,e}function To(e,t,n){return(e=Oo(6,e,null,t)).lanes=n,e}function Mo(e,t,n){return(t=Oo(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ko(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=K,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=xt(0),this.expirationTimes=xt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xt(0),Z&&(this.mutableSourceEagerHydrationData=null)}function Ro(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw Error(s(268,Object.keys(e)))}return null===(e=I(t))?null:e.stateNode}function Io(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function jo(e,t){Io(e,t),(e=e.alternate)&&Io(e,t)}function Bo(e){return null===(e=I(e))?null:e.stateNode}function Lo(){return null}return r.IsThisRendererActing=po,r.act=function(e){function t(){yo--,ti.current=n,po.current=r}!1===xo&&(xo=!0,console.error("act(...) is not supported in production builds of React, and might not behave as expected.")),yo++;var n=ti.current,r=po.current;ti.current=!0,po.current=!0;try{var a=Vi(e)}catch(i){throw t(),i}if(null!==a&&"object"===typeof a&&"function"===typeof a.then)return{then:function(e,r){a.then((function(){1<yo||!0===vo&&!0===n?(t(),e()):bo((function(n){t(),n?r(n):e()}))}),(function(e){t(),r(e)}))}};try{1!==yo||!1!==vo&&!1!==n||go(),t()}catch(i){throw t(),i}return{then:function(e){e()}}},r.attemptContinuousHydration=function(e){13===e.tag&&(Pi(e,67108864,Ni()),jo(e,67108864))},r.attemptHydrationAtCurrentPriority=function(e){if(13===e.tag){var t=Ni(),n=Di(e);Pi(e,n,t),jo(e,n)}},r.attemptSynchronousHydration=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.hydrate){var n=mt(t.pendingLanes);t.expiredLanes|=n&t.pendingLanes,Gi(t,Ht()),0===(48&ni)&&(gi(),Kt())}break;case 13:var r=Ni();Wi((function(){return Pi(e,1,r)})),jo(e,4)}},r.attemptUserBlockingHydration=function(e){13===e.tag&&(Pi(e,4,Ni()),jo(e,4))},r.batchedEventUpdates=function(e,t){var n=ni;ni|=2;try{return e(t)}finally{0===(ni=n)&&(gi(),Kt())}},r.batchedUpdates=Vi,r.createComponentSelector=function(e){return{$$typeof:Ga,value:e}},r.createContainer=function(e,t,n){return e=new ko(e,t,n),t=Oo(3,null,null,2===t?7:1===t?3:0),e.current=t,t.stateNode=e,pn(t),e},r.createHasPsuedoClassSelector=function(e){return{$$typeof:Ua,value:e}},r.createPortal=function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:l,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}},r.createRoleSelector=function(e){return{$$typeof:za,value:e}},r.createTestNameSelector=function(e){return{$$typeof:Ha,value:e}},r.createTextSelector=function(e){return{$$typeof:Va,value:e}},r.deferredUpdates=function(e){return Jt(97,e)},r.discreteUpdates=function(e,t,n,r,a){var i=ni;ni|=4;try{return Jt(98,e.bind(null,t,n,r,a))}finally{0===(ni=i)&&(gi(),Kt())}},r.findAllNodes=Ya,r.findBoundingRects=function(e,t){if(!ie)throw Error(s(363));t=Ya(e,t),e=[];for(var n=0;n<t.length;n++)e.push(se(t[n]));for(t=e.length-1;0<t;t--)for(var r=(n=e[t]).x,a=r+n.width,i=n.y,o=i+n.height,c=t-1;0<=c;c--)if(t!==c){var u=e[c],l=u.x,d=l+u.width,h=u.y,f=h+u.height;if(r>=l&&i>=h&&a<=d&&o<=f){e.splice(t,1);break}if(!(r!==l||n.width!==u.width||f<i||h>o)){h>i&&(u.height+=h-i,u.y=i),f<o&&(u.height=o-h),e.splice(t,1);break}if(!(i!==h||n.height!==u.height||d<r||l>a)){l>r&&(u.width+=l-r,u.x=r),d<a&&(u.width=a-l),e.splice(t,1);break}}return e},r.findHostInstance=Ro,r.findHostInstanceWithNoPortals=function(e){return null===(e=function(e){if(!(e=R(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child&&4!==t.tag)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}(e))?null:20===e.tag?e.stateNode.instance:e.stateNode},r.findHostInstanceWithWarning=function(e){return Ro(e)},r.flushControlled=function(e){var t=ni;ni|=1;try{Jt(99,e)}finally{0===(ni=t)&&(gi(),Kt())}},r.flushDiscreteUpdates=function(){0===(49&ni)&&(function(){if(null!==Ti){var e=Ti;Ti=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,Gi(e,Ht())}))}Kt()}(),io())},r.flushPassiveEffects=io,r.flushSync=Wi,r.focusWithin=function(e,t){if(!ie)throw Error(s(363));for(t=qa(e=Ja(e),t),t=Array.from(t),e=0;e<t.length;){var n=t[e++];if(!ue(n)){if(5===n.tag&&de(n.stateNode))return!0;for(n=n.child;null!==n;)t.push(n),n=n.sibling}}return!1},r.getCurrentUpdateLanePriority=function(){return ft},r.getFindAllNodesFailureDescription=function(e,t){if(!ie)throw Error(s(363));var n=0,r=[];e=[Ja(e),0];for(var a=0;a<e.length;){var i=e[a++],o=e[a++],c=t[o];if((5!==i.tag||!ue(i))&&(Xa(i,c)&&(r.push(Ka(c)),++o>n&&(n=o)),o<t.length))for(i=i.child;null!==i;)e.push(i,o),i=i.sibling}if(n<t.length){for(e=[];n<t.length;n++)e.push(Ka(t[n]));return"findAllNodes was able to match part of the selector:\n  "+r.join(" > ")+"\n\nNo matching component was found for:\n  "+e.join(" > ")}return null},r.getPublicRootInstance=function(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:return L(e.child.stateNode);default:return e.child.stateNode}},r.injectIntoDevTools=function(e){if(e={bundleType:e.bundleType,version:e.version,rendererPackageName:e.rendererPackageName,rendererConfig:e.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:c.ReactCurrentDispatcher,findHostInstanceByFiber:Bo,findFiberByHostInstance:e.findFiberByHostInstance||Lo,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null},"undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)e=!1;else{var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!t.isDisabled&&t.supportsFiber)try{dt=t.inject(e),ht=t}catch(n){}e=!0}return e},r.observeVisibleRects=function(e,t,n,r){if(!ie)throw Error(s(363));e=Ya(e,t);var a=he(e,n,r).disconnect;return{disconnect:function(){a()}}},r.registerMutableSourceForHydration=function(e,t){var n=t._getVersion;n=n(t._source),null==e.mutableSourceEagerHydrationData?e.mutableSourceEagerHydrationData=[t,n]:e.mutableSourceEagerHydrationData.push(t,n)},r.runWithPriority=function(e,t){var n=ft;try{return ft=e,t()}finally{ft=n}},r.shouldSuspend=function(){return!1},r.unbatchedUpdates=function(e,t){var n=ni;ni&=-2,ni|=8;try{return e(t)}finally{0===(ni=n)&&(gi(),Kt())}},r.updateContainer=function(e,t,n,r){var a=t.current,i=Ni(),o=Di(a);e:if(n){t:{if(M(n=n._reactInternals)!==n||1!==n.tag)throw Error(s(170));var c=n;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(it(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(null!==c);throw Error(s(171))}if(1===n.tag){var u=n.type;if(it(u)){n=ct(n,u,c);break e}}n=c}else n=et;return null===t.context?t.context=n:t.pendingContext=n,(t=vn(i,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),gn(a,t),Pi(a,o,i),o},r}}).call(this,n(179)(e))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){if(Object.is(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(var r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}},function(e,t){function n(e,t,n){var r,a,i,o,s;function c(){var u=Date.now()-o;u<t&&u>=0?r=setTimeout(c,t-u):(r=null,n||(s=e.apply(i,a),i=a=null))}null==t&&(t=100);var u=function(){i=this,a=arguments,o=Date.now();var u=n&&!r;return r||(r=setTimeout(c,t)),u&&(s=e.apply(i,a),i=a=null),s};return u.clear=function(){r&&(clearTimeout(r),r=null)},u.flush=function(){r&&(s=e.apply(i,a),i=a=null,clearTimeout(r),r=null)},u}n.debounce=n,e.exports=n},function(e,t,n){"use strict";e.exports=function e(t,n){if(t===n)return!0;if(t&&n&&"object"==typeof t&&"object"==typeof n){if(t.constructor!==n.constructor)return!1;var r,a,i;if(Array.isArray(t)){if((r=t.length)!=n.length)return!1;for(a=r;0!==a--;)if(!e(t[a],n[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if((r=(i=Object.keys(t)).length)!==Object.keys(n).length)return!1;for(a=r;0!==a--;)if(!Object.prototype.hasOwnProperty.call(n,i[a]))return!1;for(a=r;0!==a--;){var o=i[a];if(!e(t[o],n[o]))return!1}return!0}return t!==t&&n!==n}},function(e,t,n){"use strict";var r,a;n.d(t,"a",(function(){return r})),function(e){e[e.DT_INVALID=0]="DT_INVALID",e[e.DT_FLOAT=1]="DT_FLOAT",e[e.DT_DOUBLE=2]="DT_DOUBLE",e[e.DT_INT32=3]="DT_INT32",e[e.DT_UINT8=4]="DT_UINT8",e[e.DT_INT16=5]="DT_INT16",e[e.DT_INT8=6]="DT_INT8",e[e.DT_STRING=7]="DT_STRING",e[e.DT_COMPLEX64=8]="DT_COMPLEX64",e[e.DT_INT64=9]="DT_INT64",e[e.DT_BOOL=10]="DT_BOOL",e[e.DT_QINT8=11]="DT_QINT8",e[e.DT_QUINT8=12]="DT_QUINT8",e[e.DT_QINT32=13]="DT_QINT32",e[e.DT_BFLOAT16=14]="DT_BFLOAT16",e[e.DT_FLOAT_REF=101]="DT_FLOAT_REF",e[e.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",e[e.DT_INT32_REF=103]="DT_INT32_REF",e[e.DT_UINT8_REF=104]="DT_UINT8_REF",e[e.DT_INT16_REF=105]="DT_INT16_REF",e[e.DT_INT8_REF=106]="DT_INT8_REF",e[e.DT_STRING_REF=107]="DT_STRING_REF",e[e.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",e[e.DT_INT64_REF=109]="DT_INT64_REF",e[e.DT_BOOL_REF=110]="DT_BOOL_REF",e[e.DT_QINT8_REF=111]="DT_QINT8_REF",e[e.DT_QUINT8_REF=112]="DT_QUINT8_REF",e[e.DT_QINT32_REF=113]="DT_QINT32_REF",e[e.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF"}(r||(r={})),function(e){!function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"}(e.CheckpointFormatVersion||(e.CheckpointFormatVersion={}))}(a||(a={}))},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number"}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}]},function(e,t,n){"use strict";n.r(t),n.d(t,"json",(function(){return r}));var r=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]}]},function(e,t,n){var r=n(441),a=n(442),i=n(443),o=n(444),s=n(445),c=n(446),u=n(447);u.alea=r,u.xor128=a,u.xorwow=i,u.xorshift7=o,u.xor4096=s,u.tychei=c,e.exports=u},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(" "),t.s1=n(" "),t.s2=n(" "),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}function s(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function c(e,t){var n=new o(e),r=t&&t.state,a=n.next;return a.int32=function(){return 4294967296*n.next()|0},a.double=function(){return a()+11102230246251565e-32*(2097152*a()|0)},a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=c:n(163)&&n(189)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.alea=c}(0,e,n(163))}).call(this,n(179)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function c(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=c:n(163)&&n(189)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.xor128=c}(0,e,n(163))}).call(this,n(179)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}function s(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function c(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=c:n(163)&&n(189)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.xorwow=c}(0,e,n(163))}).call(this,n(179)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.x,a=t.i;return e=r[a],n=(e^=e>>>7)^e<<24,n^=(e=r[a+1&7])^e>>>10,n^=(e=r[a+3&7])^e>>>3,n^=(e=r[a+4&7])^e<<7,e=r[a+7&7],n^=(e^=e<<13)^e<<9,r[a]=n,t.i=a+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=""+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}function s(e,t){return t.x=e.x.slice(),t.i=e.i,t}function c(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.x&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=c:n(163)&&n(189)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.xorshift7=c}(0,e,n(163))}).call(this,n(179)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this;t.next=function(){var e,n,r=t.w,a=t.X,i=t.i;return t.w=r=r+1640531527|0,n=a[i+34&127],e=a[i=i+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=a[i]=n^e,t.i=i,n+(r^r>>>16)|0},function(e,t){var n,r,a,i,o,s=[],c=128;for(t===(0|t)?(r=t,t=null):(t+="\0",r=0,c=Math.max(c,t.length)),a=0,i=-32;i<c;++i)t&&(r^=t.charCodeAt((i+32)%t.length)),0===i&&(o=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,i>=0&&(o=o+1640531527|0,a=0==(n=s[127&i]^=r+o)?a+1:0);for(a>=128&&(s[127&(t&&t.length||0)]=-1),a=127,i=512;i>0;--i)r=s[a+34&127],n=s[a=a+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[a]=r^n;e.w=o,e.X=s,e.i=a}(t,e)}function s(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function c(e,t){null==e&&(e=+new Date);var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&(r.X&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=c:n(163)&&n(189)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.xor4096=c}(0,e,n(163))}).call(this,n(179)(e))},function(e,t,n){(function(e){var r;!function(e,a,i){function o(e){var t=this,n="";t.next=function(){var e=t.b,n=t.c,r=t.d,a=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^a,a=a-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^a,t.a=a-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}function s(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function c(e,t){var n=new o(e),r=t&&t.state,a=function(){return(n.next()>>>0)/4294967296};return a.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},a.int32=n.next,a.quick=a,r&&("object"==typeof r&&s(r,n),a.state=function(){return s(n,{})}),a}a&&a.exports?a.exports=c:n(163)&&n(189)?void 0===(r=function(){return c}.call(t,n,t,a))||(a.exports=r):this.tychei=c}(0,e,n(163))}).call(this,n(179)(e))},function(e,t,n){var r;!function(a,i){var o,s=this,c=256,u=i.pow(c,6),l=i.pow(2,52),d=2*l,h=255;function f(e,t,n){var r=[],h=g(v((t=1==t?{entropy:!0}:t||{}).entropy?[e,b(a)]:null==e?function(){try{var e;return o&&(e=o.randomBytes)?e=e(c):(e=new Uint8Array(c),(s.crypto||s.msCrypto).getRandomValues(e)),b(e)}catch(r){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,b(a)]}}():e,3),r),f=new p(r),y=function(){for(var e=f.g(6),t=u,n=0;e<l;)e=(e+n)*c,t*=c,n=f.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t};return y.int32=function(){return 0|f.g(4)},y.quick=function(){return f.g(4)/4294967296},y.double=y,g(b(f.S),a),(t.pass||n||function(e,t,n,r){return r&&(r.S&&m(r,f),e.state=function(){return m(f,{})}),n?(i.random=e,t):e})(y,h,"global"in t?t.global:this==i,t.state)}function p(e){var t,n=e.length,r=this,a=0,i=r.i=r.j=0,o=r.S=[];for(n||(e=[n++]);a<c;)o[a]=a++;for(a=0;a<c;a++)o[a]=o[i=h&i+e[a%n]+(t=o[a])],o[i]=t;(r.g=function(e){for(var t,n=0,a=r.i,i=r.j,o=r.S;e--;)t=o[a=h&a+1],n=n*c+o[h&(o[a]=o[i=h&i+t])+(o[i]=t)];return r.i=a,r.j=i,n})(c)}function m(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function v(e,t){var n,r=[],a=typeof e;if(t&&"object"==a)for(n in e)try{r.push(v(e[n],t-1))}catch(i){}return r.length?r:"string"==a?e:e+"\0"}function g(e,t){for(var n,r=e+"",a=0;a<r.length;)t[h&a]=h&(n^=19*t[h&a])+r.charCodeAt(a++);return b(t)}function b(e){return String.fromCharCode.apply(0,e)}if(i.seedrandom=f,g(i.random(),a),e.exports){e.exports=f;try{o=n(448)}catch(y){}}else void 0===(r=function(){return f}.call(t,n,t,e))||(e.exports=r)}([],Math)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";var r,a,i,o=n(142),s=n(12),c=n(13),u=n.n(c),l=n(65),d=n(20),h=n(147),f=n(149),p=n(67),m=n(171),v=n(172),g={},b={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function y(e){if(!(e in g)){var t=function(e){if(1!==e&&2!==e)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");var t=function(e){if("undefined"!==typeof OffscreenCanvas&&2===e)return new OffscreenCanvas(300,150);if("undefined"!==typeof document)return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}(e);if(t.addEventListener("webglcontextlost",(function(t){t.preventDefault(),delete g[e]}),!1),1===e)return t.getContext("webgl",b)||t.getContext("experimental-webgl",b);return t.getContext("webgl2",b)}(e);if(null===t)return console.log("Could not get context for WebGL version",e),null;g[e]=t}var n=g[e];return n.isContextLost()?(delete g[e],y(e)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),g[e])}function x(e,t){return[t,e]}function w(e){var t=o.Ld.sizeFromShape(e),n=Math.ceil(t/4);return o.Ld.sizeToSquarishShape(n)}function O(e,t){return[Math.max(1,Math.ceil(t/2)),Math.max(1,Math.ceil(e/2))]}function A(e,t){var n,r,a,i,s,c,u,l,d,h=e;return 2===Object(o.md)().getNumber("WEBGL_VERSION")?(n=h.R32F,r=h.R16F,a=h.RGBA16F,i=h.RGBA32F,s=h.RED,c=4,u=1,l=h.HALF_FLOAT,d=h.FLOAT):(n=e.RGBA,r=e.RGBA,a=e.RGBA,i=h.RGBA,s=e.RGBA,c=4,u=4,l=null!=t?t.HALF_FLOAT_OES:null,d=e.FLOAT),{internalFormatFloat:n,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:s,downloadTextureFormat:e.RGBA,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:l,textureTypeFloat:d}}function _(e,t){var n=t();return Object(o.md)().getBool("DEBUG")&&function(e){var t=e.getError();if(t!==e.NO_ERROR)throw new Error("WebGL Error: "+function(e,t){switch(t){case e.NO_ERROR:return"NO_ERROR";case e.INVALID_ENUM:return"INVALID_ENUM";case e.INVALID_VALUE:return"INVALID_VALUE";case e.INVALID_OPERATION:return"INVALID_OPERATION";case e.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case e.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case e.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return"Unknown error code ".concat(t)}}(e,t))}(e),n}!function(e){e[e.DENSE=0]="DENSE",e[e.SHARED_BATCH=1]="SHARED_BATCH"}(r||(r={})),function(e){e[e.RENDER=0]="RENDER",e[e.UPLOAD=1]="UPLOAD",e[e.PIXELS=2]="PIXELS",e[e.DOWNLOAD=3]="DOWNLOAD"}(a||(a={})),function(e){e[e.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",e[e.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",e[e.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",e[e.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",e[e.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"}(i||(i={}));function E(e){return!!(Object(o.md)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||0===e||5.96e-8<Math.abs(e)&&Math.abs(e)<65504)}function S(e,t){return F(e,(function(){return e.getExtension(t)}),'Extension "'+t+'" not supported on this browser.')}function C(e,t){var n=F(e,(function(){return e.createShader(e.FRAGMENT_SHADER)}),"Unable to create fragment WebGLShader.");if(_(e,(function(){return e.shaderSource(n,t)})),_(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=k.exec(t);if(null==n)return console.log("Couldn't parse line number in error: ".concat(t)),void console.log(e);for(var r=+n[1],a=e.split("\n"),i=a.length.toString().length+2,s=a.map((function(e,t){return o.Ld.rightPad((t+1).toString(),i)+e})),c=0,u=0;u<s.length;u++)c=Math.max(s[u].length,c);var l=s.slice(0,r-1),d=s.slice(r-1,r),h=s.slice(r);console.log(l.join("\n")),console.log(t.split("\n")[0]),console.log("%c ".concat(o.Ld.rightPad(d[0],c)),"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join("\n"))}(t,e.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}var T,M,k=/ERROR: [0-9]+:([0-9]+):/g;function R(e,t){if(_(e,(function(){return e.validateProgram(t)})),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Shader program validation failed.")}function I(e,t,n,r,a,i,o){var s=e.getAttribLocation(t,n);return-1!==s&&(_(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,r)})),_(e,(function(){return e.vertexAttribPointer(s,a,e.FLOAT,!1,i,o)})),_(e,(function(){return e.enableVertexAttribArray(s)})),!0)}function j(e,t,n){return F(e,(function(){return e.getUniformLocation(t,n)}),'uniform "'+n+'" not present in program.')}function B(e,t,n){return e.getUniformLocation(t,n)}function L(e,t,n,r){_(e,(function(){return function(e,t,n){G(e,n),_(e,(function(){return e.activeTexture(e.TEXTURE0+n)})),_(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)}))}(e,t,r)})),_(e,(function(){return e.uniform1i(n,r)}))}function N(e,t,n){_(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)})),_(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)}))}function D(e,t){_(e,(function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)})),_(e,(function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)}))}function P(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+function(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case e.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return"unknown error ".concat(t)}}(e,t))}function F(e,t,n){var r=_(e,(function(){return t()}));if(null==r)throw new Error(n);return r}function G(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n){var a="[gl.TEXTURE0, gl.TEXTURE".concat(n,"]");throw new Error("textureUnit must be in ".concat(a,"."))}}function U(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return o.Ld.sizeFromShape(e.slice(0,e.length-t))}function z(e){if(0===e.length)throw Error("Cannot get rows and columns of an empty shape array.");return[e.length>1?e[e.length-2]:1,e[e.length-1]]}function H(e){var t=[1,1,1];return 0===e.length||1===e.length&&1===e[0]||(t=[U(e)].concat(Object(l.a)(z(e)))),t}function V(e){return e%2===0}function W(e,t){if(e=e.slice(-2),t=t.slice(-2),o.Ld.arraysEqual(e,t))return!0;if(!e.length||!t.length)return!0;if(0===e[0]||0===e[1]||0===t[0]||0===t[1])return!0;if(e.length!==t.length){var n=e.slice(-1)[0],r=t.slice(-1)[0];if(n===r)return!0;if(V(n)&&V(r)&&(1===e[0]||1===t[0]))return!0}return e[1]===t[1]&&V(e[0])&&V(t[0])}function J(e,t){return null!=e.getExtension(t)}function X(e){try{if(null!=y(e))return!0}catch(t){return console.log("Error when getting WebGL context: ",t),!1}return!1}function K(e){if(0===e)return!1;var t=y(e);if(1!==e){if(J(t,"EXT_color_buffer_float"))return q(t);var n="EXT_color_buffer_half_float";if(J(t,n)){var r=t.getExtension(n);return function(e,t){var n=A(e,t),r=e.createTexture();e.bindTexture(e.TEXTURE_2D,r);var a=1,i=1;e.texImage2D(e.TEXTURE_2D,0,n.internalFormatHalfFloat,a,i,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);var o=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,o),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,r,0);var s=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(r),e.deleteFramebuffer(o),s}(t,r)}return!1}return!!J(t,"OES_texture_float")&&(!!J(t,"WEBGL_color_buffer_float")&&q(t))}function q(e){var t=A(e),n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n);e.texImage2D(e.TEXTURE_2D,0,t.internalFormatFloat,1,1,0,t.textureFormatFloat,t.textureTypeFloat,null);var r=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,r),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,n,0);var a=e.checkFramebufferStatus(e.FRAMEBUFFER)===e.FRAMEBUFFER_COMPLETE;return e.bindTexture(e.TEXTURE_2D,null),e.bindFramebuffer(e.FRAMEBUFFER,null),e.deleteTexture(n),e.deleteFramebuffer(r),a}function Y(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&o.Ld.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors ")+"in the WebGL backend."}))}))}var Q=Object(o.md)();function Z(){var e,t,n,r,a,i,s,c,u,l;return 2===Object(o.md)().getNumber("WEBGL_VERSION")?(e="#version 300 es",t="in",n="out",r="in",a="texture",i="outputColor",s="out vec4 outputColor;",c="\n      bool isnan_custom(float val) {\n        return (val > 0.0 || val < 0.0) ? false : val != 0.0;\n      }\n\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan_custom(val.x),\n          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));\n      }\n\n      #define isnan(value) isnan_custom(value)\n    ",u="",l="\n      #define round(value) newRound(value)\n      int newRound(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 newRound(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "):(e="",t="attribute",n="varying",r="varying",a="texture2D",i="gl_FragColor",s="",c="\n      #define isnan(value) isnan_custom(value)\n      bool isnan_custom(float val) {\n        return (val > 0. || val < 1. || val == 0.) ? false : true;\n      }\n      bvec4 isnan_custom(vec4 val) {\n        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));\n      }\n    ",u="\n      uniform float INFINITY;\n\n      bool isinf(float val) {\n        return abs(val) == INFINITY;\n      }\n      bvec4 isinf(vec4 val) {\n        return equal(abs(val), vec4(INFINITY));\n      }\n    ",l="\n      int round(float value) {\n        return int(floor(value + 0.5));\n      }\n\n      ivec4 round(vec4 value) {\n        return ivec4(floor(value + vec4(0.5)));\n      }\n    "),{version:e,attribute:t,varyingVs:n,varyingFs:r,texture2D:a,output:i,defineOutput:s,defineSpecialNaN:c,defineSpecialInf:u,defineRound:l}}function $(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"index",r=o.Ld.computeStrides(t);return r.map((function(t,a){var i="int ".concat(e[a]," = ").concat(n," / ").concat(t),o=a===r.length-1?"int ".concat(e[a+1]," = ").concat(n," - ").concat(e[a]," * ").concat(t):"index -= ".concat(e[a]," * ").concat(t);return"".concat(i,"; ").concat(o,";")})).join("")}function ee(e){var t=o.Ld.computeStrides(e).map((function(e){return e.toString()}));return"\n  int getFlatIndex(ivec3 coords) {\n    return coords.x * ".concat(t[0]," + coords.y * ").concat(t[1]," + coords.z;\n  }\n")}Q.registerFlag("HAS_WEBGL",(function(){return Q.getNumber("WEBGL_VERSION")>0})),Q.registerFlag("WEBGL_VERSION",(function(){return X(2)?2:X(1)?1:0})),Q.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",(function(){return!1})),Q.registerFlag("WEBGL_BUFFER_SUPPORTED",(function(){return 2===Q.get("WEBGL_VERSION")})),Q.registerFlag("WEBGL_CPU_FORWARD",(function(){return!0})),Q.registerFlag("WEBGL_FORCE_F16_TEXTURES",(function(){return!1})),Q.registerFlag("WEBGL_PACK",(function(){return Q.getBool("HAS_WEBGL")})),Q.registerFlag("WEBGL_PACK_NORMALIZATION",(function(){return Q.getBool("WEBGL_PACK")})),Q.registerFlag("WEBGL_PACK_CLIP",(function(){return Q.getBool("WEBGL_PACK")})),Q.registerFlag("WEBGL_PACK_DEPTHWISECONV",(function(){return!1})),Q.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",(function(){return Q.getBool("WEBGL_PACK")})),Q.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",(function(){return Q.getBool("WEBGL_PACK")})),Q.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",(function(){return Q.getBool("WEBGL_PACK")})),Q.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",(function(){return Q.getBool("WEBGL_PACK")})),Q.registerFlag("WEBGL_PACK_REDUCE",(function(){return Q.getBool("WEBGL_PACK")})),Q.registerFlag("WEBGL_LAZILY_UNPACK",(function(){return Q.getBool("WEBGL_PACK")})),Q.registerFlag("WEBGL_CONV_IM2COL",(function(){return Q.getBool("WEBGL_PACK")})),Q.registerFlag("WEBGL_MAX_TEXTURE_SIZE",(function(){return function(e){if(null==T){var t=y(e);T=t.getParameter(t.MAX_TEXTURE_SIZE)}return T}(Q.getNumber("WEBGL_VERSION"))})),Q.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",(function(){return function(e){if(null==M){var t=y(e);M=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,M)}(Q.getNumber("WEBGL_VERSION"))})),Q.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",(function(){var e=Q.getNumber("WEBGL_VERSION");return 0===e?0:function(e){if(0===e)return 0;var t=y(e);return J(t,"EXT_disjoint_timer_query_webgl2")&&2===e?2:J(t,"EXT_disjoint_timer_query")?1:0}(e)})),Q.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",(function(){return Q.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!o.jd.isMobile()})),Q.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",(function(){return function(e){if(0===e)return!1;var t=y(e);if(1===e){if(!J(t,"OES_texture_float"))return!1}else if(!J(t,"EXT_color_buffer_float"))return!1;return q(t)}(Q.getNumber("WEBGL_VERSION"))})),Q.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",(function(){return!Q.getBool("WEBGL_FORCE_F16_TEXTURES")&&Q.getBool("WEBGL_RENDER_FLOAT32_CAPABLE")})),Q.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",(function(){return K(Q.getNumber("WEBGL_VERSION"))})),Q.registerFlag("WEBGL_FENCE_API_ENABLED",(function(){return 2===(e=Q.getNumber("WEBGL_VERSION"))&&null!=y(e).fenceSync;var e})),Q.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",(function(){return Q.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0})),Q.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",(function(){return-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never "+"delete) or at least 0, but got ".concat(e,"."))})),Q.registerFlag("WEBGL_FLUSH_THRESHOLD",(function(){return o.jd.isMobile()&&Q.getBool("IS_CHROME")?1:-1}),(function(e){if(e<0&&-1!==e)throw new Error("WEBGL_FLUSH_THRESHOLD must be -1 (indicating never "+"manual flush) or at least 0, but got ".concat(e,"."))}));var te="\n  const float FLOAT_MAX = 1.70141184e38;\n  const float FLOAT_MIN = 1.17549435e-38;\n\n  lowp vec4 encode_float(highp float v) {\n    if (isnan(v)) {\n      return vec4(255, 255, 255, 255);\n    }\n\n    highp float av = abs(v);\n\n    if(av < FLOAT_MIN) {\n      return vec4(0.0, 0.0, 0.0, 0.0);\n    } else if(v > FLOAT_MAX) {\n      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;\n    } else if(v < -FLOAT_MAX) {\n      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;\n    }\n\n    highp vec4 c = vec4(0,0,0,0);\n\n    highp float e = floor(log2(av));\n    highp float m = exp2(fract(log2(av))) - 1.0;\n\n    c[2] = floor(128.0 * m);\n    m -= c[2] / 128.0;\n    c[1] = floor(32768.0 * m);\n    m -= c[1] / 32768.0;\n    c[0] = floor(8388608.0 * m);\n\n    highp float ebias = e + 127.0;\n    c[3] = floor(ebias / 2.0);\n    ebias -= c[3] * 2.0;\n    c[2] += floor(ebias) * 128.0;\n\n    c[3] += 128.0 * step(0.0, -v);\n\n    return c / 255.0;\n  }\n",ne=function e(t){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=r.DENSE;var n=w(t),a=Z();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat($(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getA(rc.x, rc.y, rc.z);\n        }\n\n        ").concat(a.output," = result;\n      }\n    ")},re=function e(t){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=r.DENSE;var n=w(t),a=Z();this.outputShape=t,this.userCode="\n      ivec3 outCoordsFromFlatIndex(int index) {\n        ".concat($(["r","c","d"],t),"\n        return ivec3(r, c, d);\n      }\n\n      void main() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n          vec2(").concat(n[0],", ").concat(n[1],"));\n        int index = 4 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n\n        vec4 result = vec4(0.);\n\n        for (int i=0; i<4; i++) {\n          int flatIndex = index + i;\n          ivec3 rc = outCoordsFromFlatIndex(flatIndex);\n          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));\n        }\n\n        ").concat(a.output," = result;\n      }\n    ")},ae=function e(t){Object(h.a)(this,e),this.variableNames=["A"],this.outTexUsage=a.DOWNLOAD;var n=Z();this.outputShape=t,this.userCode="\n      ".concat(te,"\n\n      void main() {\n        float x = getAAtOutCoords();\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},ie=function e(t){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=a.DOWNLOAD;var n=Z();this.outputShape=t,this.userCode="\n      ".concat(te,"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));\n        ").concat(n.output," = encode_float(x);\n      }\n    ")},oe=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,e),this.variableNames=["A"];var a=Z(),i=Object(s.a)(n,2),o=i[0],c=i[1];this.outputShape=t;var u="result";r&&(u="floor(result * 255. + 0.5)"),this.userCode="\n      ".concat(ee(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        int flatIndex = getFlatIndex(coords);\n        int offset = imod(flatIndex, 4);\n\n        flatIndex = idiv(flatIndex, 4, 1.);\n\n        int r = flatIndex / ").concat(c,";\n        int c = imod(flatIndex, ").concat(c,");\n        vec2 uv = (vec2(c, r) + halfCR) / vec2(").concat(c,".0, ").concat(o,".0);\n        vec4 values = ").concat(a.texture2D,"(A, uv);\n\n        float result;\n\n        if(offset == 0) {\n          result = values[0];\n        } else if(offset == 1) {\n          result = values[1];\n        } else if(offset == 2) {\n          result = values[2];\n        } else {\n          result = values[3];\n        }\n\n        ").concat(a.output," = vec4(").concat(u,", 0., 0., 0.);\n      }\n    ")},se=function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var a=Z(),i=Object(s.a)(n,2),o=i[0],c=i[1];this.outputShape=t;var u="",l="result";r&&(l="floor(result * 255. + 0.5)");for(var d=0;d<=1;d++)for(var f=0;f<=1;f++){var p=2*d+f;u+="\n          localCoords = coords;\n          if(localCoords[2] + ".concat(f," < ").concat(t[2],") {\n            localCoords[2] += ").concat(f,";\n            if(localCoords[1] + ").concat(d," < ").concat(t[1],") {\n              localCoords[1] += ").concat(d,";\n\n              flatIndex = getFlatIndex(localCoords);\n              offset = imod(flatIndex, 4);\n\n              flatIndex = idiv(flatIndex, 4, 1.);\n\n              r = flatIndex / ").concat(c,";\n              c = imod(flatIndex, ").concat(c,");\n              uv = (vec2(c, r) + halfCR) / vec2(").concat(c,".0, ").concat(o,".0);\n              values = ").concat(a.texture2D,"(A, uv);\n\n              if(offset == 0) {\n                result[").concat(p,"] = values[0];\n              } else if(offset == 1) {\n                result[").concat(p,"] = values[1];\n              } else if(offset == 2) {\n                result[").concat(p,"] = values[2];\n              } else {\n                result[").concat(p,"] = values[3];\n              }\n            }\n          }\n        ")}this.userCode="\n      ".concat(ee(t),"\n\n      void main() {\n        ivec3 coords = getOutputCoords();\n\n        vec4 result = vec4(0.);\n        int flatIndex, r, c, offset;\n        ivec3 localCoords;\n        vec2 uv;\n        vec4 values;\n\n        ").concat(u,"\n\n        ").concat(a.output," = ").concat(l,";\n      }\n    ")};function ce(e){var t=Z();return function(e,t){var n=F(e,(function(){return e.createShader(e.VERTEX_SHADER)}),"Unable to create vertex WebGLShader.");if(_(e,(function(){return e.shaderSource(n,t)})),_(e,(function(){return e.compileShader(n)})),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}(e,"".concat(t.version,"\n    precision highp float;\n    ").concat(t.attribute," vec3 clipSpacePos;\n    ").concat(t.attribute," vec2 uv;\n    ").concat(t.varyingVs," vec2 resultUV;\n\n    void main() {\n      gl_Position = vec4(clipSpacePos, 1);\n      resultUV = uv;\n    }"))}function ue(e){return function(e,t){var n=F(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return _(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),_(e,(function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]))}function le(e){return function(e,t){var n=F(e,(function(){return e.createBuffer()}),"Unable to create WebGLBuffer");return _(e,(function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)})),_(e,(function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)})),n}(e,new Uint16Array([0,1,2,2,1,3]))}function de(e,t,n,r,a,i){!function(e,t){var n=Object(o.md)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(e<=0||t<=0){var r="[".concat(e,"x").concat(t,"]");throw new Error("Requested texture size "+r+" is invalid.")}if(e>n||t>n){var a="[".concat(e,"x").concat(t,"]"),i="[".concat(n,"x").concat(n,"]");throw new Error("Requested texture size "+a+" greater than WebGL maximum on this browser / GPU "+i+".")}}(t,n);var s=function(e){return F(e,(function(){return e.createTexture()}),"Unable to create WebGLTexture.")}(e),c=e.TEXTURE_2D;return _(e,(function(){return e.bindTexture(c,s)})),_(e,(function(){return e.texParameteri(c,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)})),_(e,(function(){return e.texParameteri(c,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)})),_(e,(function(){return e.texParameteri(c,e.TEXTURE_MIN_FILTER,e.NEAREST)})),_(e,(function(){return e.texParameteri(c,e.TEXTURE_MAG_FILTER,e.NEAREST)})),_(e,(function(){return e.texImage2D(c,0,r,t,n,0,a,i,null)})),_(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)})),s}function he(e){return e.internalFormatFloat}function fe(e){return e.internalFormatHalfFloat}function pe(e){return e.downloadTextureFormat}function me(e){return e.internalFormatPackedFloat}function ve(e){return e.internalFormatPackedHalfFloat}function ge(e,t,n,r,a,i,o,c){var u=e,l=new Float32Array(function(e,t){var n=O(e,t),r=Object(s.a)(n,2);return r[0]*r[1]*4}(i,o));return u.bindBuffer(u.PIXEL_PACK_BUFFER,t),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,l),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),l}var be=function(){function e(t){Object(h.a)(this,e),this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];var n=Object(o.md)().getNumber("WEBGL_VERSION");null!=t?(this.gl=t,function(e,t){g[e]=t}(n,t)):this.gl=y(n);var r="WEBGL_color_buffer_float",a="EXT_color_buffer_half_float";if(1===Object(o.md)().getNumber("WEBGL_VERSION")){var i="OES_texture_half_float";if(this.textureFloatExtension=S(this.gl,"OES_texture_float"),J(this.gl,i))this.textureHalfFloatExtension=S(this.gl,i);else if(Object(o.md)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),J(this.gl,a))this.colorBufferHalfFloatExtension=S(this.gl,a);else if(Object(o.md)().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",J(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else{if(!J(this.gl,a))throw new Error("GL context does not support color renderable floats");this.colorBufferHalfFloatExtension=this.gl.getExtension(a)}this.vertexBuffer=ue(this.gl),this.indexBuffer=le(this.gl),this.framebuffer=function(e){return F(e,(function(){return e.createFramebuffer()}),"Unable to create WebGLFramebuffer.")}(this.gl),this.textureConfig=A(this.gl,this.textureHalfFloatExtension)}return Object(f.a)(e,[{key:"debug",get:function(){return Object(o.md)().getBool("DEBUG")}},{key:"dispose",value:function(){var e=this;if(!this.disposed){null!=this.program&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),null!=this.outputTexture&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");var t=this.gl;_(t,(function(){return t.finish()})),_(t,(function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)})),_(t,(function(){return t.deleteFramebuffer(e.framebuffer)})),_(t,(function(){return t.bindBuffer(t.ARRAY_BUFFER,null)})),_(t,(function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)})),_(t,(function(){return t.deleteBuffer(e.indexBuffer)})),this.disposed=!0}}},{key:"createFloat32MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=x(t,n),i=Object(s.a)(a,2);return de(e,i[0],i[1],he(r),r.textureFormatFloat,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"createFloat16MatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=x(t,n),i=Object(s.a)(a,2);return de(e,i[0],i[1],fe(r),r.textureFormatFloat,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createUnsignedBytesMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=x(t,n),i=Object(s.a)(a,2);return de(e,i[0],i[1],pe(r),e.RGBA,e.UNSIGNED_BYTE)}(this.gl,e,t,this.textureConfig)}},{key:"uploadPixelDataToTexture",value:function(e,t){this.throwIfDisposed(),function(e,t,n){_(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),n.data instanceof Uint8Array?_(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,n.width,n.height,0,e.RGBA,e.UNSIGNED_BYTE,n.data)})):_(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)})),_(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t)}},{key:"uploadDenseMatrixToTexture",value:function(e,t,n,r){this.throwIfDisposed(),function(e,t,n,r,a,i){var o,s,c;_(e,(function(){return e.bindTexture(e.TEXTURE_2D,t)})),a instanceof Uint8Array?(o=new Uint8Array(n*r*4),s=e.UNSIGNED_BYTE,c=e.RGBA):(o=new Float32Array(n*r*4),s=e.FLOAT,c=i.internalFormatPackedFloat),o.set(a),_(e,(function(){return e.texImage2D(e.TEXTURE_2D,0,c,n,r,0,e.RGBA,s,o)})),_(e,(function(){return e.bindTexture(e.TEXTURE_2D,null)}))}(this.gl,e,t,n,r,this.textureConfig)}},{key:"createFloat16PackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=O(t,n),i=Object(s.a)(a,2);return de(e,i[0],i[1],ve(r),e.RGBA,r.textureTypeHalfFloat)}(this.gl,e,t,this.textureConfig)}},{key:"createPackedMatrixTexture",value:function(e,t){return this.throwIfDisposed(),function(e,t,n,r){var a=O(t,n),i=Object(s.a)(a,2);return de(e,i[0],i[1],me(r),e.RGBA,e.FLOAT)}(this.gl,e,t,this.textureConfig)}},{key:"deleteMatrixTexture",value:function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(D(this.gl,this.framebuffer),this.outputTexture=null),_(this.gl,(function(){return t.gl.deleteTexture(e)}))}},{key:"downloadByteEncodedFloatMatrixFromOutputTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n,r){var a=x(t,n),i=Object(s.a)(a,2),o=i[0],c=i[1],u=new Uint8Array(t*n*4);return _(e,(function(){return e.readPixels(0,0,o,c,r.downloadTextureFormat,e.UNSIGNED_BYTE,u)})),new Float32Array(u.buffer)}(r.gl,t,n,r.textureConfig)}))}},{key:"downloadPackedMatrixFromBuffer",value:function(e,t,n,r,a,i){return ge(this.gl,e,0,0,0,a,i,this.textureConfig)}},{key:"downloadFloat32MatrixFromBuffer",value:function(e,t){return function(e,t,n){var r=e,a=new Float32Array(n);return r.bindBuffer(r.PIXEL_PACK_BUFFER,t),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,a),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),a}(this.gl,e,t)}},{key:"createBufferFromTexture",value:function(e,t,n){this.bindTextureToFrameBuffer(e);var r=function(e,t,n,r){var a=e.createBuffer();_(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,a)}));var i=16*t*n;return _(e,(function(){return e.bufferData(e.PIXEL_PACK_BUFFER,i,e.STREAM_READ)})),_(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,0)})),_(e,(function(){return e.bindBuffer(e.PIXEL_PACK_BUFFER,null)})),a}(this.gl,t,n,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}},{key:"createAndWaitForFence",value:function(){var e=this.createFence(this.gl);return this.pollFence(e)}},{key:"createFence",value:function(e){var t,n,r=this;if(Object(o.md)().getBool("WEBGL_FENCE_API_ENABLED")){var a=e,i=a.fenceSync(a.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),n=function(){var e=a.clientWaitSync(i,0,0);return e===a.ALREADY_SIGNALED||e===a.CONDITION_SATISFIED},t=i}else Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),n=function(){return r.isQueryAvailable(t,Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}):n=function(){return!0};return{query:t,isFencePassed:n}}},{key:"downloadMatrixFromPackedTexture",value:function(e,t,n){var r=this;return this.downloadMatrixDriver(e,(function(){return function(e,t,n){var r=new Float32Array(t*n*4);return _(e,(function(){return e.readPixels(0,0,n,t,e.RGBA,e.FLOAT,r)})),r}(r.gl,t,n)}))}},{key:"createProgram",value:function(e){this.throwIfDisposed();var t=this.gl,n=C(t,e),r=ce(t),a=function(e){return F(e,(function(){return e.createProgram()}),"Unable to create WebGLProgram.")}(t);return _(t,(function(){return t.attachShader(a,r)})),_(t,(function(){return t.attachShader(a,n)})),function(e,t){if(_(e,(function(){return e.linkProgram(t)})),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error("Failed to link vertex and fragment shaders.")}(t,a),this.debug&&R(t,a),this.vertexAttrsAreBound||(this.setProgram(a),this.vertexAttrsAreBound=function(e,t,n){return _(e,(function(){return e.bindBuffer(e.ARRAY_BUFFER,n)})),I(e,t,"clipSpacePos",n,3,20,0)&&I(e,t,"uv",n,2,20,12)}(t,this.program,this.vertexBuffer)),a}},{key:"deleteProgram",value:function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&_(this.gl,(function(){return t.gl.deleteProgram(e)}))}},{key:"setProgram",value:function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.debug&&R(this.gl,this.program),_(this.gl,(function(){return t.gl.useProgram(e)}))}},{key:"getUniformLocation",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.throwIfDisposed(),n?j(this.gl,e,t):B(this.gl,e,t)}},{key:"getAttributeLocation",value:function(e,t){var n=this;return this.throwIfDisposed(),_(this.gl,(function(){return n.gl.getAttribLocation(e,t)}))}},{key:"getUniformLocationNoThrow",value:function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}},{key:"setInputMatrixTexture",value:function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),L(this.gl,e,t,n)}},{key:"setOutputMatrixTexture",value:function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)}},{key:"setOutputPackedMatrixTexture",value:function(e,t,n){this.throwIfDisposed();var r=O(t,n),a=Object(s.a)(r,2),i=a[0],o=a[1];this.setOutputMatrixTextureDriver(e,i,o)}},{key:"setOutputMatrixWriteRegion",value:function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)}},{key:"setOutputPackedMatrixWriteRegion",value:function(e,t,n,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}},{key:"debugValidate",value:function(){null!=this.program&&R(this.gl,this.program),P(this.gl)}},{key:"executeProgram",value:function(){this.throwIfDisposed(),this.throwIfNoProgram();var e=this.gl;this.debug&&this.debugValidate(),_(e,(function(){return e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0)}))}},{key:"blockUntilAllProgramsCompleted",value:function(){var e=this;this.throwIfDisposed(),_(this.gl,(function(){return e.gl.finish()}))}},{key:"getQueryTimerExtension",value:function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=S(this.gl,2===Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}},{key:"getQueryTimerExtensionWebGL2",value:function(){return this.getQueryTimerExtension()}},{key:"getQueryTimerExtensionWebGL1",value:function(){return this.getQueryTimerExtension()}},{key:"beginQuery",value:function(){if(2===Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}var r=this.getQueryTimerExtensionWebGL1(),a=r.createQueryEXT();return r.beginQueryEXT(r.TIME_ELAPSED_EXT,a),a}},{key:"endQuery",value:function(){if(2!==Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")){var e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}else{var t=this.gl,n=this.getQueryTimerExtensionWebGL2();t.endQuery(n.TIME_ELAPSED_EXT)}}},{key:"waitForQueryAndGetTime",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.Ld.repeatedTry((function(){return n.disposed||n.isQueryAvailable(t,Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}));case 2:return e.abrupt("return",this.getQueryTime(t,Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")));case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getQueryTime",value:function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}},{key:"isQueryAvailable",value:function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}var i=this.getQueryTimerExtensionWebGL1(),o=i.getQueryObjectEXT(e,i.QUERY_RESULT_AVAILABLE_EXT);return null==this.disjoint&&(this.disjoint=this.gl.getParameter(i.GPU_DISJOINT_EXT)),o&&!this.disjoint}},{key:"pollFence",value:function(e){var t=this;return new Promise((function(n){t.addItemToPoll((function(){return e.isFencePassed()}),(function(){return n()}))}))}},{key:"pollItems",value:function(){for(var e=function(e){for(var t=0;t<e.length;++t){if(!e[t]())break}return t-1}(this.itemsToPoll.map((function(e){return e.isDoneFn}))),t=0;t<=e;++t){(0,this.itemsToPoll[t].resolveFn)()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}},{key:"addItemToPoll",value:function(e,t){var n=this;this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1||o.Ld.repeatedTry((function(){return n.pollItems(),0===n.itemsToPoll.length}))}},{key:"bindTextureToFrameBuffer",value:function(e){this.throwIfDisposed(),N(this.gl,e,this.framebuffer),this.debug&&P(this.gl)}},{key:"unbindTextureToFrameBuffer",value:function(){null!=this.outputTexture?(N(this.gl,this.outputTexture,this.framebuffer),this.debug&&P(this.gl)):D(this.gl,this.framebuffer)}},{key:"downloadMatrixDriver",value:function(e,t){this.bindTextureToFrameBuffer(e);var n=t();return this.unbindTextureToFrameBuffer(),n}},{key:"setOutputMatrixTextureDriver",value:function(e,t,n){this.throwIfDisposed();var r=this.gl;N(r,e,this.framebuffer),this.debug&&P(r),this.outputTexture=e,_(r,(function(){return r.viewport(0,0,t,n)})),_(r,(function(){return r.scissor(0,0,t,n)}))}},{key:"setOutputMatrixWriteRegionDriver",value:function(e,t,n,r){var a=this;this.throwIfDisposed(),_(this.gl,(function(){return a.gl.scissor(e,t,n,r)}))}},{key:"throwIfDisposed",value:function(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}},{key:"throwIfNoProgram",value:function(){if(null==this.program)throw new Error("No GPU program is currently set.")}}]),e}();var ye=o.cd.getBroadcastDims;function xe(e,t,n,r){var a=[];e.forEach((function(e){var t=o.Ld.sizeFromShape(e.shapeInfo.logicalShape);e.shapeInfo.isUniform?a.push("uniform float ".concat(e.name).concat(t>1?"[".concat(t,"]"):"",";")):(a.push("uniform sampler2D ".concat(e.name,";")),a.push("uniform int offset".concat(e.name,";")))}));var i,s,c=a.join("\n"),u=e.map((function(e){return function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r="";r+=n?Oe(e):we(e);var a=e.shapeInfo.logicalShape,i=t.logicalShape;a.length<=i.length&&(r+=n?Me(e,t):ke(e,t));return r}(e,t,r)})).join("\n"),l=t.texShape,d=Z(),h=function(e){return"\n    float sampleTexture(sampler2D textureSampler, vec2 uv) {\n      return ".concat(e.texture2D,"(textureSampler, uv).r;\n    }\n  ")}(d),f=function(e){return"".concat(e.version,"\n    precision highp float;\n    precision highp int;\n    precision highp sampler2D;\n    ").concat(e.varyingFs," vec2 resultUV;\n    ").concat(e.defineOutput,"\n    const vec2 halfCR = vec2(0.5, 0.5);\n\n    struct ivec5\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n    };\n\n    struct ivec6\n    {\n      int x;\n      int y;\n      int z;\n      int w;\n      int u;\n      int v;\n    };\n\n    uniform float NAN;\n    ").concat(e.defineSpecialNaN,"\n    ").concat(e.defineSpecialInf,"\n    ").concat(e.defineRound,"\n\n    int imod(int x, int y) {\n      return x - y * (x / y);\n    }\n\n    int idiv(int a, int b, float sign) {\n      int res = a / b;\n      int mod = imod(a, b);\n      if (sign < 0. && mod != 0) {\n        res -= 1;\n      }\n      return res;\n    }\n\n    //Based on the work of Dave Hoskins\n    //https://www.shadertoy.com/view/4djSRW\n    #define HASHSCALE1 443.8975\n    float random(float seed){\n      vec2 p = resultUV * seed;\n      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);\n      p3 += dot(p3, p3.yzx + 19.19);\n      return fract((p3.x + p3.y) * p3.z);\n    }\n\n    ").concat(Ae,"\n    ").concat(_e,"\n    ").concat(Ee,"\n  ")}(d);return t.isPacked?(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(1===n[0])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.x * ".concat(n[1],".0);\n      }\n    ");if(1===n[1])return"\n      int getOutputCoords() {\n        return 2 * int(resultUV.y * ".concat(n[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      return 2 * (resTexRC.x * ").concat(n[1]," + resTexRC.y);\n    }\n  ")}(0,t);case 2:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)];if(o.Ld.arraysEqual(e,t))return"\n      ivec2 getOutputCoords() {\n        return 2 * ivec2(resultUV.yx * vec2(".concat(n[0],", ").concat(n[1],"));\n      }\n    ");var r=Math.ceil(e[1]/2);return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[2]/2),a=r*Math.ceil(e[1]/2);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec3(b, r, c);\n    }\n  ")}(e,t);default:return function(e,t){for(var n=[Math.ceil(t[0]/2),Math.ceil(t[1]/2)],r=Math.ceil(e[e.length-1]/2),a=r*Math.ceil(e[e.length-2]/2),i=a,o="",s="b, r, c",c=2;c<e.length-1;c++)i*=e[e.length-c-1],o="\n      int b".concat(c," = index / ").concat(i,";\n      index -= b").concat(c," * ").concat(i,";\n    ")+o,s="b".concat(c,", ")+s;return"\n    ivec".concat(e.length," getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(").concat(n[0],", ").concat(n[1],"));\n      int index = resTexRC.x * ").concat(n[1]," + resTexRC.y;\n\n      ").concat(o,"\n\n      int b = index / ").concat(a,";\n      index -= b * ").concat(a,";\n\n      int r = 2 * (index / ").concat(r,");\n      int c = imod(index, ").concat(r,") * 2;\n\n      return ivec").concat(e.length,"(").concat(s,");\n    }\n  ")}(e,t)}}(t.logicalShape,l),s=function(e){return"\n    void setOutput(vec4 val) {\n      ".concat(e.output," = val;\n    }\n  ")}(d)):(i=function(e,t){switch(e.length){case 0:return"\n    int getOutputCoords() {\n      return 0;\n    }\n  ";case 1:return function(e,t){if(1===t[0])return"\n      int getOutputCoords() {\n        return int(resultUV.x * ".concat(t[1],".0);\n      }\n    ");if(1===t[1])return"\n      int getOutputCoords() {\n        return int(resultUV.y * ".concat(t[0],".0);\n      }\n    ");return"\n    int getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      return resTexRC.x * ").concat(t[1]," + resTexRC.y;\n    }\n  ")}(0,t);case 2:return function(e,t){if(o.Ld.arraysEqual(e,t))return"\n      ivec2 getOutputCoords() {\n        return ivec2(resultUV.yx * vec2(".concat(t[0],", ").concat(t[1],"));\n      }\n    ");if(1===e[1])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(index, 0);\n      }\n    ");if(1===e[0])return"\n      ivec2 getOutputCoords() {\n        ivec2 resTexRC = ivec2(resultUV.yx *\n                               vec2(".concat(t[0],", ").concat(t[1],"));\n        int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n        return ivec2(0, index);\n      }\n    ");return"\n    ivec2 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      int r = index / ").concat(e[1],";\n      int c = index - r * ").concat(e[1],";\n      return ivec2(r, c);\n    }\n  ")}(e,t);case 3:return function(e,t){var n=$(["r","c","d"],e);return"\n    ivec3 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n                             vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec3(r, c, d);\n    }\n  ")}(e,t);case 4:return function(e,t){var n=$(["r","c","d","d2"],e);return"\n    ivec4 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n      ").concat(n,"\n      return ivec4(r, c, d, d2);\n    }\n  ")}(e,t);case 5:return function(e,t){var n=$(["r","c","d","d2","d3"],e);return"\n    ivec5 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx * vec2(".concat(t[0],",\n                             ").concat(t[1],"));\n\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec5 outShape = ivec5(r, c, d, d2, d3);\n      return outShape;\n    }\n  ")}(e,t);case 6:return function(e,t){var n=$(["r","c","d","d2","d3","d4"],e);return"\n    ivec6 getOutputCoords() {\n      ivec2 resTexRC = ivec2(resultUV.yx *\n        vec2(".concat(t[0],", ").concat(t[1],"));\n      int index = resTexRC.x * ").concat(t[1]," + resTexRC.y;\n\n      ").concat(n,"\n\n      ivec6 result = ivec6(r, c, d, d2, d3, d4);\n      return result;\n    }\n  ")}(e,t);default:throw new Error("".concat(e.length,"-D output sampling is not yet supported"))}}(t.logicalShape,l),s=function(e){return"\n    void setOutput(float val) {\n      ".concat(e.output," = vec4(val, 0, 0, 0);\n    }\n  ")}(d)),r&&(f+=Se),[f,h,s,c,i,u,n].join("\n")}function we(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"float ".concat(n,"() {return ").concat(t,";}");var r=Object(s.a)(e.shapeInfo.texShape,2),a=r[0],i=r[1];if(1===a&&1===i)return"\n      float ".concat(n,"() {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=Object(s.a)(e.shapeInfo.texShape,2),c=o[0],u=o[1],l=Ce(t);return"\n    float ".concat(n,"() {\n      vec2 uv = uvFromFlat(").concat(c,", ").concat(u,", ").concat(l,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1);if(e.shapeInfo.isUniform)return"\n      float ".concat(n,"(int index) {\n        ").concat(Te(e),"\n      }\n    ");var r=e.shapeInfo.texShape,a=r[0],i=r[1];if(1===i&&1===a)return"\n      float ".concat(n,"(int index) {\n        return sampleTexture(").concat(t,", halfCR);\n      }\n    ");var o=Ce(t);if(1===i)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2(0.5, (float(index + ").concat(o,") + 0.5) / ").concat(a,".0);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");if(1===a)return"\n      float ".concat(n,"(int index) {\n        vec2 uv = vec2((float(index + ").concat(o,") + 0.5) / ").concat(i,".0, 0.5);\n        return sampleTexture(").concat(t,", uv);\n      }\n    ");return"\n    float ".concat(n,"(int index) {\n      vec2 uv = uvFromFlat(").concat(a,", ").concat(i,", index + ").concat(o,");\n      return sampleTexture(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape;if(null!=a&&o.Ld.arraysEqual(t,a)){var i=a[0],s=a[1];return"\n    float ".concat(r,"(int row, int col) {\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(i,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}var c=o.Ld.squeezeShape(t),u=c.newShape,l=c.keptDims,d=u;if(d.length<t.length){var h=Ie(e,d),f=["row","col"];return"\n      ".concat(we(h),"\n      float ").concat(r,"(int row, int col) {\n        return ").concat(r,"(").concat(je(f,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col) {\n        int index = round(dot(vec2(row, col), vec2(").concat(t[1],", 1)));\n        ").concat(Te(e),"\n      }\n    ");var p=a[0],m=a[1],v=Ce(n);if(1===m)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2(0.5, (index + 0.5) / ").concat(p,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");if(1===p)return"\n    float ".concat(r,"(int row, int col) {\n      float index = dot(vec3(row, col, ").concat(v,"), vec3(").concat(t[1],", 1, 1));\n      vec2 uv = vec2((index + 0.5) / ").concat(m,".0, 0.5);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");return"\n  float ".concat(r,"(int row, int col) {\n    // Explicitly use integer operations as dot() only works on floats.\n    int index = row * ").concat(t[1]," + col + ").concat(v,";\n    vec2 uv = uvFromFlat(").concat(p,", ").concat(m,", index);\n    return sampleTexture(").concat(n,", uv);\n  }\n")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[1]*t[2],i=t[2],s=o.Ld.squeezeShape(t),c=s.newShape,u=s.keptDims,l=c;if(l.length<t.length){var d=Ie(e,l),h=["row","col","depth"];return"\n        ".concat(we(d),"\n        float ").concat(r,"(int row, int col, int depth) {\n          return ").concat(r,"(").concat(je(h,u),");\n        }\n      ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth) {\n        int index = round(dot(vec3(row, col, depth),\n                          vec3(").concat(a,", ").concat(i,", 1)));\n        ").concat(Te(e),"\n      }\n    ");var f=e.shapeInfo.texShape,p=f[0],m=f[1],v=e.shapeInfo.flatOffset;if(m===a&&null==v)return"\n        float ".concat(r,"(int row, int col, int depth) {\n          float texR = float(row);\n          float texC = dot(vec2(col, depth), vec2(").concat(i,", 1));\n          vec2 uv = (vec2(texC, texR) + halfCR) /\n                     vec2(").concat(m,".0, ").concat(p,".0);\n          return sampleTexture(").concat(n,", uv);\n        }\n      ");if(m===i&&null==v)return"\n    float ".concat(r,"(int row, int col, int depth) {\n      float texR = dot(vec2(row, col), vec2(").concat(t[1],", 1));\n      float texC = float(depth);\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(m,".0, ").concat(p,".0);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ");var g=Ce(n);return"\n      float ".concat(r,"(int row, int col, int depth) {\n        // Explicitly use integer operations as dot() only works on floats.\n        int index = row * ").concat(a," + col * ").concat(i," + depth + ").concat(g,";\n        vec2 uv = uvFromFlat(").concat(p,", ").concat(m,", index);\n        return sampleTexture(").concat(n,", uv);\n      }\n  ")}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[3],i=t[2]*a,s=t[1]*i,c=o.Ld.squeezeShape(t),u=c.newShape,l=c.keptDims;if(u.length<t.length){var d=Ie(e,u),h=["row","col","depth","depth2"];return"\n      ".concat(we(d),"\n      float ").concat(r,"(int row, int col, int depth, int depth2) {\n        return ").concat(r,"(").concat(je(h,l),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        int index = round(dot(vec4(row, col, depth, depth2),\n                          vec4(").concat(s,", ").concat(i,", ").concat(a,", 1)));\n        ").concat(Te(e),"\n      }\n    ");var f=e.shapeInfo.flatOffset,p=e.shapeInfo.texShape,m=p[0],v=p[1];if(v===s&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = float(row);\n        float texC =\n            dot(vec3(col, depth, depth2),\n                vec3(").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(v===a&&null==f)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2) {\n        float texR = dot(vec3(row, col, depth),\n                         vec3(").concat(t[1]*t[2],", ").concat(t[2],", 1));\n        float texC = float(depth2);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(v,".0, ").concat(m,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var g=Ce(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(s," + col * ").concat(i," +\n          depth * ").concat(a," + depth2;\n      vec2 uv = uvFromFlat(").concat(m,", ").concat(v,", index + ").concat(g,");\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 5:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=t[4],i=t[3]*a,s=t[2]*i,c=t[1]*s,u=o.Ld.squeezeShape(t),l=u.newShape,d=u.keptDims;if(l.length<t.length){var h=Ie(e,l),f=["row","col","depth","depth2","depth3"];return"\n      ".concat(we(h),"\n      float ").concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        return ").concat(r,"(").concat(je(f,d),");\n      }\n    ")}if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float index = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(c,", ").concat(s,", ").concat(i,", ").concat(a,")) +\n          depth3;\n        ").concat(Te(e),"\n      }\n    ");var p=e.shapeInfo.flatOffset,m=e.shapeInfo.texShape,v=m[0],g=m[1];if(g===c&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n                         vec4(").concat(s,", ").concat(i,", ").concat(a,", 1));\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(g===a&&null==p)return"\n      float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n        float texR = dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3],",\n               ").concat(t[2]*t[3],", ").concat(t[3],", 1));\n        int texC = depth3;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(g,".0, ").concat(v,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var b=Ce(n);return"\n    float ".concat(r,"(int row, int col, int depth, int depth2, int depth3) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(c," + col * ").concat(s," + depth * ").concat(i," +\n          depth2 * ").concat(a," + depth3 + ").concat(b,";\n      vec2 uv = uvFromFlat(").concat(v,", ").concat(g,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);case 6:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=o.Ld.squeezeShape(t),i=a.newShape,s=a.keptDims;if(i.length<t.length){var c=Ie(e,i),u=["row","col","depth","depth2","depth3","depth4"];return"\n      ".concat(we(c),"\n      float ").concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        return ").concat(r,"(").concat(je(u,s),");\n      }\n    ")}var l=t[5],d=t[4]*l,h=t[3]*d,f=t[2]*h,p=t[1]*f;if(e.shapeInfo.isUniform)return"\n      float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n        int index = round(dot(\n          vec4(row, col, depth, depth2),\n          vec4(").concat(p,", ").concat(f,", ").concat(h,", ").concat(d,")) +\n          dot(\n            vec2(depth3, depth4),\n            vec2(").concat(l,", 1)));\n        ").concat(Te(e),"\n      }\n    ");var m=e.shapeInfo.flatOffset,v=e.shapeInfo.texShape,g=v[0],b=v[1];if(b===p&&null==m)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        int texR = row;\n        float texC = dot(vec4(col, depth, depth2, depth3),\n          vec4(").concat(f,", ").concat(h,", ").concat(d,", ").concat(l,")) +\n               float(depth4);\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                   vec2(").concat(b,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");if(b===l&&null==m)return"\n      float ".concat(r,"(int row, int col, int depth,\n                    int depth2, int depth3, int depth4) {\n        float texR = dot(vec4(row, col, depth, depth2),\n          vec4(").concat(t[1]*t[2]*t[3]*t[4],",\n               ").concat(t[2]*t[3]*t[4],",\n               ").concat(t[3]*t[4],",\n               ").concat(t[4],")) + float(depth3);\n        int texC = depth4;\n        vec2 uv = (vec2(texC, texR) + halfCR) /\n                  vec2(").concat(b,".0, ").concat(g,".0);\n        return sampleTexture(").concat(n,", uv);\n      }\n    ");var y=Ce(n);return"\n    float ".concat(r,"(int row, int col, int depth,\n                  int depth2, int depth3, int depth4) {\n      // Explicitly use integer operations as dot() only works on floats.\n      int index = row * ").concat(p," + col * ").concat(f," + depth * ").concat(h," +\n          depth2 * ").concat(d," + depth3 * ").concat(l," + depth4 + ").concat(y,";\n      vec2 uv = uvFromFlat(").concat(g,", ").concat(b,", index);\n      return sampleTexture(").concat(n,", uv);\n    }\n  ")}(e);default:throw new Error("".concat(t.length,"-D input sampling")+" is not yet supported")}}function Oe(e){switch(e.shapeInfo.logicalShape.length){case 0:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=Z();return"\n    vec4 ".concat(n,"() {\n      return ").concat(r.texture2D,"(").concat(t,", halfCR);\n    }\n  ")}(e);case 1:return function(e){var t=e.name,n="get"+t.charAt(0).toUpperCase()+t.slice(1),r=e.shapeInfo.texShape,a=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)],i=Z();return"\n    vec4 ".concat(n,"(int index) {\n      vec2 uv = packedUVfrom1D(\n        ").concat(a[0],", ").concat(a[1],", index);\n      return ").concat(i.texture2D,"(").concat(t,", uv);\n    }\n  ")}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=a[0],s=a[1],c=Z();if(null!=a&&o.Ld.arraysEqual(t,a))return"\n      vec4 ".concat(r,"(int row, int col) {\n        vec2 uv = (vec2(col, row) + halfCR) / vec2(").concat(s,".0, ").concat(i,".0);\n\n        return ").concat(c.texture2D,"(").concat(n,", uv);\n      }\n    ");var u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],l=Math.ceil(t[1]/2);return"\n    vec4 ".concat(r,"(int row, int col) {\n      vec2 uv = packedUVfrom2D(").concat(l,", ").concat(u[0],", ").concat(u[1],", row, col);\n      return ").concat(c.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);case 3:return function(e){var t=e.shapeInfo.logicalShape,n=e.name,r="get"+n.charAt(0).toUpperCase()+n.slice(1),a=e.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(1===t[0]){var o=[1,2],s=Ie(e,t.slice(1)),c=["b","row","col"];return"\n        ".concat(Oe(s),"\n        vec4 ").concat(r,"(int b, int row, int col) {\n          return ").concat(r,"(").concat(je(c,o),");\n        }\n      ")}var u=i[0],l=i[1],d=Math.ceil(t[2]/2),h=d*Math.ceil(t[1]/2),f=Z();return"\n    vec4 ".concat(r,"(int b, int row, int col) {\n      vec2 uv = packedUVfrom3D(\n        ").concat(u,", ").concat(l,", ").concat(h,", ").concat(d,", b, row, col);\n      return ").concat(f.texture2D,"(").concat(n,", uv);\n    }\n  ")}(e);default:return function(e){for(var t=e.shapeInfo.logicalShape,n=t.length,r=e.name,a="get"+r.charAt(0).toUpperCase()+r.slice(1),i=e.shapeInfo.texShape,o=[Math.ceil(i[0]/2),Math.ceil(i[1]/2)],s=o[0],c=o[1],u=Math.ceil(t[n-1]/2),l=u*Math.ceil(t[n-2]/2),d="int b, int row, int col",h="b * ".concat(l," + (row / 2) * ").concat(u," + (col / 2)"),f=2;f<n-1;f++)d="int b".concat(f,", ")+d,l*=t[n-f-1],h="b".concat(f," * ").concat(l," + ")+h;var p=Z();return"\n    vec4 ".concat(a,"(").concat(d,") {\n      int index = ").concat(h,";\n      int texR = index / ").concat(c,";\n      int texC = index - texR * ").concat(c,";\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(").concat(c,", ").concat(s,");\n      return ").concat(p.texture2D,"(").concat(r,", uv);\n    }\n  ")}(e)}}var Ae="\nvec2 uvFromFlat(int texNumR, int texNumC, int index) {\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\nvec2 packedUVfrom1D(int texNumR, int texNumC, int index) {\n  int texelIndex = index / 2;\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",_e="\nvec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,\n  int texNumC, int row, int col) {\n  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = texelIndex / texNumC;\n  int texC = texelIndex - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Ee="\nvec2 packedUVfrom3D(int texNumR, int texNumC,\n    int texelsInBatch, int texelsInLogicalRow, int b,\n    int row, int col) {\n  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);\n  int texR = index / texNumC;\n  int texC = index - texR * texNumC;\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\n}\n",Se="\n  float getChannel(vec4 frag, vec2 innerDims) {\n    vec2 modCoord = mod(innerDims, 2.);\n    return modCoord.x == 0. ?\n      (modCoord.y == 0. ? frag.r : frag.g) :\n      (modCoord.y == 0. ? frag.b : frag.a);\n  }\n  float getChannel(vec4 frag, int dim) {\n    float modCoord = mod(float(dim), 2.);\n    return modCoord == 0. ? frag.r : frag.g;\n  }\n";function Ce(e){return"offset".concat(e)}function Te(e){var t=e.name,n=o.Ld.sizeFromShape(e.shapeInfo.logicalShape);return n<2?"return ".concat(t,";"):"\n    for (int i = 0; i < ".concat(n,"; i++) {\n      if (i == index) {\n        return ").concat(t,"[i];\n      }\n    }\n  ")}function Me(e,t){var n,r=e.name,a=r.charAt(0).toUpperCase()+r.slice(1),i="get"+a+"AtOutCoords",s=e.shapeInfo.logicalShape.length,c=t.logicalShape.length,u=ye(e.shapeInfo.logicalShape,t.logicalShape),l=Re(c),d=c-s,h=["x","y","z","w","u","v"];n=0===s?"":c<2&&u.length>=1?"coords = 0;":u.map((function(e){return"coords.".concat(h[e+d]," = 0;")})).join("\n");var f="";f=c<2&&s>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(h[t+d])})).join(", ");var p="return outputValue;",m=1===o.Ld.sizeFromShape(e.shapeInfo.logicalShape),v=1===o.Ld.sizeFromShape(t.logicalShape);if(1!==s||m||v){if(m&&!v)p=1===c?"\n        return vec4(outputValue.x, outputValue.x, 0., 0.);\n      ":"\n        return vec4(outputValue.x);\n      ";else if(u.length){var g=s-2,b=s-1;u.indexOf(g)>-1&&u.indexOf(b)>-1?p="return vec4(outputValue.x);":u.indexOf(g)>-1?p="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":u.indexOf(b)>-1&&(p="return vec4(outputValue.xx, outputValue.zz);")}}else p="\n      return vec4(outputValue.xy, outputValue.xy);\n    ";return"\n    vec4 ".concat(i,"() {\n      ").concat(l," coords = getOutputCoords();\n      ").concat(n,"\n      vec4 outputValue = get").concat(a,"(").concat(f,");\n      ").concat(p,"\n    }\n  ")}function ke(e,t){var n=e.name,r=n.charAt(0).toUpperCase()+n.slice(1),a="get"+r+"AtOutCoords",i=t.texShape,s=e.shapeInfo.texShape,c=e.shapeInfo.logicalShape.length,u=t.logicalShape.length;if(!e.shapeInfo.isUniform&&c===u&&null==e.shapeInfo.flatOffset&&o.Ld.arraysEqual(s,i))return"\n      float ".concat(a,"() {\n        return sampleTexture(").concat(n,", resultUV);\n      }\n    ");var l,d=Re(u),h=ye(e.shapeInfo.logicalShape,t.logicalShape),f=u-c,p=["x","y","z","w","u","v"];l=0===c?"":u<2&&h.length>=1?"coords = 0;":h.map((function(e){return"coords.".concat(p[e+f]," = 0;")})).join("\n");var m="";return m=u<2&&c>0?"coords":e.shapeInfo.logicalShape.map((function(e,t){return"coords.".concat(p[t+f])})).join(", "),"\n    float ".concat(a,"() {\n      ").concat(d," coords = getOutputCoords();\n      ").concat(l,"\n      return get").concat(r,"(").concat(m,");\n    }\n  ")}function Re(e){if(e<=1)return"int";if(2===e)return"ivec2";if(3===e)return"ivec3";if(4===e)return"ivec4";if(5===e)return"ivec5";if(6===e)return"ivec6";throw Error("GPU for rank ".concat(e," is not yet supported"))}function Ie(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function je(e,t){return t.map((function(t){return e[t]})).join(", ")}function Be(e,t,n,r){var a=t.userCode,i=n.map((function(e,n){var r={logicalShape:e.shape,texShape:e.isUniform?null:e.texData.texShape,isUniform:e.isUniform,isPacked:!e.isUniform&&e.texData.isPacked,flatOffset:null};return null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0&&(r.flatOffset=e.texData.slice.flatOffset),{name:t.variableNames[n],shapeInfo:r}})),s=i.map((function(e){return e.shapeInfo})),c={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},u=xe(i,c,a,t.packedInputs),l=e.createProgram(u),d=null,h=e.getUniformLocation(l,"NAN",!1);1===Object(o.md)().getNumber("WEBGL_VERSION")&&(d=e.getUniformLocation(l,"INFINITY",!1));for(var f={},p=0;p<t.variableNames.length;p++){var m=t.variableNames[p];f[m]=e.getUniformLocation(l,m,false),f["offset".concat(m)]=e.getUniformLocation(l,"offset".concat(m),false)}return{program:t,source:u,webGLProgram:l,uniformLocations:f,inShapeInfos:s,outShapeInfo:c,infLoc:d,nanLoc:h}}function Le(e,t){if(e.length!==t.length)throw Error("Binary was compiled with ".concat(e.length," inputs, but ")+"was executed with ".concat(t.length," inputs"));e.forEach((function(e,n){var r=e.logicalShape,a=t[n],i=a.shape;if(!o.Ld.arraysEqual(r,i))throw Error("Binary was compiled with different shapes than "+"the current args. Shapes ".concat(r," and ").concat(i," must match"));if(!e.isUniform||!a.isUniform){var s=e.texShape,c=a.isUniform?null:a.texData.texShape;if(!o.Ld.arraysEqual(s,c))throw Error("Binary was compiled with different texture shapes than the"+" current args. Shape ".concat(s," and ").concat(c," must match"))}}))}function Ne(e,t,n,r,a){Le(t.inShapeInfos,n),Le([t.outShapeInfo],[r]);var i=r.texData.texture,s=r.texData.texShape;r.texData.isPacked?e.setOutputPackedMatrixTexture(i,s[0],s[1]):e.setOutputMatrixTexture(i,s[0],s[1]),e.setProgram(t.webGLProgram),1===Object(o.md)().getNumber("WEBGL_VERSION")&&null!==t.infLoc&&e.gl.uniform1f(t.infLoc,1/0),null!==t.nanLoc&&e.gl.uniform1f(t.nanLoc,NaN),n.forEach((function(n,r){var a=t.program.variableNames[r],i=t.uniformLocations[a],s=t.uniformLocations["offset".concat(a)];if(null!=i)if(n.isUniform)if(o.Ld.sizeFromShape(n.shape)<2)e.gl.uniform1f(i,n.uniformValues[0]);else{var c=n.uniformValues;c instanceof Float32Array||(c=new Float32Array(c)),e.gl.uniform1fv(i,c)}else null!=n.texData.slice&&null!=s&&e.gl.uniform1i(s,n.texData.slice.flatOffset),e.setInputMatrixTexture(n.texData.texture,i,r)})),null!=a&&a(e,t.webGLProgram),e.executeProgram()}function De(e,t,n){var r="";t.concat(n).forEach((function(e){var t=null!=e.texData&&null!=e.texData.slice&&e.texData.slice.flatOffset>0,n=e.isUniform?"uniform":e.texData.texShape;r+="".concat(e.shape,"_").concat(n,"_").concat(t)}));var a=e.userCode,i=e.constructor.name;return i+="_"+r+"_"+a}function Pe(e){return function(t,n,r,a,i){var s=o.cd.assertAndGetBroadcastShape(t,n),c=s.length,u=o.Ld.computeStrides(s),l=o.Ld.sizeFromShape(s),d=o.Ld.getTypedArrayFromDType(i,l),h=t.length,f=n.length,p=o.Ld.computeStrides(t),m=o.Ld.computeStrides(n),v=o.cd.getBroadcastDims(t,s),g=o.cd.getBroadcastDims(n,s);if(v.length+g.length===0)for(var b=0;b<d.length;++b)d[b]=e(r[b%r.length],a[b%a.length]);else for(var y=function(t){var n=o.Ld.indexToLoc(t,c,u),i=n.slice(-h);v.forEach((function(e){return i[e]=0}));var s=o.Ld.locToIndex(i,h,p),l=n.slice(-f);g.forEach((function(e){return l[e]=0}));var b=o.Ld.locToIndex(l,f,m);d[t]=e(r[s],a[b])},x=0;x<d.length;++x)y(x);return[d,s]}}function Fe(e,t){Array.isArray(e)||(e=[e]),e.forEach((function(e){null!=e&&o.Ld.assert("complex64"!==e.dtype,(function(){return"".concat(t," does not support complex64 tensors in the CPU backend.")}))}))}function Ge(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.data.get(r.dataId).values,o=n.data.get(a.dataId).values,s=n.makeTensorInfo(r.shape,"complex64");return n.data.get(s.dataId).complexTensorInfos={real:n.makeTensorInfo(r.shape,"float32",i),imag:n.makeTensorInfo(a.shape,"float32",o)},s}o.y;function Ue(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"float32";if("complex64"===n){var r=Ue(e,t,"float32"),a=Ue(e,t,"float32");return Ge({inputs:{real:r,imag:a},backend:e})}var i=o.Ld.makeZerosTypedArray(o.Ld.sizeFromShape(t),n);return e.makeTensorInfo(t,n,i)}function ze(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}o.ob;function He(e){var t=e.inputs,n=e.backend,r=t.input,a=n.data.get(r.dataId).complexTensorInfos.real,i=n.data.get(a.dataId).values;return n.makeTensorInfo(a.shape,a.dtype,i)}o.gc;function Ve(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dtype;if("complex64"===i){if("complex64"===a.dtype)return ze({inputs:{x:a},backend:n});var c=Ue(n,a.shape,a.dtype),u=Ve({inputs:{x:a},backend:n,attrs:{dtype:"float32"}}),l=Ge({inputs:{real:u,imag:c},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),l}if("complex64"===a.dtype){var d=He({inputs:{input:a},backend:n}),h=Ve({inputs:{x:d},backend:n,attrs:{dtype:i}});return n.disposeIntermediateTensorInfo(d),h}if(!o.Ld.hasEncodingLoss(a.dtype,i)){var f=ze({inputs:{x:a},backend:n});return{dataId:f.dataId,shape:f.shape,dtype:i}}if("int32"===i){var p=n.data.get(a.dataId).values,m=Int32Array.from(p);return n.makeTensorInfo(a.shape,"int32",m)}if("bool"===i){var v=n.data.get(a.dataId).values,g=o.Ld.toTypedArray([0],a.dtype),b=Pe((function(e,t){return e!==t?1:0}))(a.shape,[],v,g,"bool"),y=Object(s.a)(b,2),x=y[0],w=y[1];return n.makeTensorInfo(w,"bool",x)}throw new Error("Error in Cast: failed to cast ".concat(a.dtype," to ").concat(i))}o.v;function We(e,t,n,r){return null==n?function(n){var a=n.inputs,i=n.backend,o=a.a,c=a.b,u=i;Fe([o,c],e);var l=u.data.get(o.dataId).values,d=u.data.get(c.dataId).values,h=r||o.dtype,f=t(o.shape,c.shape,l,d,h),p=Object(s.a)(f,2),m=p[0],v=p[1];return u.makeTensorInfo(v,h,m)}:function(e){var a=e.inputs,i=e.backend,o=a.a,c=a.b,u=i;if("complex64"===o.dtype||"complex64"===c.dtype){var l=Ve({inputs:{x:o},backend:u,attrs:{dtype:"complex64"}}),d=u.data.get(l.dataId),h=d.complexTensorInfos.real,f=d.complexTensorInfos.imag,p=u.data.get(h.dataId).values,m=u.data.get(f.dataId).values,v=Ve({inputs:{x:c},backend:u,attrs:{dtype:"complex64"}}),g=u.data.get(v.dataId),b=g.complexTensorInfos.real,y=g.complexTensorInfos.imag,x=u.data.get(b.dataId).values,w=u.data.get(y.dataId).values,O=n(o.shape,c.shape,p,m,x,w),A=Object(s.a)(O,3),_=A[0],E=A[1],S=A[2],C=u.makeTensorInfo(S,"float32",_),T=u.makeTensorInfo(S,"float32",E),M=Ge({inputs:{real:C,imag:T},backend:u});return u.disposeIntermediateTensorInfo(l),u.disposeIntermediateTensorInfo(v),u.disposeIntermediateTensorInfo(C),u.disposeIntermediateTensorInfo(T),M}var k=u.data.get(o.dataId).values,R=u.data.get(c.dataId).values,I=r||o.dtype,j=t(o.shape,c.shape,k,R,I),B=Object(s.a)(j,2),L=B[0],N=B[1];return u.makeTensorInfo(N,I,L)}}function Je(e){return function(t,n,r,a,i,s){var c=o.cd.assertAndGetBroadcastShape(t,n),u=o.Ld.sizeFromShape(c),l=c.length,d=o.Ld.computeStrides(c),h=o.Ld.getTypedArrayFromDType("float32",u),f=o.Ld.getTypedArrayFromDType("float32",u),p=o.cd.getBroadcastDims(t,c),m=o.cd.getBroadcastDims(n,c),v=o.cd.mergeRealAndImagArrays(r,a),g=o.cd.mergeRealAndImagArrays(i,s),b=t.length,y=o.Ld.computeStrides(t),x=n.length,w=o.Ld.computeStrides(n);if(p.length+m.length===0)for(var O=0;O<h.length;O++){var A=O%v.length,_=O%g.length,E=e(v[2*A],v[2*A+1],g[2*_],g[2*_+1]);h[O]=E.real,f[O]=E.imag}else for(var S=function(t){var n=o.Ld.indexToLoc(t,l,d),r=n.slice(-b);p.forEach((function(e){return r[e]=0}));var a=o.Ld.locToIndex(r,b,y),i=n.slice(-x);m.forEach((function(e){return i[e]=0}));var s=o.Ld.locToIndex(i,x,w),c=e(v[2*a],v[2*a+1],g[2*s],g[2*s+1]);h[t]=c.real,f[t]=c.imag},C=0;C<h.length;C++)S(C);return[h,f,c]}}var Xe=Pe((function(e,t){return e+t})),Ke=Je((function(e,t,n,r){return{real:e+n,imag:t+r}}));We(o.d,Xe,Ke),o.d;function qe(e){return function(t,n,r){for(var a=o.Ld.getTypedArrayFromDType(n,t.length),i=0;i<t.length;++i)a[i]=e(t[i],r);return a}}function Ye(e,t,n){return function(r){var a=r.inputs,i=r.attrs,o=r.backend,s=a.x;if(Fe(s,e),"string"===s.dtype||"string"===n)throw new Error("unaryKernelFunc does not support string input/output");var c=o,u=c.data.get(s.dataId).values,l=n||s.dtype,d=t(u,l,i);return c.makeTensorInfo(s.shape,l,d)}}var Qe=qe((function(e){return Math.ceil(e)}));Ye(o.w,Qe),o.w;var Ze=qe((function(e){return Math.exp(e)})),$e=(Ye(o.X,Ze),o.X,qe((function(e){return Math.expm1(e)}))),et=(Ye(o.Z,$e),o.Z,qe((function(e){return Math.floor(e)})));Ye(o.db,et),o.db;var tt=Pe((function(e,t){return e>t?1:0})),nt=(We(o.lb,tt,null,"bool"),o.lb,Pe((function(e,t){return e<t?1:0})));We(o.xb,nt,null,"bool"),o.xb;var rt=qe((function(e){return Math.log(e)}));Ye(o.Ab,rt),o.Ab;var at=Pe((function(e,t){return Math.max(e,t)})),it=(We(o.Lb,at),o.Lb,Pe((function(e,t){return Math.min(e,t)}))),ot=(We(o.Ob,it),o.Ob,Pe((function(e,t){return e*t}))),st=Je((function(e,t,n,r){return{real:e*n-t*r,imag:e*r+t*n}}));We(o.Sb,ot,st),o.Sb;function ct(e,t,n){var r=o.Ld.createScalarValue(-1,n);return ot([],t,r,e,n)}o.Tb;function ut(e,t,n,r,a){for(var i=t.length,s=o.Ld.sizeFromShape(t),c=o.Ld.computeStrides(t),u=o.Ld.computeStrides(a),l=o.Ld.getTypedArrayFromDType(n,o.Ld.sizeFromShape(a)),d=0;d<s;++d){for(var h=o.Ld.indexToLoc(d,i,c),f=new Array(h.length),p=0;p<f.length;p++)f[p]=h[r[p]];l[o.Ld.locToIndex(f,i,u)]=e[d]}return l}o.Vc;function lt(e,t,n,r){for(var a=o.cd.computeOutAndReduceShapes(e,r),i=Object(s.a)(a,2),c=i[0],u=i[1],l=Object(o.Kd)(t,"int32"),d=o.Ld.makeZerosTypedArray(o.Ld.sizeFromShape(c),l),h=o.Ld.sizeFromShape(u),f=0;f<d.length;++f){for(var p=f*h,m=1,v=0;v<h;++v)m*=n[p+v];d[f]=m}return{outVals:d,outShape:c,outDtype:l}}o.ec;var dt=qe((function(e){return 1/Math.sqrt(e)}));Ye(o.tc,dt),o.tc;function ht(e){for(var t=new Float32Array(e.length),n=0;n<e.length;++n)t[n]=Math.abs(e[n]);return t}o.a;function ft(e,t,n,r,a){var i=o.Ad.isSliceContinous(r,t,n),s=o.Ld.sizeFromShape(n),c=o.Ld.computeStrides(r);if(i){var u=o.Ad.computeFlatOffset(t,c);return"string"===a?e.slice(u,u+s):e.subarray(u,u+s)}for(var d="string"===a?o.cd.fromUint8ToStringArray(e):e,h=Object(o.ed)(r,a,d),f=Object(o.ed)(n,a),p=0;p<f.size;++p){var m=f.indexToLoc(p),v=m.map((function(e,n){return e+t[n]}));f.set.apply(f,[h.get.apply(h,Object(l.a)(v))].concat(Object(l.a)(m)))}return"string"===a?o.cd.fromStringArrayToUint8(f.values):f.values}o.Bc;var pt=Pe((function(e,t){return e-t})),mt=Je((function(e,t,n,r){return{real:e-n,imag:t-r}}));We(o.Mc,pt,mt),o.Mc;var vt=Xe,gt=function(e,t,n,r,a){for(var i=o.Ld.sizeFromShape(r),s=o.Ld.makeZerosTypedArray(a,n),c=0;c<e.length;c++){var u=e[c];if(u<0)throw new Error("Input x must be non-negative!");u>=a||(s[u]+=i>0?t[c]:1)}return s},bt=function(e,t,n){for(var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=e.shape[0],i=e.shape[1],s=Object(o.ed)([a,n],t.dtype),c=0;c<a;c++)for(var u=0;u<i;u++){var l=e.get(c,u);if(l<0)throw new Error("Input x must be non-negative!");l>=n||(r?s.set(1,c,l):t.size>0?s.set(s.get(c,l)+t.get(c,u),c,l):s.set(s.get(c,l)+1,c,l))}return s},yt=Qe,xt=function(e,t,n,r){var a=o.Ld.getArrayFromDType(n,o.Ld.sizeFromShape(t));if(r&&"string"!==n){var i=0;e.forEach((function(e){var t=o.Ld.sizeFromShape(e.shape);a.set(e.vals,i),i+=t}))}else{var s=0;e.forEach((function(e){for(var r="string"===n?o.cd.fromUint8ToStringArray(e.vals):e.vals,i=0,c=0;c<e.shape[0];++c)for(var u=c*t[1]+s,l=0;l<e.shape[1];++l)a[u+l]=r[i++];s+=e.shape[1]}))}return a},wt=Ze,Ot=$e,At=et,_t=function(e,t,n){for(var r=Object(o.ed)(n,e.dtype),a=0;a<r.size;++a){var i=r.indexToLoc(a).slice(),s=i[0],c=i[2],u=t.locToIndex([s,c]);i[2]=t.values[u];var l=e.locToIndex(i);r.values[a]=e.values[l]}return r},Et=tt,St=nt,Ct=function(e,t,n){var r=(t-e)/(n-1),a=o.Ld.makeZerosTypedArray(n,"float32");a[0]=e;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return a},Tt=rt,Mt=function(e,t,n,r){for(var a=o.Ld.getTypedArrayFromDType(r,o.Ld.sizeFromShape(n)),i=0;i<a.length;++i){for(var s=i*t,c=e[s],u=0;u<t;++u){var l=e[s+u];l>c&&(c=l)}a[i]=c}return a},kt=at,Rt=it,It=ot,jt=ct,Bt=lt,Lt=function(e,t,n,r){if(e===t||e<t&&n<0||t<e&&n>1)return o.Ld.makeZerosTypedArray(0,r);var a=Math.abs(Math.ceil((t-e)/n)),i=o.Ld.makeZerosTypedArray(a,r);t<e&&1===n&&(n=-1),i[0]=e;for(var s=1;s<i.length;s++)i[s]=i[s-1]+n;return i},Nt=dt,Dt=ht,Pt=ft,Ft=function(e,t,n,r){for(var a=Object(o.ed)(e,t.dtype),i=0;i<a.size;i++){for(var s=a.indexToLoc(i),c=new Array(s.length),u=0;u<c.length;u++)c[u]=s[u]*n[u]+r[u];a.set.apply(a,[t.get.apply(t,c)].concat(Object(l.a)(s)))}return a},Gt=pt,Ut=function(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];for(var a=Object(o.ed)(n,e.dtype),i=0;i<a.values.length;++i){for(var s=a.indexToLoc(i),c=new Array(e.rank),u=0;u<c.length;u++)c[u]=s[u]%e.shape[u];var l=e.locToIndex(c);a.values[i]=e.values[l]}return a},zt=function(e,t,n,r,a){for(var i=t[t.length-1],s=e.length/i,c=i,u=o.Ld.getTypedArrayFromDType(n,s*r),l=o.Ld.getTypedArrayFromDType("int32",s*r),d=0;d<s;d++){for(var h=d*c,f=e.subarray(h,h+c),p=[],m=0;m<f.length;m++)p.push({value:f[m],index:m});p.sort((function(e,t){return t.value-e.value}));for(var v=d*r,g=u.subarray(v,v+r),b=l.subarray(v,v+r),y=0;y<r;y++)g[y]=p[y].value,b[y]=p[y].index}var x=t.slice();return x[x.length-1]=r,[Object(o.ed)(x,n,u),Object(o.ed)(x,"int32",l)]},Ht=ut,Vt=function(e,t,n,r){for(var a=o.Ld.parseAxisParam(t,n)[0],i=[1,n[0],1],s=0;s<a;s++)i[0]*=n[s];i[1]=n[a];for(var c=a+1;c<n.length;c++)i[2]*=n[c];for(var u={},l=new Int32Array(n[a]),d=new o.Rc(i,r,e),h=[],f=1===i[0]&&1===i[2],p=0;p<n[a];p++){var m=void 0;if(f)m=e[p].toString();else{for(var v=[],g=0;g<i[0];g++)for(var b=0;b<i[2];b++)v.push(d.get(g,p,b));m=v.join(",")}if(void 0!==u[m])l[p]=u[m];else{var y=Object.keys(u).length;u[m]=y,l[p]=y,h.push(p)}}var x=i.slice();x[1]=Object.keys(u).length;var w=new o.Rc(x,r);h.forEach((function(e,t){for(var n=0;n<i[0];n++)for(var r=0;r<i[2];r++)w.set(d.get(n,e,r),n,t,r)}));var O=n.slice();return O[a]=x[1],{outputValues:w.values,outputShape:O,indices:l}};function Wt(e,t){return["x","y","z","w","u","v"].slice(0,t).map((function(t){return"".concat(e,".").concat(t)}))}function Jt(e,t){return 1===t?[e]:Wt(e,t)}var Xt=function e(t){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=t;var n=t.length;if(0===n)this.userCode="\n        void main() {\n          setOutput(vec4(getA(), 0., 0., 0.));\n        }\n      ";else{var r=Jt("rc",n),a=Re(n),i=function(e,t,n){if(1===e)return"rc > ".concat(t[0]);for(var r="",a=e-2;a<e;a++)r+="".concat(n[a]," >= ").concat(t[a]),a<e-1&&(r+="||");return r}(n,t,r),o=function(e,t,n,r){if(1===e)return"";var a=r.slice(-2);return"\n    int r = ".concat(a[0],";\n    int c = ").concat(a[1],";\n    int rp1 = r + 1;\n    int cp1 = c + 1;\n\n    bool cEdge = cp1 >= ").concat(t,";\n    bool rEdge = rp1 >= ").concat(n,";\n  ")}(n,t[t.length-1],t[t.length-2],r),s=function(e,t){var n=e.length,r=function(e,t){for(var n=[],r=0;r<=1;r++)for(var a=0;a<=1;a++){for(var i="".concat(0===r?"r":"rp1",", ").concat(0===a?"c":"cp1"),o=2;o<e;o++)i="".concat(t[t.length-1-o],",")+i;n.push(i)}return n}(n,t);if(1===n)return"getA(rc),\n            rc + 1 >= ".concat(e[0]," ? 0. : getA(rc + 1),\n            0, 0");return"getA(".concat(r[0],"),\n          cEdge ? 0. : getA(").concat(r[1],"),\n          rEdge ? 0. : getA(").concat(r[2],"),\n          rEdge || cEdge ? 0. : getA(").concat(r[3],")")}(t,r);this.userCode="\n        void main() {\n          ".concat(a," rc = getOutputCoords();\n\n          if(").concat(i,") {\n            setOutput(vec4(0));\n          } else {\n            ").concat(o,"\n\n            setOutput(vec4(").concat(s,"));\n          }\n        }\n      ")}};var Kt=function e(t,n){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var r="",a=0;a<4;a++){var i="thisRC = rc;";a%2===1&&(i+="thisRC.z += 1;"),a>1&&(i+="thisRC.y += 1;"),r+="\n        ".concat(i,"\n        ").concat(a>0?"if(thisRC.y < rows && thisRC.z < cols){":"","\n          int flatIndex = getFlatIndex(thisRC);\n\n          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);\n          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));\n\n          result[").concat(a,"] =\n            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);\n        ").concat(a>0?"}":"","\n      ")}this.userCode="\n      ".concat(function(e){var t=$(["r","c","d"],e);return"\n    ivec3 inputCoordsFromReshapedOutCoords(int index) {\n      ".concat(t,"\n      return ivec3(r, c, d);\n    }\n  ")}(n),"\n      ").concat(ee(t),"\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n\n        vec4 result = vec4(0.);\n\n        ivec3 thisRC;\n        int rows = ").concat(t[1],";\n        int cols = ").concat(t[2],";\n\n        ").concat(r,"\n\n        setOutput(result);\n      }\n    ")};var qt=function(){function e(t){Object(h.a)(this,e),this.gpgpu=t,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}return Object(f.a)(e,[{key:"acquireTexture",value:function(e,t,n){var r=Qt(t,n),a=Zt(e,r,n);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);var o,s=Yt(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,n);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=s,this.log();var c=this.freeTextures[a].shift();return this.usedTextures[a].push(c),c}return r===i.PACKED_2X2_FLOAT32?o=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===i.PACKED_2X2_FLOAT16?o=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===i.UNPACKED_FLOAT32?o=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===i.UNPACKED_FLOAT16?o=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===i.PACKED_4X1_UNSIGNED_BYTE&&(o=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(o),this.numUsedTextures++,this._numBytesAllocated+=s,this.log(),o}},{key:"releaseTexture",value:function(e,t,n,r){if(null!=this.freeTextures){var a=Qt(n,r),i=Zt(t,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);var s=Yt(t,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),c=Object(o.md)().get("WEBGL_DELETE_TEXTURE_THRESHOLD");-1!==c&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(e),this._numBytesAllocated-=s):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=s),this.numUsedTextures--;var u=this.usedTextures[i],l=u.indexOf(e);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u.splice(l,1),this.log()}}},{key:"log",value:function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used","".concat(this.numFreeTextures," / ").concat(this.numUsedTextures),"(".concat(e,")"));var t=this._numBytesFree/this._numBytesAllocated;console.log("Bytes allocated: ".concat(this._numBytesAllocated)),console.log("Bytes unused: ".concat(this._numBytesFree," (").concat(Math.round(100*t),"%)"))}}},{key:"numBytesAllocated",get:function(){return this._numBytesAllocated}},{key:"numBytesFree",get:function(){return this._numBytesFree}},{key:"getNumUsedTextures",value:function(){return this.numUsedTextures}},{key:"getNumFreeTextures",value:function(){return this.numFreeTextures}},{key:"dispose",value:function(){var e=this;if(null!=this.freeTextures){for(var t in this.freeTextures)this.freeTextures[t].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));for(var n in this.usedTextures)this.usedTextures[n].forEach((function(t){e.gpgpu.deleteMatrixTexture(t)}));this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}]),e}();function Yt(e,t,n,r,a){var o,c=function(e,t){switch(e){case i.PACKED_2X2_FLOAT32:return me(t);case i.PACKED_2X2_FLOAT16:return ve(t);case i.UNPACKED_FLOAT32:return he(t);case i.UNPACKED_FLOAT16:return fe(t);case i.PACKED_4X1_UNSIGNED_BYTE:return pe(t);default:throw new Error("Unknown physical texture type ".concat(e))}}(t,r);if(a){var u=O(e[0],e[1]),l=Object(s.a)(u,2);o=l[0]*l[1]}else{var d=x(e[0],e[1]),h=Object(s.a)(d,2);o=h[0]*h[1]}return o*function(e,t){var n=e;if(t===n.R32F)return 4;if(t===n.R16F)return 2;if(t===n.RGBA32F)return 16;if(t===e.RGBA)return 16;if(t===n.RGBA16F)return 8;throw new Error("Unknown internal format ".concat(t))}(n,c)}function Qt(e,t){if(e===a.UPLOAD)return i.PACKED_2X2_FLOAT32;if(e===a.RENDER||null==e)return function(e){return Object(o.md)().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?e?i.PACKED_2X2_FLOAT32:i.UNPACKED_FLOAT32:e?i.PACKED_2X2_FLOAT16:i.UNPACKED_FLOAT16}(t);if(e===a.DOWNLOAD||e===a.PIXELS)return i.PACKED_4X1_UNSIGNED_BYTE;throw new Error("Unknown logical texture type ".concat(e))}function Zt(e,t,n){return"".concat(e[0],"_").concat(e[1],"_").concat(t,"_").concat(n)}var $t=function e(t,n){Object(h.a)(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      float unaryOperation(float x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        float x = getAAtOutCoords();\n        float y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},en="if (isnan(x)) return x;",tn="return x;",nn="return abs(x);";var rn="return (x >= 0.0) ? x : (exp(x) - 1.0);",an=en+"\n  return (x < 0.0) ? 0.0 : x;\n",on=en+"\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",sn="return x;",cn="return x;",un="\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n",ln="\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",dn="\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n",hn=function e(t,n){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      vec4 unaryOperation(vec4 x) {\n        ".concat(n,"\n      }\n\n      void main() {\n        vec4 x = getAAtOutCoords();\n        vec4 y = unaryOperation(x);\n\n        setOutput(y);\n      }\n    ")},fn=function e(t){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=t;var n=t.length,r=Jt("rc",n),a=Re(n),i=function(e,t){if(1===e)return"rc";for(var n="",r=0;r<e;r++)n+=t[r],r<e-1&&(n+=",");return n}(n,r),o=r.slice(-2),s=n<=1?"rc":"vec2(".concat(o.join(","),")");this.userCode="\n      void main() {\n        ".concat(a," rc = getOutputCoords();\n        vec4 packedInput = getA(").concat(i,");\n\n        setOutput(getChannel(packedInput, ").concat(s,"));\n      }\n    ")},pn=o.sd.whereImpl,mn={};var vn=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(e){var r,a;if(Object(h.a)(this,n),(r=t.call(this)).pendingRead=new WeakMap,r.pendingDisposal=new WeakSet,r.dataRefCount=new WeakMap,r.numBytesInGPU=0,r.uploadWaitMs=0,r.downloadWaitMs=0,r.lastGlFlushTime=0,r.warnedAboutMemory=!1,r.warnedAboutCPUBackend=!1,r.pendingDeletes=0,r.disposed=!1,!Object(o.md)().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");if(null==e){var i=y(Object(o.md)().getNumber("WEBGL_VERSION"));r.binaryCache=((a=Object(o.md)().getNumber("WEBGL_VERSION"))in mn||(mn[a]={}),mn[a]),r.gpgpu=new be(i),r.canvas=i.canvas,r.gpgpuCreatedLocally=!0}else r.gpgpu=e,r.binaryCache={},r.gpgpuCreatedLocally=!1,r.canvas=e.gl.canvas;return r.textureManager=new qt(r.gpgpu),r.numMBBeforeWarning=null==Object(o.md)().global.screen?1024:Object(o.md)().global.screen.height*Object(o.md)().global.screen.width*window.devicePixelRatio*600/1024/1024,r.texData=new o.L(Object(p.a)(r),Object(o.ld)()),r}return Object(f.a)(n,[{key:"nextDataId",value:function(){return n.nextDataId++}},{key:"numDataIds",value:function(){return this.texData.numDataIds()+(this.cpuBackend?this.cpuBackend.numDataIds():0)-this.pendingDeletes}},{key:"write",value:function(e,t,n){if((Object(o.md)().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||Object(o.md)().getBool("DEBUG"))&&this.checkNumericalProblems(e),"complex64"===n&&null!=e)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");var r={id:this.nextDataId()};return this.texData.set(r,{shape:t,dtype:n,values:e,usage:a.UPLOAD,refCount:1}),r}},{key:"refCount",value:function(e){return this.texData.has(e)?this.texData.get(e).refCount:0}},{key:"incRef",value:function(e){this.texData.get(e).refCount++}},{key:"decRef",value:function(e){this.texData.has(e)&&this.texData.get(e).refCount--}},{key:"move",value:function(e,t,n,r,i){if(Object(o.md)().getBool("DEBUG")&&this.checkNumericalProblems(t),"complex64"===r)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:n,dtype:r,values:t,usage:a.UPLOAD,refCount:i})}},{key:"disposeIntermediateTensorInfo",value:function(e){this.disposeData(e.dataId)}},{key:"readSync",value:function(e){var t=this.texData.get(e),n=t.values,r=t.dtype,a=t.complexTensorInfos,i=t.slice,s=t.shape,c=t.isPacked;if(null!=i){var u;u=c?new hn(s,sn):new $t(s,sn);var l=this.runWebGLProgram(u,[{dataId:e,shape:s,dtype:r}],r),d=this.readSync(l.dataId);return this.disposeIntermediateTensorInfo(l),d}if(null!=n)return this.convertAndCacheOnCPU(e);if("string"===r)return n;var h,f,p=null!=this.activeTimers;if(p&&(h=o.Ld.now()),"complex64"===r){var m=this.readSync(a.real.dataId),v=this.readSync(a.imag.dataId);f=o.cd.mergeRealAndImagArrays(m,v)}else f=this.getValuesFromTexture(e);return p&&(this.downloadWaitMs+=o.Ld.now()-h),this.convertAndCacheOnCPU(e,f)}},{key:"read",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r,a,i,s,c,d,h,f,p,m,v,g,b,y,x,O,A,_,E,S,C;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.pendingRead.has(t)){e.next=3;break}return n=this.pendingRead.get(t),e.abrupt("return",new Promise((function(e){return n.push(e)})));case 3:if(r=this.texData.get(t),a=r.values,i=r.shape,s=r.slice,c=r.dtype,d=r.complexTensorInfos,h=r.isPacked,null==s){e.next=11;break}return f=h?new hn(i,sn):new $t(i,sn),p=this.runWebGLProgram(f,[{dataId:t,shape:i,dtype:c}],c),m=this.read(p.dataId),this.disposeIntermediateTensorInfo(p),e.abrupt("return",m);case 11:if(null==a){e.next=13;break}return e.abrupt("return",this.convertAndCacheOnCPU(t));case 13:if(Object(o.md)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")||2!==Object(o.md)().getNumber("WEBGL_VERSION")){e.next=15;break}throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");case 15:if(v=null,"complex64"!==c&&Object(o.md)().get("WEBGL_BUFFER_SUPPORTED")&&(g=this.decode(t),y=this.texData.get(g.dataId),v=(b=this.gpgpu).createBufferFromTexture.apply(b,[y.texture].concat(Object(l.a)(w(i))))),this.pendingRead.set(t,[]),"complex64"===c){e.next=21;break}return e.next=21,this.gpgpu.createAndWaitForFence();case 21:if("complex64"!==c){e.next=30;break}return e.next=24,Promise.all([this.read(d.real.dataId),this.read(d.imag.dataId)]);case 24:O=e.sent,A=O[0],_=O[1],x=o.cd.mergeRealAndImagArrays(A,_),e.next=31;break;case 30:null==v?x=this.getValuesFromTexture(t):(E=o.Ld.sizeFromShape(i),x=this.gpgpu.downloadFloat32MatrixFromBuffer(v,E));case 31:return null!=g&&this.disposeIntermediateTensorInfo(g),S=this.convertAndCacheOnCPU(t,x),C=this.pendingRead.get(t),this.pendingRead.delete(t),C.forEach((function(e){return e(S)})),this.pendingDisposal.has(t)&&(this.pendingDisposal.delete(t),this.disposeData(t)&&Object(o.ld)().removeDataId(t,this),this.pendingDeletes--),e.abrupt("return",S);case 38:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"bufferSync",value:function(e){var t=this.readSync(e.dataId),n=t;if("string"===e.dtype)try{n=t.map((function(e){return o.Ld.decodeString(e)}))}catch(r){throw new Error("Failed to decode encoded string bytes into utf-8")}return Object(o.ed)(e.shape,e.dtype,n)}},{key:"checkNumericalProblems",value:function(e){if(null!=e)for(var t=0;t<e.length;t++){var n=e[t];if(!E(n)){if(Object(o.md)().getBool("WEBGL_RENDER_FLOAT32_CAPABLE"))throw Error("The value ".concat(n," cannot be represented with your ")+"current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'");throw Error("The value ".concat(n," cannot be represented on this device."))}}}},{key:"getValuesFromTexture",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,a=t.isPacked,i=o.Ld.sizeFromShape(n);if(Object(o.md)().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){var s,c=this.decode(e),u=this.texData.get(c.dataId),d=(s=this.gpgpu).downloadMatrixFromPackedTexture.apply(s,[u.texture].concat(Object(l.a)(w(n)))).subarray(0,i);return this.disposeIntermediateTensorInfo(c),d}var h=Object(o.md)().getBool("WEBGL_PACK")&&!0===a,f=h?H(n):n,p=h?new ie(f):new ae(f),m=this.runWebGLProgram(p,[{shape:f,dtype:r,dataId:e}],"float32"),v=this.texData.get(m.dataId),g=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(v.texture,v.texShape[0],v.texShape[1]).subarray(0,i);return this.disposeIntermediateTensorInfo(m),g}},{key:"timerAvailable",value:function(){return Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}},{key:"time",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,r,a,i,s,c,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.activeTimers,r=[],a=!1,null==this.programTimersStack?(this.programTimersStack=r,a=!0):this.activeTimers.push(r),this.activeTimers=r,t(),i=o.Ld.flatten(this.activeTimers.map((function(e){return e.query}))).filter((function(e){return null!=e})),s=o.Ld.flatten(this.activeTimers.map((function(e){return e.name}))).filter((function(e){return null!=e})),this.activeTimers=n,a&&(this.programTimersStack=null),c={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null},!(Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=19;break}return e.next=14,Promise.all(i);case 14:l=e.sent,c.kernelMs=o.Ld.sum(l),c.getExtraProfileInfo=function(){return l.map((function(e,t){return{name:s[t],ms:e}})).map((function(e){return"".concat(e.name,": ").concat(e.ms)})).join(", ")},e.next=20;break;case 19:c.kernelMs={error:"WebGL query timers are not supported in this environment."};case 20:return this.uploadWaitMs=0,this.downloadWaitMs=0,e.abrupt("return",c);case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"memory",value:function(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}},{key:"startTimer",value:function(){return Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:o.Ld.now(),endMs:null}}},{key:"endTimer",value:function(e){return Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=o.Ld.now(),e)}},{key:"getQueryTime",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(Object(o.md)().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)){e.next=2;break}return e.abrupt("return",this.gpgpu.waitForQueryAndGetTime(t));case 2:return n=t,e.abrupt("return",n.endMs-n.startMs);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"disposeData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);var n=this.texData.get(e),r=n.complexTensorInfos;return null!=r&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}},{key:"releaseGPUData",value:function(e){var t=this.texData.get(e),n=t.texture,r=t.dtype,a=t.texShape,i=t.usage,o=t.isPacked,s=t.slice,c=s&&s.origDataId||e,u=this.dataRefCount.get(c);u>1?this.dataRefCount.set(c,u-1):(this.dataRefCount.delete(c),null!=n&&(this.numBytesInGPU-=this.computeBytes(a,r),this.textureManager.releaseTexture(n,a,i,o)));var l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}},{key:"getTexture",value:function(e){return this.uploadToGPU(e),this.texData.get(e).texture}},{key:"getDataInfo",value:function(e){return this.texData.get(e)}},{key:"getCPUBackend",value:function(){return Object(o.md)().getBool("WEBGL_CPU_FORWARD")?(null==this.cpuBackend&&(this.cpuBackend=Object(o.ld)().findBackend("cpu")),this.cpuBackend):null}},{key:"shouldExecuteOnCPU",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:128,r=this.getCPUBackend();return Object(o.md)().getBool("IS_TEST")||this.warnedAboutCPUBackend||null!=r||(console.warn("Your application contains ops that are small enough to be executed on the CPU backend, however the CPU backend cannot be found. Consider importing the CPU backend (@tensorflow/tfjs-backend-cpu) for better performance."),this.warnedAboutCPUBackend=!0),null!=r&&e.every((function(e){return null==t.texData.get(e.dataId).texture&&o.Ld.sizeFromShape(e.shape)<n}))}},{key:"getGPGPUContext",value:function(){return this.gpgpu}},{key:"where",value:function(e){o.cd.warn("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");var t=e.dataSync();return pn(e.shape,t)}},{key:"packedUnaryOp",value:function(e,t,n){var r=new hn(e.shape,t),a=this.compileAndRun(r,[e],n);return Object(o.ld)().makeTensorFromDataId(a.dataId,a.shape,a.dtype)}},{key:"abs",value:function(e){if(this.shouldExecuteOnCPU([e])&&"complex64"!==e.dtype){var t=Dt(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,t)}if(Object(o.md)().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,nn,e.dtype);var n=new $t(e.shape,nn),r=this.compileAndRun(n,[e]);return Object(o.ld)().makeTensorFromDataId(r.dataId,r.shape,r.dtype)}},{key:"makeTensorInfo",value:function(e,t,n){var r;if("string"===t&&null!=n&&n.length>0&&o.Ld.isString(n[0])){var a=n.map((function(e){return o.Ld.encodeString(e)}));r=this.write(a,e,t)}else r=this.write(n,e,t);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:t}}},{key:"makeOutput",value:function(e,t,n){var r=this.makeTensorInfo(e,t,n).dataId;return Object(o.ld)().makeTensorFromDataId(r,e,t,this)}},{key:"unpackTensor",value:function(e){var t=new fn(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}},{key:"packTensor",value:function(e){var t=new Xt(e.shape);return this.runWebGLProgram(t,[e],e.dtype,null,!0)}},{key:"packedReshape",value:function(e,t){var n=[U(e.shape)].concat(Object(l.a)(z(e.shape))),r={dtype:e.dtype,shape:n,dataId:e.dataId},a=[U(t)].concat(Object(l.a)(z(t))),i=new Kt(a,n),o=this.runWebGLProgram(i,[r],e.dtype,null,!0);return{dataId:o.dataId,shape:t,dtype:o.dtype}}},{key:"decode",value:function(e){var t,n=this.texData.get(e),r=n.isPacked,a=n.shape,i=n.dtype,o=H(a);t=r?new re(o):new ne(o);return{dtype:i,shape:a,dataId:this.runWebGLProgram(t,[{shape:o,dtype:i,dataId:e}],i,null,!0).dataId}}},{key:"runWebGLProgram",value:function(e,t,n,a){var i=this,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],c=this.makeTensorInfo(e.outputShape,n),u=this.texData.get(c.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===r.DENSE){var l=w(e.outputShape);u.texShape=l.map((function(e){return 2*e}))}if(null!=e.outTexUsage&&(u.usage=e.outTexUsage),0===o.Ld.sizeFromShape(c.shape))return u.values=o.Ld.getTypedArrayFromDType(c.dtype,0),c;var d=[],h=t.map((function(t){if("complex64"===t.dtype)throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");var n=i.texData.get(t.dataId);if(null==n.texture){if(!e.packedInputs&&o.Ld.sizeFromShape(t.shape)<=Object(o.md)().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:t.shape,texData:null,isUniform:!0,uniformValues:n.values};e.packedInputs&&(n.isPacked=!0,n.shape=t.shape)}else if(!!n.isPacked!==!!e.packedInputs)t=n.isPacked?i.unpackTensor(t):i.packTensor(t),d.push(t),n=i.texData.get(t.dataId);else if(n.isPacked&&!W(n.shape,t.shape)){var r=t,a=t.shape;t.shape=n.shape,t=i.packedReshape(t,a),d.push(t),n=i.texData.get(t.dataId),r.shape=a}return i.uploadToGPU(t.dataId),{shape:t.shape,texData:n,isUniform:!1}}));this.uploadToGPU(c.dataId);var f,p={shape:c.shape,texData:u,isUniform:!1},m=De(e,h,p),v=this.getAndSaveBinary(m,(function(){return Be(i.gpgpu,e,h,p)})),g=null!=this.activeTimers;g&&(f=this.startTimer()),Ne(this.gpgpu,v,h,p,a),d.forEach((function(e){return i.disposeIntermediateTensorInfo(e)})),g&&(f=this.endTimer(f),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(f)}));var b=Object(o.md)().get("WEBGL_FLUSH_THRESHOLD");if(b>0){var y=o.Ld.now();y-this.lastGlFlushTime>b&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=y)}if(!Object(o.md)().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&!1===s){var x=this.unpackTensor(c);return this.disposeIntermediateTensorInfo(c),x}return c}},{key:"compileAndRun",value:function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];n=n||t[0].dtype;var i=this.runWebGLProgram(e,t,n,r,a);return i}},{key:"getAndSaveBinary",value:function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}},{key:"getTextureManager",value:function(){return this.textureManager}},{key:"dispose",value:function(){var e=this;if(!this.disposed){if(!Object(o.md)().getBool("IS_TEST"))Object.keys(this.binaryCache).forEach((function(t){e.gpgpu.deleteProgram(e.binaryCache[t].webGLProgram),delete e.binaryCache[t]}));this.textureManager.dispose(),null!=this.canvas&&"undefined"!==typeof HTMLCanvasElement&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0}}},{key:"floatPrecision",value:function(){var e=this;return null==this.floatPrecisionValue&&(this.floatPrecisionValue=Object(o.Id)((function(){if(!Object(o.md)().get("WEBGL_RENDER_FLOAT32_ENABLED")){var t=Object(o.md)().getBool("DEBUG");Object(o.md)().set("DEBUG",!1);var n=e.abs(Object(o.xd)(1e-8)).dataSync()[0];if(Object(o.md)().set("DEBUG",t),n>0)return 32}return 16}))),this.floatPrecisionValue}},{key:"epsilon",value:function(){return 32===this.floatPrecision()?1e-7:1e-4}},{key:"uploadToGPU",value:function(e){var t=this.texData.get(e),n=t.shape,r=t.dtype,i=t.values,c=t.texture,u=t.usage,l=t.isPacked;if(null==c){var d,h=null!=this.activeTimers;h&&(d=o.Ld.now());var f=t.texShape;if(null==f&&(f=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Object(o.md)().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t&&(n*=2,1===(e=e.map((function(t,n){return n>=e.length-2?o.Ld.nearestLargerEven(e[n]):e[n]}))).length&&(e=[2,e[0]])),2!==e.length){var r=o.Ld.squeezeShape(e);e=r.newShape}var a=o.Ld.sizeFromShape(e);if(e.length<=1&&a<=n)return[1,a];if(2===e.length&&e[0]<=n&&e[1]<=n)return e;if(3===e.length&&e[0]*e[1]<=n&&e[2]<=n)return[e[0]*e[1],e[2]];if(3===e.length&&e[0]<=n&&e[1]*e[2]<=n)return[e[0],e[1]*e[2]];if(4===e.length&&e[0]*e[1]*e[2]<=n&&e[3]<=n)return[e[0]*e[1]*e[2],e[3]];if(4===e.length&&e[0]<=n&&e[1]*e[2]*e[3]<=n)return[e[0],e[1]*e[2]*e[3]];if(t){var i=U(e),c=2,u=2;if(e.length){var l=z(e),d=Object(s.a)(l,2);c=d[0],u=d[1]}return a=i*(c/2)*(u/2),o.Ld.sizeToSquarishShape(a).map((function(e){return 2*e}))}return o.Ld.sizeToSquarishShape(a)}(n,l),t.texShape=f),null!=i){var p,m=H(n),v=f[1],g=f[0],b=i instanceof Uint8Array;if(l){var y=O(f[0],f[1]),x=Object(s.a)(y,2);v=x[0],g=x[1],p=new se(m,[g,v],b)}else p=new oe(m,[g,v],b);var w=this.makeTensorInfo([g,v],r);this.texData.get(w.dataId).usage=b?a.PIXELS:a.UPLOAD,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(w.dataId),v,g,i);var A=this.runWebGLProgram(p,[w],r,null,!0),_=this.texData.get(A.dataId);t.texture=_.texture,t.texShape=_.texShape,t.isPacked=_.isPacked,t.usage=_.usage,this.disposeIntermediateTensorInfo(w),this.texData.delete(A.dataId),t.values=null,h&&(this.uploadWaitMs+=o.Ld.now()-d)}else{var E=this.acquireTexture(f,u,r,l);t.texture=E}}}},{key:"convertAndCacheOnCPU",value:function(e,t){var n=this.texData.get(e),r=n.dtype;return this.releaseGPUData(e),null!=t&&(n.values=function(e,t){if("float32"===t||"complex64"===t)return e;if("int32"===t||"bool"===t){for(var n="int32"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r)n[r]=Math.round(e[r]);return n}throw new Error("Unknown dtype ".concat(t))}(t,r)),n.values}},{key:"acquireTexture",value:function(e,t,n,r){if(this.numBytesInGPU+=this.computeBytes(e,n),!this.warnedAboutMemory&&this.numBytesInGPU>1024*this.numMBBeforeWarning*1024){var a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn("High memory usage in GPU: ".concat(a," MB, ")+"most likely due to a memory leak")}return this.textureManager.acquireTexture(e,t,r)}},{key:"computeBytes",value:function(e,t){return e[0]*e[1]*o.Ld.bytesPerElement(t)}}]),n}(o.tb);vn.nextDataId=0,o.jd.isBrowser()&&Object(o.ud)("webgl",(function(){return new vn}),2);var gn=function e(t,n,r){Object(h.a)(this,e),this.variableNames=["A","B"],this.outputShape=o.cd.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOperation(float a, float b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float a = getAAtOutCoords();\n        float b = getBAtOutCoords();\n        setOutput(binaryOperation(a, b));\n      }\n    ")},bn=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];Object(h.a)(this,e),this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=o.cd.assertAndGetBroadcastShape(n,r);var i=this.outputShape.length,s="";if(a)if(0===i||1===o.Ld.sizeFromShape(this.outputShape))s="\n          result.y = 0.;\n          result.z = 0.;\n          result.w = 0.;\n        ";else{var c=Re(i);if(s="\n          ".concat(c," coords = getOutputCoords();\n        "),1===i)s+="\n            result.y = (coords + 1) >= ".concat(this.outputShape[0]," ? 0. : result.y;\n            result.z = 0.;\n            result.w = 0.;\n          ");else{var u=Jt("coords",i);s+="\n            bool nextRowOutOfBounds =\n              (".concat(u[i-2]," + 1) >= ").concat(this.outputShape[i-2],";\n            bool nextColOutOfBounds =\n              (").concat(u[i-1]," + 1) >= ").concat(this.outputShape[i-1],";\n            result.y = nextColOutOfBounds ? 0. : result.y;\n            result.z = nextRowOutOfBounds ? 0. : result.z;\n            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;\n          ")}}this.userCode="\n      vec4 binaryOperation(vec4 a, vec4 b) {\n        ".concat(t,"\n      }\n\n      void main() {\n        vec4 a = getAAtOutCoords();\n        vec4 b = getBAtOutCoords();\n\n        vec4 result = binaryOperation(a, b);\n        ").concat(s,"\n\n        setOutput(result);\n      }\n    ")};function yn(e){var t=e.inputs,n=e.backend,r=t.x;return n.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}var xn={kernelName:o.ob,backendName:"webgl",kernelFunc:yn};function wn(e){var t=e.inputs,n=e.backend,r=t.real,a=t.imag,i=n.makeTensorInfo(r.shape,"complex64"),o=n.texData.get(i.dataId),s=yn({inputs:{x:r},backend:n}),c=yn({inputs:{x:a},backend:n});return o.complexTensorInfos={real:s,imag:c},i}var On={kernelName:o.y,backendName:"webgl",kernelFunc:wn},An="return (a < 0.) ? b * a : a;",_n="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var En={kernelName:o.wb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.alpha,s=n.makeTensorInfo([],"float32",o.Ld.createScalarValue(i,"float32")),c=Object(o.md)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bn(_n,a.shape,s.shape):new gn(An,a.shape,s.shape),u=n.runWebGLProgram(c,[a,s],a.dtype);return n.disposeIntermediateTensorInfo(s),u}},Sn="return (a < 0.) ? b * a : a;",Cn="\n  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));\n  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);\n";var Tn={kernelName:o.dc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=t.alpha,i=Object(o.md)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bn(Cn,r.shape,a.shape):new gn(Sn,r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}};function Mn(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.cpuKernelImpl,a=e.dtype;return function(e){var i,s=e.inputs,c=e.backend,u=s.x,l=c,d=a||u.dtype;if(l.shouldExecuteOnCPU([u])&&null!=r){var h=l.texData.get(u.dataId),f=r(h.values,d);return l.makeTensorInfo(u.shape,d,f)}return i=Object(o.md)().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&null!=n?new hn(u.shape,n):new $t(u.shape,t),l.runWebGLProgram(i,[u],d)}}function kn(e){var t=e.opSnippet,n=e.packedOpSnippet,r=e.checkOutOfBounds,a=void 0!==r&&r,i=e.supportsComplex,c=void 0!==i&&i,u=e.cpuKernelImpl,l=e.dtype;return function(e){var r=e.inputs,i=e.backend,d=r.a,h=r.b,f=i;if(c&&"complex64"===d.dtype){var p=f.texData.get(d.dataId),m=f.texData.get(h.dataId),v=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map((function(e){var n=Object(s.a)(e,2),r=n[0],a=n[1],i={dataId:r.dataId,dtype:r.dtype,shape:d.shape},c={dataId:a.dataId,dtype:a.dtype,shape:h.shape},u=new gn(t,d.shape,h.shape);return f.runWebGLProgram(u,[i,c],Object(o.Kd)(r.dtype,a.dtype))})),g=Object(s.a)(v,2),b=g[0],y=g[1],x=wn({inputs:{real:b,imag:y},backend:f});return f.disposeIntermediateTensorInfo(b),f.disposeIntermediateTensorInfo(y),x}var w,O=l||Object(o.Kd)(d.dtype,h.dtype);if(f.shouldExecuteOnCPU([d,h])&&null!=u){var A=f.texData.get(d.dataId),_=f.texData.get(h.dataId),E=u(d.shape,h.shape,A.values,_.values,O),S=Object(s.a)(E,2),C=S[0],T=S[1],M=f.makeTensorInfo(T,O);return f.texData.get(M.dataId).values=C,M}return w=Object(o.md)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&null!=n?new bn(n,d.shape,h.shape,a):new gn(t,d.shape,h.shape),f.runWebGLProgram(w,[d,h],O)}}function Rn(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if("linear"===e)return t?cn:tn;if("relu"===e)return t?ln:an;if("elu"===e)return t?un:rn;if("relu6"===e)return t?dn:on;if("prelu"===e)return t?Cn:Sn;if("leakyrelu"===e)return t?_n:An;throw new Error("Activation ".concat(e," has not been implemented for the WebGL backend."))}var In=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7&&void 0!==arguments[7]&&arguments[7],u=arguments.length>8&&void 0!==arguments[8]&&arguments[8];Object(h.a)(this,e),this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r;var l=a?t[1]:t[2],d=Math.ceil(l/2),f=a?"i * 2, rc.y":"rc.y, i * 2",p=i?"rc.z, i * 2":"i * 2, rc.z",m=a?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=i?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"],g="",b="";s&&(g=c?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(s,"\n        }"):u?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(s,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(s,"\n        }"),b="result = activation(result);");var y=o?"result += getBiasAtOutCoords();":"";o&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");var x="rc.x",w="rc.x";t[0]<n[0]?x="int(min(float(rc.x), ".concat(t[0]-1,".))"):n[0]<t[0]&&(w="int(min(float(rc.x), ".concat(n[0]-1,".))")),this.userCode="\n      ".concat(g,"\n\n      const float sharedDimension = ").concat(d,".0;\n\n      vec4 dot2x2ARowBCol(ivec3 rc) {\n        vec4 result = vec4(0);\n        for (int i = 0; i < ").concat(d,"; i++) {\n          int batchA = ").concat(x,";\n          int batchB = ").concat(w,";\n          vec4 a = getMatrixA(batchA, ").concat(f,");\n          vec4 b = getMatrixB(batchB, ").concat(p,");\n\n          // These swizzled products need to be separately added.\n          // See: https://github.com/tensorflow/tfjs/issues/1735\n          result += (").concat(m[0]," * ").concat(v[0],");\n          result += (").concat(m[1]," * ").concat(v[1],");\n        }\n        return result;\n      }\n\n      void main() {\n        ivec3 rc = getOutputCoords();\n        vec4 result = dot2x2ARowBCol(rc);\n\n        ").concat(y,"\n\n        ").concat(b,"\n\n        setOutput(result);\n      }\n    ")},jn="return areal * breal - aimag * bimag;",Bn="return areal * bimag + aimag * breal;",Ln=function e(t,n,r){Object(h.a)(this,e),this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=o.cd.assertAndGetBroadcastShape(n,r),this.userCode="\n      float binaryOpComplex(\n          float areal, float aimag, float breal, float bimag) {\n        ".concat(t,"\n      }\n\n      void main() {\n        float areal = getARealAtOutCoords();\n        float aimag = getAImagAtOutCoords();\n        float breal = getBRealAtOutCoords();\n        float bimag = getBImagAtOutCoords();\n        setOutput(binaryOpComplex(areal, aimag, breal, bimag));\n      }\n    ")},Nn="return a * b;";function Dn(e){var t,n=e.inputs,r=e.backend,a=n.a,i=n.b,c=o.cd.upcastType(a.dtype,i.dtype);if("complex64"===a.dtype){var u=r.texData.get(a.dataId),l=r.texData.get(i.dataId),d=new Ln(jn,a.shape,i.shape),h=new Ln(Bn,a.shape,i.shape),f=[{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:a.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:a.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:i.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:i.shape}],p=r.runWebGLProgram(d,f,"float32"),m=r.runWebGLProgram(h,f,"float32"),v=wn({inputs:{real:p,imag:m},backend:r});return r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(m),v}if(r.shouldExecuteOnCPU([a,i])){var g=r.texData.get(a.dataId),b=r.texData.get(i.dataId),y=It(a.shape,i.shape,g.values,b.values,c),x=Object(s.a)(y,2),w=x[0],O=x[1],A=r.makeTensorInfo(O,c);return r.texData.get(A.dataId).values=w,A}return t=Object(o.md)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bn(Nn,a.shape,i.shape):new gn(Nn,a.shape,i.shape),r.runWebGLProgram(t,[a,i],c)}var Pn={kernelName:o.Sb,backendName:"webgl",kernelFunc:Dn};function Fn(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.shape,s=n,c=o.Ld.sizeFromShape(a.shape),u=o.Ld.inferFromImplicitShape(i,c),d=o.Ld.sizeFromShape(u);o.Ld.assert(c===d,(function(){return"The new shape (".concat(u,") has ").concat(d," elements and the old ")+"shape (".concat(a.shape,") has ").concat(c," elements. The new shape and old ")+"shape must have the same number of elements."}));var h=s.texData.get(a.dataId);return!h.isPacked||W(a.shape,u)||null!==h.texture&&W(h.shape,u)?(s.incRef(a.dataId),{dataId:a.dataId,shape:u,dtype:a.dtype}):function(e,t,n){var r=[U(e.shape)].concat(Object(l.a)(z(e.shape))),a={dtype:e.dtype,shape:r,dataId:e.dataId},i=[U(t)].concat(Object(l.a)(z(t))),o=new Kt(i,r),s=n.runWebGLProgram(o,[a],e.dtype,null,!0);return{dataId:s.dataId,shape:t,dtype:s.dtype}}(a,u,s)}var Gn={kernelName:o.lc,backendName:"webgl",kernelFunc:Fn},Un=function e(t,n){Object(h.a)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,s=t.outSize;this.outputShape=[a,s];var c=4*Math.floor(r/4),u=r%4,l="sumValue += dot(values, ones);";if(null!=n){var d=1/n;l="sumValue += dot(values * ".concat(o.Ld.isInt(d)?d.toPrecision(2):d,", ones);")}var f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return 0.0;\n        }\n      ")),this.userCode="\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ".concat(f,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1), 0.0, 0.0);\n\n          ").concat(l,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2), 0.0);\n\n          ").concat(l,"\n        }\n        setOutput(sumValue);\n      }\n    ")},zn=function e(t,n){Object(h.a)(this,e),this.variableNames=["x"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.outSize;this.outputShape=[a,o];var s="0.0",c="";"prod"===n?s="1.0":"min"===n?(s="1.0 / 1e-20",c="min"):"max"===n&&(s="-1.0 / 1e-20",c="max");var u="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"sum"===n?u="sumValue":"prod"===n?u="prodValue":"all"===n?u="allValue":"any"===n&&(u="anyValue");var l=4*Math.floor(r/4),d=r%4,f="\n      if (".concat("sum"===n,") {\n        sumValue += dot(values, ones);\n      } else if (").concat("prod"===n,") {\n        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);\n        prodValue *= tmp[0] * tmp[1];\n      } else {\n        minMaxValue = ").concat(c,"(values, minMaxValue);\n      }\n    "),p="vec4";"all"===n?(s="1.0",f="\n        bool reducedAllValue = all(values);\n        float floatedReducedAllValue = float(reducedAllValue);\n        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);\n      ",p="bvec4"):"any"===n&&(s="0.0",f="\n        bool reducedAnyValue = any(values);\n        float floatedReducedAnyValue = float(reducedAnyValue);\n        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);\n      ",p="bvec4");var m="";i%r>0&&(m="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat(s,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float getValue(int batch, int inIdx) {\n        ").concat(m,"\n        return getX(batch, inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ").concat(r,";\n\n        vec4 minMaxValue = vec4(").concat(s,");\n        float prodValue = 1.0;\n        float sumValue = 0.0;\n        float allValue = 1.0;\n        float anyValue = 0.0;\n\n        for (int i = 0; i < ").concat(l,"; i += 4) {\n          int inIdx = inOffset + i;\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          ").concat(f,"\n        }\n\n        int inIdx = inOffset + ").concat(l,";\n        if (").concat(1===d,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(f,"\n        } else if (").concat(2===d,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          ").concat(f,"\n        } else if (").concat(3===d,") {\n          ").concat(p," values = ").concat(p,"(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          ").concat(f,"\n        }\n        setOutput(").concat(u,");\n      }\n    ")};function Hn(e,t,n,r){for(var a=function(e){for(var t=[];0===t.length||1!==t[t.length-1].outSize;){var n=t.length?t[t.length-1].outSize:e[1],r=o.cd.computeOptimalWindowSize(n);t.push({inSize:n,windowSize:r,outSize:Math.ceil(n/r)})}return t}(e.shape),i=e,s=0;s<a.length;s++){var c,u=a[s],l=u.inSize,d=u.windowSize,h=u.outSize,f=void 0;f="mean"===n?0===s?new Un({windowSize:d,inSize:l,batchSize:e.shape[0],outSize:h},l):new Un({windowSize:d,inSize:l,batchSize:e.shape[0],outSize:h}):new zn({windowSize:d,inSize:l,batchSize:e.shape[0],outSize:h},n),c=i,i=r.runWebGLProgram(f,[i],t),c.dataId!==e.dataId&&r.disposeIntermediateTensorInfo(c)}return i}var Vn=function e(t,n){Object(h.a)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];this.outputShape=r,this.rank=r.length;var i=Re(this.rank),o=function(e){var t=e.length;if(t>6)throw Error("Transpose for rank ".concat(t," is not yet supported"));for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(t),a=0;a<e.length;a++)r[e[a]]=n[a];return r.join()}(n);this.userCode="\n    void main() {\n      ".concat(i," resRC = getOutputCoords();\n      setOutput(getA(").concat(o,"));\n    }\n    ")};var Wn=function e(t,n){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[n[a]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error("Packed transpose for rank ".concat(this.rank," is not yet supported."));for(var i=Re(this.rank),o=Wt("rc",this.rank),s=new Array(this.rank),c=0;c<n.length;c++)s[n[c]]=o[c];var u="vec2(".concat(s.slice(-2).join(),")"),l="++".concat(o[this.rank-1]," < ").concat(r[this.rank-1]),d="getChannel(getA(".concat(s.join(),"), ").concat(u,")");this.userCode="\n    void main() {\n      ".concat(i," rc = getOutputCoords();\n      vec4 result = vec4(0.);\n      result[0] = ").concat(d,";\n      if(").concat(l,") {\n        result[1] = ").concat(d,";\n      }\n      --").concat(o[this.rank-1],";\n      if(++").concat(o[this.rank-2]," < ").concat(r[this.rank-2],") {\n        result[2] = ").concat(d,";\n        if(").concat(l,") {\n          result[3] = ").concat(d,";\n        }\n      }\n      setOutput(result);\n    }\n    ")};function Jn(e,t,n){var r=Object(o.md)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Wn(e.shape,t):new Vn(e.shape,t);return n.runWebGLProgram(r,[e],e.dtype)}function Xn(e){var t=e.inputs,n=e.backend,r=e.attrs;return function(e,t,n,r){var a=t,i=e.shape.length,c=o.Ld.parseAxisParam(a,e.shape),u=c,l=o.cd.getAxesPermutation(u,i),d=null!=l,h=e;d&&(h=Jn(e,l,r),u=o.cd.getInnerMostAxes(u.length,i)),o.cd.assertAxesAreInnerMostDims("sum",u,i);var f=o.cd.computeOutAndReduceShapes(h.shape,u),p=Object(s.a)(f,2),m=p[0],v=p[1],g=m;n&&(g=o.cd.expandShapeToKeepDim(m,c));var b=o.Ld.sizeFromShape(v),y=Fn({inputs:{x:h},attrs:{shape:[o.Ld.sizeFromShape(e.shape)/b,b]},backend:r}),x=Hn(y,Object(o.Ed)(e.dtype),"sum",r),w=Fn({inputs:{x:x},attrs:{shape:g},backend:r});return r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(x),d&&r.disposeIntermediateTensorInfo(h),w}(t.x,r.axis,r.keepDims,n)}var Kn={kernelName:o.Nc,backendName:"webgl",kernelFunc:Xn};function qn(e){for(var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,o=a.perm,s=r,c=i.shape.length,u=new Array(c),l=0;l<u.length;l++)u[l]=i.shape[o[l]];if(s.shouldExecuteOnCPU([i])){var d=s.texData.get(i.dataId).values,h=Ht(d,i.shape,i.dtype,o,u);t=s.makeTensorInfo(u,i.dtype),s.texData.get(t.dataId).values=h}else t=Jn(i,o,s);return t}var Yn={kernelName:o.Vc,backendName:"webgl",kernelFunc:qn};function Qn(e){var t=e.a,n=e.b,r=e.transposeA,a=e.transposeB,i=e.backend,s=e.bias,c=void 0===s?null:s,u=e.preluActivationWeights,l=void 0===u?null:u,d=e.leakyreluAlpha,h=void 0===d?0:d,f=e.activation,p=void 0===f?null:f,m=t.shape.length,v=n.shape.length,g=r?t.shape[m-2]:t.shape[m-1],b=a?n.shape[v-1]:n.shape[v-2],y=r?t.shape[m-1]:t.shape[m-2],x=a?n.shape[v-2]:n.shape[v-1],w=t.shape.slice(0,-2),O=n.shape.slice(0,-2),A=o.Ld.sizeFromShape(w),_=o.Ld.sizeFromShape(O),E=A===_||1===A||1===_;o.Ld.assert(m>=2&&v>=2&&E,(function(){return"Error in matMul: the input batch dimensions must either be the same or at least one input batch dimension must be 1. Got input "+"batch dimensions of (".concat(w,") and (").concat(O,").")}));var S=(A>_?t.shape.slice(0,-2):n.shape.slice(0,-2)).concat([y,x]);o.Ld.assert(g===b,(function(){return"Error in matMul: inner shapes (".concat(g,") and (")+"".concat(b,") of Tensors with shapes ").concat(t.shape," and ")+"".concat(n.shape," and transposeA=").concat(r)+" and transposeB=".concat(a," must match.")}));var C,T=r?[A,g,y]:[A,y,g],M=a?[_,x,b]:[_,b,x],k=Fn({inputs:{x:t},backend:i,attrs:{shape:T}}),R=Fn({inputs:{x:n},backend:i,attrs:{shape:M}}),I=[k,R],j=Math.max(A,_),B=r?k.shape[1]:k.shape[2],L=null!=c,N=null!=l,D="leakyrelu"===p,P=null!=p?Rn(p,!0):null;if((1===y||1===x)&&B>1e3&&!1===(L||N||D||null!=P)){var F=k,G=R;r&&(F=qn({inputs:{x:k},backend:i,attrs:{perm:[0,2,1]}}),I.push(F)),a&&(G=qn({inputs:{x:R},backend:i,attrs:{perm:[0,2,1]}}),I.push(G));var U=1===x,z=F;1!==x&&(z=Fn({inputs:{x:F},backend:i,attrs:{shape:[j,B,1]}}),I.push(z));var H=1===x?2:1,V=G;U&&(V=Fn({inputs:{x:G},backend:i,attrs:{shape:[j,1,B]}}),I.push(V));var W=Dn({inputs:{a:z,b:V},backend:i});C=Xn({inputs:{x:W},backend:i,attrs:{axis:H,keepDims:!0}}),I.push(W)}else{var J=Object(o.Kd)(t.dtype,n.dtype),X=new In(T,M,[j,y,x],r,a,L,P,N,D),K=[k,R];if(null!=c&&K.push(c),N&&K.push(l),D){var q=i.makeTensorInfo([],"float32",o.Ld.createScalarValue(h,"float32"));K.push(q),I.push(q)}C=i.runWebGLProgram(X,K,J)}var Y=Fn({inputs:{x:C},backend:i,attrs:{shape:S}});I.push(C);for(var Q=0,Z=I;Q<Z.length;Q++){var $=Z[Q];i.disposeIntermediateTensorInfo($)}return Y}var Zn={kernelName:o.ad,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.a,i=t.b,o=t.bias,s=t.preluActivationWeights,c=r.transposeA,u=r.transposeB,l=r.activation;return Qn({a:a,b:i,transposeA:c,transposeB:u,backend:n,bias:o,preluActivationWeights:s,leakyreluAlpha:r.leakyreluAlpha,activation:l})}},$n="return abs(x);";var er={kernelName:o.a,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])&&"complex64"!==a.dtype){var i=r.texData.get(a.dataId),s=Dt(i.values);return r.makeTensorInfo(a.shape,a.dtype,s)}return t=Object(o.md)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new hn(a.shape,$n):new $t(a.shape,$n),r.runWebGLProgram(t,[a],a.dtype)}},tr=Mn({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return acos(x);\n"}),nr={kernelName:o.b,backendName:"webgl",kernelFunc:tr},rr=Mn({opSnippet:"if (isnan(x)) return x;\n  if (x < 1.0) return NAN;\nreturn log(x + sqrt(x * x - 1.0));"}),ar={kernelName:o.c,backendName:"webgl",kernelFunc:rr},ir="return a + b;",or=kn({opSnippet:ir,packedOpSnippet:ir,supportsComplex:!0,cpuKernelImpl:vt}),sr={kernelName:o.d,backendName:"webgl",kernelFunc:or},cr=function e(t,n){Object(h.a)(this,e),this.outputShape=[],this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("float v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        float result = ").concat(a,";\n        setOutput(result);\n      }\n    ")},ur=function e(t,n){Object(h.a)(this,e),this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.variableNames=n.map((function(e,t){return"T".concat(t)}));var r=[];this.variableNames.forEach((function(e){r.push("vec4 v".concat(e," = get").concat(e,"AtOutCoords();"))}));var a=this.variableNames.map((function(e){return"v".concat(e)})).join(" + ");this.userCode="\n      void main() {\n        ".concat(r.join("\n        "),"\n\n        vec4 result = ").concat(a,";\n        setOutput(result);\n      }\n    ")};var lr={kernelName:o.e,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n;if(1===a.length)return yn({inputs:{x:a[0]},backend:r});if(a.length>Object(o.md)().get("WEBGL_MAX_TEXTURES_IN_SHADER")){var i=Math.floor(a.length/2),s=e({inputs:a.slice(0,i),backend:r}),c=e({inputs:a.slice(i),backend:r});return e({inputs:[s,c],backend:r})}var u=a.map((function(e){return e.dtype})).reduce((function(e,t){return Object(o.Kd)(e,t)})),l=a.map((function(e){return e.shape})),d=Object(o.md)().getBool("WEBGL_PACK")?new ur(a[0].shape,l):new cr(a[0].shape,l);return r.runWebGLProgram(d,a,u)}};var dr={kernelName:o.f,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,c=r.keepDims,u=a.shape.length,l=o.Ld.parseAxisParam(i,a.shape),d=l,h=o.cd.getAxesPermutation(d,u),f=a;null!=h&&(f=qn({inputs:{x:a},backend:n,attrs:{perm:h}}),d=o.cd.getInnerMostAxes(d.length,u)),o.cd.assertAxesAreInnerMostDims("all",d,u);var p,m=o.cd.computeOutAndReduceShapes(f.shape,d),v=Object(s.a)(m,2),g=v[0],b=v[1],y=Fn({inputs:{x:f},backend:n,attrs:{shape:[-1,o.Ld.sizeFromShape(b)]}}),x=Hn(y,y.dtype,"all",n);return p=Fn(c?{inputs:{x:x},backend:n,attrs:{shape:o.cd.expandShapeToKeepDim(g,l)}}:{inputs:{x:x},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),null!=h&&n.disposeIntermediateTensorInfo(f),p}};var hr={kernelName:o.g,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,c=r.keepDims,u=a.shape.length,l=o.Ld.parseAxisParam(i,a.shape),d=l,h=o.cd.getAxesPermutation(d,u),f=a;null!=h&&(f=qn({inputs:{x:a},backend:n,attrs:{perm:h}}),d=o.cd.getInnerMostAxes(d.length,u)),o.cd.assertAxesAreInnerMostDims("any",d,u);var p,m=o.cd.computeOutAndReduceShapes(f.shape,d),v=Object(s.a)(m,2),g=v[0],b=v[1],y=Fn({inputs:{x:f},backend:n,attrs:{shape:[-1,o.Ld.sizeFromShape(b)]}}),x=Hn(y,y.dtype,"any",n);return p=Fn(c?{inputs:{x:x},backend:n,attrs:{shape:o.cd.expandShapeToKeepDim(g,l)}}:{inputs:{x:x},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),null!=h&&n.disposeIntermediateTensorInfo(f),p}},fr=function e(t,n,r){Object(h.a)(this,e),this.variableNames=["A"];var a=t.windowSize,i=t.batchSize,o=t.outSize;r||this.variableNames.push("bestIndicesA"),this.outputShape=[i,o];var s="max"===n?">":"<",c=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = outIdx * ".concat(a,";\n\n        int bestIndex = inOffset;\n        float bestValue = getA(batch, bestIndex);\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          int inIdx = ").concat(c,";\n          float candidate = getA(batch, inIdx);\n          if (candidate ").concat(s," bestValue) {\n            bestValue = candidate;\n            bestIndex = inIdx;\n          }\n        }\n        setOutput(float(bestIndex));\n      }\n    ")},pr=function e(t,n,r,a){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,o.Ld.assert(t.length>2,(function(){return"Packed arg".concat(r.charAt(0).toUpperCase()+r.slice(1)," supports only inputs with rank above 2.")}));var i=t[t.length-1],s=Math.ceil(i/n);this.outputShape=t.slice(0,-1),s>1&&this.outputShape.push(s),a||this.variableNames.push("bestIndicesA");var c,u,l=this.outputShape,d=l.length,f=Re(d),p=Jt("coords",d);if(1===s){var m=Re(u=d+1);c="\n        ".concat(m," sourceLocR = ").concat(m,"(").concat(p.join(),", 0);\n        ++").concat(p[d-1],";\n        ").concat(m," sourceLocG = ").concat(m,"(").concat(p.join(),", 0);\n        ++").concat(p[d-2],";\n        ").concat(m," sourceLocA = ").concat(m,"(").concat(p.join(),", 0);\n        --").concat(p[d-1],";\n        ").concat(m," sourceLocB = ").concat(m,"(").concat(p.join(),", 0);\n        --").concat(p[d-2],";")}else u=d,c="\n        ".concat(f," sourceLocR = coords;\n        ++").concat(p[d-1],";\n        ").concat(f," sourceLocG = coords;\n        ++").concat(p[d-2],";\n        ").concat(f," sourceLocA = coords;\n        --").concat(p[d-1],";\n        ").concat(f," sourceLocB = coords;\n        --").concat(p[d-2],";");var v=["x","y","z","w","u","v"].slice(0,u),g="."+v[u-1],b=v.map((function(e){return"int "+e})),y=Jt("sourceLocR",u-1).concat("inIdx.r"),x=Jt("sourceLocG",u-1).concat("inIdx.g"),w=Jt("sourceLocB",u-1).concat("inIdx.b"),O=Jt("sourceLocA",u-1).concat("inIdx.a"),A="max"===r?"greaterThan":"lessThan",_=a?"":"\n          inIdx = round(vec4(getBestIndicesAChannel(".concat(y.join(),"),\n                             getBestIndicesAChannel(").concat(x.join(),"),\n                             getBestIndicesAChannel(").concat(w.join(),"),\n                             getBestIndicesAChannel(").concat(O.join(),")));"),E="vec4(\n            getAChannel(".concat(y.join(),"),\n            hasNextCol ? getAChannel(").concat(x.join(),") : 0.,\n            hasNextRow ? getAChannel(").concat(w.join(),") : 0.,\n            hasNextRow && hasNextCol ? getAChannel(").concat(O.join(),") : 0.)"),S=a?"":"\n      float getBestIndicesAChannel(".concat(b.join(),") {\n        return getChannel(getBestIndicesA(").concat(v.join(),"),\n                                          vec2(").concat(v.slice(-2).join(),"));\n      }");this.userCode="\n      float getAChannel(".concat(b.join(),") {\n        return getChannel(getA(").concat(v.join(),"),\n                               vec2(").concat(v.slice(-2).join(),"));\n      }\n      ").concat(S,"\n      void main() {\n        ").concat(f," coords = getOutputCoords();\n        bool hasNextCol = ").concat(p[d-1]," < ").concat(l[d-1]-1,";\n        bool hasNextRow = ").concat(p[d-2]," < ").concat(l[d-2]-1,";\n        ").concat(c,"\n        ivec4 srcIdx = ivec4(sourceLocR").concat(g,", sourceLocG").concat(g,",\n          sourceLocB").concat(g,", sourceLocA").concat(g,") * ").concat(n,";\n        ivec4 inIdx = srcIdx;\n        vec4 bestIndex = vec4(inIdx);\n        vec4 bestValue = ").concat(E,";\n\n        for (int i = 0; i < ").concat(n,"; i++) {\n          inIdx = srcIdx;\n          ").concat(_,"\n          vec4 candidate = ").concat(E,";\n          bvec4 nan = isnan(candidate);\n          bvec4 replace = bvec4(\n            vec4(").concat(A,"(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));\n\n          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,\n                           replace.y  ? candidate.y : bestValue.y,\n                           replace.z  ? candidate.z : bestValue.z,\n                           replace.w  ? candidate.w : bestValue.w);\n          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));\n          srcIdx++;\n        }\n        setOutput(bestIndex);\n      }\n    ")};function mr(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=t.shape[0],i=t.shape[1];null!=r&&(a=r.shape[0],i=r.shape[1]);var s=o.cd.computeOptimalWindowSize(i),c={windowSize:s,inSize:i,batchSize:a,outSize:Math.ceil(i/s)},u=new fr(c,n,null==r),l=[t];null!=r&&l.push(r);var d=e.runWebGLProgram(u,l,"int32");if(1===d.shape[1])return d;var h=mr(e,t,n,d);return e.disposeIntermediateTensorInfo(d),h}function vr(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null!=r?r.shape:t.shape,i=a[a.length-1],s=o.cd.computeOptimalWindowSize(i),c=new pr(a,s,n,null==r),u=null==r?[t]:[t,r],l=e.runWebGLProgram(c,u,"int32");if(l.shape.length===t.shape.length){var d=vr(e,t,n,l);return e.disposeIntermediateTensorInfo(l),d}return l}function gr(e,t,n,r){var a=[n];if(o.cd.assertAxesAreInnerMostDims("arg"+r.charAt(0).toUpperCase()+r.slice(1),a,t.shape.length),!Object(o.md)().getBool("WEBGL_PACK_REDUCE")||t.shape.length<=2){var i=[],c=o.cd.computeOutAndReduceShapes(t.shape,a),u=Object(s.a)(c,2),l=u[0],d=u[1],h=o.Ld.sizeFromShape(d),f=Fn({inputs:{x:t},backend:e,attrs:{shape:[-1,h]}});i.push(f);var p=mr(e,f,r);i.push(p);var m=Fn({inputs:{x:p},backend:e,attrs:{shape:l}});return i.forEach((function(t){return e.disposeIntermediateTensorInfo(t)})),m}return vr(e,t,r)}var br={kernelName:o.h,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,s=o.Ld.parseAxisParam(i,a.shape),c=o.cd.getAxesPermutation(s,a.shape.length),u=a,l=[];null!=c&&(u=qn({inputs:{x:a},backend:n,attrs:{perm:c}}),l.push(u),s=o.cd.getInnerMostAxes(s.length,u.shape.length)),o.cd.assertAxesAreInnerMostDims("argMax",[s[0]],u.shape.length);var d=gr(n,u,s[0],"max");return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),d}};var yr={kernelName:o.i,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,s=o.Ld.parseAxisParam(i,a.shape),c=o.cd.getAxesPermutation(s,a.shape.length),u=a,l=[];null!=c&&(u=qn({inputs:{x:a},backend:n,attrs:{perm:c}}),l.push(u),s=o.cd.getInnerMostAxes(s.length,u.shape.length)),o.cd.assertAxesAreInnerMostDims("argMin",[s[0]],u.shape.length);var d=gr(n,u,s[0],"min");return l.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),d}},xr=Mn({opSnippet:"if (isnan(x)) return x;\n  if (abs(x) > 1.) {\n    return NAN;\n  }\n  return asin(x);\n"}),wr={kernelName:o.j,backendName:"webgl",kernelFunc:xr},Or=Mn({opSnippet:"if (isnan(x)) return x;return log(x + sqrt(x * x + 1.0));"}),Ar={kernelName:o.k,backendName:"webgl",kernelFunc:Or},_r=Mn({opSnippet:"if (isnan(x)) return x;\n  return atan(x);\n"}),Er={kernelName:o.l,backendName:"webgl",kernelFunc:_r},Sr=kn({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return atan(a, b);\n",packedOpSnippet:"\n  vec4 result = atan(a, b);\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),Cr={kernelName:o.m,backendName:"webgl",kernelFunc:Sr},Tr=Mn({opSnippet:"if (isnan(x)) return x;\n  if ((x < -1.0) || (x > 1.0)) return NAN;\nreturn (log(1.0 + x) - log(1.0 - x)) / 2.0;"}),Mr={kernelName:o.n,backendName:"webgl",kernelFunc:Tr},kr=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(h.a)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideHeight,c=t.strideWidth,u=t.dilationHeight,l=t.dilationWidth,d=t.effectiveFilterHeight,f=t.effectiveFilterWidth,p=t.padInfo.top,m=t.padInfo.left;this.outputShape=t.outShape;var v="avg"===n,g="((batch  * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),b="(xR * ".concat(t.inWidth," + xC) * ").concat(t.inChannels," + d"),y="0.0";if(v||(y="-1.0 / 1e-20"),r){var x=">=";this.userCode="\n        const ivec2 strides = ivec2(".concat(s,", ").concat(c,");\n        const ivec2 pads = ivec2(").concat(p,", ").concat(m,");\n\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int batch = coords[0];\n          int d = coords[3];\n\n          ivec2 xRCCorner = coords.yz * strides - pads;\n          int xRCorner = xRCCorner.x;\n          int xCCorner = xRCCorner.y;\n\n          // max/min x(?, ?, d) to get y(yR, yC, d).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n          float avgValue = 0.0;\n\n          for (int wR = 0; wR < ").concat(d,";\n              wR += ").concat(u,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(f,";\n                wC += ").concat(l,") {\n              int xC = xCCorner + wC;\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float value = getX(batch, xR, xC, d);\n\n              // If a min / max value has already been found, use it. If not,\n              // use the current value.\n              float currMinMaxValue = mix(\n                  value, minMaxValue, minMaxValueFound);\n              if (value ").concat(x," currMinMaxValue) {\n                minMaxValue = value;\n                minMaxValueFound = 1.0;\n                minMaxPosition = ").concat(a?i?g:b:"wR * ".concat(f," + wC"),";\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var w="max",O="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(O="avgValue / count");var A=4*Math.floor(o/4),_=o%4,E="\n      if (".concat(v,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(w,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec2 strides = ivec2(".concat(s,", ").concat(c,");\n      const ivec2 pads = ivec2(").concat(p,", ").concat(m,");\n      const float initializationValue = ").concat(y,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xR, int xC, int d) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xR, xC, d);\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d = coords[3];\n\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // max/min x(?, ?, d) to get y(yR, yC, d).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(y,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wR = 0; wR < ").concat(d,";\n            wR += ").concat(u,") {\n          int xR = xRCorner + wR;\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(A,"; wC += 4) {\n            int xC = xCCorner + wC * ").concat(l,";\n\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              getValue(batch, xR, xC + 3 * ").concat(l,", d)\n            );\n\n            ").concat(E,"\n          }\n\n          int xC = xCCorner + ").concat(A,";\n          if (").concat(1===_,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              initializationValue,\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(E,"\n          } else if (").concat(2===_,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              initializationValue,\n              initializationValue\n            );\n\n            ").concat(E,"\n          } else if (").concat(3===_,") {\n            vec4 values = vec4(\n              getValue(batch, xR, xC, d),\n              getValue(batch, xR, xC + ").concat(l,", d),\n              getValue(batch, xR, xC + 2 * ").concat(l,", d),\n              initializationValue\n            );\n\n            ").concat(E,"\n          }\n        }\n        setOutput(").concat(O,");\n      }\n    ")}},Rr=function e(t,n,r){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(Object(h.a)(this,e),this.variableNames=["x"],"avg"===n&&r)throw new Error("Cannot compute positions for average pool.");var o=t.filterWidth,s=t.strideDepth,c=t.strideHeight,u=t.strideWidth,l=t.dilationDepth,d=t.dilationHeight,f=t.dilationWidth,p=t.effectiveFilterDepth,m=t.effectiveFilterHeight,v=t.effectiveFilterWidth,g=t.padInfo.front,b=t.padInfo.top,y=t.padInfo.left;this.outputShape=t.outShape;var x="avg"===n,w="0.0";if(x||(w="-1.0 / 1e-20"),r){var O=">=";this.userCode="\n        const ivec3 strides =\n            ivec3(".concat(s,", ").concat(c,", ").concat(u,");\n        const ivec3 pads = ivec3(").concat(g,", ").concat(b,", ").concat(y,");\n\n        void main() {\n          ivec5 coords = getOutputCoords();\n          int batch = coords.x;\n          int ch = coords.u;\n\n          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n          int xDCorner = xCorner.x;\n          int xRCorner = xCorner.y;\n          int xCCorner = xCorner.z;\n\n          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).\n          // ? = to be determined\n          float minMaxValue = 0.0;\n          float minMaxValueFound = 0.0;\n          int minMaxPosition = 0;\n\n          for (int wD = 0; wD < ").concat(p,";\n              wD += ").concat(l,") {\n            int xD = xDCorner + wD;\n\n            if (xD < 0 || xD >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int wR = 0; wR < ").concat(m,";\n                wR += ").concat(d,") {\n              int xR = xRCorner + wR;\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int wC = 0; wC < ").concat(v,";\n                  wC += ").concat(f,") {\n                int xC = xCCorner + wC;\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float value = getX(batch, xD, xR, xC, ch);\n\n                // If a min / max value has already been found, use it. If not,\n                // use the current value.\n                float currMinMaxValue = mix(\n                    value, minMaxValue, minMaxValueFound);\n                if (value ").concat(O," currMinMaxValue) {\n                  minMaxValue = value;\n                  minMaxValueFound = 1.0;\n                  minMaxPosition = ").concat(a?i?"(((batch * ".concat(t.inDepth," + xD) * ").concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"((xD * ".concat(t.inHeight," + xR) * ").concat(t.inWidth," + xC) * ").concat(t.inChannels," + ch"):"wD * ".concat(m," * ").concat(v," +\n                      wR * ").concat(v," + wC"),";\n                }\n              }\n            }\n          }\n          setOutput(float(minMaxPosition));\n        }\n      ")}else{var A="max",_="".concat(n,"(").concat(n,"(").concat(n,"(")+"minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])";"avg"===n&&(_="avgValue / count");var E=4*Math.floor(o/4),S=o%4,C="\n      if (".concat(x,") {\n        avgValue += dot(values, ones);\n      } else {\n        minMaxValue = ").concat(A,"(values, minMaxValue);\n      }\n    ");this.userCode="\n      const ivec3 strides =\n        ivec3(".concat(s,", ").concat(c,", ").concat(u,");\n      const ivec3 pads = ivec3(").concat(g,", ").concat(b,", ").concat(y,");\n      const float initializationValue = ").concat(w,";\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\n\n      float count = 0.0;\n\n      float getValue(int batch, int xD, int xR, int xC, int ch) {\n        if (xC < 0 || xC >= ").concat(t.inWidth,") {\n          return initializationValue;\n        }\n        count += 1.0;\n        return getX(batch, xD, xR, xC, ch);\n      }\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xDCorner = xCorner.x;\n        int xRCorner = xCorner.y;\n        int xCCorner = xCorner.z;\n\n        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).\n        // ? = to be determined\n        vec4 minMaxValue = vec4(").concat(w,");\n        float avgValue = 0.0;\n        count = 0.0;\n\n        for (int wD = 0; wD < ").concat(p,";\n            wD += ").concat(l,") {\n          int xD = xDCorner + wD;\n\n          if (xD < 0 || xD >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(m,";\n            wR += ").concat(d,") {\n            int xR = xRCorner + wR;\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(E,"; wC += 4) {\n              int xC = xCCorner + wC * ").concat(f,";\n\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 3 * ").concat(f,", ch)\n              );\n\n              ").concat(C,"\n            }\n\n            int xC = xCCorner + ").concat(E,";\n            if (").concat(1===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                initializationValue,\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(2===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                initializationValue,\n                initializationValue\n              );\n\n              ").concat(C,"\n            } else if (").concat(3===S,") {\n              vec4 values = vec4(\n                getValue(batch, xD, xR, xC, ch),\n                getValue(batch, xD, xR, xC + ").concat(f,", ch),\n                getValue(batch, xD, xR, xC + 2 * ").concat(f,", ch),\n                initializationValue\n              );\n\n              ").concat(C,"\n            }\n          }\n          setOutput(").concat(_,");\n        }\n      }\n    ")}};var Ir={kernelName:o.o,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;Y(a,"avgPool");var i=r.filterSize,s=r.strides,c=r.pad,u=r.dimRoundingMode;o.Ld.assert(o.cd.eitherStridesOrDilationsAreOne(s,1),(function(){return"Error in avgPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")}));var l=o.cd.computePool2DInfo(a.shape,i,s,1,c,u);if(1===l.filterWidth&&1===l.filterHeight&&o.Ld.arraysEqual(l.inShape,l.outShape))return yn({inputs:{x:a},backend:n});var d=new kr(l,"avg",!1);return n.runWebGLProgram(d,[a],"float32")}};var jr={kernelName:o.p,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,s=r.strides,c=r.pad,u=r.dimRoundingMode,l=r.dataFormat,d=o.cd.computePool3DInfo(a.shape,i,s,[1,1,1],c,u,l),h=new Rr(d,"avg",!1);return n.runWebGLProgram(h,[a],"float32")}},Br=function e(t){Object(h.a)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=t.dilationHeight,s=t.dilationWidth,c=t.effectiveFilterHeight,u=t.effectiveFilterWidth,l=c-1-t.padInfo.top,d=u-1-t.padInfo.left,f=1/(n*r);this.userCode="\n      const ivec2 pads = ivec2(".concat(l,", ").concat(d,");\n      const float avgMultiplier = float(").concat(f,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(c,";\n            wR += ").concat(o,") {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(u,";\n            wC+= ").concat(s,") {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n\n            dotProd += dyValue * avgMultiplier;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Lr=function e(t){Object(h.a)(this,e),this.variableNames=["dy"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,c=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,d=t.effectiveFilterDepth,f=t.effectiveFilterHeight,p=t.effectiveFilterWidth,m=d-1-t.padInfo.front,v=f-1-t.padInfo.top,g=p-1-t.padInfo.left,b=1/(n*r*a);this.userCode="\n      const ivec3 pads = ivec3(".concat(m,", ").concat(v,", ").concat(g,");\n      const float avgMultiplier = float(").concat(b,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(d,";\n            wD += ").concat(c,") {\n          float dyD = float(dyDCorner + wD) / ").concat(i,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(f,";\n              wR += ").concat(u,") {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(p,";\n                wC += ").concat(l,") {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n\n              dotProd += dyValue * avgMultiplier;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var Nr={kernelName:o.q,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,s=r.filterSize,c=r.strides,u=r.pad,l=r.dimRoundingMode,d=o.cd.computePool3DInfo(i.shape,s,c,[1,1,1],u,l),h=new Lr(d);return n.runWebGLProgram(h,[a],i.dtype)}};var Dr={kernelName:o.r,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,s=i;Y([a,i],"avgPoolGrad");var c=r.filterSize,u=r.strides,l=r.pad,d=o.cd.computePool2DInfo(s.shape,c,u,1,l),h=new Br(d);return n.runWebGLProgram(h,[a],s.dtype)}};var Pr={kernelName:o.s,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs;return Qn({a:t.a,b:t.b,transposeA:r.transposeA,transposeB:r.transposeB,backend:n})}},Fr=function e(t,n,r,a,i,s){Object(h.a)(this,e),this.outputShape=[],this.variableNames=["x","mean","variance"],o.cd.assertAndGetBroadcastShape(t,n),o.cd.assertAndGetBroadcastShape(t,r);var c="0.0";null!=a&&(o.cd.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");var u="1.0";null!=i&&(o.cd.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        float x = getXAtOutCoords();\n        float mean = getMeanAtOutCoords();\n        float variance = getVarianceAtOutCoords();\n        float offset = ".concat(c,";\n        float scale = ").concat(u,";\n        float inv = scale * inversesqrt(variance + float(").concat(s,"));\n        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));\n      }\n    ")},Gr=function e(t,n,r,a,i,s){Object(h.a)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],o.cd.assertAndGetBroadcastShape(t,n),o.cd.assertAndGetBroadcastShape(t,r);var c="vec4(0.0)";null!=a&&(o.cd.assertAndGetBroadcastShape(t,a),this.variableNames.push("offset"),c="getOffsetAtOutCoords()");var u="vec4(1.0)";null!=i&&(o.cd.assertAndGetBroadcastShape(t,i),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=t,this.userCode="\n      void main() {\n        vec4 offset = ".concat(c,";\n        vec4 scale = ").concat(u,";\n\n        vec4 x = getXAtOutCoords();\n        vec4 mean = getMeanAtOutCoords();\n        vec4 variance = getVarianceAtOutCoords();\n\n        vec4 inv = scale * inversesqrt(variance + vec4(").concat(s,"));\n\n        setOutput((x - mean) * inv + offset);\n      }\n    ")},Ur={kernelName:o.gb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.mean,s=t.variance,c=t.offset,u=t.scale;o.Ld.assert(i.shape.length===s.shape.length,(function(){return"Batch normalization gradient requires mean and variance to have equal ranks."})),o.Ld.assert(null==c||i.shape.length===c.shape.length,(function(){return"Batch normalization gradient requires mean and offset to have equal ranks."})),o.Ld.assert(null==u||i.shape.length===u.shape.length,(function(){return"Batch normalization gradient requires mean and scale to have equal ranks."}));var l=r.varianceEpsilon;null==l&&(l=.001);var d=[a,i,s],h=null;null!=c&&(h=c.shape,d.push(c));var f=null;null!=u&&(f=u.shape,d.push(u));var p=Object(o.md)().getBool("WEBGL_PACK_NORMALIZATION")?new Gr(a.shape,i.shape,s.shape,h,f,l):new Fr(a.shape,i.shape,s.shape,h,f,l);return n.runWebGLProgram(p,d,d[0].dtype)}},zr=function(){function e(t){Object(h.a)(this,e),this.variableNames=["source"],this.outputShape=t,this.rank=t.length;var n,r=Re(this.rank),a="uniform int start[".concat(this.rank,"];"),i=function(e){if(1===e)return"sourceLoc";if(e<=6)return Hr.slice(0,e).map((function(e){return"sourceLoc."+e})).join(",");throw Error("Slicing for rank ".concat(e," is not yet supported"))}(this.rank),o=t.map((function(e,t){return"sourceLoc.".concat(Hr[t]," = start[").concat(t,"] + coords.").concat(Hr[t],";")}));n="\n        ".concat(r," sourceLoc;\n        ").concat(r," coords = getOutputCoords();\n        ").concat(o.join("\n"),"\n      "),this.userCode="\n      ".concat(a,"\n      void main() {\n        ").concat(n,"\n        setOutput(getSource(").concat(i,"));\n      }\n    ")}return Object(f.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}(),Hr=["x","y","z","w","u","v"];var Vr=function(){function e(t){Object(h.a)(this,e),this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.rank=t.length;var n=Re(this.rank),r=Jt("coords",this.rank),a=Jt("sourceLoc",this.rank),i=1===this.rank?"sourceLoc":"vec2(".concat(a.slice(-2).join(),")"),o="getChannel(getSource(".concat(a.join(),"), ").concat(i,")"),s="\n      result.x = ".concat(o,";\n      if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n        ++").concat(a[this.rank-1],";\n        result.y = ").concat(o,";\n        --").concat(a[this.rank-1],";\n      }\n    "),c=1===this.rank?"":"\n      --".concat(r[this.rank-1],";\n      if (++").concat(r[this.rank-2]," < ").concat(t[this.rank-2],") {\n        ++").concat(a[this.rank-2],";\n        result.z = ").concat(o,";\n        if (++").concat(r[this.rank-1]," < ").concat(t[this.rank-1],") {\n          ++").concat(a[this.rank-1],";\n          result.w = ").concat(o,";\n        }\n      }\n    "),u=this.rank<=4?"sourceLoc = coords +\n            ".concat(n,"(").concat(t.map((function(e,t){return"start[".concat(t,"]")})).join(),");"):t.map((function(e,t){return"".concat(a[t]," = ").concat(r[t]," + start[").concat(t,"];")})).join("\n");this.userCode="\n      uniform int start[".concat(this.rank,"];\n      void main() {\n        ").concat(n," coords = getOutputCoords();\n        ").concat(n," sourceLoc;\n        ").concat(u,"\n        vec4 result = vec4(0.);\n        ").concat(s,"\n        ").concat(c,"\n        setOutput(result);\n      }\n    ")}return Object(f.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;if(e.length!==this.rank)throw Error("The rank (".concat(this.rank,") of the program must match the ")+"length of start (".concat(e.length,")"));return function(n,r){null==t.startLoc&&(t.startLoc=n.getUniformLocationNoThrow(r,"start"),null==t.startLoc)||n.gl.uniform1iv(t.startLoc,e)}}}]),e}();function Wr(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.begin,c=r.size,u=o.Ad.parseSliceParams(a,i,c),l=Object(s.a)(u,2),d=l[0],h=l[1];if(o.Ad.assertParamsValid(a,d,h),0===o.Ld.sizeFromShape(h))return n.makeTensorInfo(h,a.dtype,[]);if(n.shouldExecuteOnCPU([a])||"string"===a.dtype){var f=n.texData.get(a.dataId),p=Pt(f.values,d,h,a.shape,a.dtype);return n.makeTensorInfo(h,a.dtype,p)}var m=n.texData.get(a.dataId).isPacked,v=o.Ad.isSliceContinous(a.shape,d,h);if(m||!v){var g=Object(o.md)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Vr(h):new zr(h),b=g.getCustomSetupFunc(d);return n.runWebGLProgram(g,[a],a.dtype,b)}return n.uploadToGPU(a.dataId),function(e,t,n,r){var a=r.texData.get(e.dataId),i=r.makeTensorInfo(n,e.dtype),s=r.texData.get(i.dataId);Object.assign(s,a),s.refCount=1,s.shape=n,s.dtype=e.dtype;var c=o.Ad.computeFlatOffset(t,o.Ld.computeStrides(e.shape));a.slice&&(c+=a.slice.flatOffset),s.slice={flatOffset:c,origDataId:a.slice&&a.slice.origDataId||e.dataId};var u=r.dataRefCount.get(s.slice.origDataId)||1;return r.dataRefCount.set(s.slice.origDataId,u+1),i}(a,d,h,n)}var Jr={kernelName:o.Bc,backendName:"webgl",kernelFunc:Wr},Xr={kernelName:o.t,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,s=r.crops;o.Ld.assert(a.shape.length<=4,(function(){return"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet"}));var c=i.reduce((function(e,t){return e*t})),u=o.cd.getReshaped(a.shape,i,c),l=o.cd.getPermuted(u.length,i.length),d=o.cd.getReshapedPermuted(a.shape,i,c),h=o.cd.getSliceBeginCoords(s,i.length),f=o.cd.getSliceSize(d,s,i.length),p=[],m=Fn({inputs:{x:a},backend:n,attrs:{shape:u}}),v=qn({inputs:{x:m},backend:n,attrs:{perm:l}}),g=Fn({inputs:{x:v},backend:n,attrs:{shape:d}}),b=Wr({inputs:{x:g},backend:n,attrs:{begin:h,size:f}});return p.push(m),p.push(v),p.push(g),p.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),b}};var Kr={kernelName:o.u,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=n.readSync(a.dataId),c=n.readSync(i.dataId),u=gt(s,c,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,u)}},qr=kn({opSnippet:"return float(a != b);",dtype:"bool"}),Yr={kernelName:o.Xb,backendName:"webgl",kernelFunc:qr};function Qr(e){var t=e.inputs,n=e.backend,r=t.input;return yn({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.real},backend:n})}var Zr={kernelName:o.gc,backendName:"webgl",kernelFunc:Qr};var $r={kernelName:o.v,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=t.attrs,i=n.x,s=a.dtype;if("complex64"===s){if("complex64"===i.dtype)return yn({inputs:{x:i},backend:r});var c=o.Md(i.shape),u=e({inputs:{x:i},backend:r,attrs:{dtype:"float32"}}),l=wn({inputs:{real:u,imag:c},backend:r});return c.dispose(),r.disposeIntermediateTensorInfo(u),l}if("complex64"===i.dtype){var d=Qr({inputs:{input:i},backend:r}),h=e({inputs:{x:d},backend:r,attrs:{dtype:s}});return r.disposeIntermediateTensorInfo(d),h}if(!o.Ld.hasEncodingLoss(i.dtype,s)){var f=yn({inputs:{x:i},backend:r});return{dataId:f.dataId,shape:f.shape,dtype:s}}if("int32"===s)return function(e,t){var n=new $t(e.shape,"return float(int(x));"),r=t.runWebGLProgram(n,[e],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}(i,r);if("bool"===s){var p=r.makeTensorInfo([],"bool",o.Ld.getTypedArrayFromDType("bool",1)),m=qr({inputs:{a:i,b:p},backend:r});return r.disposeIntermediateTensorInfo(p),m}throw new Error("Error in Cast: failed to cast ".concat(i.dtype," to ").concat(s))}},ea="return ceil(x);",ta=Mn({opSnippet:ea,packedOpSnippet:ea,cpuKernelImpl:yt}),na={kernelName:o.w,backendName:"webgl",kernelFunc:ta},ra=function(){function e(t){Object(h.a)(this,e),this.variableNames=["A"],this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        float value = getAAtOutCoords();\n        if (isnan(value)) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, minVal, maxVal));\n      }\n    "}return Object(f.a)(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}(),aa=function(){function e(t){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t,this.userCode="\n      uniform float minVal;\n      uniform float maxVal;\n\n      void main() {\n        vec4 value = getAAtOutCoords();\n\n        if (any(isnan(value))) {\n          setOutput(value);\n          return;\n        }\n\n        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));\n      }\n    "}return Object(f.a)(e,[{key:"getCustomSetupFunc",value:function(e,t){var n=this;return function(r,a){null==n.minLoc&&(n.minLoc=r.getUniformLocationNoThrow(a,"minVal"),n.maxLoc=r.getUniformLocationNoThrow(a,"maxVal")),r.gl.uniform1f(n.minLoc,e),r.gl.uniform1f(n.maxLoc,t)}}}]),e}();var ia={kernelName:o.x,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,s=a.clipValueMin,c=a.clipValueMax,u=(t=Object(o.md)().getBool("WEBGL_PACK_CLIP")?new aa(i.shape):new ra(i.shape)).getCustomSetupFunc(s,c);return r.runWebGLProgram(t,[i],i.dtype,u)}},oa=function e(t){Object(h.a)(this,e),this.variableNames=["real","imag"],this.outputShape=t,this.userCode="\n      void main() {\n        float re = abs(getRealAtOutCoords());\n        float im = abs(getImagAtOutCoords());\n        float mx = max(re, im);\n\n        // sadly the length function in glsl is not underflow-safe\n        // (at least not on Intel GPUs). So the safe solution is\n        // to ensure underflow-safety in all cases.\n        setOutput(\n          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))\n        );\n      }\n    "};function sa(e,t){return{dataId:t.dataId,dtype:t.dtype,shape:e.shape}}var ca={kernelName:o.z,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=n.texData.get(r.dataId),i=new oa(r.shape),o=[sa(r,a.complexTensorInfos.real),sa(r,a.complexTensorInfos.imag)];return n.runWebGLProgram(i,o,o[0].dtype)}},ua=function e(t){Object(h.a)(this,e),this.outputShape=[],this.outputShape=o.cd.computeOutShape(t,1),this.variableNames=t.map((function(e,t){return"T".concat(t)}));var n=new Array(t.length-1);n[0]=t[0][1];for(var r=1;r<n.length;r++)n[r]=n[r-1]+t[r][1];for(var a=["if (yC < ".concat(n[0],") setOutput(getT0(yR, yC));")],i=1;i<n.length;i++){var s=n[i-1];a.push("else if (yC < ".concat(n[i],") ")+"setOutput(getT".concat(i,"(yR, yC-").concat(s,"));"))}var c=n.length,u=n[n.length-1];a.push("else setOutput(getT".concat(c,"(yR, yC-").concat(u,"));")),this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int yR = coords.x;\n        int yC = coords.y;\n\n        ".concat(a.join("\n        "),"\n      }\n    ")},la=function e(t,n){Object(h.a)(this,e),this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=o.cd.computeOutShape(t,n);var r=this.outputShape,a=r.length,i=Re(a),s=Jt("coords",a),c=["x","y","z","w","u","v"].slice(0,a);this.variableNames=t.map((function(e,t){return"T".concat(t)}));var u=new Array(t.length-1);u[0]=t[0][n];for(var l=1;l<u.length;l++)u[l]=u[l-1]+t[l][n];for(var d=c[n],f=c.slice(-2),p=c.join(),m="if (".concat(d," < ").concat(u[0],") {\n        return getChannel(\n            getT0(").concat(p,"), vec2(").concat(f.join(),"));\n        }"),v=1;v<u.length;v++){var g=u[v-1];m+="\n        if (".concat(d," < ").concat(u[v],"  && ").concat(d," >= ").concat(u[v-1],") {\n          return getChannel(\n            getT").concat(v,"(").concat(da(c,d,g),"),\n            vec2(").concat(da(f,d,g),"));\n        }")}var b=u.length,y=u[u.length-1];m+="\n        return getChannel(\n          getT".concat(b,"(").concat(da(c,d,y),"),\n          vec2(").concat(da(f,d,y),"));"),this.userCode="\n      float getValue(".concat(c.map((function(e){return"int "+e})),") {\n        ").concat(m,"\n      }\n\n      void main() {\n        ").concat(i," coords = getOutputCoords();\n        vec4 result = vec4(getValue(").concat(s,"), 0., 0., 0.);\n\n        ").concat(s[a-1]," = ").concat(s[a-1]," + 1;\n        if (").concat(s[a-1]," < ").concat(r[a-1],") {\n          result.g = getValue(").concat(s,");\n        }\n\n        ").concat(s[a-2]," = ").concat(s[a-2]," + 1;\n        if (").concat(s[a-2]," < ").concat(r[a-2],") {\n          result.a = getValue(").concat(s,");\n        }\n\n        ").concat(s[a-1]," = ").concat(s[a-1]," - 1;\n        if (").concat(s[a-2]," < ").concat(r[a-2]," &&\n            ").concat(s[a-1]," < ").concat(r[a-1],") {\n          result.b = getValue(").concat(s,");\n        }\n        setOutput(result);\n      }\n    ")};function da(e,t,n){var r=e.indexOf(t);return e.map((function(e,t){return t===r?"".concat(e," - ").concat(n):e})).join()}function ha(e){var t=e.inputs,n=e.backend,r=t.input;return yn({inputs:{x:n.texData.get(r.dataId).complexTensorInfos.imag},backend:n})}var fa={kernelName:o.pb,backendName:"webgl",kernelFunc:ha};function pa(e,t,n){var r=e[0].dtype;if("complex64"===r){var a=e.map((function(e){return Qr({inputs:{input:e},backend:n})})),i=e.map((function(e){return ha({inputs:{input:e},backend:n})})),s=pa(a,t,n),c=pa(i,t,n),u=wn({inputs:{real:s,imag:c},backend:n});return a.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),i.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(c),u}if("string"===r){var l=ma(e,t,n),d=l.tensors2D,h=l.outShape,f=d.map((function(e){return{vals:n.readSync(e.dataId),shape:e.shape}})),p=1===d[0].shape[0],m=xt(f,h,r,p),v=o.cd.computeOutShape(e.map((function(e){return e.shape})),t),g=n.makeTensorInfo(v,r,m);return d.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}if(e.length>Object(o.md)().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){var b=Math.floor(e.length/2),y=pa(e.slice(0,b),t,n),x=pa(e.slice(b),t,n),w=pa([y,x],t,n);return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),w}if(Object(o.md)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&e[0].shape.length>1){var O=new la(e.map((function(e){return e.shape})),t);return n.runWebGLProgram(O,e,r)}var A=ma(e,t,n),_=A.tensors2D,E=A.outShape,S=new ua(_.map((function(e){return e.shape}))),C=n.runWebGLProgram(S,_,r);_.forEach((function(e){return n.disposeIntermediateTensorInfo(e)}));var T=Fn({inputs:{x:C},attrs:{shape:E},backend:n});return n.disposeIntermediateTensorInfo(C),T}function ma(e,t,n){var r=o.cd.computeOutShape(e.map((function(e){return e.shape})),t);return{tensors2D:e.map((function(e){return Fn({inputs:{x:e},attrs:{shape:[-1,o.Ld.sizeFromShape(e.shape.slice(t))]},backend:n})})),outShape:r}}function va(e){var t=e.inputs,n=e.backend,r=e.attrs.axis,a=o.Ld.parseAxisParam(r,t[0].shape)[0],i=o.cd.computeOutShape(t.map((function(e){return e.shape})),a);if(0===o.Ld.sizeFromShape(i))return n.makeTensorInfo(i,t[0].dtype,[]);var s=t.filter((function(e){return o.Ld.sizeFromShape(e.shape)>0}));if(1===s.length)return yn({inputs:{x:s[0]},backend:n});var c=s.map((function(e){return e.shape}));return o.cd.assertParamsConsistent(c,a),pa(s,a,n)}var ga={kernelName:o.A,backendName:"webgl",kernelFunc:va},ba=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(h.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.padInfo.top,s=t.padInfo.left,c=t.strideHeight,u=t.strideWidth,l=t.dilationHeight,d=t.dilationWidth,f=t.filterHeight,p=t.filterWidth,m=4*Math.floor(t.inChannels/4),v=t.inChannels%4,g="channelsLast"===t.dataFormat,b=g?1:2,y=g?2:3,x=g?3:1,w="",O="";r&&(w=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),O="result = activation(result);");var A=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(w,"\n\n      const ivec2 strides = ivec2(").concat(c,", ").concat(u,");\n      const ivec2 pads = ivec2(").concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d2 = coords[").concat(x,"];\n\n        ivec2 xRCCorner =\n            ivec2(coords[").concat(b,"], coords[").concat(y,"]) * strides - pads;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(f,"; wR++) {\n          int xR = xRCorner + wR * ").concat(l,";\n\n          if (xR < 0 || xR >= ").concat(t.inHeight,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(p,"; wC++) {\n            int xC = xCCorner + wC * ").concat(d,";\n\n            if (xC < 0 || xC >= ").concat(t.inWidth,") {\n              continue;\n            }\n\n            for (int d1 = 0; d1 < ").concat(m,"; d1 += 4) {\n              vec4 wValues = vec4(\n                getW(wR, wC, d1, d2),\n                getW(wR, wC, d1 + 1, d2),\n                getW(wR, wC, d1 + 2, d2),\n                getW(wR, wC, d1 + 3, d2)\n              );\n\n              if (").concat(g,") {\n                vec4 xValues = vec4(\n                  getX(batch, xR, xC, d1),\n                  getX(batch, xR, xC, d1 + 1),\n                  getX(batch, xR, xC, d1 + 2),\n                  getX(batch, xR, xC, d1 + 3)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec4 xValues = vec4(\n                  getX(batch, d1, xR, xC),\n                  getX(batch, d1 + 1, xR, xC),\n                  getX(batch, d1 + 2, xR, xC),\n                  getX(batch, d1 + 3, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n\n            if (").concat(1===v,") {\n\n              if (").concat(g,") {\n                dotProd +=\n                    getX(batch, xR, xC, ").concat(m,") *\n                    getW(wR, wC, ").concat(m,", d2);\n              } else {\n                dotProd +=\n                    getX(batch, ").concat(m,", xR, xC) *\n                    getW(wR, wC, ").concat(m,", d2);\n              }\n\n            } else if (").concat(2===v,") {\n              vec2 wValues = vec2(\n                getW(wR, wC, ").concat(m,", d2),\n                getW(wR, wC, ").concat(m," + 1, d2)\n              );\n\n              if (").concat(g,") {\n                vec2 xValues = vec2(\n                  getX(batch, xR, xC, ").concat(m,"),\n                  getX(batch, xR, xC, ").concat(m," + 1)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec2 xValues = vec2(\n                  getX(batch, ").concat(m,", xR, xC),\n                  getX(batch, ").concat(m," + 1, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            } else if (").concat(3===v,") {\n              vec3 wValues = vec3(\n                getW(wR, wC, ").concat(m,", d2),\n                getW(wR, wC, ").concat(m," + 1, d2),\n                getW(wR, wC, ").concat(m," + 2, d2)\n              );\n\n              if (").concat(g,") {\n                vec3 xValues = vec3(\n                  getX(batch, xR, xC, ").concat(m,"),\n                  getX(batch, xR, xC, ").concat(m," + 1),\n                  getX(batch, xR, xC, ").concat(m," + 2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else {\n                vec3 xValues = vec3(\n                  getX(batch, ").concat(m,", xR, xC),\n                  getX(batch, ").concat(m," + 1, xR, xC),\n                  getX(batch, ").concat(m," + 2, xR, xC)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n\n            }\n          }\n        }\n\n        float result = dotProd;\n        ").concat(A,"\n        ").concat(O,"\n        setOutput(result);\n      }\n    ")},ya=function e(t){Object(h.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.padInfo.front,r=t.padInfo.top,a=t.padInfo.left,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,c=t.dilationDepth,u=t.dilationHeight,l=t.dilationWidth,d=t.filterDepth,f=t.filterHeight,p=t.filterWidth,m=4*Math.floor(t.inChannels/4),v=t.inChannels%4;this.userCode="\n      const ivec3 strides = ivec3(".concat(i,", ").concat(o,", ").concat(s,");\n      const ivec3 pads = ivec3(").concat(n,", ").concat(r,", ").concat(a,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d2 = coords.u;\n\n        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;\n        int xFCorner = xFRCCorner.x;\n        int xRCorner = xFRCCorner.y;\n        int xCCorner = xFRCCorner.z;\n\n        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get\n        // y(yF, yR, yC, d2). ? = to be determined. : = across all\n        // values in that axis.\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(d,"; wF++) {\n          int xF = xFCorner + wF * ").concat(c,";\n\n          if (xF < 0 || xF >= ").concat(t.inDepth,") {\n            continue;\n          }\n\n          for (int wR = 0; wR < ").concat(f,"; wR++) {\n            int xR = xRCorner + wR * ").concat(u,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int wC = 0; wC < ").concat(p,"; wC++) {\n              int xC = xCCorner + wC * ").concat(l,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              for (int d1 = 0; d1 < ").concat(m,"; d1 += 4) {\n                vec4 xValues = vec4(\n                  getX(batch, xF, xR, xC, d1),\n                  getX(batch, xF, xR, xC, d1 + 1),\n                  getX(batch, xF, xR, xC, d1 + 2),\n                  getX(batch, xF, xR, xC, d1 + 3)\n                );\n                vec4 wValues = vec4(\n                  getW(wF, wR, wC, d1, d2),\n                  getW(wF, wR, wC, d1 + 1, d2),\n                  getW(wF, wR, wC, d1 + 2, d2),\n                  getW(wF, wR, wC, d1 + 3, d2)\n                );\n\n                dotProd += dot(xValues, wValues);\n              }\n\n              if (").concat(1===v,") {\n                dotProd +=\n                  getX(batch, xF, xR, xC, ").concat(m,") *\n                  getW(wF, wR, wC, ").concat(m,", d2);\n              } else if (").concat(2===v,") {\n                vec2 xValues = vec2(\n                  getX(batch, xF, xR, xC, ").concat(m,"),\n                  getX(batch, xF, xR, xC, ").concat(m," + 1)\n                );\n                vec2 wValues = vec2(\n                  getW(wF, wR, wC, ").concat(m,", d2),\n                  getW(wF, wR, wC, ").concat(m," + 1, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              } else if (").concat(3===v,") {\n                vec3 xValues = vec3(\n                  getX(batch, xF, xR, xC, ").concat(m,"),\n                  getX(batch, xF, xR, xC, ").concat(m," + 1),\n                  getX(batch, xF, xR, xC, ").concat(m," + 2)\n                );\n                vec3 wValues = vec3(\n                  getW(wF, wR, wC, ").concat(m,", d2),\n                  getW(wF, wR, wC, ").concat(m," + 1, d2),\n                  getW(wF, wR, wC, ").concat(m," + 2, d2)\n                );\n                dotProd += dot(xValues, wValues);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},xa=function e(t,n,r){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t;for(var a=r.filterWidth,i=r.inChannels,o=r.strideWidth,s=r.strideHeight,c=r.padInfo,u=r.outWidth,l=r.dilationWidth,d=r.dilationHeight,f=r.dataFormat,p=c.left,m=c.top,v=i*a,g=Z(),b="channelsLast"===f,y=b?0:1,x=b?1:2,w="",O=0;O<=1;O++)for(var A=0;A<=1;A++)w+="\n          blockIndex = rc.y + ".concat(A,";\n          pos = rc.x + ").concat(O,";\n\n          if(blockIndex < ").concat(t[1]," && pos < ").concat(t[0],") {\n            offsetY = int(blockIndex / (").concat(u,")) * ").concat(s," - ").concat(m,";\n            d0 = offsetY + ").concat(d," * (pos / ").concat(v,");\n\n            if(d0 < ").concat(n[y]," && d0 >= 0) {\n\n              offsetX = int(mod(float(blockIndex), ").concat(u,".) * ").concat(o,". - ").concat(p,".);\n              d1 = offsetX + ").concat(l," * (int(mod(float(pos), ").concat(v,".) / ").concat(i,".));\n\n              if(d1 < ").concat(n[x]," && d1 >= 0) {\n\n                ch = int(mod(float(pos), ").concat(i,".));\n\n                if (").concat(b,") {\n                  innerDims = vec2(d1, ch);\n                  result[").concat(2*O+A,"] = getChannel(\n                    getA(d0, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                } else {\n                  innerDims = vec2(d0, d1);\n                  result[").concat(2*O+A,"] = getChannel(\n                    getA(ch, int(innerDims.x),\n                    int(innerDims.y)), innerDims);\n                }\n              }\n            }\n          }\n        ");this.userCode="\n      void main() {\n        ivec2 rc = getOutputCoords();\n\n        vec4 result = vec4(0);\n\n        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;\n        vec2 innerDims;\n\n        ".concat(w,"\n\n        ").concat(g.output," = result;\n      }\n    ")};function wa(e){var t,n=e.x,r=e.filter,a=e.convInfo,i=e.backend,s=e.bias,c=void 0===s?null:s,u=e.preluActivationWeights,l=void 0===u?null:u,d=e.leakyreluAlpha,h=void 0===d?0:d,f=e.activation,p=void 0===f?null:f,m=n.shape,v=i.texData.get(n.dataId),g=a.inChannels,b=m[0]*m[1]*m[2],y=a.outChannels,x="channelsLast"===a.dataFormat,w=[],O=(1===b||1===y)&&g>1e3,A=m[2]%2!==0&&!!v.isPacked;if(!O&&Object(o.md)().getBool("WEBGL_LAZILY_UNPACK")&&Object(o.md)().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&A){var _=x?m[0]*m[1]*(m[2]+1):m[0]*m[2]*(m[3]+1),E={dataId:n.dataId,shape:[1,_,a.inChannels],dtype:n.dtype},S=v.shape;v.shape=v.shape.slice(),v.shape[v.shape.length-2]++,o.Ld.assert(W(v.shape,E.shape),(function(){return"packed reshape ".concat(v.shape," to ").concat(E.shape," isn't free")}));var C=Fn({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}});w.push(C);var T=Qn({a:E,b:C,backend:i,transposeA:false,transposeB:false,bias:c,activation:p,preluActivationWeights:l,leakyreluAlpha:h}),M=i.texData.get(T.dataId);o.Ld.assert(M.isPacked,(function(){return"batchMatMul result is expected to be packed"})),v.shape=S,M.shape=a.outShape,(t=yn({inputs:{x:T},backend:i})).shape=a.outShape,w.push(T)}else{var k=Fn({inputs:{x:n},backend:i,attrs:{shape:[1,x?m[0]*m[1]*m[2]:m[0]*m[2]*m[3],a.inChannels]}}),R=Fn({inputs:{x:r},backend:i,attrs:{shape:[1,a.inChannels,a.outChannels]}}),I=Qn({a:k,b:R,transposeA:false,transposeB:false,backend:i,bias:c,activation:p,preluActivationWeights:l,leakyreluAlpha:h});t=Fn({inputs:{x:I},backend:i,attrs:{shape:a.outShape}}),w.push(k),w.push(R),w.push(I)}for(var j=0,B=w;j<B.length;j++){var L=B[j];i.disposeIntermediateTensorInfo(L)}return t}function Oa(e){var t=e.x,n=e.filter,r=e.convInfo,a=e.backend,i=e.bias,s=void 0===i?null:i,c=e.preluActivationWeights,u=void 0===c?null:c,l=e.leakyreluAlpha,d=void 0===l?0:l,h=e.activation,f=void 0===h?null:h,p=r.filterWidth,m=r.filterHeight,v=r.inChannels,g=r.outWidth,b=r.outHeight,y="channelsLast"===r.dataFormat,x=p*m*v,w=b*g,O=[x,w],A=[],_=Fn({inputs:{x:t},backend:a,attrs:{shape:t.shape.slice(1)}}),E=Fn({inputs:{x:n},backend:a,attrs:{shape:[1,x,o.Ld.sizeFromShape(n.shape)/x]}});A.push(_),A.push(E);var S=new xa(O,_.shape,r),C=a.runWebGLProgram(S,[_],"float32"),T=Fn({inputs:{x:C},backend:a,attrs:{shape:[1,O[0],O[1]]}});A.push(C),A.push(T);var M=null!=s,k=null!=u,R="leakyrelu"===f,I=f?Rn(f,!0):null,j=new In(T.shape,E.shape,[1,w,r.outChannels],!0,!1,M,I,k,R),B=[T,E];if(s&&B.push(s),k&&B.push(u),R){var L=a.makeTensorInfo([],"float32",o.Ld.createScalarValue(d,"float32"));B.push(L),A.push(L)}var N=a.runWebGLProgram(j,B,"float32"),D=Fn({inputs:{x:N},backend:a,attrs:{shape:y?[1,b,g,r.outChannels]:[1,r.outChannels,b,g]}});A.push(N);for(var P=0,F=A;P<F.length;P++){var G=F[P];a.disposeIntermediateTensorInfo(G)}return D}var Aa={kernelName:o.B,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,s=n.filter,c=a.strides,u=a.pad,l=a.dataFormat,d=a.dilations,h=a.dimRoundingMode,f=o.cd.convertConv2DDataFormat(l),p=o.cd.computeConv2DInfo(i.shape,s.shape,c,d,u,h,!1,f);if(1!==p.filterHeight||1!==p.filterWidth||1!==p.dilationHeight||1!==p.dilationWidth||1!==p.strideHeight||1!==p.strideWidth||"SAME"!==p.padInfo.type&&"VALID"!==p.padInfo.type)if(Object(o.md)().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])t=Oa({x:i,filter:s,convInfo:p,backend:r});else{var m=new ba(p);t=r.runWebGLProgram(m,[i,s],"float32")}else t=wa({x:i,filter:s,convInfo:p,backend:r});var v=Fn({inputs:{x:t},backend:r,attrs:{shape:p.outShape}});return r.disposeIntermediateTensorInfo(t),v}},_a=function e(t){Object(h.a)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o="channelsLast"===t.dataFormat;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int d2 = coords.w;\n\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              if (").concat(o,") {\n                float dyValue = getDy(b, yR, yC, d2);\n                float xValue = getX(b, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              } else {\n                float dyValue = getDy(b, d2, yR, yC);\n                float xValue = getX(b, d1, xR, xC);\n                dotProd += (xValue * dyValue);\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Ea=function e(t){Object(h.a)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o="channelsLast"===t.dataFormat,s=n-1-t.padInfo.top,c=r-1-t.padInfo.left,u=o?1:2,l=o?2:3,d=o?3:1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[").concat(d,"];\n\n        ivec2 dyCorner = ivec2(coords[").concat(u,"], coords[").concat(l,"]) - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n\n              if (").concat(o,") {\n                float xValue = getDy(batch, idyR, idyC, d2);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              } else {\n                float xValue = getDy(batch, d2, idyR, idyC);\n                float wValue = getW(wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Sa=function e(t){Object(h.a)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.padInfo.front,o=t.padInfo.top,s=t.padInfo.left;this.userCode="\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int wF = coords.x;\n        int wR = coords.y;\n        int wC = coords.z;\n        int d1 = coords.w;\n        int d2 = coords.u;\n\n        float dotProd = 0.0;\n\n        for (int b = 0; b < ".concat(t.batchSize,"; b++) {\n          for (int yF = 0; yF < ").concat(t.outDepth,"; yF++) {\n            int xF = wF + yF * ").concat(n," - ").concat(i,";\n\n            if (xF < 0 || xF >= ").concat(t.inDepth,") {\n              continue;\n            }\n\n            for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n              int xR = wR + yR * ").concat(r," - ").concat(o,";\n\n              if (xR < 0 || xR >= ").concat(t.inHeight,") {\n                continue;\n              }\n\n              for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n                int xC = wC + yC * ").concat(a," - ").concat(s,";\n\n                if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                  continue;\n                }\n\n                float dyValue = getDy(b, yF, yR, yC, d2);\n                float xValue = getX(b, xF, xR, xC, d1);\n                dotProd += (xValue * dyValue);\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Ca=function e(t){Object(h.a)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterDepth,r=t.filterHeight,a=t.filterWidth,i=t.strideDepth,o=t.strideHeight,s=t.strideWidth,c=n-1-t.padInfo.front,u=r-1-t.padInfo.top,l=a-1-t.padInfo.left;this.userCode="\n      const ivec3 pads = ivec3(".concat(c,", ").concat(u,", ").concat(l,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.u;\n\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyFCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        float dotProd = 0.0;\n        for (int wF = 0; wF < ").concat(n,"; wF++) {\n          float dyF = float(dyFCorner + wF) / ").concat(i,".0;\n\n          if (dyF < 0.0 || dyF >= ").concat(t.outDepth,".0 || fract(dyF) > 0.0) {\n            continue;\n          }\n          int idyF = int(dyF);\n\n          int wFPerm = ").concat(n," - 1 - wF;\n\n          for (int wR = 0; wR < ").concat(r,"; wR++) {\n            float dyR = float(dyRCorner + wR) / ").concat(o,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n              fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            int wRPerm = ").concat(r," - 1 - wR;\n\n            for (int wC = 0; wC < ").concat(a,"; wC++) {\n              float dyC = float(dyCCorner + wC) / ").concat(s,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              int wCPerm = ").concat(a," - 1 - wC;\n\n              for (int d2 = 0; d2 < ").concat(t.outChannels,"; d2++) {\n                float xValue = getDy(batch, idyF, idyR, idyC, d2);\n                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);\n                dotProd += xValue * wValue;\n              }\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var Ta={kernelName:o.C,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,s=r.strides,c=r.pad,u=r.dataFormat,l=r.dimRoundingMode,d=r.filterShape,h=o.cd.convertConv2DDataFormat(u),f=o.cd.computeConv2DInfo(a.shape,d,s,1,c,l,!1,h),p=new _a(f);return n.runWebGLProgram(p,[a,i],"float32")}};var Ma={kernelName:o.D,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,s=r.inputShape,c=r.strides,u=r.pad,l=r.dataFormat,d=r.dimRoundingMode,h=o.cd.convertConv2DDataFormat(l),f=o.cd.computeConv2DInfo(s,i.shape,c,1,u,d,!1,h),p=new Ea(f);return n.runWebGLProgram(p,[a,i],"float32")}};var ka={kernelName:o.E,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,s=r.strides,c=r.pad,u=r.dilations,l=o.cd.computeConv3DInfo(a.shape,i.shape,s,u,c),d=new ya(l);return n.runWebGLProgram(d,[a,i],"float32")}};var Ra={kernelName:o.F,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,s=r.strides,c=r.pad,u=r.filterShape,l=o.cd.computeConv3DInfo(a.shape,u,s,1,c),d=new Sa(l);return n.runWebGLProgram(d,[a,i],"float32")}};var Ia={kernelName:o.G,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,s=r.pad,c=r.strides,u=r.inputShape,l=o.cd.computeConv3DInfo(u,i.shape,c,1,s),d=new Ca(l);return n.runWebGLProgram(d,[a,i],"float32")}},ja=Mn({opSnippet:"if (isnan(x)) return x;\n  return cos(x);\n"}),Ba={kernelName:o.H,backendName:"webgl",kernelFunc:ja},La=Mn({opSnippet:"\n  float e2x = exp(-x);\n  return (e2x + 1.0 / e2x) / 2.0;\n"}),Na={kernelName:o.I,backendName:"webgl",kernelFunc:La},Da=function e(t,n,r,a,i){Object(h.a)(this,e),this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];var o=Object(s.a)(t,4),c=o[0],u=o[1],l=o[2],d=o[3],f=Object(s.a)(n,1)[0],p=Object(s.a)(r,2),m=p[0],v=p[1];this.outputShape=[f,m,v,d];var g="bilinear"===a?1:0,b="".concat(u-1,".0"),y="".concat(l-1,".0"),x=m>1?["".concat((u-1)/(m-1)),"(y2-y1) * height_ratio","y1*".concat(b," + float(y)*(height_scale)")]:["0.0","0.0","0.5 * (y1+y2) * ".concat(b)],w=Object(s.a)(x,3),O=w[0],A=w[1],_=w[2],E=v>1?["".concat((l-1)/(v-1)),"(x2-x1) * width_ratio","x1*".concat(y," + float(x)*(width_scale)")]:["0.0","0.0","0.5 * (x1+x2) * ".concat(y)],S=Object(s.a)(E,3),C=S[0],T=S[1],M=S[2];this.userCode="\n      const float height_ratio = float(".concat(O,");\n      const float width_ratio = float(").concat(C,");\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int y = coords[1];\n        int x = coords[2];\n        int d = coords[3];\n\n        // get box vals\n        float y1 = getBoxes(b,0);\n        float x1 = getBoxes(b,1);\n        float y2 = getBoxes(b,2);\n        float x2 = getBoxes(b,3);\n\n        // get image in batch index\n        int bInd = round(getBoxInd(b));\n        if(bInd < 0 || bInd >= ").concat(c,") {\n          return;\n        }\n\n        float height_scale = ").concat(A,";\n        float width_scale = ").concat(T,";\n\n        float in_y = ").concat(_,";\n        if( in_y < 0.0 || in_y > ").concat(b," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n        float in_x = ").concat(M,";\n        if( in_x < 0.0 || in_x > ").concat(y," ) {\n          setOutput(float(").concat(i,"));\n          return;\n        }\n\n        vec2 sourceFracIndexCR = vec2(in_x,in_y);\n        if(").concat(g," == 1) {\n          // Compute the four integer indices.\n          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);\n          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));\n\n          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);\n          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);\n          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);\n          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);\n\n          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);\n\n          float top = topLeft + (topRight - topLeft) * fracCR.x;\n          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;\n          float newValue = top + (bottom - top) * fracCR.y;\n          setOutput(newValue);\n        } else {\n          // Compute the coordinators of nearest neighbor point.\n          ivec2 sourceNearestCR = ivec2(floor(\n            sourceFracIndexCR + vec2(0.5,0.5)));\n          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);\n          setOutput(newValue);\n        }\n      }\n    ")},Pa={kernelName:o.J,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.boxes,o=t.boxInd,s=r.cropSize,c=r.method,u=r.extrapolationValue,l=new Da(a.shape,i.shape,s,c,u);return n.runWebGLProgram(l,[a,i,o],"float32")}},Fa=function(){function e(t,n,r){Object(h.a)(this,e),this.variableNames=["x"],this.outputShape=t;var a=t.length,i=n?"0.0":"getX(".concat(Ga(a,"coords"),")"),o=t[t.length-1],s="",c="";n?(s=r?"end != ".concat(o-1):"end != 0",c=r?"end + 1":"end - 1"):(s=r?"end + pow2 < ".concat(o):"end >= pow2",c=r?"end + pow2":"end - pow2"),this.userCode="\n      uniform float index;\n      void main() {\n        ".concat(Re(a)," coords = getOutputCoords();\n        int end = ").concat(Ua(a,"coords"),";\n        float val = ").concat(i,";\n        int pow2 = int(pow(2.0, index));\n        if (").concat(s,") {\n          int idx = ").concat(c,";\n          ").concat(Ua(a,"coords")," = idx;\n          val += getX(").concat(Ga(a,"coords"),");\n        }\n        setOutput(val);\n      }\n    ")}return Object(f.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.index&&(t.index=n.getUniformLocation(r,"index")),n.gl.uniform1f(t.index,e)}}}]),e}();function Ga(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".x, ").concat(t,".y");if(3===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z");if(4===e)return"".concat(t,".x, ").concat(t,".y, ").concat(t,".z, ").concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}function Ua(e,t){if(1===e)return"".concat(t);if(2===e)return"".concat(t,".y");if(3===e)return"".concat(t,".z");if(4===e)return"".concat(t,".w");throw Error("Cumulative sum for rank ".concat(e," is not yet supported"))}var za={kernelName:o.K,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,s=r.exclusive,c=r.reverse,u=a.shape.length,l=o.cd.getAxesPermutation([i],u),d=a;null!=l&&(d=qn({inputs:{x:a},backend:n,attrs:{perm:l}}));var h=o.cd.getInnerMostAxes(1,u)[0];if(h!==u-1)throw new Error("WebGL cumsum shader expects an inner-most axis=".concat(a.shape.length-1," ")+"but got axis=".concat(i));for(var f=d.shape[h],p=yn({inputs:{x:d},backend:n}),m=0;m<=Math.ceil(Math.log2(f))-1;m++){var v=new Fa(d.shape,!1,c),g=v.getCustomSetupFunc(m),b=p;p=n.runWebGLProgram(v,[p],p.dtype,g),n.disposeIntermediateTensorInfo(b)}if(s){var y=new Fa(d.shape,s,c),x=p;p=n.runWebGLProgram(y,[p],p.dtype),n.disposeIntermediateTensorInfo(x)}if(null!=l){var w=qn({inputs:{x:p},backend:n,attrs:{perm:o.cd.getUndoAxesPermutation(l)}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(d),w}return p}};var Ha={kernelName:o.M,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.weights,o=r.size,s=r.binaryOutput;if(1===a.shape.length){var c=n.readSync(a.dataId),u=n.readSync(i.dataId),l=gt(c,u,i.dtype,i.shape,o);return n.makeTensorInfo([o],i.dtype,l)}if(2===a.shape.length){var d=n.bufferSync(a),h=n.bufferSync(i),f=bt(d,h,o,s);return n.makeTensorInfo(f.shape,i.dtype,f.values)}throw new Error("Error in denseBincount: input must be at most rank 2, but got rank"+"".concat(a.shape.length,"."))}},Va=function(){function e(t,n,r){Object(h.a)(this,e),this.variableNames=["x"],this.outputShape=[],this.outputShape=t,this.blockSize=n,this.dataFormat=r,this.userCode="\n    void main() {\n      ivec4 coords = getOutputCoords();\n      int b = coords[0];\n      int h = ".concat(this.getHeightCoordString(),";\n      int w = ").concat(this.getWidthCoordString(),";\n      int d = ").concat(this.getDepthCoordString(),";\n\n      int in_h = h / ").concat(n,";\n      int offset_h = imod(h, ").concat(n,");\n      int in_w = w / ").concat(n,";\n      int offset_w = imod(w, ").concat(n,");\n      int offset_d = (offset_h * ").concat(n," + offset_w) *\n        ").concat(this.getOutputDepthSize(),";\n      int in_d = d + offset_d;\n\n      float result = ").concat(this.getInputSamplingString(),";\n      setOutput(result);\n    }\n  ")}return Object(f.a)(e,[{key:"getHeightCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[1]":"coords[2]"}},{key:"getWidthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[2]":"coords[3]"}},{key:"getDepthCoordString",value:function(){return"NHWC"===this.dataFormat?"coords[3]":"coords[1]"}},{key:"getOutputDepthSize",value:function(){return"NHWC"===this.dataFormat?this.outputShape[3]:this.outputShape[1]}},{key:"getInputSamplingString",value:function(){return"NHWC"===this.dataFormat?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}]),e}();var Wa={kernelName:o.N,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockSize,s=r.dataFormat;o.Ld.assert(i>1,(function(){return"blockSize should be > 1 for depthToSpace, but was: ".concat(i)}));var c=a.shape[0],u="NHWC"===s?a.shape[1]:a.shape[2],l="NHWC"===s?a.shape[2]:a.shape[3],d="NHWC"===s?a.shape[3]:a.shape[1],h=u*i,f=l*i,p=d/(i*i),m=new Va("NHWC"===s?[c,h,f,p]:[c,p,h,f],i,s);return n.runWebGLProgram(m,[a],a.dtype)}},Ja=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(h.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var o=t.inHeight,s=t.inWidth,c=t.padInfo.top,u=t.padInfo.left,l=t.strideHeight,d=t.strideWidth,f=t.dilationHeight,p=t.dilationWidth,m=t.filterHeight,v=t.filterWidth,g=t.outChannels/t.inChannels,b="",y="";r&&(b=a?"float activation(float a) {\n          float b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"float activation(float a) {\n          float b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"\n          float activation(float x) {\n            ".concat(r,"\n          }\n        "),y="result = activation(result);");var x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(b,"\n\n      const ivec2 strides = ivec2(").concat(l,", ").concat(d,");\n      const ivec2 pads = ivec2(").concat(c,", ").concat(u,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2 / ").concat(g,";\n        int q = d2 - d1 * ").concat(g,";\n\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.\n        for (int wR = 0; wR < ").concat(m,"; wR++) {\n          int xR = xRCorner + wR * ").concat(f,";\n\n          if (xR < 0 || xR >= ").concat(o,") {\n            continue;\n          }\n\n          for (int wC = 0; wC < ").concat(v,"; wC++) {\n            int xC = xCCorner + wC * ").concat(p,";\n\n            if (xC < 0 || xC >= ").concat(s,") {\n              continue;\n            }\n\n            float xVal = getX(batch, xR, xC, d1);\n            float wVal = getW(wR, wC, d1, q);\n            dotProd += xVal * wVal;\n          }\n        }\n\n        float result = dotProd;\n        ").concat(x,"\n        ").concat(y,"\n        setOutput(result);\n      }\n    ")},Xa=function e(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];Object(h.a)(this,e),this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.outShape;for(var s=t.inHeight,c=t.inWidth,u=t.padInfo.top,l=t.padInfo.left,d=t.strideHeight,f=t.strideWidth,p=t.dilationHeight,m=t.dilationWidth,v=t.filterHeight,g=t.filterWidth,b=g,y="int xR; int xC; int xCOffset;",x=0;x<v;x++)for(var w=0;w<g;w++)y+="\n          vec4 xTexelR".concat(x,"C").concat(2*w," = vec4(0.);\n          vec4 wR").concat(x,"C").concat(w," = vec4(0.);\n          vec4 xR").concat(x,"C").concat(w," = vec4(0.);");for(var O=0;O<v;O++)for(var A=0;A<b;A++){var _=2*A;if(y+="\n          xR = xRCorner + ".concat(O*p,";\n          xC = xCCorner + ").concat(_*m,";\n        "),1===f){if(_<g&&(y+=l%2===1?"\n                xCOffset = xC + 1;\n                if(xR >= 0 && xR < ".concat(s," && xCOffset >= 0 && xCOffset < ").concat(c,") {\n                  xTexelR").concat(O,"C").concat(_," = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(c,") {\n                    xTexelR").concat(O,"C").concat(_,".zw = vec2(0.);\n                  }\n                } else {\n                  xTexelR").concat(O,"C").concat(_," = vec4(0.);\n                }\n\n                xCOffset = xC + 1 - 2;\n                if(xR >= 0 && xR < ").concat(s," && xCOffset >= 0 && xCOffset < ").concat(c,") {\n                  vec4 previous = getX(batch, xR, xCOffset, d1);\n\n                  // Need to manually clear unused channels in case\n                  // we're reading from recycled texture.\n                  if(xCOffset + 1 >= ").concat(c,") {\n                    previous.zw = vec2(0.);\n                  }\n\n                  xR").concat(O,"C").concat(_," = vec4(previous.zw, xTexelR").concat(O,"C").concat(_,".xy);\n                } else {\n                  xR").concat(O,"C").concat(_," = vec4(0, 0, xTexelR").concat(O,"C").concat(_,".xy);\n                }\n              "):"\n                if(xR >= 0 && xR < ".concat(s," && xC >= 0 && xC < ").concat(c,") {\n                  xTexelR").concat(O,"C").concat(_," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(O,"C").concat(_," = vec4(0.);\n                }\n\n                xR").concat(O,"C").concat(_," = xTexelR").concat(O,"C").concat(_,";\n              "),_+1<g)){var E=l%2===0?o.Ld.nearestLargerEven(m):m;m%2===0&&l%2===1||m%2!==0&&l%2!==1?(y+="\n                  xCOffset = xC + ".concat(l%2," + ").concat(E,";\n\n                  if(xR >= 0 && xR < ").concat(s," &&\n                    xCOffset >= 0 && xCOffset < ").concat(c,") {\n                    xTexelR").concat(O,"C").concat(_+2," = getX(batch, xR, xCOffset, d1);\n                  }\n                "),m>1&&(y+="\n                    xCOffset -= 2;\n                    if(xR >= 0 && xR < ".concat(s," &&\n                      xCOffset >= 0 && xCOffset < ").concat(c,") {\n                      xTexelR").concat(O,"C").concat(_," = getX(batch, xR, xCOffset, d1);\n                    } else {\n                      xTexelR").concat(O,"C").concat(_," = vec4(0.);\n                    }\n                  ")),y+="\n                  xR".concat(O,"C").concat(_+1," = vec4(\n                    xTexelR").concat(O,"C").concat(_,".zw, xTexelR").concat(O,"C").concat(_+2,".xy);\n                ")):y+="\n                  xCOffset = xC + ".concat(E,";\n\n                  if(xR >= 0 && xR < ").concat(s," &&\n                    xCOffset >= 0 && xCOffset < ").concat(c,") {\n                    xTexelR").concat(O,"C").concat(_+2," = getX(batch, xR, xCOffset, d1);\n                  }\n\n                  xR").concat(O,"C").concat(_+1," = xTexelR").concat(O,"C").concat(_+2,";\n                ")}}else _<g&&(y+="\n              if(xR >= 0 && xR < ".concat(s,") {\n            "),l%2===1?(y+="\n                xCOffset = xC + 1 - ".concat(f,";\n                if(xCOffset >= 0 && xCOffset < ").concat(c,") {\n                  xTexelR").concat(O,"C").concat(_," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(O,"C").concat(_," = vec4(0.);\n                }\n\n                if(xC + 1 >= 0 && xC + 1 < ").concat(c,") {\n                  xTexelR").concat(O,"C").concat(_+2," = getX(batch, xR, xC + 1, d1);\n                } else {\n                  xTexelR").concat(O,"C").concat(_+2," = vec4(0.);\n                }\n\n                xR").concat(O,"C").concat(_," = vec4(\n                  xTexelR").concat(O,"C").concat(_,".zw, xTexelR").concat(O,"C").concat(_+2,".zw);\n              "),_+1<g&&(y+="\n                  vec4 final = vec4(0.);\n                  xCOffset = xC + 1 + ".concat(f,";\n                  if(xCOffset >= 0 && xCOffset < ").concat(c,") {\n                    final = getX(batch, xR, xCOffset, d1);\n                  }\n                  xR").concat(O,"C").concat(_+1," = vec4(xTexelR").concat(O,"C").concat(_+2,".xy, final.xy);\n                "))):(y+="\n                if(xC >= 0 && xC < ".concat(c,") {\n                  xTexelR").concat(O,"C").concat(_," = getX(batch, xR, xC, d1);\n                } else {\n                  xTexelR").concat(O,"C").concat(_," = vec4(0.);\n                }\n\n                xCOffset = xC + ").concat(f,";\n                if(xCOffset >= 0 && xCOffset < ").concat(c,") {\n                  xTexelR").concat(O,"C").concat(_+2," = getX(batch, xR, xCOffset, d1);\n                } else {\n                  xTexelR").concat(O,"C").concat(_+2," = vec4(0.);\n                }\n\n                xR").concat(O,"C").concat(_," = vec4(\n                  xTexelR").concat(O,"C").concat(_,".xy, xTexelR").concat(O,"C").concat(_+2,".xy);\n              "),_+1<g&&(y+="\n                  xR".concat(O,"C").concat(_+1," = vec4(\n                    xTexelR").concat(O,"C").concat(_,".zw, xTexelR").concat(O,"C").concat(_+2,".zw);\n                "))),y+="}");_<g&&(y+="\n            vec4 wTexelR".concat(O,"C").concat(_," = getW(").concat(O,", ").concat(_,", d1, q);\n            wR").concat(O,"C").concat(_," = vec4(wTexelR").concat(O,"C").concat(_,".xz, wTexelR").concat(O,"C").concat(_,".xz);\n          "),_+1<g&&(y+="\n              vec4 wTexelR".concat(O,"C").concat(_+1," = getW(").concat(O,", ").concat(_+1,", d1, q);\n              wR").concat(O,"C").concat(_+1," =\n                vec4(wTexelR").concat(O,"C").concat(_+1,".xz, wTexelR").concat(O,"C").concat(_+1,".xz);")))}for(var S=0;S<v;S++)for(var C=0;C<g;C++)y+="dotProd += xR".concat(S,"C").concat(C," * wR").concat(S,"C").concat(C,";");var T="",M="";r&&(T=a?"vec4 activation(vec4 a) {\n          vec4 b = getPreluActivationWeightsAtOutCoords();\n          ".concat(r,"\n        }"):i?"vec4 activation(vec4 a) {\n          vec4 b = getLeakyreluAlphaAtOutCoords();\n          ".concat(r,"\n        }"):"vec4 activation(vec4 x) {\n          ".concat(r,"\n        }"),M="result = activation(result);");var k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),a&&this.variableNames.push("preluActivationWeights"),i&&this.variableNames.push("leakyreluAlpha"),this.userCode="\n      ".concat(T,"\n\n      const ivec2 strides = ivec2(").concat(d,", ").concat(f,");\n      const ivec2 pads = ivec2(").concat(u,", ").concat(l,");\n\n      void main() {\n\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        ivec2 xRCCorner = coords.yz * strides - pads;\n        int d2 = coords.w;\n        int d1 = d2;\n        int q = 0;\n        int xRCorner = xRCCorner.x;\n        int xCCorner = xRCCorner.y;\n\n        vec4 dotProd = vec4(0.);\n\n        ").concat(y,"\n\n        vec4 result = dotProd;\n        ").concat(k,"\n        ").concat(M,"\n        setOutput(result);\n      }\n    ")};var Ka={kernelName:o.O,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,s=r.strides,c=r.pad,u=r.dilations,l=r.dimRoundingMode,d=u;null==d&&(d=[1,1]),o.Ld.assert(o.cd.eitherStridesOrDilationsAreOne(s,d),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(s," and dilations '").concat(d,"'")}));var h,f=o.cd.computeConv2DInfo(a.shape,i.shape,s,d,c,l,!0);return h=Object(o.md)().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?new Xa(f):new Ja(f),n.runWebGLProgram(h,[a,i],"float32")}},qa=function e(t){Object(h.a)(this,e),this.variableNames=["x","dy"],this.outputShape=t.filterShape;var n=t.strideHeight,r=t.strideWidth,a=t.padInfo.top,i=t.padInfo.left,o=t.outChannels/t.inChannels;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int wR = coords.x;\n        int wC = coords.y;\n        int d1 = coords.z;\n        int dm = coords.w;\n        int d2 = d1 * ".concat(o," + dm;\n\n        float dotProd = 0.0;\n\n        // TO DO: Vec4 over the batch size\n        for (int b = 0; b < ").concat(t.batchSize,"; b++) {\n          for (int yR = 0; yR < ").concat(t.outHeight,"; yR++) {\n            int xR = wR + yR * ").concat(n," - ").concat(a,";\n\n            if (xR < 0 || xR >= ").concat(t.inHeight,") {\n              continue;\n            }\n\n            for (int yC = 0; yC < ").concat(t.outWidth,"; yC++) {\n              int xC = wC + yC * ").concat(r," - ").concat(i,";\n\n              if (xC < 0 || xC >= ").concat(t.inWidth,") {\n                continue;\n              }\n\n              float dyValue = getDy(b, yR, yC, d2);\n              float xValue = getX(b, xR, xC, d1);\n              dotProd += (xValue * dyValue);\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},Ya=function e(t){Object(h.a)(this,e),this.variableNames=["dy","W"],this.outputShape=t.inShape;var n=t.filterHeight,r=t.filterWidth,a=t.strideHeight,i=t.strideWidth,o=n-1-t.padInfo.top,s=r-1-t.padInfo.left,c=t.outChannels/t.inChannels;this.userCode="\n      const ivec2 pads = ivec2(".concat(o,", ").concat(s,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords[0];\n        int d1 = coords[3];\n        ivec2 dyCorner = coords.yz - pads;\n        int dyRCorner = dyCorner.x;\n        int dyCCorner = dyCorner.y;\n\n        float dotProd = 0.0;\n\n        for (int wR = 0; wR < ").concat(n,"; wR++) {\n          float dyR = float(dyRCorner + wR) / ").concat(a,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          int wRPerm = ").concat(n," - 1 - wR;\n\n          for (int wC = 0; wC < ").concat(r,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(i,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            int wCPerm = ").concat(r," - 1 - wC;\n\n            // TO DO: Vec4 over the channelMul\n            for (int dm = 0; dm < ").concat(c,"; dm++) {\n              int d2 = d1 * ").concat(c," + dm;\n              float xValue = getDy(batch, idyR, idyC, d2);\n              float wValue = getW(wRPerm, wCPerm, d1, dm);\n              dotProd += xValue * wValue;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var Qa={kernelName:o.P,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.dy,s=r.strides,c=r.dilations,u=r.pad,l=r.dimRoundingMode,d=r.filterShape,h=o.cd.computeConv2DInfo(a.shape,d,s,c,u,l,!0),f=new qa(h);return n.runWebGLProgram(f,[a,i],"float32")}};var Za={kernelName:o.Q,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.filter,s=r.strides,c=r.dilations,u=r.pad,l=r.dimRoundingMode,d=r.inputShape,h=o.cd.computeConv2DInfo(d,i.shape,s,c,u,l,!0),f=new Ya(h);return n.runWebGLProgram(f,[a,i],"float32")}},$a=function e(t){Object(h.a)(this,e),this.variableNames=["X"],this.outputShape=[t,t],this.userCode="\n      void main() {\n          ivec2 coords = getOutputCoords();\n          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;\n          setOutput(val);\n      }\n    "};var ei={kernelName:o.R,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.x,a=[].concat(Object(l.a)(r.shape),Object(l.a)(r.shape)),i=o.Ld.sizeFromShape(r.shape),s=Fn({inputs:{x:r},backend:n,attrs:{shape:[i]}}),c=new $a(i),u=n.runWebGLProgram(c,[s],s.dtype),d=Fn({inputs:{x:u},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(u),d}},ti=function e(t){Object(h.a)(this,e),this.variableNames=["x","W"],this.outputShape=t.outShape;var n=t.inHeight,r=t.inWidth,a=t.padInfo,i=t.strideHeight,o=t.strideWidth,s=t.filterHeight,c=t.filterWidth,u=t.dilationHeight,l=t.dilationWidth,d=a.top,f=a.left;this.userCode="\n      const ivec2 strides = ivec2(".concat(i,", ").concat(o,");\n      const ivec2 pads = ivec2(").concat(d,", ").concat(f,");\n      const float neg_infinity = -3.4e38;\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int batch = coords.x;\n        int d1 = coords.w;\n        ivec2 outTopLeftCorner =\n            coords.yz * strides - pads;\n        int hBeg = outTopLeftCorner.x;\n        int wBeg = outTopLeftCorner.y;\n\n        float curVal = neg_infinity;\n        for (int h = 0; h < ").concat(s,"; h++) {\n          int hIn = hBeg + h * ").concat(u,";\n\n          if (hIn >= 0 && hIn < ").concat(n,") {\n            for (int w = 0; w < ").concat(c,"; w++) {\n              int wIn = wBeg + w * ").concat(l,";\n\n              if (wIn >= 0 && wIn < ").concat(r,") {\n                float xVal = getX(batch, hIn, wIn, d1);\n                float wVal = getW(h, w, d1);\n\n                float val = xVal + wVal;\n                if (val > curVal) {\n                  curVal = val;\n                }\n              }\n            }\n          }\n        }\n\n        float result = curVal;\n        setOutput(result);\n      }\n    ")};var ni={kernelName:o.S,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,s=n.filter,c=a.strides,u=a.pad,l=a.dilations,d=o.cd.computeDilation2DInfo(i.shape,s.shape,c,u,"NHWC",l),h=new ti(d),f=Fn({inputs:{x:t=r.runWebGLProgram(h,[i,s],"float32")},backend:r,attrs:{shape:d.outShape}});return r.disposeIntermediateTensorInfo(t),f}},ri=Mn({opSnippet:"return (x >= 0.0) ? x : (exp(x) - 1.0);",packedOpSnippet:"\n  vec4 result;\n\n  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);\n  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);\n  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);\n  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);\n\n  return result;\n"}),ai={kernelName:o.T,backendName:"webgl",kernelFunc:ri},ii={kernelName:o.U,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.dy,a=t.y,i=Object(o.md)().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new bn("\n  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));\n  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));\n",r.shape,a.shape):new gn("return (b >= 1.0) ? a : a * (b + 1.0);",r.shape,a.shape);return n.runWebGLProgram(i,[r,a],r.dtype)}},oi=kn({opSnippet:"return float(a == b);",packedOpSnippet:"\n  return vec4(equal(a, b));\n",dtype:"bool"}),si={kernelName:o.V,backendName:"webgl",kernelFunc:oi},ci=Mn({opSnippet:'\n  // Error function is calculated approximately with elementary function.\n  // See "Handbook of Mathematical Functions with Formulas,\n  // Graphs, and Mathematical Tables", Abramowitz and Stegun.\n  float p = '.concat(o.cd.ERF_P,";\n  float a1 = ").concat(o.cd.ERF_A1,";\n  float a2 = ").concat(o.cd.ERF_A2,";\n  float a3 = ").concat(o.cd.ERF_A3,";\n  float a4 = ").concat(o.cd.ERF_A4,";\n  float a5 = ").concat(o.cd.ERF_A5,";\n\n  float sign = sign(x);\n  x = abs(x);\n  float t = 1.0 / (1.0 + p * x);\n  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));\n")}),ui={kernelName:o.W,backendName:"webgl",kernelFunc:ci},li="return exp(x);",di=Mn({opSnippet:li,packedOpSnippet:li,cpuKernelImpl:wt}),hi={kernelName:o.X,backendName:"webgl",kernelFunc:di};function fi(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.dim,i=t.input,s=i.shape.length,c=i.shape.slice(),u=a;return a<0&&(o.Ld.assert(-(s+1)<=a,(function(){return"Axis must be in the interval [".concat(-(s+1),", ").concat(s,"]")})),u=s+a+1),c.splice(u,0,1),Fn({inputs:{x:i},backend:r,attrs:{shape:c}})}var pi={kernelName:o.Y,backendName:"webgl",kernelFunc:fi},mi="return exp(x) - 1.0;",vi=Mn({opSnippet:mi,packedOpSnippet:mi,cpuKernelImpl:Ot}),gi={kernelName:o.Z,backendName:"webgl",kernelFunc:vi},bi=function e(t,n,r){Object(h.a)(this,e),this.variableNames=["real","imag"];var a=n[1];this.outputShape=n;var i,o=r?"2.0 * ".concat(Math.PI):"-2.0 * ".concat(Math.PI),s=r?"".concat(a,".0"):"1.0";if("real"===t)i="return real * expR - imag * expI;";else{if("imag"!==t)throw new Error('FFT component must be either "real" or "imag", got '.concat(t,"."));i="return real * expI + imag * expR;"}this.userCode="\n      const float exponentMultiplier = ".concat(o,";\n\n      float unaryOpComplex(float real, float expR, float imag, float expI) {\n        ").concat(i,"\n      }\n\n      float mulMatDFT(int batch, int index) {\n        float indexRatio = float(index) / float(").concat(a,");\n        float exponentMultiplierTimesIndexRatio =\n            exponentMultiplier * indexRatio;\n\n        float result = 0.0;\n\n        for (int i = 0; i < ").concat(a,"; i++) {\n          // x = (-2|2 * PI / N) * index * i;\n          float x = exponentMultiplierTimesIndexRatio * float(i);\n          float expR = cos(x);\n          float expI = sin(x);\n          float real = getReal(batch, i);\n          float imag = getImag(batch, i);\n\n          result +=\n              unaryOpComplex(real, expR, imag, expI) / ").concat(s,";\n        }\n\n        return result;\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        setOutput(mulMatDFT(coords[0], coords[1]));\n      }\n    ")};function yi(e,t,n){var r=n.texData.get(e.dataId),a=o.Ld.sizeFromShape(e.shape),i=e.shape[e.shape.length-1],s=Fn({inputs:{x:e},backend:n,attrs:{shape:[a/i,i]}}),c=s.shape,u=new bi("real",c,t),l=new bi("imag",c,t),d=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:c},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:c}],h=n.runWebGLProgram(u,d,"float32"),f=n.runWebGLProgram(l,d,"float32"),p=wn({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);var m=Fn({inputs:{x:p},backend:n,attrs:{shape:e.shape}});return n.disposeIntermediateTensorInfo(s),n.disposeIntermediateTensorInfo(p),m}var xi={kernelName:o.ab,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return yi(t.input,!1,n)}},wi=function(){function e(t,n){Object(h.a)(this,e),this.outputShape=[],this.variableNames=["x"],this.outputShape=t,this.userCode="\n      uniform float value;\n      void main() {\n        // Input can be obtained from uniform value.\n        setOutput(value);\n      }\n    "}return Object(f.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}();function Oi(e){var t=e.backend,n=e.attrs,r=n.shape,a=n.value,i=n.dtype;if("string"===(i=i||o.Ld.inferDtype(a))){var s=o.Ld.getArrayFromDType(i,o.Ld.sizeFromShape(r));return s.fill(a),t.makeTensorInfo(r,i,s)}var c=new wi(r,a),u=c.getCustomSetupFunc(a);return t.runWebGLProgram(c,[],i,u)}var Ai,_i={kernelName:o.bb,backendName:"webgl",kernelFunc:Oi},Ei=function e(t){Object(h.a)(this,e),this.variableNames=["Image"],this.outputShape=[];var n=t[2];this.outputShape=t,this.userCode="\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n\n          int coordX = ".concat(n," - x;\n          float outputValue;\n          if(coordX >= 0 && coordX < ").concat(n,") {\n            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);\n          } else {\n            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")},Si={kernelName:o.cb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.image,a=n,i=new Ei(r.shape);return a.runWebGLProgram(i,[r],r.dtype)}},Ci="return floor(x);",Ti=Mn({opSnippet:Ci,packedOpSnippet:Ci,cpuKernelImpl:At}),Mi={kernelName:o.db,backendName:"webgl",kernelFunc:Ti},ki=kn({opSnippet:"\n  float s = sign(a) * sign(b);\n  int ia = round(a);\n  int ib = round(b);\n  if (ib != 0) {\n    // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n    return float(idiv(ia, ib, s));\n  } else {\n    return NAN;\n  }\n",packedOpSnippet:"\n  ivec4 ia = round(a);\n  ivec4 ib = round(b);\n  bvec4 cond = notEqual(ib, ivec4(0));\n  ivec4 result = ivec4(0);\n  vec4 s = sign(a) * sign(b);\n\n  // Windows (D3D) wants guaranteed non-zero int division at compile-time.\n  if (cond[0]) {\n    result[0] = idiv(ia[0], ib[0], s[0]);\n  }\n  if (cond[1]) {\n    result[1] = idiv(ia[1], ib[1], s[1]);\n  }\n  if (cond[2]) {\n    result[2] = idiv(ia[2], ib[2], s[2]);\n  }\n  if (cond[3]) {\n    result[3] = idiv(ia[3], ib[3], s[3]);\n  }\n  return vec4(result);\n",dtype:"int32"}),Ri={kernelName:o.eb,backendName:"webgl",kernelFunc:ki},Ii=function e(t){Object(h.a)(this,e),this.variableNames=["A"];var n=Z(),r=Object(s.a)(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(".concat(i,".0, ").concat(a,".0);\n\n        vec4 values = ").concat(n.texture2D,"(A, uv);\n        float value;\n        if (depth == 0) {\n          value = values.r;\n        } else if (depth == 1) {\n          value = values.g;\n        } else if (depth == 2) {\n          value = values.b;\n        } else if (depth == 3) {\n          value = values.a;\n        }\n\n        setOutput(floor(value * 255.0 + 0.5));\n      }\n    ")},ji=function e(t){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;var n=Z(),r=Object(s.a)(t,2),a=r[0],i=r[1];this.outputShape=t,this.userCode="\n      void main() {\n        ivec3 coords = getOutputCoords();\n        int texR = coords[0];\n        int texC = coords[1];\n        int depth = coords[2];\n\n        vec4 result = vec4(0.);\n\n        for(int row=0; row<=1; row++) {\n          for(int col=0; col<=1; col++) {\n            texC = coords[1] + row;\n            depth = coords[2] + col;\n\n            vec2 uv = (vec2(texC, texR) + halfCR) /\n                       vec2(".concat(i,".0, ").concat(a,".0);\n            vec4 values = ").concat(n.texture2D,"(A, uv);\n            float value;\n            if (depth == 0) {\n              value = values.r;\n            } else if (depth == 1) {\n              value = values.g;\n            } else if (depth == 2) {\n              value = values.b;\n            } else if (depth == 3) {\n              value = values.a;\n            }\n\n            result[row * 2 + col] = floor(value * 255.0 + 0.5);\n          }\n        }\n\n        ").concat(n.output," = result;\n      }\n    ")},Bi={kernelName:o.fb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,i=t.pixels,c=r.numChannels,u="undefined"!==typeof HTMLVideoElement&&i instanceof HTMLVideoElement,l="undefined"!==typeof HTMLImageElement&&i instanceof HTMLImageElement,d=u?[i.videoWidth,i.videoHeight]:[i.width,i.height],h=Object(s.a)(d,2),f=h[0],p=h[1],m=[p,f],v=[p,f,c];(l||u)&&(null==Ai&&(Ai=document.createElement("canvas").getContext("2d")),Ai.canvas.width=f,Ai.canvas.height=p,Ai.drawImage(i,0,0,f,p),i=Ai.canvas);var g=n.makeTensorInfo(m,"int32");n.texData.get(g.dataId).usage=a.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(g.dataId),i);var b=Object(o.md)().getBool("WEBGL_PACK")?new ji(v):new Ii(v),y=n.runWebGLProgram(b,[g],"int32");return n.disposeData(g.dataId),y}};var Li={kernelName:o.hb,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,s=n.filter,c=n.bias,u=n.preluActivationWeights,l=a.strides,d=a.pad,h=a.dataFormat,f=a.dilations,p=a.dimRoundingMode,m=a.activation,v=a.leakyreluAlpha,g=o.cd.convertConv2DDataFormat(h),b=o.cd.computeConv2DInfo(i.shape,s.shape,l,f,d,p,!1,g),y=[];if(1!==b.filterHeight||1!==b.filterWidth||1!==b.dilationHeight||1!==b.dilationWidth||1!==b.strideHeight||1!==b.strideWidth||"SAME"!==b.padInfo.type&&"VALID"!==b.padInfo.type)if(Object(o.md)().getBool("WEBGL_CONV_IM2COL")&&1===i.shape[0])t=Oa({x:i,filter:s,convInfo:b,backend:r,bias:c,activation:m,preluActivationWeights:u,leakyreluAlpha:v});else{var x=null!=c,w=null!=u,O="leakyrelu"===m,A=m?Rn(m,!1):null,_=new ba(b,x,A,w,O),E=[i,s];if(c&&E.push(c),u&&E.push(u),O){var S=r.makeTensorInfo([],"float32",o.Ld.createScalarValue(v,"float32"));E.push(S),y.push(S)}t=r.runWebGLProgram(_,E,"float32")}else t=wa({x:i,filter:s,convInfo:b,backend:r,bias:c,activation:m,preluActivationWeights:u,leakyreluAlpha:v});var C=Fn({inputs:{x:t},backend:r,attrs:{shape:b.outShape}});return y.push(t),y.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),C}};var Ni={kernelName:o.ib,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.filter,s=t.bias,c=t.preluActivationWeights,u=r.strides,l=r.pad,d=r.dilations,h=r.dimRoundingMode,f=r.activation,p=r.leakyreluAlpha,m=[],v=d;null==v&&(v=[1,1]),o.Ld.assert(o.cd.eitherStridesOrDilationsAreOne(u,v),(function(){return"Error in depthwiseConv2d: Either strides or dilations must be "+"1. Got strides ".concat(u," and dilations '").concat(v,"'")}));var g,b=o.cd.computeConv2DInfo(a.shape,i.shape,u,v,l,h,!0),y=Object(o.md)().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels===1,x=f?Rn(f,y):null,w=[a,i],O=null!=s,A=null!=c,_="leakyrelu"===f;if(O&&w.push(s),A&&w.push(c),_){var E=n.makeTensorInfo([],"float32",o.Ld.createScalarValue(p,"float32"));w.push(E),m.push(E)}g=y?new Xa(b,O,x,A,_):new Ja(b,O,x,A,_);var S=n.runWebGLProgram(g,w,"float32");return m.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),S}},Di=function e(t,n,r){Object(h.a)(this,e),this.sliceDim=t,this.strides=n,this.variableNames=["x","indices"],this.outputShape=r;var a=Re(n.length),i=Re(r.length),o=this.sliceDim>1?"strides[j]":"strides";this.userCode="\n        ".concat(a," strides = ").concat(a,"(").concat(this.strides,");\n         void main() {\n          ").concat(i," coords = getOutputCoords();\n          int flattenIndex = 0;\n          for (int j = 0; j < ").concat(this.sliceDim,"; j++) {\n            int index = round(getIndices(coords[0], j));\n            flattenIndex += index * ").concat(o,";\n          }\n          setOutput(getX(flattenIndex, coords[1]));\n        }\n      ")};var Pi={kernelName:o.jb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.params,a=t.indices,i=a.shape,c=i[i.length-1],u=o.cd.prepareAndValidate(r,a),l=Object(s.a)(u,4),d=l[0],h=l[1],f=l[2],p=l[3],m=Fn({inputs:{x:a},backend:n,attrs:{shape:[h,c]}}),v=Fn({inputs:{x:r},backend:n,attrs:{shape:[o.Ld.sizeFromShape(r.shape)/f,f]}}),g=new Di(c,p,[h,f]),b=n.runWebGLProgram(g,[v,m],v.dtype),y=Fn({inputs:{x:b},backend:n,attrs:{shape:d}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(b),y}},Fi=function e(t,n){Object(h.a)(this,e),this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;var r=Re(this.rank),a=function(e,t){for(var n=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[],a=0;a<e.length;a++)2===a?r.push("int(getIndices(resRC.x, resRC.z))"):r.push("".concat(n[a]));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(r," resRC = getOutputCoords();\n        setOutput(getA(").concat(a,"));\n      }\n    ")};var Gi={kernelName:o.kb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.indices,s=r.axis,c=r.batchDims,u=o.Ld.parseAxisParam(s,a.shape)[0],l=o.cd.segment_util.collectGatherOpShapeInfo(a,i,u,c),d=o.Ld.sizeFromShape(i.shape),h=[],f=Fn({inputs:{x:a},backend:n,attrs:{shape:[l.batchSize,l.outerSize,l.dimSize,l.sliceSize]}}),p=Fn({inputs:{x:i},backend:n,attrs:{shape:[l.batchSize,d/l.batchSize]}});h.push(f),h.push(p);var m=[l.batchSize,l.outerSize,d/l.batchSize,l.sliceSize];if(n.shouldExecuteOnCPU([a,i])||"string"===a.dtype){var v=n.bufferSync(p),g=n.bufferSync(f),b=_t(g,v,m);return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),n.makeTensorInfo(l.outputShape,b.dtype,b.values)}var y=new Fi(f.shape,m),x=n.runWebGLProgram(y,[f,p],f.dtype);h.push(x);var w=Fn({inputs:{x:x},backend:n,attrs:{shape:l.outputShape}});return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),w}},Ui=kn({opSnippet:"return float(a > b);",packedOpSnippet:"\n  return vec4(greaterThan(a, b));\n",cpuKernelImpl:Et,dtype:"bool"}),zi={kernelName:o.lb,backendName:"webgl",kernelFunc:Ui},Hi=kn({opSnippet:"return float(a >= b);",packedOpSnippet:"\n  return vec4(greaterThanEqual(a, b));\n",dtype:"bool"}),Vi={kernelName:o.mb,backendName:"webgl",kernelFunc:Hi};var Wi={kernelName:o.nb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend;return yi(t.input,!0,n)}},Ji=Mn({opSnippet:"return float(!isnan(x) && !isinf(x));",dtype:"bool"}),Xi={kernelName:o.qb,backendName:"webgl",kernelFunc:Ji},Ki=Mn({opSnippet:"return float(isinf(x));",dtype:"bool"}),qi={kernelName:o.rb,backendName:"webgl",kernelFunc:Ki},Yi=Mn({opSnippet:"return float(isnan(x));",dtype:"bool"}),Qi={kernelName:o.sb,backendName:"webgl",kernelFunc:Yi},Zi=kn({opSnippet:"return float(a < b);",packedOpSnippet:"\n  return vec4(lessThan(a, b));\n",cpuKernelImpl:St,dtype:"bool"}),$i={kernelName:o.xb,backendName:"webgl",kernelFunc:Zi},eo=kn({opSnippet:"return float(a <= b);",packedOpSnippet:"\n  return vec4(lessThanEqual(a, b));\n",dtype:"bool"}),to={kernelName:o.yb,backendName:"webgl",kernelFunc:eo};var no={kernelName:o.zb,backendName:"webgl",kernelFunc:function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.num,o=Ct(r,a,i);return t.makeTensorInfo([o.length],"float32",o)}},ro=Mn({opSnippet:"if (x < 0.0) return NAN;\n  return log(x);",packedOpSnippet:"\n  vec4 result = log(x);\n  vec4 isNaN = vec4(lessThan(x, vec4(0.0)));\n  result.r = isNaN.r == 1.0 ? NAN : result.r;\n  result.g = isNaN.g == 1.0 ? NAN : result.g;\n  result.b = isNaN.b == 1.0 ? NAN : result.b;\n  result.a = isNaN.a == 1.0 ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Tt}),ao={kernelName:o.Ab,backendName:"webgl",kernelFunc:ro},io=Mn({opSnippet:"return log(1.0 + x);"}),oo={kernelName:o.Bb,backendName:"webgl",kernelFunc:io},so=kn({opSnippet:"return float(a >= 1.0 && b >= 1.0);",packedOpSnippet:"\n  return vec4(\n    vec4(greaterThanEqual(a, vec4(1.0))) *\n    vec4(greaterThanEqual(b, vec4(1.0))));\n",dtype:"bool"}),co={kernelName:o.Cb,backendName:"webgl",kernelFunc:so},uo=Mn({opSnippet:"return float(!(x >= 1.0));"}),lo={kernelName:o.Db,backendName:"webgl",kernelFunc:uo},ho=kn({opSnippet:"return float(a >= 1.0 || b >= 1.0);",packedOpSnippet:"\n  return min(\n    vec4(greaterThanEqual(a, vec4(1.0))) +\n    vec4(greaterThanEqual(b, vec4(1.0))),\n    vec4(1.0));\n",dtype:"bool"}),fo={kernelName:o.Eb,backendName:"webgl",kernelFunc:ho},po=function e(t,n,r,a,i){Object(h.a)(this,e),this.variableNames=["x"],this.outputShape=[];var o,s=n,c=t[3]-1;this.outputShape=t;var u="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(u,")"):1===i?"1.0/(".concat(u,")"):"exp(log(".concat(u,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n        int d = coords[3];\n        float x = getX(b, r, c, d);\n        float sum = 0.0;\n        for (int j = -".concat(s,"; j <= ").concat(s,"; j++) {\n          int idx = d + j;\n          if (idx >= 0 && idx <=  ").concat(c,") {\n            float z = getX(b, r, c, idx);\n            sum += z * z;\n          }\n        }\n        float val = x * ").concat(o,";\n        setOutput(val);\n      }\n    ")},mo=function e(t,n,r,a,i){Object(h.a)(this,e),this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;var o,s=n,c=t[3]-1;this.outputShape=t;var u="float(".concat(r,") + float(").concat(a,") * sum");o=.5===i?"inversesqrt(".concat(u,")"):1===i?"1.0/(".concat(u,")"):"exp(log(".concat(u,") * float(-").concat(i,"));"),this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords.x;\n        int r = coords.y;\n        int c = coords.z;\n        int d = coords.w;\n\n        bool hasNextCol = d < ".concat(this.outputShape[3],";\n        bool hasNextRow = c < ").concat(this.outputShape[2],";\n\n        vec4 sum = vec4(0.);\n        vec4 xFragAtOutputCoords = getX(b, r, c, d);\n\n        vec4 xAtOutputCoords = vec4(\n          getChannel(xFragAtOutputCoords, vec2(c, d)),\n          hasNextCol ?\n            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,\n          hasNextRow ?\n            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0\n        );\n\n        int firstChannel = d - ").concat(s,";\n        vec2 cache = vec2(0.);\n        if(firstChannel >= 0){\n          vec4 firstChannelFrag = getX(b, r, c, firstChannel);\n          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));\n            if(hasNextRow){\n              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));\n            }\n        }\n\n        ivec2 depth = ivec2(d, d + 1);\n        for (int j = - ").concat(s,"; j <= ").concat(s,"; j++) {\n          ivec2 idx = depth + j;\n          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));\n          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(").concat(c,"));\n\n          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;\n          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;\n\n          if(depthInRange || depthPlusOneInRange){\n            vec4 z = vec4(0.);\n            vec4 xFragAtCurrentDepth;\n            z.xz = cache.xy;\n            if(depthPlusOneInRange && hasNextCol){\n              xFragAtCurrentDepth = idx.y != d ?\n                getX(b, r, c, idx.y) : xFragAtOutputCoords;\n              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));\n              if(hasNextRow){\n                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));\n              }\n            }\n            cache.xy = z.yw;\n            sum += z * z;\n          }\n        }\n        vec4 result = xAtOutputCoords * ").concat(o,";\n        setOutput(result);\n      }\n    ")},vo={kernelName:o.ub,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.depthRadius,s=r.bias,c=r.alpha,u=r.beta,l=Object(o.md)().getBool("WEBGL_PACK_NORMALIZATION")?new mo(a.shape,i,s,c,u):new po(a.shape,i,s,c,u);return n.runWebGLProgram(l,[a],a.dtype)}},go=function e(t,n,r,a,i){Object(h.a)(this,e),this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=t,this.depth=t[3],this.depthRadius=n,this.bias=r,this.alpha=a,this.beta=i,this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int r = coords[1];\n        int c = coords[2];\n\n        float result = 0.0;\n        for (int d = 0; d < ".concat(this.depth,"; ++d) {\n          int depthBegin = int(max(0.0, float(d - ").concat(n,")));\n          int depthEnd = int(min(float(").concat(this.depth,"),\n              float(d + ").concat(n," + 1)));\n\n          const int MIN_DEPTH_BEGIN = 0;\n          const int MAX_DEPTH_END = ").concat(this.depth,";\n\n          float norm = 0.0;\n          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd) {\n              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);\n            }\n            else {\n              break;\n            }\n          }\n\n          norm = float(").concat(a,") * norm + float(").concat(r,");\n\n          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){\n            if (k < depthBegin){\n              continue;\n            }\n            else if (k >= depthBegin && k < depthEnd){\n              float dyi = -2.0 * float(").concat(a,")\n                * float(").concat(i,")\n                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)\n                / norm;\n              if (k == d) {\n                dyi += pow(norm, -1.0 * ").concat(i,");\n              }\n              if (k == coords[3]) {\n                dyi *= getDy(b, r, c, d);\n                result += dyi;\n              }\n            }\n            else {\n              break;\n            }\n          }\n      }\n      setOutput(result);\n      }\n    ")},bo={kernelName:o.vb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.y,o=t.dy,s=r.depthRadius,c=r.bias,u=r.alpha,l=r.beta,d=new go(a.shape,s,c,u,l);return n.runWebGLProgram(d,[a,i,o],a.dtype)}};function yo(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reductionIndices,c=r.keepDims,u=a.shape.length,l=o.Ld.parseAxisParam(i,a.shape),d=l,h=o.cd.getAxesPermutation(d,u),f=null!=h,p=n.shouldExecuteOnCPU([a]),m=a;if(f){if(p){for(var v=n.texData.get(m.dataId).values,g=new Array(u),b=0;b<g.length;b++)g[b]=a.shape[h[b]];var y=Ht(v,a.shape,a.dtype,h,g);m=n.makeTensorInfo(g,a.dtype),n.texData.get(m.dataId).values=y}else m=Jn(a,h,n);d=o.cd.getInnerMostAxes(d.length,u)}o.cd.assertAxesAreInnerMostDims("max",d,u);var x,w=o.cd.computeOutAndReduceShapes(m.shape,d),O=Object(s.a)(w,2),A=O[0],_=O[1],E=A;if(c&&(E=o.cd.expandShapeToKeepDim(A,l)),p){var S=n.texData.get(m.dataId).values,C=Mt(S,o.Ld.sizeFromShape(_),E,a.dtype);x=n.makeTensorInfo(E,a.dtype),n.texData.get(x.dataId).values=C}else x=function(e,t,n,r){var a=o.Ld.sizeFromShape(t),i=Fn({inputs:{x:e},attrs:{shape:[o.Ld.sizeFromShape(e.shape)/a,a]},backend:r}),s=Hn(i,e.dtype,"max",r),c=Fn({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(s),c}(m,_,E,n);return f&&n.disposeIntermediateTensorInfo(m),x}var xo={kernelName:o.Fb,backendName:"webgl",kernelFunc:yo},wo=kn({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return max(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(max(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:kt}),Oo={kernelName:o.Lb,backendName:"webgl",kernelFunc:wo};var Ao={kernelName:o.Gb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x;Y(a,"maxPool");var i=r.filterSize,s=r.strides,c=r.pad,u=r.dimRoundingMode;o.Ld.assert(o.cd.eitherStridesOrDilationsAreOne(s,1),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(s," and dilations '").concat(1,"'")}));var l=o.cd.computePool2DInfo(a.shape,i,s,1,c,u);if(1===l.filterWidth&&1===l.filterHeight&&o.Ld.arraysEqual(l.inShape,l.outShape))return yn({inputs:{x:a},backend:n});var d=new kr(l,"max",!1);return n.runWebGLProgram(d,[a],a.dtype)}};var _o={kernelName:o.Hb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.filterSize,s=r.strides,c=r.pad,u=r.dataFormat,l=r.dimRoundingMode,d=o.cd.computePool3DInfo(a.shape,i,s,[1,1,1],c,l,u),h=new Rr(d,"max",!1);return n.runWebGLProgram(h,[a],a.dtype)}},Eo=function e(t){Object(h.a)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideHeight,r=t.strideWidth,a=t.dilationHeight,i=t.effectiveFilterHeight,o=t.effectiveFilterWidth,s=i-1-t.padInfo.top,c=o-1-t.padInfo.left,u=i*o-1;this.userCode="\n      const ivec2 pads = ivec2(".concat(s,", ").concat(c,");\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n\n        ivec2 dyRCCorner = coords.yz - pads;\n        int dyRCorner = dyRCCorner.x;\n        int dyCCorner = dyRCCorner.y;\n\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n        for (int wR = 0; wR < ").concat(i,";\n          wR += ").concat(a,") {\n          float dyR = float(dyRCorner + wR) / ").concat(n,".0;\n\n          if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 || fract(dyR) > 0.0) {\n            continue;\n          }\n          int idyR = int(dyR);\n\n          for (int wC = 0; wC < ").concat(o,"; wC++) {\n            float dyC = float(dyCCorner + wC) / ").concat(r,".0;\n\n            if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                fract(dyC) > 0.0) {\n              continue;\n            }\n            int idyC = int(dyC);\n\n            float dyValue = getDy(b, idyR, idyC, d);\n            int maxPosValue = ").concat(u," - int(getMaxPos(b, idyR, idyC, d));\n\n            // Get the current value, check it against the value from the\n            // position matrix.\n            int curPosValue = wR * ").concat(o," + wC;\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n            dotProd += dyValue * mask;\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")},So=function e(t){Object(h.a)(this,e),this.variableNames=["dy","maxPos"],this.outputShape=t.inShape;var n=t.strideDepth,r=t.strideHeight,a=t.strideWidth,i=t.dilationDepth,o=t.dilationHeight,s=t.dilationWidth,c=t.effectiveFilterDepth,u=t.effectiveFilterHeight,l=t.effectiveFilterWidth,d=c-1-t.padInfo.front,f=u-1-t.padInfo.top,p=l-1-t.padInfo.left,m=c*u*l-1;this.userCode="\n      const ivec3 pads = ivec3(".concat(d,", ").concat(f,", ").concat(p,");\n\n      void main() {\n        ivec5 coords = getOutputCoords();\n        int batch = coords.x;\n        int ch = coords.u;\n\n        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;\n        int dyDCorner = dyCorner.x;\n        int dyRCorner = dyCorner.y;\n        int dyCCorner = dyCorner.z;\n\n        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get\n        // dx(xD, xR, xC, ch).\n        // ? = to be determined. : = across all values in that axis.\n        float dotProd = 0.0;\n\n        for (int wD = 0; wD < ").concat(c,";\n           wD += ").concat(i,") {\n          float dyD = float(dyDCorner + wD) / ").concat(n,".0;\n\n          if (dyD < 0.0 || dyD >= ").concat(t.outDepth,".0 || fract(dyD) > 0.0) {\n            continue;\n          }\n          int idyD = int(dyD);\n\n          for (int wR = 0; wR < ").concat(u,";\n              wR += ").concat(o,") {\n            float dyR = float(dyRCorner + wR) / ").concat(r,".0;\n\n            if (dyR < 0.0 || dyR >= ").concat(t.outHeight,".0 ||\n                fract(dyR) > 0.0) {\n              continue;\n            }\n            int idyR = int(dyR);\n\n            for (int wC = 0; wC < ").concat(l,";\n                wC += ").concat(s,") {\n              float dyC = float(dyCCorner + wC) / ").concat(a,".0;\n\n              if (dyC < 0.0 || dyC >= ").concat(t.outWidth,".0 ||\n                  fract(dyC) > 0.0) {\n                continue;\n              }\n              int idyC = int(dyC);\n\n              float dyValue = getDy(batch, idyD, idyR, idyC, ch);\n              int maxPosValue = ").concat(m," -\n                  int(getMaxPos(batch, idyD, idyR, idyC, ch));\n\n              // Get the current value, check it against the value from the\n              // position matrix.\n              int curPosValue =\n                  wD * ").concat(u," * ").concat(l," +\n                  wR * ").concat(l," + wC;\n              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\n\n              dotProd += dyValue * mask;\n            }\n          }\n        }\n        setOutput(dotProd);\n      }\n    ")};var Co={kernelName:o.Ib,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,s=r.filterSize,c=r.strides,u=r.pad,l=r.dimRoundingMode,d=o.cd.computePool3DInfo(i.shape,s,c,[1,1,1],u,l),h=new Rr(d,"max",!0),f=n.runWebGLProgram(h,[i],i.dtype),p=new So(d),m=n.runWebGLProgram(p,[a,f],i.dtype);return n.disposeIntermediateTensorInfo(f),m}};var To={kernelName:o.Jb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.dy,i=t.input,s=i;Y([i,t.output],"maxPoolGrad");var c=r.filterSize,u=r.strides,l=r.pad,d=r.dimRoundingMode,h=o.cd.computePool2DInfo(s.shape,c,u,1,l,d),f=new kr(h,"max",!0),p=n.runWebGLProgram(f,[s],s.dtype),m=new Eo(h),v=n.runWebGLProgram(m,[a,p],s.dtype);return n.disposeIntermediateTensorInfo(p),v}};var Mo={kernelName:o.Kb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.filterSize,c=n.strides,u=n.pad,l=n.includeBatchInIndex,d=r;o.Ld.assert(4===a.shape.length,(function(){return"Error in maxPool: input must be rank 4 but got rank ".concat(a.shape.length,".")}));var h=[1,1];o.Ld.assert(o.cd.eitherStridesOrDilationsAreOne(c,h),(function(){return"Error in maxPool: Either strides or dilations must be 1. "+"Got strides ".concat(c," and dilations '").concat(h,"'")}));var f=o.cd.computePool2DInfo(a.shape,i,c,h,u),p=function(e,t,n,r){var a=new kr(n,"max",!1),i=r.runWebGLProgram(a,[e],"float32");return a=new kr(n,"max",!0,!0,t),[i,r.runWebGLProgram(a,[e],"float32")]}(a,l,f,d),m=Object(s.a)(p,2);return[m[0],m[1]]}};var ko={kernelName:o.Mb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=n.keepDims,c=n.axis,u=r,l=a.shape.length,d=o.Ld.parseAxisParam(c,a.shape),h=d,f=o.cd.getAxesPermutation(h,l),p=null!=f,m=u.shouldExecuteOnCPU([a]),v=[],g=a;if(p){if(m){for(var b=u.texData.get(g.dataId).values,y=new Array(l),x=0;x<y.length;x++)y[x]=a.shape[f[x]];var w=Ht(b,a.shape,a.dtype,f,y);g=u.makeTensorInfo(y,a.dtype),u.texData.get(g.dataId).values=w}else g=Jn(a,f,u);v.push(g),h=o.cd.getInnerMostAxes(h.length,l)}o.cd.assertAxesAreInnerMostDims("sum",h,l);var O=o.cd.computeOutAndReduceShapes(g.shape,h),A=Object(s.a)(O,2),_=A[0],E=A[1],S=_;i&&(S=o.cd.expandShapeToKeepDim(_,d));for(var C=function(e,t,n,r){var a=o.Ld.sizeFromShape(t),i=Fn({inputs:{x:e},attrs:{shape:[o.Ld.sizeFromShape(e.shape)/a,a]},backend:r}),s=Hn(i,"float32","mean",r),c=Fn({inputs:{x:s},attrs:{shape:n},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(s),c}(g,E,S,u),T=0,M=v;T<M.length;T++){var k=M[T];u.disposeIntermediateTensorInfo(k)}return C}};var Ro={kernelName:o.Nb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.axis,c=r.keepDims,u=a.shape.length,l=o.Ld.parseAxisParam(i,a.shape),d=l,h=o.cd.getAxesPermutation(d,u),f=a;null!=h&&(f=qn({inputs:{x:a},backend:n,attrs:{perm:h}}),d=o.cd.getInnerMostAxes(d.length,a.shape.length)),o.cd.assertAxesAreInnerMostDims("min",d,u);var p,m=o.cd.computeOutAndReduceShapes(f.shape,d),v=Object(s.a)(m,2),g=v[0],b=v[1],y=Fn({inputs:{x:f},backend:n,attrs:{shape:[-1,o.Ld.sizeFromShape(b)]}}),x=Hn(y,y.dtype,"min",n);return p=Fn(c?{inputs:{x:x},backend:n,attrs:{shape:o.cd.expandShapeToKeepDim(g,l)}}:{inputs:{x:x},backend:n,attrs:{shape:g}}),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(x),null!=h&&n.disposeIntermediateTensorInfo(f),p}},Io=kn({opSnippet:"\n  if (isnan(a)) return a;\n  if (isnan(b)) return b;\n\n  return min(a, b);\n",packedOpSnippet:"\n  vec4 result = vec4(min(a, b));\n  vec4 isNaN = min(vec4(isnan(a)) + vec4(isnan(b)), vec4(1.0));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n",cpuKernelImpl:Rt}),jo={kernelName:o.Ob,backendName:"webgl",kernelFunc:Io},Bo=function e(t,n,r){Object(h.a)(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Re(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a),u="reflect"===r?0:1;this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        for (int i = 0; i < ").concat(a,"; i++) {\n          if (outC[i] < start[i]) {\n            outC[i] = start[i] * 2 - outC[i] - ").concat(u,";\n          } else if(outC[i] >= end[i]) {\n            outC[i] = (end[i] - 1) * 2 - outC[i] + ").concat(u,";\n          }\n        }\n        ").concat(i," coords = outC - start;\n        setOutput(getX(").concat(c,"));\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start) {\n            outC = start * 2 - outC - ").concat(u,";\n          } else if(outC >= end) {\n            outC = (end - 1) * 2 - outC + ").concat(u,";\n          }\n          setOutput(getX(outC - start));\n        }\n      ")},Lo=function e(t,n,r){Object(h.a)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Re(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),c=Jt("rc",a),u=Jt("source",a),l="".concat(c[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(u.slice(-2).join(),")"),f="reflect"===r?0:1,p="";if(1===a){var m="\n        ".concat(i," source = rc;\n        if (source < start) {\n          source = start * 2 - source - ").concat(f,";\n        } else if (source >= end) {\n          source = (end - 1) * 2 - source + ").concat(f,";\n        }\n        source -= start;\n      ");p="\n        ".concat(i," rc = outputLoc;\n        ").concat(m,"\n        result[0] = getChannel(getX(").concat(u.join(),"), ").concat(d,");\n        ").concat(c[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(m,"\n          result[1] = getChannel(getX(").concat(u.join(),"), ").concat(d,");\n        }\n      ")}else{var v="\n        ".concat(i," source = rc;\n        ").concat(i," lt = ").concat(i,"(lessThan(source, start));\n        ").concat(i," gte = ").concat(i,"(greaterThanEqual(source, end));\n        ").concat(i," orig = 1 - (lt + gte);\n        source = orig * source +\n                lt * (start * 2 - source - ").concat(f,") +\n                gte * ((end - 1) * 2 - source + ").concat(f,");\n        source -= start;\n      ");p="\n        ".concat(i," rc = outputLoc;\n        ").concat(v,"\n        result[0] = getChannel(getX(").concat(u.join(),"), ").concat(d,");\n        ").concat(c[a-1]," += 1;\n        if(").concat(l,") {\n          ").concat(v,"\n          result[1] = getChannel(getX(").concat(u.join(),"), ").concat(d,");\n        }\n        rc = outputLoc;\n        ").concat(c[a-2]," += 1;\n        if(").concat(c[a-2]," < ").concat(this.outputShape[a-2],") {\n          ").concat(v,"\n          result[2] = getChannel(getX(").concat(u.join(),"), ").concat(d,");\n          ").concat(c[a-1]," += 1;\n          if(").concat(l,") {\n            ").concat(v,"\n            result[3] = getChannel(getX(").concat(u.join(),"), ").concat(d,");\n          }\n        }\n      ")}this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(p,"\n        setOutput(result);\n      }\n    ")},No={kernelName:o.Pb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,s=r.mode,c=Object(o.md)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Lo(a.shape,i,s):new Bo(a.shape,i,s);return n.runWebGLProgram(c,[a],a.dtype)}},Do=kn({opSnippet:"if (b == 0.0) return NAN;\n  return mod(a, b);",packedOpSnippet:"\n  vec4 result = mod(a, b);\n  vec4 isNaN = vec4(equal(b, vec4(0.0)));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),Po={kernelName:o.Qb,backendName:"webgl",kernelFunc:Do},Fo=function(){function e(t,n,r){Object(h.a)(this,e),this.variableNames=["probs"],this.outputShape=[t,r],this.userCode="\n      uniform float seed;\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n\n        float r = random(seed);\n        float cdf = 0.0;\n\n        for (int i = 0; i < ".concat(n-1,"; i++) {\n          cdf += getProbs(batch, i);\n\n          if (r < cdf) {\n            setOutput(float(i));\n            return;\n          }\n        }\n\n        // If no other event happened, last event happened.\n        setOutput(float(").concat(n-1,"));\n      }\n    ")}return Object(f.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,"seed")),n.gl.uniform1f(t.seedLoc,e)}}}]),e}(),Go=kn({opSnippet:"\nif (a == b) {\n  return 1.0;\n};\nreturn a / b;",packedOpSnippet:"\n  // vec4 one = vec4(equal(a, b));\n  // return one + (vec4(1.0) - one) * a / b;\n  vec4 result = a / b;\n  if(a.x == b.x) {\n    result.x = 1.;\n  }\n  if(a.y == b.y) {\n    result.y = 1.;\n  }\n  if(a.z == b.z) {\n    result.z = 1.;\n  }\n  if(a.w == b.w) {\n    result.w = 1.;\n  }\n\n  return result;\n",checkOutOfBounds:!0}),Uo={kernelName:o.hc,backendName:"webgl",kernelFunc:Go},zo="return a - b;",Ho=kn({opSnippet:zo,packedOpSnippet:zo,supportsComplex:!0,cpuKernelImpl:Gt}),Vo={kernelName:o.Mc,backendName:"webgl",kernelFunc:Ho};function Wo(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.dim,s=o.Ld.parseAxisParam([i],a.shape),c=yo({inputs:{x:a},backend:n,attrs:{reductionIndices:s,keepDims:!1}}),u=o.cd.expandShapeToKeepDim(c.shape,s),l=Fn({inputs:{x:c},backend:n,attrs:{shape:u}}),d=Ho({inputs:{a:a,b:l},backend:n}),h=di({inputs:{x:d},backend:n}),f=Xn({inputs:{x:h},backend:n,attrs:{axis:s,keepDims:!1}}),p=Fn({inputs:{x:f},backend:n,attrs:{shape:u}}),m=Go({inputs:{a:h,b:p},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}var Jo={kernelName:o.Cc,backendName:"webgl",kernelFunc:Wo};var Xo={kernelName:o.Rb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.logits,i=r.numSamples,o=r.seed,s=r.normalized,c=s?a:Wo({inputs:{logits:a},backend:n,attrs:{dim:a.shape.length-1}}),u=c.shape[0],l=c.shape[1],d=new Fo(u,l,i),h=d.getCustomSetupFunc(o),f=n.runWebGLProgram(d,[c],"int32",h);return s||n.disposeIntermediateTensorInfo(c),f}},Ko="return -x;";var qo={kernelName:o.Tb,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=n.x;if(r.shouldExecuteOnCPU([a])){var i=r.texData.get(a.dataId),c=jt(i.values,a.shape,a.dtype),u=Object(s.a)(c,2),l=u[0],d=u[1];return r.makeTensorInfo(d,a.dtype,l)}return t=Object(o.md)().getBool("WEBGL_PACK_UNARY_OPERATIONS")?new hn(a.shape,Ko):new $t(a.shape,Ko),r.runWebGLProgram(t,[a],a.dtype)}},Yo=o.sd.nonMaxSuppressionV3Impl;var Qo={kernelName:o.Ub,backendName:"webgl",kernelFunc:function(e){o.cd.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,s=r.maxOutputSize,c=r.iouThreshold,u=r.scoreThreshold,l=n.readSync(a.dataId),d=n.readSync(i.dataId),h=Yo(l,d,s,c,u).selectedIndices;return n.makeTensorInfo([h.length],"int32",new Int32Array(h))}},Zo=o.sd.nonMaxSuppressionV4Impl;var $o={kernelName:o.Vb,backendName:"webgl",kernelFunc:function(e){o.cd.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,s=r.maxOutputSize,c=r.iouThreshold,u=r.scoreThreshold,l=r.padToMaxOutputSize,d=n.readSync(a.dataId),h=n.readSync(i.dataId),f=Zo(d,h,s,c,u,l),p=f.selectedIndices,m=f.validOutputs;return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([m]))]}},es=o.sd.nonMaxSuppressionV5Impl;var ts={kernelName:o.Wb,backendName:"webgl",kernelFunc:function(e){o.cd.warn("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");var t=e.inputs,n=e.backend,r=e.attrs,a=t.boxes,i=t.scores,s=r.maxOutputSize,c=r.iouThreshold,u=r.scoreThreshold,l=r.softNmsSigma,d=n.readSync(a.dataId),h=n.readSync(i.dataId),f=es(d,h,s,c,u,l),p=f.selectedIndices,m=f.selectedScores;return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([m.length],"float32",new Float32Array(m))]}},ns=function e(t,n,r,a){Object(h.a)(this,e),this.variableNames=["indices"],this.outputShape=[t,n],this.userCode="\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int index = round(getIndices(coords.x));\n        setOutput(mix(float(".concat(a,"), float(").concat(r,"),\n                      float(index == coords.y)));\n      }\n    ")},rs={kernelName:o.Yb,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=r.depth,s=r.onValue,c=r.offValue,u=o.Ld.sizeFromShape(a.shape),d=new ns(u,i,s,c),h=Fn({inputs:{x:a},backend:n,attrs:{shape:[u]}}),f=n.runWebGLProgram(d,[h],a.dtype);n.disposeIntermediateTensorInfo(h);var p=Fn({inputs:{x:f},backend:n,attrs:{shape:[].concat(Object(l.a)(a.shape),[i])}});return n.disposeIntermediateTensorInfo(f),p}};function as(e){var t=e.inputs,n=e.backend,r=t.x;if("complex64"===r.dtype){var a=Qr({inputs:{input:r},backend:n}),i=as({inputs:{x:a},backend:n}),o=ha({inputs:{input:r},backend:n}),s=as({inputs:{x:o},backend:n}),c=wn({inputs:{real:i,imag:s},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(s),c}return Oi({attrs:{shape:r.shape,dtype:r.dtype,value:"string"===r.dtype?"":0},backend:n})}var is={kernelName:o.Zc,backendName:"webgl",kernelFunc:as};var os={kernelName:o.Zb,backendName:"webgl",kernelFunc:function e(t){var n=t.inputs,r=t.backend,a=n.x;if("string"===a.dtype)throw new Error("onesLike is not supported under string dtype");if("complex64"===a.dtype){var i=Qr({inputs:{input:a},backend:r}),o=e({inputs:{x:i},backend:r}),s=ha({inputs:{input:a},backend:r}),c=as({inputs:{x:s},backend:r}),u=wn({inputs:{real:o,imag:c},backend:r});return r.disposeIntermediateTensorInfo(i),r.disposeIntermediateTensorInfo(o),r.disposeIntermediateTensorInfo(s),r.disposeIntermediateTensorInfo(c),u}return Oi({attrs:{shape:a.shape,dtype:a.dtype,value:1},backend:r})}};var ss={kernelName:o.ac,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs.axis;if(1===t.length)return fi({inputs:{input:t[0]},backend:n,attrs:{dim:r}});var a=t[0].shape,i=t[0].dtype;t.forEach((function(e){o.Ld.assertShapesMatch(a,e.shape,"All tensors passed to stack must have matching shapes"),o.Ld.assert(i===e.dtype,(function(){return"All tensors passed to stack must have matching dtypes"}))}));var s=[],c=va({inputs:t.map((function(e){var t=fi({inputs:{input:e},backend:n,attrs:{dim:r}});return s.push(t),t})),backend:n,attrs:{axis:r}});return s.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),c}},cs=function(){function e(t,n,r){Object(h.a)(this,e),this.variableNames=["x"],this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));var a=t.length,i=Re(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,a);this.userCode=1!==a?"\n      ".concat(i," start = ").concat(i,"(").concat(o,");\n      ").concat(i," end = ").concat(i,"(").concat(s,");\n      uniform float value;\n\n      void main() {\n        ").concat(i," outC = getOutputCoords();\n        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {\n          setOutput(value);\n        } else {\n          ").concat(i," coords = outC - start;\n          setOutput(getX(").concat(c,"));\n        }\n      }\n    "):"\n        int start = ".concat(o,";\n        int end = ").concat(s,";\n        uniform float value;\n\n        void main() {\n          int outC = getOutputCoords();\n          if (outC < start || outC >= end) {\n            setOutput(value);\n          } else {\n            setOutput(getX(outC - start));\n          }\n        }\n      ")}return Object(f.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}(),us=function(){function e(t,n,r){Object(h.a)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((function(e,n){return e[0]+t[n]+e[1]}));for(var a=t.length,i=Re(a),o=n.map((function(e){return e[0]})).join(","),s=n.map((function(e,n){return e[0]+t[n]})).join(","),c=Jt("rc",a),u=Jt("source",a),l="".concat(c[a-1]," < ").concat(this.outputShape[a-1]),d=1===a?"source":"vec2(".concat(u.slice(-2).join(),")"),f=["".concat(i," rc = outputLoc;"),"".concat(c[a-1]," += 1;\n       if(").concat(l,") {\n      "),1===a?"":"}\n       rc = outputLoc;\n       ".concat(c[a-2]," += 1;\n       if(").concat(c[a-2]," < ").concat(this.outputShape[a-2],") {"),1===a?"":"  ".concat(c[a-1]," += 1;\n         if(").concat(l,") {")],p=1===a?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))",m="",v=0,g=1===a?2:4;v<g;v++)m+="\n        ".concat(f[v],"\n        if (").concat(p,") {\n          result[").concat(v,"] = float(value);\n        } else {\n          ").concat(i," source = rc - start;\n          result[").concat(v,"] = getChannel(getX(").concat(u.join(),"), ").concat(d,");\n        }\n      ");m+=1===a?"} ":"}}",this.userCode="\n      const ".concat(i," start = ").concat(i,"(").concat(o,");\n      const ").concat(i," end = ").concat(i,"(").concat(s,");\n      uniform float value;\n\n      void main() {\n        ").concat(i," outputLoc = getOutputCoords();\n        vec4 result = vec4(0.);\n        ").concat(m,"\n        setOutput(result);\n      }\n    ")}return Object(f.a)(e,[{key:"getCustomSetupFunc",value:function(e){var t=this;return function(n,r){null==t.valueLoc&&(t.valueLoc=n.getUniformLocationNoThrow(r,"value")),n.gl.uniform1f(t.valueLoc,e)}}}]),e}(),ls=function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.paddings,s=r.constantValue,c=Object(o.md)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new us(a.shape,i,s):new cs(a.shape,i,s),u=c.getCustomSetupFunc(s);return n.runWebGLProgram(c,[a],a.dtype,u)},ds={kernelName:o.bc,backendName:"webgl",kernelFunc:ls},hs=kn({opSnippet:"\n  if(a < 0.0 && floor(b) < b){\n    return NAN;\n  }\n  if (b == 0.0) {\n    return 1.0;\n  }\n  return (round(mod(b, 2.0)) != 1) ?\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\n",packedOpSnippet:"\n  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.\n  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));\n  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);\n  vec4 result = multiplier * pow(abs(a), b);\n\n  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS\n  bvec4 isExpZero = equal(b, vec4(0.0));\n  result.r = isExpZero.r ? 1.0 : result.r;\n  result.g = isExpZero.g ? 1.0 : result.g;\n  result.b = isExpZero.b ? 1.0 : result.b;\n  result.a = isExpZero.a ? 1.0 : result.a;\n\n  vec4 isNaN = vec4(lessThan(a, vec4(0.0))) * vec4(lessThan(floor(b), b));\n  \n  result.r = isNaN.r > 0. ? NAN : result.r;\n  result.g = isNaN.g > 0. ? NAN : result.g;\n  result.b = isNaN.b > 0. ? NAN : result.b;\n  result.a = isNaN.a > 0. ? NAN : result.a;\n\n  return result;\n"}),fs={kernelName:o.cc,backendName:"webgl",kernelFunc:hs};var ps={kernelName:o.ec,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,c=a.axis,u=a.keepDims,l=i.shape.length,d=[],h=o.Ld.parseAxisParam(c,i.shape),f=h,p=o.cd.getAxesPermutation(f,l),m=i;if(null!=p&&(m=qn({inputs:{x:i},backend:r,attrs:{perm:p}}),f=o.cd.getInnerMostAxes(f.length,l),d.push(m)),o.cd.assertAxesAreInnerMostDims("prod",f,l),r.shouldExecuteOnCPU([m])){var v=r.texData.get(m.dataId).values,g=Bt(m.shape,m.dtype,v,f),b=g.outVals,y=g.outShape,x=g.outDtype;t=r.makeTensorInfo(y,x,b)}else{var w=o.cd.computeOutAndReduceShapes(m.shape,f),O=Object(s.a)(w,2),A=O[0],_=O[1],E=o.Ld.sizeFromShape(_),S=Fn({inputs:{x:m},backend:r,attrs:{shape:[-1,E]}}),C=Hn(S,Object(o.Ed)(i.dtype),"prod",r);t=Fn({inputs:{x:C},backend:r,attrs:{shape:A}}),d.push(S),d.push(C)}if(u){d.push(t);var T=o.cd.expandShapeToKeepDim(t.shape,h);t=Fn({inputs:{x:t},backend:r,attrs:{shape:T}})}return d.forEach((function(e){return r.disposeIntermediateTensorInfo(e)})),t}},ms=function(e){var t=e.backend,n=e.attrs,r=n.start,a=n.stop,i=n.step,o=n.dtype,s=Lt(r,a,i,o);return t.makeTensorInfo([s.length],o,s)},vs={kernelName:o.fc,backendName:"webgl",kernelFunc:ms},gs=Mn({opSnippet:"return 1.0 / x;"}),bs={kernelName:o.ic,backendName:"webgl",kernelFunc:gs},ys=Mn({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : x;\n",packedOpSnippet:"\n  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),xs={kernelName:o.jc,backendName:"webgl",kernelFunc:ys},ws=Mn({opSnippet:"if (isnan(x)) return x;\n  return (x < 0.0) ? 0.0 : min(6.0, x);\n",packedOpSnippet:"\n  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));\n  bvec4 isNaN = isnan(x);\n\n  result.r = isNaN.r ? x.r : result.r;\n  result.g = isNaN.g ? x.g : result.g;\n  result.b = isNaN.b ? x.b : result.b;\n  result.a = isNaN.a ? x.a : result.a;\n\n  return result;\n"}),Os={kernelName:o.kc,backendName:"webgl",kernelFunc:ws},As=function e(t,n,r,a,i){Object(h.a)(this,e),this.variableNames=["A"],this.outputShape=[];var o=Object(s.a)(t,4),c=o[0],u=o[1],l=o[2],d=o[3];this.outputShape=[c,n,r,d];var f,p=[a&&n>1?u-1:u,a&&r>1?l-1:l],m=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=i?"(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/m[0],",\n          ").concat(p[1]/m[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));\n        ivec2 sourceCeilRC = ivec2(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\n\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\n\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\n        float newValue = top + (bottom - top) * fracRC.x;\n\n        setOutput(newValue);\n      }\n    ")},_s=function e(t,n,r,a,i){Object(h.a)(this,e),this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];var o=Object(s.a)(t,4),c=o[0],u=o[1],l=o[2],d=o[3];this.outputShape=[c,n,r,d];var f,p=[a&&n>1?u-1:u,a&&r>1?l-1:l],m=[a&&n>1?n-1:n,a&&r>1?r-1:r];f=i?"(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":"vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec3 effectiveInputOverOutputRatioRC = vec3(\n          ".concat(p[0]/m[0],",\n          ").concat(p[1]/m[1],",\n          ").concat(p[1]/m[1],");\n      const vec3 inputShapeRC = vec3(").concat(u,".0, ").concat(l,".0,\n                                     ").concat(l,".0);\n\n      float getAValue(int b, int r, int c, int d) {\n        return getChannel(getA(b, r, c, d), vec2(c, d));\n      }\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        // Calculate values for next column in yRC.z.\n        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);\n\n        // Fractional source index.\n        vec3 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the four integer indices.\n        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));\n        ivec3 sourceCeilRC = ivec3(\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\n\n        // Should we calculate next column and row elements in 2x2 packed cell.\n        bool hasNextCol = d < ").concat(d-1,";\n        bool hasNextRow = coords.z < ").concat(r-1,";\n\n        // In parallel, construct four corners for all four components in\n        // packed 2x2 cell.\n        vec4 topLeft = vec4(\n          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 bottomLeft = vec4(\n          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);\n\n        vec4 topRight = vec4(\n          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec4 bottomRight = vec4(\n          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),\n          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)\n                     : 0.0,\n          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)\n                     : 0.0,\n          (hasNextRow && hasNextCol) ?\n            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);\n\n        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);\n\n        vec4 top = mix(topLeft, topRight, fracRC.yyzz);\n        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);\n        vec4 newValue = mix(top, bottom, fracRC.x);\n\n        setOutput(newValue);\n      }\n    ")};var Es={kernelName:o.mc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,c=r.halfPixelCenters,u=r.size,l=Object(s.a)(u,2),d=l[0],h=l[1],f=Object(o.md)().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new _s(a.shape,d,h,i,c):new As(a.shape,d,h,i,c);return n.runWebGLProgram(f,[a],"float32")}},Ss=function e(t,n,r){Object(h.a)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=Object(s.a)(n,3),i=a[1],o=a[2],c=Object(s.a)(t,3),u=c[1],l=c[2],d=[r&&u>1?i-1:i,r&&l>1?o-1:o],f=[r&&u>1?u-1:u,r&&l>1?l-1:l],p=d[0]/f[0],m=d[1]/f[1],v=1/p,g=1/m,b=2*Math.ceil(v)+2,y=2*Math.ceil(g)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(m,");\n\n        const float invHeightScale = float(").concat(v,");\n        const float invWidthScale = float(").concat(g,");\n\n        const int winHeight = int(").concat(b,");\n        const int winWidth = int(").concat(y,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(startRLerp - float(winHeight / 2));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(startCLerp - float(winWidth / 2));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float dxR = float(dyR) * heightScale;\n            int topDxRIndex = int(floor(dxR));\n            int bottomDxRIndex = int(min(ceil(dxR), ").concat(i-1,".0));\n            float dxRLerp = dxR - float(topDxRIndex);\n            float inverseDxRLerp = 1.0 - dxRLerp;\n\n            float dxC = float(dyC) * widthScale;\n            int leftDxCIndex = int(floor(dxC));\n            int rightDxCIndex = int(min(ceil(dxC), ").concat(o-1,".0));\n            float dxCLerp = dxC - float(leftDxCIndex);\n            float inverseDxCLerp = 1.0 - dxCLerp;\n\n            if (r == topDxRIndex && c == leftDxCIndex) {\n              // topLeft\n              accumulator +=\n                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;\n            }\n\n            if (r == topDxRIndex && c == rightDxCIndex) {\n              // topRight\n              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == leftDxCIndex) {\n              // bottomLeft\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;\n            }\n\n            if (r == bottomDxRIndex && c == rightDxCIndex) {\n              // bottomRight\n              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")};var Cs={kernelName:o.nc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new Ss(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},Ts=function e(t,n,r,a,i){Object(h.a)(this,e),this.variableNames=["A"],this.outputShape=[];var o=Object(s.a)(t,4),c=o[0],u=o[1],l=o[2],d=o[3];this.outputShape=[c,n,r,d];var f,p=[a&&n>1?u-1:u,a&&r>1?l-1:l],m=[a&&n>1?n-1:n,a&&r>1?r-1:r],v=a?"0.5":"0.0";f=i?"max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":"vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode="\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\n          ".concat(p[0]/m[0],",\n          ").concat(p[1]/m[1],");\n      const vec2 inputShapeRC = vec2(").concat(u,".0, ").concat(l,".0);\n\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        ivec2 yRC = coords.yz;\n\n        // Fractional source index.\n        vec2 sourceFracIndexRC = ").concat(f,";\n\n        // Compute the coordinators of nearest neighbor point.\n        ivec2 sourceNearestRC = ivec2(\n          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ").concat(v,")));\n        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);\n\n        setOutput(newValue);\n      }\n    ")};var Ms={kernelName:o.oc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=r.alignCorners,o=r.halfPixelCenters,c=r.size,u=Object(s.a)(c,2),l=u[0],d=u[1],h=new Ts(a.shape,l,d,i,o);return n.runWebGLProgram(h,[a],a.dtype)}},ks=function e(t,n,r){Object(h.a)(this,e),this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;var a=Object(s.a)(n,3),i=a[1],o=a[2],c=Object(s.a)(t,3),u=c[1],l=c[2],d=[r&&u>1?i-1:i,r&&l>1?o-1:o],f=[r&&u>1?u-1:u,r&&l>1?l-1:l],p=d[0]/f[0],m=d[1]/f[1],v=1/p,g=1/m,b=2*Math.ceil(v)+2,y=2*Math.ceil(g)+2;this.userCode="\n      void main() {\n        ivec4 coords = getOutputCoords();\n        int b = coords[0];\n        int d = coords[3];\n        int r = coords[1];\n        int c = coords[2];\n\n        float accumulator = 0.0;\n\n        const float heightScale = float(".concat(p,");\n        const float widthScale = float(").concat(m,");\n\n        const float invHeightScale = float(").concat(v,");\n        const float invWidthScale = float(").concat(g,");\n\n        const int winHeight = int(").concat(b,");\n        const int winWidth = int(").concat(y,");\n\n        // Compute bounds for where in dy we will look\n        float startRLerp = floor(float(r) * invHeightScale);\n        int startDyR = int(floor(startRLerp - float(winHeight / 2)));\n\n        float startCLerp = floor(float(c) * invWidthScale);\n        int startDyC = int(floor(startCLerp - float(winWidth / 2)));\n\n        // Loop over dy\n        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {\n          int dyR = dyROffset + startDyR;\n\n          // Guard against the window exceeding the bounds of dy\n          if (dyR < 0 || dyR >= ").concat(u,") {\n            continue;\n          }\n\n          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {\n            int dyC = dyCOffset + startDyC;\n\n            // Guard against the window exceeding the bounds of dy\n            if (dyC < 0 || dyC >= ").concat(l,") {\n              continue;\n            }\n\n            float sourceFracRow =\n              float(").concat(d[0],") *\n                (float(dyR) / float(").concat(f[0],"));\n\n            float sourceFracCol =\n                float(").concat(d[1],") *\n                  (float(dyC) / float(").concat(f[1],"));\n\n            int sourceNearestRow = int(min(\n                float(int(").concat(i,") - 1),\n                ").concat(r," ? float(round(sourceFracRow)) :\n                                  float(floor(sourceFracRow))));\n\n            int sourceNearestCol = int(min(\n                float(int(").concat(o,") - 1),\n                ").concat(r," ? float(round(sourceFracCol)) :\n                                  float(floor(sourceFracCol))));\n\n            if (r == sourceNearestRow && c == sourceNearestCol) {\n              accumulator += getDy(b, dyR, dyC, d);\n            }\n          }\n        }\n        // End loop over dy\n\n        setOutput(accumulator);\n      }\n    ")};var Rs={kernelName:o.pc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.images,i=t.dy,o=r.alignCorners,s=new ks(i.shape,a.shape,o);return n.runWebGLProgram(s,[i],i.dtype)}},Is=function e(t,n){Object(h.a)(this,e),this.variableNames=["x"];var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));if(this.outputShape=t,1!==r){var a=t.map((function(e,r){return function(e){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - coords[").concat(e,"] - 1"):"coords[".concat(e,"]")}(r)})).join(","),i=Re(r);this.userCode="\n      void main() {\n        ".concat(i," coords = getOutputCoords();\n        setOutput(getX(").concat(a,"));\n      }\n    ")}else this.userCode="\n        void main() {\n          int coord = getOutputCoords();\n          setOutput(getX(".concat(t[0]," - coord - 1));\n        }\n      ")},js=function e(t,n){Object(h.a)(this,e),this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;var r=t.length;if(r>4)throw new Error("WebGL backend: Reverse of rank-".concat(r," tensor is not yet supported"));this.outputShape=t;var a=Jt("rc",r),i="".concat(a[r-1]," + 1 < ").concat(this.outputShape[r-1]),o="".concat(a[r-2]," + 1 < ").concat(this.outputShape[r-2]),s=Re(r);function c(e){var r=t.map((function(r,a){return function(e,r){return-1!==n.indexOf(e)&&1!==t[e]?"".concat(t[e]," - ").concat(r[e]," - 1"):"".concat(r[e])}(a,e)})),a=r.join(","),i=r.slice(-2).join(",");return"getChannel(getX(".concat(a,"), vec2(").concat(i,"))")}this.userCode=1===r?"\n        void main(){\n          int rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = getChannel(getX(".concat(t[0]," - rc - 1),\n            ").concat(t[0]," - rc - 1);\n          if(").concat(i,"){\n              result.g = getChannel(getX(").concat(t[0]," - (rc  + 1) - 1),\n                ").concat(t[0]," - (rc  + 1) - 1);\n          }\n          setOutput(result);\n        }\n      "):"\n        void main() {\n          ".concat(s," rc = getOutputCoords();\n          vec4 result = vec4(0.);\n          result.r = ").concat(function(e){return c(e)}(a.slice()),";\n          if(").concat(i,"){\n            result.g = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",c(e)}(a.slice()),";\n          }\n          if(").concat(o,") {\n            result.b = ").concat(function(e){return e[r-2]="("+e[r-2]+" + 1)",c(e)}(a.slice()),";\n            if(").concat(i,") {\n              result.a = ").concat(function(e){return e[r-1]="("+e[r-1]+" + 1)",e[r-2]="("+e[r-2]+" + 1)",c(e)}(a.slice()),";\n            }\n          }\n          setOutput(result);\n        }\n    ")};var Bs={kernelName:o.qc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.dims,s=a.shape.length,c=o.Ld.parseAxisParam(i,a.shape);if(0===s)return yn({inputs:{x:a},backend:n});var u=Object(o.md)().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new js(a.shape,c):new Is(a.shape,c);return n.runWebGLProgram(u,[a],a.dtype)}},Ls=function(){function e(t,n){Object(h.a)(this,e),this.variableNames=["Image"],this.outputShape=[];var r=t[1],a=t[2];this.outputShape=t;var i="";i="number"===typeof n?"float outputValue = ".concat(n.toFixed(2),";"):"\n        vec3 fill = vec3(".concat(n.join(","),");\n        float outputValue = fill[coords[3]];"),this.userCode="\n        uniform vec4 params;\n        void main() {\n          ivec4 coords = getOutputCoords();\n          int x = coords[2];\n          int y = coords[1];\n          float coordXFloat = (float(x) - params[0]) * params[3] -\n            (float(y) - params[1]) * params[2];\n          float coordYFloat = (float(x) - params[0]) * params[2] +\n            (float(y) - params[1]) * params[3];\n          int coordX = int(round(coordXFloat + params[0]));\n          int coordY = int(round(coordYFloat + params[1]));\n          ".concat(i,"\n          if(coordX >= 0 && coordX < ").concat(a," && coordY >= 0 && coordY < ").concat(r,") {\n            outputValue = getImage(coords[0], coordY, coordX, coords[3]);\n          }\n          setOutput(outputValue);\n        }\n    ")}return Object(f.a)(e,[{key:"getCustomSetupFunc",value:function(e,t,n,r){var a=this;return function(i,o){null==a.paramsLoc&&(a.paramsLoc=i.getUniformLocationNoThrow(o,"params")),i.gl.uniform4f(a.paramsLoc,e,t,n,r)}}}]),e}(),Ns={kernelName:o.rc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.image,i=n.radians,c=n.fillValue,u=n.center,l=r,d=new Ls(a.shape,c),h=o.cd.getImageCenter(u,a.shape[1],a.shape[2]),f=Object(s.a)(h,2),p=f[0],m=f[1],v=d.getCustomSetupFunc(p,m,Math.sin(i),Math.cos(i));return l.runWebGLProgram(d,[a],a.dtype,v)}},Ds=Mn({opSnippet:"\n  // OpenGL ES does not support round function.\n  // The algorithm is based on banker's rounding.\n  float base = floor(x);\n  if ((x - base) < 0.5) {\n    return floor(x);\n  } else if ((x - base) > 0.5) {\n    return ceil(x);\n  } else {\n    if (mod(base, 2.0) == 0.0) {\n      return base;\n    } else {\n      return base + 1.0;\n    }\n  }\n"}),Ps={kernelName:o.sc,backendName:"webgl",kernelFunc:Ds},Fs=Mn({opSnippet:"return inversesqrt(x);",cpuKernelImpl:Nt}),Gs={kernelName:o.tc,backendName:"webgl",kernelFunc:Fs},Us=function e(t,n,r,a,i,o){Object(h.a)(this,e),this.variableNames=["updates","indices","defaultValue"],this.outputShape=o;var s=Re(i.length),c=Re(o.length),u="";1===r?u="i":2===r&&(u="i, j");var l="getIndices(".concat(u,")"),d="";1===a?d="i":2===a&&(d="i, coords[1]");var f="getUpdates(".concat(d,")"),p=n>1?"strides[j]":"strides";this.userCode="\n        ".concat(s," strides = ").concat(s,"(").concat(i,");\n\n        void main() {\n          ").concat(c," coords = getOutputCoords();\n          float sum = 0.0;\n          bool found = false;\n          for (int i = 0; i < ").concat(t,"; i++) {\n            int flattenedIndex = 0;\n            for (int j = 0; j < ").concat(n,"; j++) {\n              int index = round(").concat(l,");\n              flattenedIndex += index * ").concat(p,";\n            }\n            if (flattenedIndex == coords[0]) {\n              sum += ").concat(f,";\n              found = true;\n            }\n          }\n          setOutput(mix(getDefaultValue(), sum, float(found)));\n        }\n      ")};var zs={kernelName:o.uc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.indices,i=t.updates,s=r.shape,c=o.cd.calculateShapes(i,a,s),u=c.sliceRank,l=c.numUpdates,d=c.sliceSize,h=c.strides,f=c.outputSize,p=[f/d,d];if(0===f)return n.makeTensorInfo(s,a.dtype);var m=Fn({inputs:{x:a},backend:n,attrs:{shape:[l,u]}}),v=Fn({inputs:{x:i},backend:n,attrs:{shape:[l,d]}}),g=n.makeTensorInfo([],"float32",new Float32Array([0])),b=new Us(l,u,m.shape.length,v.shape.length,h,p),y=n.runWebGLProgram(b,[v,m,g],v.dtype),x=Fn({inputs:{x:y},backend:n,attrs:{shape:s}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(g),x}},Hs=function e(t,n,r){var a,i;if(Object(h.a)(this,e),this.variableNames=["c","a","b"],this.outputShape=n,r>4)throw Error("Where for rank ".concat(r," is not yet supported"));if(1===r)i="resRC",a="resRC";else{for(var o=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[],c=[],u=0;u<n.length;u++)c.push("".concat(o[u])),u<t&&s.push("".concat(o[u]));a=s.join(),i=c.join()}var l=Re(r);this.userCode="\n      void main() {\n        ".concat(l," resRC = getOutputCoords();\n        float cVal = getC(").concat(a,");\n        if (cVal >= 1.0) {\n          setOutput(getA(").concat(i,"));\n        } else {\n          setOutput(getB(").concat(i,"));\n        }\n      }\n    ")};var Vs={kernelName:o.vc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=t.condition,a=t.t,i=t.e,s=new Hs(r.shape.length,a.shape,a.shape.length);return n.runWebGLProgram(s,[r,a,i],Object(o.Kd)(a.dtype,i.dtype))}},Ws=Mn({opSnippet:"\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\n  // see: https://arxiv.org/abs/1706.02515\n  float scaleAlpha = ".concat(o.cd.SELU_SCALEALPHA,";\n  float scale = ").concat(o.cd.SELU_SCALE,";\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\n")}),Js={kernelName:o.wc,backendName:"webgl",kernelFunc:Ws},Xs=Mn({opSnippet:"return 1.0 / (1.0 + exp(-1.0 * x));"}),Ks={kernelName:o.xc,backendName:"webgl",kernelFunc:Xs},qs=Mn({opSnippet:"\n  if (isnan(x)) { return 0.0; }\n  return sign(x);\n"}),Ys={kernelName:o.yc,backendName:"webgl",kernelFunc:qs},Qs=Mn({opSnippet:"if (isnan(x)) return x;\n  return sin(x);\n"}),Zs={kernelName:o.zc,backendName:"webgl",kernelFunc:Qs},$s=Mn({opSnippet:"\n  float e2x = exp(x);\n  return (e2x - 1.0 / e2x) / 2.0;\n"}),ec={kernelName:o.Ac,backendName:"webgl",kernelFunc:$s},tc=Mn({opSnippet:"\n  float epsilon = 1.1920928955078125e-7;\n  float threshold = log(epsilon) + 2.0;\n\n  bool too_large = x > -threshold;\n  bool too_small = x < threshold;\n\n  float result;\n  float exp_x = exp(x);\n\n  if (too_large){\n    result = x;\n  }\n  else if (too_small){\n    result = exp_x;\n  }\n  else{\n    result = log(exp_x + 1.0);\n  }\n  return result;\n"}),nc={kernelName:o.Dc,backendName:"webgl",kernelFunc:tc},rc={kernelName:o.Ec,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.blockShape,s=r.paddings;o.Ld.assert(a.shape.length<=4,(function(){return"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet"}));var c=i.reduce((function(e,t){return e*t})),u=[[0,0]];u.push.apply(u,Object(l.a)(s));for(var d=1+i.length;d<a.shape.length;++d)u.push([0,0]);var h=[],f=ls({inputs:{x:a},backend:n,attrs:{paddings:u,constantValue:0}}),p=o.cd.getReshaped(f.shape,i,c,!1),m=o.cd.getPermuted(p.length,i.length,!1),v=o.cd.getReshapedPermuted(f.shape,i,c,!1),g=Fn({inputs:{x:f},backend:n,attrs:{shape:p}}),b=qn({inputs:{x:g},backend:n,attrs:{perm:m}}),y=Fn({inputs:{x:b},backend:n,attrs:{shape:v}});return h.push(f),h.push(g),h.push(b),h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),y}};var ac={kernelName:o.Fc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.sparseIndices,i=t.sparseValues,s=t.defaultValue,c=r.outputShape,u=o.cd.calculateShapes(i,a,c),l=u.sliceRank,d=u.numUpdates,h=u.strides,f=u.outputSize,p=new Us(d,l,a.shape.length,i.shape.length,h,[f,1],!1),m=n.runWebGLProgram(p,[i,a,s],i.dtype),v=Fn({inputs:{x:m},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(m),v}};var ic={kernelName:o.Gc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.numOrSizeSplits,s=r.axis,c=o.Ld.parseAxisParam(s,a.shape)[0],u=o.cd.prepareSplitSize(a,i,c),d=a.shape.length,h=new Array(d).fill(0),f=a.shape.slice();return u.map((function(e){var t=Object(l.a)(f);t[c]=e;var r=Wr({inputs:{x:a},backend:n,attrs:{begin:h,size:t}});return h[c]+=e,r}))}},oc=Mn({opSnippet:"return sqrt(x);"}),sc={kernelName:o.Hc,backendName:"webgl",kernelFunc:oc},cc=Mn({opSnippet:"return x * x;"}),uc={kernelName:o.Ic,backendName:"webgl",kernelFunc:cc},lc="return (a - b) * (a - b);",dc=kn({opSnippet:lc,packedOpSnippet:lc}),hc={kernelName:o.Jc,backendName:"webgl",kernelFunc:dc};var fc={kernelName:o.Kc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=t.x,i=en+"\n    return x > 0.0 ? 1.0 : float(".concat(n.alpha,");\n  "),o=new $t(a.shape,i);return r.runWebGLProgram(o,[a],a.dtype)}},pc=function e(t,n,r){Object(h.a)(this,e),this.variableNames=["x"],this.outputShape=r;var a=r.length,i=Re(r.length),o=Re(r.length),s="";if(1===a)s="coords * strides + begin";else{var c=0;s=r.map((function(e,t){return c++,1===r.length?"coords * strides[".concat(t,"] + begin[").concat(t,"]"):"coords[".concat(c-1,"] * strides[").concat(t,"] + begin[").concat(t,"]")})).join(",")}this.userCode="\n      ".concat(i," begin = ").concat(i,"(").concat(t,");\n      ").concat(i," strides = ").concat(i,"(").concat(n,");\n\n      void main() {\n        ").concat(o," coords = getOutputCoords();\n        setOutput(getX(").concat(s,"));\n      }\n    ")};var mc={kernelName:o.Lc,backendName:"webgl",kernelFunc:function(e){var t,n=e.inputs,r=e.backend,a=e.attrs,i=n.x,s=a.begin,c=a.end,u=a.strides,l=a.beginMask,d=a.endMask,h=a.ellipsisMask,f=a.newAxisMask,p=a.shrinkAxisMask,m=o.Ad.sliceInfo(i.shape,s,c,u,l,d,h,f,p),v=m.nonStrided,g=m.$begin,b=m.$strides,y=m.size,x=m.newShape,w=m.outShape,O=Fn({inputs:{x:i},backend:r,attrs:{shape:x}});if(v){var A=Wr({inputs:{x:O},backend:r,attrs:{begin:g,size:y}});t=Fn({inputs:{x:A},backend:r,attrs:{shape:w}}),r.disposeIntermediateTensorInfo(A)}else if(w.some((function(e){return 0===e})))t=r.makeTensorInfo(w,i.dtype,[]);else{if(r.shouldExecuteOnCPU([O])){var _=r.texData.get(O.dataId).values,E=Object(o.ed)(O.shape,O.dtype,_),S=Ft(w,E,b,g);t=r.makeTensorInfo(w,O.dtype,S.values)}else{var C=new pc(g,b,w);t=r.runWebGLProgram(C,[O],O.dtype)}}var T=Fn({inputs:{x:t},backend:r,attrs:{shape:w}});return r.disposeIntermediateTensorInfo(O),r.disposeIntermediateTensorInfo(t),T}},vc=Mn({opSnippet:"return tan(x);"}),gc={kernelName:o.Oc,backendName:"webgl",kernelFunc:vc},bc=Mn({opSnippet:"\n  float e2x = exp(-2.0 * abs(x));\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\n"}),yc={kernelName:o.Pc,backendName:"webgl",kernelFunc:bc},xc=function e(t,n){Object(h.a)(this,e),this.variableNames=["A"];for(var r=new Array(t.length),a=0;a<r.length;a++)r[a]=t[a]*n[a];this.outputShape=r,this.rank=r.length;var i=Re(this.rank),o=function(e){var t=e.length;if(t>5)throw Error("Tile for rank ".concat(t," is not yet supported"));if(1===t)return"imod(resRC, ".concat(e[0],")");for(var n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[],a=0;a<e.length;a++)r.push("imod(".concat(n[a],", ").concat(e[a],")"));return r.join()}(t);this.userCode="\n      void main() {\n        ".concat(i," resRC = getOutputCoords();\n        setOutput(getA(").concat(o,"));\n      }\n    ")};function wc(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.reps;if("string"===a.dtype){var s=n.readSync(a.dataId).map((function(e){return o.Ld.decodeString(e)})),c=Object(o.ed)(a.shape,a.dtype,s),u=Ut(c,i);return n.makeTensorInfo(u.shape,u.dtype,u.values)}var l=new xc(a.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}var Oc={kernelName:o.Sc,backendName:"webgl",kernelFunc:wc};var Ac={kernelName:o.Tc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=r.k,o=r.sorted,c=n.readSync(a.dataId),u=zt(c,a.shape,a.dtype,i,o),l=Object(s.a)(u,2),d=l[0],h=l[1];return[n.makeTensorInfo(d.shape,d.dtype,d.values),n.makeTensorInfo(h.shape,h.dtype,h.values)]}},_c=function e(t,n,r,a,i,o){Object(h.a)(this,e),this.variableNames=["Image","Transforms"],this.outputShape=o;var s,c="nearest"===r?1:2;switch(a){case"constant":s=1;break;case"reflect":s=2;break;case"wrap":s=3;break;case"nearest":s=4;break;default:s=1}this.userCode="\n            float mapCoord(float outCoord, float len) {\n              float inCoord = outCoord;\n              if(".concat(s," == 2) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    if (inCoord < sz2) {\n                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +\n                      inCoord;\n                    }\n                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz2 = 2.0 * len;\n                    inCoord -= sz2 * float(int(float(inCoord / sz2)));\n                    if (inCoord >= len) {\n                      inCoord = sz2 - inCoord - 1.0;\n                    }\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 3) {\n                if (inCoord < 0.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);\n                  }\n                } else if (inCoord > len - 1.0) {\n                  if (len <= 1.0) {\n                    inCoord = 0.0;\n                  } else {\n                    float sz = len - 1.0;\n                    inCoord -= len * float(int(float(inCoord / sz)));\n                  }\n                }\n                return clamp(inCoord, 0.0, len - 1.0);\n              } else if (").concat(s," == 4) {\n                return clamp(outCoord, 0.0, len - 1.0);\n              } else {\n                return outCoord;\n              }\n            }\n\n            float readWithFillValue(int batch, int coordY, int coordX,\n              int channel) {\n              float outputValue;\n              if (0 <= coordY && coordY < ").concat(t," && 0 <= coordX && coordX < ").concat(n,") {\n                  outputValue = getImage(batch, coordY, coordX, channel);\n              } else {\n                outputValue = float(").concat(i,");\n              }\n              return outputValue;\n            }\n\n            void main() {\n              ivec4 coords = getOutputCoords();\n              float outputValue;\n              int batch = coords[0];\n              int x = coords[2];\n              int y = coords[1];\n              int channel = coords[3];\n              float xf = float(x);\n              float yf = float(y);\n              float a1 = getTransforms(batch, 0);\n              float a2 = getTransforms(batch, 1);\n              float a3 = getTransforms(batch, 2);\n              float b1 = getTransforms(batch, 3);\n              float b2 = getTransforms(batch, 4);\n              float b3 = getTransforms(batch, 5);\n              float c1 = getTransforms(batch, 6);\n              float c2 = getTransforms(batch, 7);\n              float projection = c1 * xf + c2 * yf + 1.0;\n              if (projection == 0.0) {\n                outputValue = float(").concat(i,");\n              } else {\n                float inX = (a1 * xf + a2 * yf + a3) / projection;\n                float inY = (b1 * xf + b2 * yf + b3) / projection;\n                float mapX = mapCoord(inX, float(").concat(n,"));\n                float mapY = mapCoord(inY, float(").concat(t,"));\n\n                if (").concat(c," == 1) {\n                  int coordY = int(round(mapY));\n                  int coordX = int(round(mapX));\n                  outputValue = readWithFillValue(batch, coordY, coordX,\n                    channel);\n                } else {\n                  float yFloor = floor(mapY);\n                  float xFloor = floor(mapX);\n                  float yCeil = yFloor + 1.0;\n                  float xCeil = xFloor + 1.0;\n                  float valueYFloor = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);\n                  float valueYCeil = (xCeil - mapX) *\n                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +\n                  (mapX - xFloor) *\n                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);\n                  outputValue = (yCeil - mapY) * valueYFloor +\n                  (mapY - yFloor) * valueYCeil;\n                }\n              }\n              setOutput(outputValue);\n            }\n        ")};var Ec={kernelName:o.Uc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.image,i=t.transforms,o=r.interpolation,c=r.fillMode,u=r.fillValue,l=r.outputShape,d=Object(s.a)(a.shape,4),h=d[0],f=d[1],p=d[2],m=d[3],v=null!=l?l:[f,p],g=Object(s.a)(v,2),b=g[0],y=g[1],x=new _c(f,p,o,c,u,[h,b,y,m]);return n.runWebGLProgram(x,[a,i],"float32")}};var Sc={kernelName:o.Wc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.attrs,r=e.backend,a=n.axis,i=t.x;Y(i,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");var o=r.readSync(i.dataId),s=Vt(o,a,i.shape,i.dtype),c=s.outputValues,u=s.outputShape,l=s.indices;return[r.makeTensorInfo(u,i.dtype,c),r.makeTensorInfo([l.length],"int32",l)]}};var Cc={kernelName:o.Xc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.value,i=r.axis;i<0&&(i+=a.shape.length);for(var o=a,s=o.shape.length,c=a.shape[i],u=new Array(s-1),l=0,d=0;d<s;d++)d!==i&&(u[l++]=o.shape[d]);var h=[],f=new Array(s).fill(0),p=o.shape.slice();p[i]=1;for(var m=new Array(c),v=0;v<m.length;v++){f[i]=v;var g=Wr({inputs:{x:o},backend:n,attrs:{begin:f,size:p}}),b=Fn({inputs:{x:g},backend:n,attrs:{shape:u}});m[v]=b,h.push(g)}return h.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),m}},Tc=function e(t,n){Object(h.a)(this,e),this.variableNames=["x","segmentIds"];var r=t.windowSize,a=t.batchSize,i=t.inSize,o=t.numSegments,s=o*Math.ceil(i/r);this.outputShape=[a,s];var c=4*Math.floor(r/4),u=r%4,l="\n        sumValue += dot(values, segFilter);\n    ",d="";i%r>0&&(d="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return initializationValue;\n        }\n      "));var f="";i%r>0&&(f="\n        if (inIdx < 0 || inIdx >= ".concat(i,") {\n          return -1.0;\n        }\n      ")),this.userCode="\n      const float initializationValue = ".concat("0.0",";\n\n      float getValue(int batch, int inIdx) {\n        ").concat(d,"\n        return getX(batch, inIdx);\n      }\n\n      float getSegmentIdAtIndex(int inIdx) {\n        ").concat(f,"\n        return getSegmentIds(inIdx);\n      }\n\n      void main() {\n        ivec2 coords = getOutputCoords();\n        int batch = coords[0];\n        int outIdx = coords[1];\n        int inOffset = int(floor(float(outIdx) / float(\n          ").concat(o,")) * float(").concat(r,"));\n        int currentSeg = int(mod(float(outIdx), float(").concat(o,")));\n\n        float sumValue = 0.0;\n\n        for (int i = 0; i < ").concat(c,"; i += 4) {\n          int inIdx = inOffset + i;\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            getValue(batch, inIdx + 3)\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0\n          );\n\n          ").concat(l,"\n        }\n\n        int inIdx = inOffset + ").concat(c,";\n        if (").concat(1===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            initializationValue,\n            initializationValue,\n            initializationValue\n          );\n\n          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            0,\n            0,\n            0\n          );\n\n          ").concat(l,"\n        } else if (").concat(2===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            initializationValue,\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n              0,\n              0\n          );\n\n          ").concat(l,"\n        } else if (").concat(3===u,") {\n          vec4 values = vec4(\n            getValue(batch, inIdx),\n            getValue(batch, inIdx + 1),\n            getValue(batch, inIdx + 2),\n            initializationValue\n          );\n\n          vec4 segFilter = vec4(\n            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,\n            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,\n            0\n          );\n\n          ").concat(l,"\n        }\n        setOutput(").concat("sumValue",");\n      }\n    ")};for(var Mc=0,kc=[vo,bo,Zn,er,nr,ar,sr,lr,dr,hr,br,yr,wr,Ar,Cr,Er,Mr,jr,Ir,Nr,Dr,Pr,Ur,Xr,Kr,$r,na,ia,ca,On,ga,Ta,Ma,Aa,Ra,Ia,ka,Ba,Na,Pa,za,Ha,Wa,Qa,Za,Ka,ei,ni,ai,ii,si,ui,hi,pi,gi,xi,_i,Si,Mi,Ri,Bi,Li,Ni,Pi,Gi,zi,Vi,xn,Wi,fa,Xi,qi,Qi,En,$i,to,no,oo,ao,co,lo,fo,xo,_o,Ao,Co,To,Mo,Oo,ko,Ro,jo,No,Po,Xo,Pn,qo,Qo,$o,ts,Yr,rs,os,ss,ds,fs,Tn,ps,vs,Zr,Uo,bs,Os,xs,Gn,Es,Cs,Ms,Rs,Bs,Ns,Ps,Gs,zs,Vs,Js,Ks,Ys,Zs,ec,Jr,Jo,nc,rc,ac,ic,sc,uc,hc,fc,mc,Vo,Kn,gc,yc,Oc,Ac,Ec,Yn,Sc,Cc,{kernelName:o.Yc,backendName:"webgl",kernelFunc:function(e){var t=e.inputs,n=e.backend,r=e.attrs,a=t.x,i=t.segmentIds,s=r.numSegments,c=a.shape.length,u=[],l=0,d=o.cd.getAxesPermutation([l],c),h=a;null!=d&&(h=qn({inputs:{x:a},backend:n,attrs:{perm:d}}),u.push(h),l=o.cd.getInnerMostAxes(1,c)[0]);var f=o.cd.segment_util.computeOutShape(h.shape,l,s),p=o.Ld.sizeFromShape([h.shape[l]]),m=Fn({inputs:{x:h},backend:n,attrs:{shape:[-1,p]}});u.push(m);var v=Fn({inputs:{x:function e(t,r,a,i,s){var c=t.shape[0],l=t.shape[1],d=o.cd.segment_util.segOpComputeOptimalWindowSize(l,s),h=new Tc({windowSize:d,inSize:l,batchSize:c,numSegments:s},r),f=n.compileAndRun(h,[t,a],i);if(u.push(f),f.shape[1]===s)return f;var p=ms({backend:n,attrs:{start:0,stop:s,step:1,dtype:"float32"}}),m=wc({inputs:{x:p},backend:n,attrs:{reps:[l/d]}});return u.push(p),u.push(m),e(f,r,m,i,s)}(m,"unsortedSegmentSum",i,Object(o.Ed)(a.dtype),s)},backend:n,attrs:{shape:f}}),g=v;if(null!=d){u.push(v);var b=o.cd.getUndoAxesPermutation(d);g=qn({inputs:{x:g},backend:n,attrs:{perm:b}})}return u.forEach((function(e){return n.disposeIntermediateTensorInfo(e)})),g}},is];Mc<kc.length;Mc++){var Rc=kc[Mc];Object(o.vd)(Rc)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return ar})),n.d(t,"b",(function(){return or}));var r=n(142),a=n(13),i=n.n(a),o=n(20),s=n(147),c=n(149),u=n(269),l=n(12),d=n(65),h=n(152),f=function(){function e(t,n,r){var a=this;Object(s.a)(this,e),this.node=t,this.tensorMap=n,this.context=r,this.inputs=[],this.attrs={},this.inputs=t.inputNames.map((function(e){return a.getInput(e)})),null!=t.rawAttrs&&(this.attrs=Object.keys(t.rawAttrs).reduce((function(e,t){return e[t]=a.getAttr(t),e}),{}))}return Object(c.a)(e,[{key:"getInput",value:function(e){return Object(h.e)(e,this.tensorMap,this.context)}},{key:"getAttr",value:function(e,t){var n=this.node.rawAttrs[e];if(null!=n.tensor)return Object(h.e)(e,this.tensorMap,this.context);if(null!=n.i||null!=n.f)return Object(u.f)(this.node.rawAttrs,e,t);if(null!=n.s)return Object(u.i)(this.node.rawAttrs,e,t);if(null!=n.b)return Object(u.c)(this.node.rawAttrs,e,t);if(null!=n.shape)return Object(u.k)(this.node.rawAttrs,e,t);if(null!=n.type)return Object(u.e)(this.node.rawAttrs,e,t);if(null!=n.list){if(null!=n.list.i||null!=n.list.f)return Object(u.g)(this.node.rawAttrs,e,t);if(null!=n.list.s)return Object(u.h)(this.node.rawAttrs,e,t);if(null!=n.list.shape)return Object(u.j)(this.node.rawAttrs,e,t);if(null!=n.list.b)return Object(u.b)(this.node.rawAttrs,e,t);if(null!=n.list.type)return Object(u.d)(this.node.rawAttrs,e,t)}return t}}]),e}(),p=n(200),m=n(166),v=n(270),g=n(271),b=n(156),y=n(176),x=n(272),w=n(225),O=n(158),A=n(247),_=n(273),E=n(239),S=n(248),C=n(186),T=n(274),M=n(275),k=n(276),R=n(277),I=n(278),j=n(279),B=n(280),L=n(281),N=n(174),D=n(282),P=n(283),F=n(251),G=n(284),U=n(188),z=n(285),H=n(286),V=n(198),W=n(249),J=n(211),X=n(187),K=n(287),q=n(210),Y=n(197),Q=n(288),Z=n(289),$=n(267),ee=n(290),te=n(291),ne=n(292),re=n(293),ae=n(238),ie=n(213),oe=n(294),se=n(295),ce=n(296),ue=n(252),le=n(297),de=n(298),he=n(254),fe=n(253);function pe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";if("number"!==typeof e&&"number"!==typeof t){r.Ld.assert(e.length===t.length,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}));for(var a=0;a<e.length;a++){var i=e[a],o=t[a];r.Ld.assert(i<0||o<0||i===o,(function(){return n+" Shapes ".concat(e," and ").concat(t," must match")}))}}}function me(e){return"number"!==typeof e&&!e.some((function(e){return e<0}))}function ve(e,t,n){var r=ge(e,n),a=!me(r);if(a&&0===t.length)throw new Error("Tried to calculate elements of an empty list"+" with non-fully-defined elementShape: ".concat(r));if(a&&t.forEach((function(e){r=ge(e.shape,r)})),!me(r))throw new Error("Non-fully-defined elementShape: ".concat(r));return r}function ge(e,t){if("number"===typeof e)return t;if("number"===typeof t)return e;if(e.length!==t.length)throw new Error("Incompatible ranks during merge: ".concat(e," vs. ").concat(t));for(var n=[],r=0;r<e.length;++r){var a=e[r],i=t[r];if(a>=0&&i>=0&&a!==i)throw new Error("Incompatible shape during merge: ".concat(e," vs. ").concat(t));n[r]=a>=0?a:i}return n}var be=function(){function e(t,n,a,i,o,c,u){Object(s.a)(this,e),this.name=t,this.dtype=n,this.maxSize=a,this.elementShape=i,this.identicalElementShapes=o,this.dynamicSize=c,this.clearAfterRead=u,this.tensors=[],this.closed_=!1,this.idTensor=Object(r.xd)(0),Object(r.rd)(this.idTensor)}return Object(c.a)(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"closed",get:function(){return this.closed_}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.tensor.id)||t.tensor.dispose()})),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"read",value:function(e){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||e>=this.size())throw new Error("Tried to read from index ".concat(e,", but array size is: ").concat(this.size()));var t=this.tensors[e];if(t.cleared)throw new Error("TensorArray ".concat(this.name,": Could not read index ").concat(e," twice because it was cleared after a previous read ")+"(perhaps try setting clear_after_read = false?).");return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}},{key:"readMany",value:function(e){var t=this;return e.map((function(e){return t.read(e)}))}},{key:"write",value:function(e,t){if(this.closed_)throw new Error("TensorArray ".concat(this.name," has already been closed."));if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error("Tried to write to index ".concat(e,", but array is not resizeable and size is: ").concat(this.maxSize));var n=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,",\n          because the value dtype is ").concat(t.dtype,", but TensorArray dtype is ").concat(this.dtype,"."));if(0!==this.size()||null!=this.elementShape&&0!==this.elementShape.length||(this.elementShape=t.shape),pe(this.elementShape,t.shape,"TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,".")),n.read)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been read."));if(n.written)throw new Error("TensorArray ".concat(this.name,": Could not write to TensorArray index ").concat(e,", because it has already been written."));n.tensor=t,Object(r.rd)(t),n.written=!0,this.tensors[e]=n}},{key:"writeMany",value:function(e,t){var n=this;if(e.length!==t.length)throw new Error("TensorArray ".concat(this.name,": could not write multiple tensors,")+"because the index size: ".concat(e.length," is not the same as tensors size: ").concat(t.length,"."));e.forEach((function(e,r){return n.write(e,t[r])}))}},{key:"gather",value:function(e,t){if(t&&t!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but gather requested dtype ").concat(t));if(e)e=e.slice(0,this.size());else{e=[];for(var n=0;n<this.size();n++)e.push(n)}if(0===e.length)return Object(r.Fd)([],[0].concat(this.elementShape));var a=this.readMany(e);return pe(this.elementShape,a[0].shape,"TensorArray shape mismatch: "),Object(r.Cd)(a,0)}},{key:"concat",value:function(e){if(e&&e!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but concat requested dtype ").concat(e));if(0===this.size())return Object(r.Fd)([],[0].concat(this.elementShape));for(var t=[],n=0;n<this.size();n++)t.push(n);var a=this.readMany(t);return pe(this.elementShape,a[0].shape,"TensorArray shape mismatch: tensor array shape (".concat(this.elementShape,") vs first tensor shape (").concat(a[0].shape,")")),Object(r.hd)(a,0)}},{key:"scatter",value:function(e,t){if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));if(e.length!==t.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(e.length," vs. ").concat(t.shape[0]));var n=Math.max.apply(Math,Object(d.a)(e));if(!this.dynamicSize&&n>=this.maxSize)throw new Error("Max index must be < array size (".concat(n,"  vs. ").concat(this.maxSize,")"));this.writeMany(e,Object(r.Jd)(t,0))}},{key:"split",value:function(e,t){var n=this;if(t.dtype!==this.dtype)throw new Error("TensorArray dtype is ".concat(this.dtype," but tensor has dtype ").concat(t.dtype));var a=0,i=e.map((function(e){return a+=e}));if(a!==t.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(a,", and tensor's shape is: ").concat(t.shape));if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error("TensorArray's size is not equal to the size of lengths (".concat(this.maxSize," vs. ").concat(e.length,"), ")+"and the TensorArray is not marked as dynamically resizeable");var o=0===a?0:t.size/a,s=[];Object(r.Id)((function(){t=Object(r.wd)(t,[1,a,o]);for(var c=0;c<e.length;++c){var u=[0,0===c?0:i[c-1],0],l=[1,e[c],o];s[c]=Object(r.wd)(Object(r.zd)(t,u,l),n.elementShape)}return s}));for(var c=[],u=0;u<e.length;u++)c[u]=u;this.writeMany(c,s)}}]),e}(),ye=function(){function e(t,n,a){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;Object(s.a)(this,e),this.tensors=t,this.elementShape=n,this.elementDtype=a,null!=t&&t.forEach((function(e){if(a!==e.dtype)throw new Error("Invalid data types; op elements ".concat(a,", but list elements ").concat(e.dtype));pe(n,e.shape,"TensorList shape mismatch: "),Object(r.rd)(e)})),this.idTensor=Object(r.xd)(0),this.maxNumElements=i,Object(r.rd)(this.idTensor)}return Object(c.a)(e,[{key:"id",get:function(){return this.idTensor.id}},{key:"copy",value:function(){return new e(Object(d.a)(this.tensors),this.elementShape,this.elementDtype)}},{key:"clearAndClose",value:function(e){this.tensors.forEach((function(t){null!=e&&e.has(t.id)||t.dispose()})),this.tensors.length=0,this.idTensor.dispose()}},{key:"size",value:function(){return this.tensors.length}},{key:"stack",value:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(-1!==a&&this.tensors.length!==a)throw new Error("Operation expected a list with ".concat(a," elements but got a list with ").concat(this.tensors.length," elements."));pe(e,this.elementShape,"TensorList shape mismatch: ");var i=ve(this.elementShape,this.tensors,e);return Object(r.Id)((function(){var e=n.tensors.map((function(e){return Object(r.wd)(e,i)}));return Object(r.Cd)(e,0)}))}},{key:"popBack",value:function(e,t){if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));if(0===this.size())throw new Error("Trying to pop from an empty list.");var n=ve(this.elementShape,this.tensors,e),a=this.tensors.pop();return pe(a.shape,e,"TensorList shape mismatch: "),Object(r.wd)(a,n)}},{key:"pushBack",value:function(e){if(e.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(this.elementDtype));if(pe(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Object(r.rd)(e),this.tensors.push(e)}},{key:"resize",value:function(e){if(e<0)throw new Error("TensorListResize expects size to be non-negative. Got: ".concat(e));if(-1!==this.maxNumElements&&e>this.maxNumElements)throw new Error("TensorListResize input size ".concat(e," is greater maxNumElement ").concat(this.maxNumElements,"."));this.tensors.length=e}},{key:"getItem",value:function(e,t,n){if(n!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(n,", but list elements ").concat(this.elementDtype));if(e<0||e>this.tensors.length)throw new Error("Trying to access element ".concat(e," in a list with ").concat(this.tensors.length," elements."));if(null==this.tensors[e])throw new Error("element at index ".concat(e," is null."));pe(this.tensors[e].shape,t,"TensorList shape mismatch: ");var a=ve(this.elementShape,this.tensors,t);return Object(r.wd)(this.tensors[e],a)}},{key:"setItem",value:function(e,t){if(t.dtype!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t.dtype,", but list elements ").concat(this.elementDtype));if(e<0||-1!==this.maxNumElements&&e>=this.maxNumElements)throw new Error("Trying to set element ".concat(e," in a list with max ").concat(this.maxNumElements," elements."));pe(this.elementShape,t.shape,"TensorList shape mismatch: "),Object(r.rd)(t),this.tensors[e]=t}},{key:"gather",value:function(e,t,n){var a=this;if(t!==this.elementDtype)throw new Error("Invalid data types; op elements ".concat(t,", but list elements ").concat(this.elementDtype));pe(this.elementShape,n,"TensorList shape mismatch: "),e=e.slice(0,this.size());var i=ve(this.elementShape,this.tensors,n);return 0===e.length?Object(r.Fd)([],[0].concat(i)):Object(r.Id)((function(){var t=e.map((function(e){return Object(r.wd)(a.tensors[e],i)}));return Object(r.Cd)(t,0)}))}},{key:"concat",value:function(e,t){var n=this;if(e&&e!==this.elementDtype)throw new Error("TensorList dtype is ".concat(this.elementDtype," but concat requested dtype ").concat(e));pe(this.elementShape,t,"TensorList shape mismatch: ");var a=ve(this.elementShape,this.tensors,t);return 0===this.size()?Object(r.Fd)([],[0].concat(a)):Object(r.Id)((function(){var e=n.tensors.map((function(e){return Object(r.wd)(e,a)}));return Object(r.hd)(e,0)}))}}]),e}();function xe(e,t,n){var a=e.dtype;if(e.shape.length<1)throw new Error("Tensor must be at least a vector, but saw shape: ".concat(e.shape));if(e.dtype!==n)throw new Error("Invalid data types; op elements ".concat(e.dtype,", but list elements ").concat(n));pe(e.shape.slice(1),t,"TensorList shape mismatch: ");var i=Object(r.Jd)(e);return new ye(i,t,a)}function we(e,t,n){return new ye([],e,t,n)}function Oe(e,t,n,a){if(t.length!==e.shape[0])throw new Error("Expected len(indices) == tensor.shape[0], but saw: ".concat(t.length," vs. ").concat(e.shape[0]));var i=Math.max.apply(Math,Object(d.a)(t));if(null!=a&&-1!==a&&i>=a)throw new Error("Max index must be < array size (".concat(i,"  vs. ").concat(a,")"));var o=new ye([],n,e.dtype,a),s=Object(r.Jd)(e,0);return t.forEach((function(e,t){o.setItem(e,s[t])})),o}function Ae(e,t,n){var a=0,i=t.map((function(e){return a+=e}));if(a!==e.shape[0])throw new Error("Expected sum of lengths to be equal to\n          tensor.shape[0], but sum of lengths is\n        ".concat(a,", and tensor's shape is: ").concat(e.shape));for(var o=ge(e.shape.slice(1),n),s=0===a?0:e.size/a,c=Object(r.Id)((function(){var n=[];e=Object(r.wd)(e,[1,a,s]);for(var c=0;c<t.length;++c){var u=[0,0===c?0:i[c-1],0],l=[1,t[c],s];n[c]=Object(r.wd)(Object(r.zd)(e,u,l),o)}return e.dispose(),n})),u=new ye([],n,e.dtype,t.length),l=0;l<c.length;l++)u.setItem(l,c[l]);return u}var _e=function(){var e=Object(o.a)(i.a.mark((function e(t,n,a){var o,s,c,u,l,d,f,p,m,v,g,b,y,x,w,O,A,_,E,S,C,T,M,k,R,I,j,B,L,N,D,P,F,G,U,z,H,V,W,J,X,K,q,Y,Q,Z,$,ee,te,ne,re,ae,ie,oe,se,ce,ue,le,de,he,fe,pe,me,ve,ge,ye,_e,Ee,Se,Ce,Te,Me,ke,Re,Ie,je,Be,Le,Ne,De,Pe,Fe,Ge,Ue,ze,He,Ve,We,Je,Xe,Ke,qe,Ye,Qe,Ze,$e;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="If"===e.t0||"StatelessIf"===e.t0?3:"While"===e.t0||"StatelessWhile"===e.t0?15:"LoopCond"===e.t0?19:"Switch"===e.t0?21:"Merge"===e.t0?32:"Enter"===e.t0?37:"Exit"===e.t0?41:"NextIteration"===e.t0?44:"TensorArrayV3"===e.t0?47:"TensorArrayWriteV3"===e.t0?57:"TensorArrayReadV3"===e.t0?63:"TensorArrayGatherV3"===e.t0?67:"TensorArrayScatterV3"===e.t0?72:"TensorArrayConcatV3"===e.t0?78:"TensorArraySplitV3"===e.t0?82:"TensorArraySizeV3"===e.t0?88:"TensorArrayCloseV3"===e.t0?91:"TensorListSetItem"===e.t0?95:"TensorListGetItem"===e.t0?101:"TensorListScatterV2"===e.t0||"TensorListScatter"===e.t0?107:"TensorListReserve"===e.t0||"EmptyTensorList"===e.t0?114:"TensorListGather"===e.t0?121:"TensorListStack"===e.t0?127:"TensorListFromTensor"===e.t0?133:"TensorListConcat"===e.t0?139:"TensorListPushBack"===e.t0?144:"TensorListPopBack"===e.t0?149:"TensorListSplit"===e.t0?154:160;break;case 3:return o=Object(h.d)("thenBranch",t,n,a),s=Object(h.d)("elseBranch",t,n,a),c=Object(h.d)("cond",t,n,a),u=Object(h.d)("args",t,n,a),e.next=9,c.data();case 9:if(!e.sent[0]){e.next=14;break}return e.abrupt("return",a.functionMap[o].executeFunctionAsync(u,a.tensorArrayMap,a.tensorListMap));case 14:return e.abrupt("return",a.functionMap[s].executeFunctionAsync(u,a.tensorArrayMap,a.tensorListMap));case 15:return e.delegateYield(i.a.mark((function e(){var r,o,s,c,u,l,d,f;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=Object(h.d)("body",t,n,a),o=Object(h.d)("cond",t,n,a),s=Object(h.d)("args",t,n,a),e.next=5,a.functionMap[o].executeFunctionAsync(s,a.tensorArrayMap,a.tensorListMap);case 5:return c=e.sent,u=s.map((function(e){return e.id})),e.next=9,c[0].data();case 9:l=e.sent,c.forEach((function(e){e.kept||-1!==u.indexOf(e.id)||e.dispose()})),d=s,f=i.a.mark((function e(){var t,n,s;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=d,e.next=3,a.functionMap[r].executeFunctionAsync(d,a.tensorArrayMap,a.tensorListMap);case 3:return d=e.sent,n=d.map((function(e){return e.id})),t.forEach((function(e){e.kept||-1!==u.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()})),e.next=8,a.functionMap[o].executeFunctionAsync(d,a.tensorArrayMap,a.tensorListMap);case 8:return s=e.sent,e.next=11,s[0].data();case 11:l=e.sent,s.forEach((function(e){e.kept||-1!==u.indexOf(e.id)||-1!==n.indexOf(e.id)||e.dispose()}));case 13:case"end":return e.stop()}}),e)}));case 13:if(!l[0]){e.next=17;break}return e.delegateYield(f(),"t0",15);case 15:e.next=13;break;case 17:return e.abrupt("return",{v:d});case 18:case"end":return e.stop()}}),e)}))(),"t1",16);case 16:if("object"!==typeof(l=e.t1)){e.next=19;break}return e.abrupt("return",l.v);case 19:return d=Object(h.d)("pred",t,n,a),e.abrupt("return",[Object(h.a)(d)]);case 21:return f=Object(h.d)("pred",t,n,a),(p=Object(h.d)("data",t,n,a)).kept||(p=Object(h.a)(p)),e.next=26,f.data();case 26:if(!e.sent[0]){e.next=30;break}e.t2=[void 0,p],e.next=31;break;case 30:e.t2=[p,void 0];case 31:return e.abrupt("return",e.t2);case 32:if(!(m=t.inputNames.find((function(e){return void 0!==Object(h.e)(e,n,a)})))){e.next=36;break}return v=Object(h.e)(m,n,a),e.abrupt("return",[Object(h.a)(v)]);case 36:return e.abrupt("return",void 0);case 37:return g=Object(h.d)("frameName",t,n,a),b=Object(h.d)("tensor",t,n,a),a.enterFrame(g),e.abrupt("return",[Object(h.a)(b)]);case 41:return y=Object(h.d)("tensor",t,n,a),a.exitFrame(),e.abrupt("return",[Object(h.a)(y)]);case 44:return x=Object(h.d)("tensor",t,n,a),a.nextIteration(),e.abrupt("return",[Object(h.a)(x)]);case 47:return w=Object(h.d)("size",t,n,a),O=Object(h.d)("dtype",t,n,a),A=Object(h.d)("elementShape",t,n,a),_=Object(h.d)("dynamicSize",t,n,a),E=Object(h.d)("clearAfterRead",t,n,a),S=Object(h.d)("identicalElementShapes",t,n,a),C=Object(h.d)("name",t,n,a),T=new be(C,O,w,A,S,_,E),a.addTensorArray(T),e.abrupt("return",[T.idTensor,Object(r.xd)(1)]);case 57:return M=Object(h.d)("tensorArrayId",t,n,a),k=Object(h.d)("index",t,n,a),R=Object(h.d)("tensor",t,n,a),(I=a.getTensorArray(M.id)).write(k,R),e.abrupt("return",[I.idTensor]);case 63:return j=Object(h.d)("tensorArrayId",t,n,a),B=Object(h.d)("index",t,n,a),L=a.getTensorArray(j.id),e.abrupt("return",[L.read(B)]);case 67:return N=Object(h.d)("tensorArrayId",t,n,a),D=Object(h.d)("indices",t,n,a),P=Object(h.d)("dtype",t,n,a),F=a.getTensorArray(N.id),e.abrupt("return",[F.gather(D,P)]);case 72:return G=Object(h.d)("tensorArrayId",t,n,a),U=Object(h.d)("indices",t,n,a),z=Object(h.d)("tensor",t,n,a),(H=a.getTensorArray(G.id)).scatter(U,z),e.abrupt("return",[H.idTensor]);case 78:return V=Object(h.d)("tensorArrayId",t,n,a),W=a.getTensorArray(V.id),J=Object(h.d)("dtype",t,n,a),e.abrupt("return",[W.concat(J)]);case 82:return X=Object(h.d)("tensorArrayId",t,n,a),K=Object(h.d)("tensor",t,n,a),q=Object(h.d)("lengths",t,n,a),(Y=a.getTensorArray(X.id)).split(q,K),e.abrupt("return",[Y.idTensor]);case 88:return Q=Object(h.d)("tensorArrayId",t,n,a),Z=a.getTensorArray(Q.id),e.abrupt("return",[Object(r.xd)(Z.size(),"int32")]);case 91:return $=Object(h.d)("tensorArrayId",t,n,a),(ee=a.getTensorArray($.id)).clearAndClose(),e.abrupt("return",[ee.idTensor]);case 95:return te=Object(h.d)("tensorListId",t,n,a),ne=Object(h.d)("index",t,n,a),re=Object(h.d)("tensor",t,n,a),(ae=a.getTensorList(te.id)).setItem(ne,re),e.abrupt("return",[ae.idTensor]);case 101:return ie=Object(h.d)("tensorListId",t,n,a),oe=Object(h.d)("index",t,n,a),se=Object(h.d)("elementShape",t,n,a),ce=Object(h.d)("elementDType",t,n,a),ue=a.getTensorList(ie.id),e.abrupt("return",[ue.getItem(oe,se,ce)]);case 107:return le=Object(h.d)("indices",t,n,a),de=Object(h.d)("tensor",t,n,a),he=Object(h.d)("elementShape",t,n,a),fe=Object(h.d)("numElements",t,n,a),pe=Oe(de,le,he,fe),a.addTensorList(pe),e.abrupt("return",[pe.idTensor]);case 114:return me=Object(h.d)("elementShape",t,n,a),ve=Object(h.d)("elementDType",t,n,a),ge="TensorListReserve"===t.op?"numElements":"maxNumElements",ye=Object(h.d)(ge,t,n,a),_e=we(me,ve,ye),a.addTensorList(_e),e.abrupt("return",[_e.idTensor]);case 121:return Ee=Object(h.d)("tensorListId",t,n,a),Se=Object(h.d)("indices",t,n,a),Ce=Object(h.d)("elementShape",t,n,a),Te=Object(h.d)("elementDType",t,n,a),Me=a.getTensorList(Ee.id),e.abrupt("return",[Me.gather(Se,Te,Ce)]);case 127:return ke=Object(h.d)("tensorListId",t,n,a),Re=Object(h.d)("elementShape",t,n,a),Ie=Object(h.d)("elementDType",t,n,a),je=Object(h.d)("numElements",t,n,a),Be=a.getTensorList(ke.id),e.abrupt("return",[Be.stack(Re,Ie,je)]);case 133:return Le=Object(h.d)("tensor",t,n,a),Ne=Object(h.d)("elementShape",t,n,a),De=Object(h.d)("elementDType",t,n,a),Pe=xe(Le,Ne,De),a.addTensorList(Pe),e.abrupt("return",[Pe.idTensor]);case 139:return Fe=Object(h.d)("tensorListId",t,n,a),Ge=a.getTensorList(Fe.id),Ue=Object(h.d)("dtype",t,n,a),ze=Object(h.d)("elementShape",t,n,a),e.abrupt("return",[Ge.concat(Ue,ze)]);case 144:return He=Object(h.d)("tensorListId",t,n,a),Ve=Object(h.d)("tensor",t,n,a),(We=a.getTensorList(He.id)).pushBack(Ve),e.abrupt("return",[We.idTensor]);case 149:return Je=Object(h.d)("tensorListId",t,n,a),Xe=Object(h.d)("elementShape",t,n,a),Ke=Object(h.d)("elementDType",t,n,a),qe=a.getTensorList(Je.id),e.abrupt("return",[qe.popBack(Xe,Ke)]);case 154:return Ye=Object(h.d)("tensor",t,n,a),Qe=Object(h.d)("elementShape",t,n,a),Ze=Object(h.d)("lengths",t,n,a),$e=Ae(Ye,Ze,Qe),a.addTensorList($e),e.abrupt("return",[$e.idTensor]);case 160:throw TypeError("Node type ".concat(t.op," is not implemented"));case 161:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),Ee=n(299),Se=n(215),Ce=n(346),Te=n(300),Me=n(255),ke=n(301),Re=n(302),Ie=n(303),je=n(304),Be=n(305),Le=n(306),Ne=n(307);function De(e,t,n){var r=Object(h.d)("fusedOps",e,t,n),a=Object(l.a)(r,2),i=a[0],o=a[1],s="biasadd"===i,c="prelu"===o,u="fusedbatchnorm"===i,d=Object(h.d)("numArgs",e,t,n);if(s){if(c&&2!==d)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&1!==d)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported.");var f=Object(h.d)("strides",e,t,n),p=Object(h.c)(e,t,n),m=Object(h.d)("dataFormat",e,t,n).toUpperCase(),v=Object(h.d)("dilations",e,t,n),g=Object(h.d)("args",e,t,n),b=Object(l.a)(g,2);return{stride:f,pad:p,dataFormat:m,dilations:v,biasArg:b[0],preluArg:b[1],activationFunc:o,leakyreluAlpha:Object(h.d)("leakyreluAlpha",e,t,n)}}var Pe=n(230),Fe=n(308),Ge=n(309),Ue=n(310),ze=n(245),He=n(311),Ve=n(312),We=n(232),Je=n(314),Xe=n(193),Ke=n(209),qe=n(157),Ye=n(315),Qe=n(316);function Ze(e,t,n){return{boxes:Object(h.d)("boxes",e,t,n),scores:Object(h.d)("scores",e,t,n),maxOutputSize:Object(h.d)("maxOutputSize",e,t,n),iouThreshold:Object(h.d)("iouThreshold",e,t,n),scoreThreshold:Object(h.d)("scoreThreshold",e,t,n),softNmsSigma:Object(h.d)("softNmsSigma",e,t,n)}}var $e=function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,o,s,c,u,l,d,f,p,m,v,g,b,y,x,w,O,A,_,E,S,C,T,M;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="NonMaxSuppressionV5"===e.t0?3:"NonMaxSuppressionV4"===e.t0?8:"NonMaxSuppressionV3"===e.t0||"NonMaxSuppressionV2"===e.t0?14:"Where"===e.t0?19:"ListDiff"===e.t0?26:27;break;case 3:return a=Ze(t,n,r),o=a.boxes,s=a.scores,c=a.maxOutputSize,u=a.iouThreshold,l=a.scoreThreshold,d=a.softNmsSigma,e.next=6,Ce.j.nonMaxSuppressionWithScoreAsync(o,s,c,u,l,d);case 6:return f=e.sent,e.abrupt("return",[f.selectedIndices,f.selectedScores]);case 8:return p=Ze(t,n,r),m=p.boxes,v=p.scores,g=p.maxOutputSize,b=p.iouThreshold,y=p.scoreThreshold,x=Object(h.d)("padToMaxOutputSize",t,n,r),e.next=12,Ce.j.nonMaxSuppressionPaddedAsync(m,v,g,b,y,x);case 12:return w=e.sent,e.abrupt("return",[w.selectedIndices,w.validOutputs]);case 14:return O=Ze(t,n,r),A=O.boxes,_=O.scores,E=O.maxOutputSize,S=O.iouThreshold,C=O.scoreThreshold,e.next=17,Ce.j.nonMaxSuppressionAsync(A,_,E,S,C);case 17:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 19:return T=qe.a(Object(h.d)("condition",t,n,r),"bool"),e.next=22,Ye.a(T);case 22:return e.t2=e.sent,M=[e.t2],T.dispose(),e.abrupt("return",M);case 26:return e.abrupt("return",Qe.a(Object(h.d)("x",t,n,r),Object(h.d)("y",t,n,r)));case 27:throw TypeError("Node type ".concat(t.op," is not implemented"));case 28:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),et=n(317),tt=n(318),nt=n(185),rt=n(159),at=function(){function e(t,n){Object(s.a)(this,e),this.keyDType=t,this.valueDType=n,this.handle=Object(r.xd)(0),this.tensorMap=new Map,Object(r.rd)(this.handle)}return Object(c.a)(e,[{key:"id",get:function(){return this.handle.id}},{key:"clearAndClose",value:function(){this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),this.handle.dispose()}},{key:"size",value:function(){return this.tensorMap.size}},{key:"tensorSize",value:function(){return rt.a(this.size(),"int32")}},{key:"import",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var a,o=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return a=e.sent,this.tensorMap.forEach((function(e){return e.dispose()})),this.tensorMap.clear(),e.abrupt("return",Object(r.Id)((function(){var e=Object(r.Jd)(n),t=a.length,i=e.length;r.Ld.assert(t===i,(function(){return"The number of elements doesn't match, keys has "+"".concat(t," elements, the values has ").concat(i," ")+"elements."}));for(var s=0;s<t;s++){var c=a[s],u=e[s];Object(r.rd)(u),o.tensorMap.set(c,u)}return o.handle})));case 7:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"find",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var a,o=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.checkKeyAndValueTensor(t,n),e.next=3,t.data();case 3:return a=e.sent,e.abrupt("return",Object(r.Id)((function(){for(var e=[],t=0;t<a.length;t++){var i=a[t],s=o.findWithDefault(i,n);e.push(s)}return Object(r.Cd)(e)})));case 5:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"findWithDefault",value:function(e,t){var n=this.tensorMap.get(e);return null!=n?n:t}},{key:"checkKeyAndValueTensor",value:function(e,t){if(e.dtype!==this.keyDType)throw new Error("Expect key dtype ".concat(this.keyDType,", but got ")+"".concat(e.dtype));if(t.dtype!==this.valueDType)throw new Error("Expect value dtype ".concat(this.valueDType,", but got ")+"".concat(t.dtype))}}]),e}(),it=function(){var e=Object(o.a)(i.a.mark((function e(t,n,r,a){var o,s,c,u,l,d,f,p,m,v,g,b,y;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=t.op,e.next="HashTable"===e.t0||"HashTableV2"===e.t0?3:"LookupTableImport"===e.t0||"LookupTableImportV2"===e.t0?8:"LookupTableFind"===e.t0||"LookupTableFindV2"===e.t0?16:"LookupTableSize"===e.t0||"LookupTableSizeV2"===e.t0?24:27;break;case 3:return o=Object(h.d)("keyDType",t,n,r),s=Object(h.d)("valueDType",t,n,r),c=new at(o,s),a.addHashTable(t.name,c),e.abrupt("return",[c.handle]);case 8:return u=Object(h.d)("tableHandle",t,n,r,a),l=Object(h.d)("keys",t,n,r),d=Object(h.d)("values",t,n,r),f=a.getHashTableById(u.id),e.next=14,f.import(l,d);case 14:return e.t1=e.sent,e.abrupt("return",[e.t1]);case 16:return p=Object(h.d)("tableHandle",t,n,r,a),m=Object(h.d)("keys",t,n,r),v=Object(h.d)("defaultValue",t,n,r),g=a.getHashTableById(p.id),e.next=22,g.find(m,v);case 22:return e.t2=e.sent,e.abrupt("return",[e.t2]);case 24:return b=Object(h.d)("tableHandle",t,n,r,a),y=a.getHashTableById(b.id),e.abrupt("return",[y.tensorSize()]);case 27:throw TypeError("Node type ".concat(t.op," is not implemented"));case 28:case"end":return e.stop()}}),e)})));return function(t,n,r,a){return e.apply(this,arguments)}}(),ot=n(259),st=n(246),ct=n(241),ut=n(235),lt=n(319),dt=n(234),ht=n(233),ft=n(320),pt=n(321),mt=n(194),vt=n(214),gt=n(242),bt=n(348),yt=n(322),xt=n(323),wt=n(324),Ot=n(349),At=n(196),_t=n(244),Et=n(237),St=n(167),Ct=n(325),Tt=n(326),Mt=n(327),kt=n(328),Rt=n(329),It=n(330),jt=n(331),Bt=n(170),Lt=n(332),Nt=n(229),Dt=n(177),Pt=n(333),Ft=n(227),Gt=n(150),Ut=n(192),zt=n(205),Ht=n(240),Vt=n(212),Wt=n(334),Jt=n(335),Xt=n(206),Kt=n(207),qt=n(208),Yt=n(228),Qt=n(226),Zt=n(336),$t=n(337),en=n(338),tn=n(339),nn=n(340),rn=n(236);function an(e,t,n,a){var i=function(e,t,n){switch(e.category){case"arithmetic":return r.Id((function(){return function(e,t,n){switch(e.op){case"BiasAdd":case"AddV2":case"Add":return[m.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"AddN":return[v.a(Object(h.d)("tensors",e,t,n))];case"FloorMod":case"Mod":return[g.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Mul":return[b.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"RealDiv":case"Div":return[y.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"DivNoNan":return[x.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"FloorDiv":return[w.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Sub":return[O.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Minimum":return[A.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Maximum":return[_.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Pow":return[E.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"SquaredDifference":return[S.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"basic_math":return r.Id((function(){return function(e,t,n){switch(e.op){case"Abs":case"ComplexAbs":return[C.a(Object(h.d)("x",e,t,n))];case"Acos":return[T.a(Object(h.d)("x",e,t,n))];case"Acosh":return[M.a(Object(h.d)("x",e,t,n))];case"Asin":return[k.a(Object(h.d)("x",e,t,n))];case"Asinh":return[R.a(Object(h.d)("x",e,t,n))];case"Atan":return[I.a(Object(h.d)("x",e,t,n))];case"Atan2":return[j.a(Object(h.d)("x",e,t,n),Object(h.d)("y",e,t,n))];case"Atanh":return[B.a(Object(h.d)("x",e,t,n))];case"Ceil":return[L.a(Object(h.d)("x",e,t,n))];case"Complex":return[N.a(Object(h.d)("real",e,t,n),Object(h.d)("imag",e,t,n))];case"Cos":return[D.a(Object(h.d)("x",e,t,n))];case"Cosh":return[P.a(Object(h.d)("x",e,t,n))];case"Elu":return[F.a(Object(h.d)("x",e,t,n))];case"Erf":return[G.a(Object(h.d)("x",e,t,n))];case"Exp":return[U.a(Object(h.d)("x",e,t,n))];case"Expm1":return[z.a(Object(h.d)("x",e,t,n))];case"Floor":return[H.a(Object(h.d)("x",e,t,n))];case"Log":return[V.a(Object(h.d)("x",e,t,n))];case"Log1p":return[W.a(Object(h.d)("x",e,t,n))];case"Imag":return[J.a(Object(h.d)("x",e,t,n))];case"Neg":return[X.a(Object(h.d)("x",e,t,n))];case"Reciprocal":return[K.a(Object(h.d)("x",e,t,n))];case"Real":return[q.a(Object(h.d)("x",e,t,n))];case"Relu":return[Y.a(Object(h.d)("x",e,t,n))];case"Round":return[Q.a(Object(h.d)("x",e,t,n))];case"Selu":return[Z.a(Object(h.d)("x",e,t,n))];case"Sigmoid":return[$.a(Object(h.d)("x",e,t,n))];case"Sin":return[ee.a(Object(h.d)("x",e,t,n))];case"Sign":return[te.a(Object(h.d)("x",e,t,n))];case"Sinh":return[ne.a(Object(h.d)("x",e,t,n))];case"Softplus":return[re.a(Object(h.d)("x",e,t,n))];case"Sqrt":return[ae.a(Object(h.d)("x",e,t,n))];case"Square":return[ie.a(Object(h.d)("x",e,t,n))];case"Tanh":return[oe.a(Object(h.d)("x",e,t,n))];case"Tan":return[se.a(Object(h.d)("x",e,t,n))];case"ClipByValue":return[ce.a(Object(h.d)("x",e,t,n),Object(h.d)("clipValueMin",e,t,n),Object(h.d)("clipValueMax",e,t,n))];case"Relu6":return[ue.a(Object(h.d)("x",e,t,n))];case"Rsqrt":return[le.a(Object(h.e)(e.inputNames[0],t,n))];case"Prod":return[de.a(Object(h.d)("x",e,t,n),Object(h.d)("axes",e,t,n))];case"LeakyRelu":return[he.a(Object(h.d)("x",e,t,n),Object(h.d)("alpha",e,t,n))];case"Prelu":return[fe.a(Object(h.d)("x",e,t,n),Object(h.d)("alpha",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"control":return _e(e,t,n);case"convolution":return r.Id((function(){return function(e,t,n){switch(e.op){case"Conv1D":var r=Object(h.d)("stride",e,t,n),a=Object(h.d)("pad",e,t,n),i=Object(h.d)("dataFormat",e,t,n).toUpperCase(),o=Object(h.d)("dilation",e,t,n);return[Ee.a(Object(h.d)("x",e,t,n),Object(h.d)("filter",e,t,n),r,a,i,o)];case"Conv2D":var s=Object(h.d)("strides",e,t,n),c=Object(h.c)(e,t,n),u=Object(h.d)("dataFormat",e,t,n).toUpperCase(),l=Object(h.d)("dilations",e,t,n);return[Se.a(Object(h.d)("x",e,t,n),Object(h.d)("filter",e,t,n),[s[1],s[2]],c,u,[l[1],l[2]])];case"_FusedConv2D":var d=De(e,t,n),f=d.stride,p=d.pad,m=d.dataFormat,v=d.dilations,g=d.biasArg,b=d.preluArg,y=d.activationFunc,x=d.leakyreluAlpha;return[Ce.i.conv2d({x:Object(h.d)("x",e,t,n),filter:Object(h.d)("filter",e,t,n),strides:[f[1],f[2]],pad:p,dataFormat:m,dilations:[v[1],v[2]],bias:g,activation:y,preluActivationWeights:b,leakyreluAlpha:x})];case"FusedDepthwiseConv2dNative":var w=De(e,t,n),O=w.stride,A=w.pad,_=w.dataFormat,E=w.dilations,S=w.biasArg,C=w.preluArg,T=w.activationFunc,M=w.leakyreluAlpha;return[Ce.i.depthwiseConv2d({x:Object(h.d)("x",e,t,n),filter:Object(h.d)("filter",e,t,n),strides:[O[1],O[2]],pad:A,dataFormat:_,dilations:[E[1],E[2]],bias:S,activation:T,preluActivationWeights:C,leakyreluAlpha:M})];case"Conv2DBackpropInput":case"Conv2dTranspose":var k=Object(h.d)("outputShape",e,t,n),R=Object(h.d)("strides",e,t,n),I=Object(h.c)(e,t,n);return[Te.a(Object(h.d)("x",e,t,n),Object(h.d)("filter",e,t,n),k,[R[1],R[2]],I)];case"DepthwiseConv2dNative":case"DepthwiseConv2d":var j=Object(h.d)("strides",e,t,n),B=Object(h.c)(e,t,n),L=Object(h.d)("dilations",e,t,n),N=Object(h.d)("dataFormat",e,t,n).toUpperCase();return[Me.a(Object(h.d)("input",e,t,n),Object(h.d)("filter",e,t,n),[j[1],j[2]],B,N,[L[1],L[2]])];case"Conv3D":var D=Object(h.d)("strides",e,t,n),P=Object(h.d)("pad",e,t,n),F=Object(h.d)("dataFormat",e,t,n).toUpperCase(),G=Object(h.d)("dilations",e,t,n);return[ke.a(Object(h.d)("x",e,t,n),Object(h.d)("filter",e,t,n),[D[1],D[2],D[3]],P,F,[G[1],G[2],G[3]])];case"AvgPool":var U=Object(h.d)("strides",e,t,n),z=Object(h.d)("pad",e,t,n),H=Object(h.d)("kernelSize",e,t,n);return[Re.a(Object(h.d)("x",e,t,n),[H[1],H[2]],[U[1],U[2]],z)];case"MaxPool":var V=Object(h.d)("strides",e,t,n),W=Object(h.d)("pad",e,t,n),J=Object(h.d)("kernelSize",e,t,n);return[Ie.a(Object(h.d)("x",e,t,n),[J[1],J[2]],[V[1],V[2]],W)];case"MaxPoolWithArgmax":var X=Object(h.d)("strides",e,t,n),K=Object(h.d)("pad",e,t,n),q=Object(h.d)("kernelSize",e,t,n),Y=Object(h.d)("includeBatchInIndex",e,t,n),Q=je.a(Object(h.d)("x",e,t,n),[q[1],q[2]],[X[1],X[2]],K,Y);return[Q.result,Q.indexes];case"AvgPool3D":var Z=Object(h.d)("strides",e,t,n),$=Object(h.d)("pad",e,t,n),ee=Object(h.d)("kernelSize",e,t,n);return[Be.a(Object(h.d)("x",e,t,n),[ee[1],ee[2],ee[3]],[Z[1],Z[2],Z[3]],$)];case"MaxPool3D":var te=Object(h.d)("strides",e,t,n),ne=Object(h.d)("pad",e,t,n),re=Object(h.d)("kernelSize",e,t,n);return[Le.a(Object(h.d)("x",e,t,n),[re[1],re[2],re[3]],[te[1],te[2],te[3]],ne)];case"Dilation2D":var ae=Object(h.d)("strides",e,t,n),ie=Object(h.d)("pad",e,t,n),oe=Object(h.d)("dilations",e,t,n),se=ae[1],ce=ae[2],ue=oe[1],le=oe[2];return[Ne.a(Object(h.d)("x",e,t,n),Object(h.d)("filter",e,t,n),[se,ce],ie,[ue,le],"NHWC")];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"creation":return r.Id((function(){return function(e,t,n){switch(e.op){case"Fill":var r=Object(h.d)("shape",e,t,n),a=Object(h.d)("dtype",e,t,n),i=Object(h.d)("value",e,t,n);return[Pe.a(r,i,a)];case"LinSpace":var o=Object(h.d)("start",e,t,n),s=Object(h.d)("stop",e,t,n),c=Object(h.d)("num",e,t,n);return[Fe.a(o,s,c)];case"Multinomial":var u=Object(h.d)("logits",e,t,n),l=Object(h.d)("numSamples",e,t,n),d=Object(h.d)("seed",e,t,n);return[Ge.a(u,l,d)];case"OneHot":var f=Object(h.d)("indices",e,t,n),p=Object(h.d)("depth",e,t,n),m=Object(h.d)("onValue",e,t,n),v=Object(h.d)("offValue",e,t,n);return[Ue.a(f,p,m,v)];case"Ones":return[ze.a(Object(h.d)("shape",e,t,n),Object(h.d)("dtype",e,t,n))];case"OnesLike":return[He.a(Object(h.d)("x",e,t,n))];case"RandomUniform":return[Ve.a(Object(h.d)("shape",e,t,n),Object(h.d)("minval",e,t,n),Object(h.d)("maxval",e,t,n),Object(h.d)("dtype",e,t,n))];case"Range":var g=Object(h.d)("start",e,t,n),b=Object(h.d)("stop",e,t,n),y=Object(h.d)("step",e,t,n);return[We.a(g,b,y,Object(h.d)("dtype",e,t,n))];case"TruncatedNormal":var x=Object(h.d)("shape",e,t,n),w=Object(h.d)("mean",e,t,n),O=Object(h.d)("stdDev",e,t,n),A=Object(h.d)("seed",e,t,n);return[Je.a(x,w,O,Object(h.d)("dtype",e,t,n),A)];case"Zeros":return[Xe.a(Object(h.d)("shape",e,t,n),Object(h.d)("dtype",e,t,n))];case"ZerosLike":return[Ke.a(Object(h.d)("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"dynamic":return $e(e,t,n);case"evaluation":return r.Id((function(){return function(e,t,n){switch(e.op){case"TopKV2":var r=Object(h.d)("x",e,t,n),a=Object(h.d)("k",e,t,n),i=Object(h.d)("sorted",e,t,n),o=et.a(r,a,i);return[o.values,o.indices];case"Unique":var s=Object(h.d)("x",e,t,n),c=tt.a(s);return[c.values,c.indices];case"UniqueV2":var u=Object(h.d)("x",e,t,n),l=Object(h.d)("axis",e,t,n),d=tt.a(u,l);return[d.values,d.indices];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"image":return r.Id((function(){return function(e,t,n){switch(e.op){case"ResizeBilinear":var r=Object(h.d)("images",e,t,n),a=Object(h.d)("size",e,t,n),i=Object(h.d)("alignCorners",e,t,n),o=Object(h.d)("halfPixelCenters",e,t,n);return[Ce.j.resizeBilinear(r,[a[0],a[1]],i,o)];case"ResizeNearestNeighbor":var s=Object(h.d)("images",e,t,n),c=Object(h.d)("size",e,t,n),u=Object(h.d)("alignCorners",e,t,n),l=Object(h.d)("halfPixelCenters",e,t,n);return[Ce.j.resizeNearestNeighbor(s,[c[0],c[1]],u,l)];case"CropAndResize":var d=Object(h.d)("image",e,t,n),f=Object(h.d)("boxes",e,t,n),p=Object(h.d)("boxInd",e,t,n),m=Object(h.d)("cropSize",e,t,n),v=Object(h.d)("method",e,t,n),g=Object(h.d)("extrapolationValue",e,t,n);return[Ce.j.cropAndResize(d,f,p,m,v,g)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"graph":return r.Id((function(){return function(e,t,n){switch(e.op){case"Const":return t[e.name];case"PlaceholderWithDefault":var r=Object(h.d)("default",e,t,n);return[Object(h.e)(e.name,t,n)||r];case"Placeholder":return[Object(h.e)(e.name,t,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":var a=Object(h.d)("x",e,t,n);return[Object(h.a)(a)];case"IdentityN":return Object(h.d)("x",e,t,n).map((function(e){return Object(h.a)(e)}));case"Snapshot":var i=Object(h.d)("x",e,t,n);return[Object(h.a)(i)];case"Shape":return[nt.a(Object(h.d)("x",e,t,n).shape,"int32")];case"ShapeN":return Object(h.d)("x",e,t,n).map((function(e){return nt.a(e.shape)}));case"Size":return[rt.a(Object(h.d)("x",e,t,n).size,"int32")];case"Rank":return[rt.a(Object(h.d)("x",e,t,n).rank,"int32")];case"NoOp":return[rt.a(1)];case"Print":var o=Object(h.d)("x",e,t,n),s=Object(h.d)("data",e,t,n),c=Object(h.d)("message",e,t,n),u=Object(h.d)("summarize",e,t,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(var l=0;l<s.length;l++)console.log(Array.prototype.slice.call(s[l].dataSync()).slice(0,u));return[o];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"logical":return r.Id((function(){return function(e,t,n){switch(e.op){case"Equal":return[ot.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"NotEqual":return[st.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Greater":return[ct.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"GreaterEqual":return[ut.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Less":return[lt.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"LessEqual":return[dt.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"LogicalAnd":return[ht.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"LogicalNot":return[ft.a(Object(h.d)("a",e,t,n))];case"LogicalOr":return[pt.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];case"Select":case"SelectV2":return[mt.a(Object(h.d)("condition",e,t,n),Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"matrices":return r.Id((function(){return function(e,t,n){switch(e.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[vt.a(Object(h.d)("a",e,t,n),Object(h.d)("b",e,t,n),Object(h.d)("transposeA",e,t,n),Object(h.d)("transposeB",e,t,n))];case"Transpose":return[gt.a(Object(h.d)("x",e,t,n),Object(h.d)("perm",e,t,n))];case"_FusedMatMul":var r=Object(h.d)("fusedOps",e,t,n),a=Object(l.a)(r,2),i=a[0],o=a[1],s="biasadd"===i,c="prelu"===o,u=Object(h.d)("numArgs",e,t,n),d=Object(h.d)("leakyreluAlpha",e,t,n);if(s){if(c&&2!==u)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!c&&1!==u)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}var f=Object(h.d)("args",e,t,n),p=Object(l.a)(f,2),m=p[0],v=p[1];return[Ce.i.matMul({a:Object(h.d)("a",e,t,n),b:Object(h.d)("b",e,t,n),transposeA:Object(h.d)("transposeA",e,t,n),transposeB:Object(h.d)("transposeB",e,t,n),bias:m,activation:o,preluActivationWeights:v,leakyreluAlpha:d})];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"normalization":return r.Id((function(){return function(e,t,n){switch(e.op){case"FusedBatchNorm":case"FusedBatchNormV2":case"FusedBatchNormV3":return[bt.a(Object(h.d)("x",e,t,n),Object(h.d)("mean",e,t,n),Object(h.d)("variance",e,t,n),Object(h.d)("offset",e,t,n),Object(h.d)("scale",e,t,n),Object(h.d)("epsilon",e,t,n))];case"LRN":return[yt.a(Object(h.d)("x",e,t,n),Object(h.d)("radius",e,t,n),Object(h.d)("bias",e,t,n),Object(h.d)("alpha",e,t,n),Object(h.d)("beta",e,t,n))];case"Softmax":return[xt.a(Object(h.d)("x",e,t,n))];case"LogSoftmax":return[wt.a(Object(h.d)("x",e,t,n))];case"SparseToDense":return[Ot.a(Object(h.d)("sparseIndices",e,t,n),Object(h.d)("outputShape",e,t,n),Object(h.d)("sparseValues",e,t,n),Object(h.d)("defaultValue",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"reduction":return r.Id((function(){return function(e,t,n){switch(e.op){case"Max":var r=Object(h.d)("axis",e,t,n),a=Object(h.d)("keepDims",e,t,n);return[At.a(Object(h.d)("x",e,t,n),r,a)];case"Mean":var i=Object(h.d)("axis",e,t,n),o=Object(h.d)("keepDims",e,t,n);return[_t.a(Object(h.d)("x",e,t,n),i,o)];case"Min":var s=Object(h.d)("axis",e,t,n),c=Object(h.d)("keepDims",e,t,n);return[Et.a(Object(h.d)("x",e,t,n),s,c)];case"Sum":var u=Object(h.d)("axis",e,t,n),l=Object(h.d)("keepDims",e,t,n);return[St.a(Object(h.d)("x",e,t,n),u,l)];case"All":var d=Object(h.d)("axis",e,t,n),f=Object(h.d)("keepDims",e,t,n);return[Ct.a(Object(h.d)("x",e,t,n),d,f)];case"Any":var p=Object(h.d)("axis",e,t,n),m=Object(h.d)("keepDims",e,t,n);return[Tt.a(Object(h.d)("x",e,t,n),p,m)];case"ArgMax":var v=Object(h.d)("axis",e,t,n);return[Mt.a(Object(h.d)("x",e,t,n),v)];case"ArgMin":var g=Object(h.d)("axis",e,t,n);return[kt.a(Object(h.d)("x",e,t,n),g)];case"Prod":var b=Object(h.d)("axis",e,t,n),y=Object(h.d)("keepDims",e,t,n);return[de.a(Object(h.d)("x",e,t,n),b,y)];case"Cumsum":var x=Object(h.d)("axis",e,t,n),w=Object(h.d)("exclusive",e,t,n),O=Object(h.d)("reverse",e,t,n);return[Rt.a(Object(h.d)("x",e,t,n),x,w,O)];case"Bincount":var A=Object(h.d)("x",e,t,n),_=Object(h.d)("weights",e,t,n),E=Object(h.d)("size",e,t,n);return[It.a(A,_,E)];case"DenseBincount":var S=Object(h.d)("x",e,t,n),C=Object(h.d)("weights",e,t,n),T=Object(h.d)("size",e,t,n),M=Object(h.d)("binaryOutput",e,t,n);return[jt.a(S,C,T,M)];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"slice_join":return r.Id((function(){return function(e,t,n){switch(e.op){case"ConcatV2":case"Concat":var a=Object(h.d)("n",e,t,n),i=Object(h.d)("axis",e,t,n),o=Object(h.d)("tensors",e,t,n);return o=o.slice(0,a),[Bt.a(o,i)];case"Gather":var s=Object(h.d)("x",e,t,n),c=Object(h.d)("indices",e,t,n);return[Lt.a(s,qe.a(c,"int32"),0)];case"GatherV2":var u=Object(h.d)("axis",e,t,n),l=Object(h.d)("batchDims",e,t,n),d=Object(h.d)("x",e,t,n),f=Object(h.d)("indices",e,t,n);return[Lt.a(d,qe.a(f,"int32"),u,l)];case"Reverse":for(var p=Object(h.d)("dims",e,t,n),m=[],v=0;v<p.length;v++)p[v]&&m.push(v);var g=Object(h.d)("x",e,t,n);return[Nt.a(g,m)];case"ReverseV2":var b=Object(h.d)("axis",e,t,n),y=Object(h.d)("x",e,t,n);return[Nt.a(y,b)];case"Slice":var x=Object(h.d)("begin",e,t,n),w=Object(h.d)("size",e,t,n);return[Dt.a(Object(h.d)("x",e,t,n),x,w)];case"StridedSlice":var O=Object(h.d)("begin",e,t,n),A=Object(h.d)("end",e,t,n),_=Object(h.d)("strides",e,t,n),E=Object(h.d)("beginMask",e,t,n),S=Object(h.d)("endMask",e,t,n),C=Object(h.d)("ellipsisMask",e,t,n),T=Object(h.d)("newAxisMask",e,t,n),M=Object(h.d)("shrinkAxisMask",e,t,n),k=Object(h.d)("x",e,t,n);return[Pt.a(k,O,A,_,E,S,C,T,M)];case"Pack":return Object(r.Id)((function(){var a=Object(h.d)("axis",e,t,n),i=Object(h.d)("tensors",e,t,n),o=i[0].shape,s=Ft.a(i[0]).shape,c=i.map((function(e){var t=r.Ld.arraysEqual(e.shape,o);if(!t&&!r.Ld.arraysEqual(Ft.a(e).shape,s))throw new Error("the input tensors shape does not match");return t?e:Gt.a(e,o)}));return[Ut.a(c,a)]}));case"Unpack":var R=Object(h.d)("axis",e,t,n),I=Object(h.d)("tensor",e,t,n);return zt.a(I,R);case"Tile":var j=Object(h.d)("reps",e,t,n);return[Ht.a(Object(h.d)("x",e,t,n),j)];case"Split":case"SplitV":var B=Object(h.d)("axis",e,t,n),L=Object(h.d)("numOrSizeSplits",e,t,n),N=Object(h.d)("x",e,t,n);return Vt.a(N,L,B);case"ScatterNd":var D=Object(h.d)("indices",e,t,n),P=Object(h.d)("values",e,t,n),F=Object(h.d)("shape",e,t,n);return[Wt.a(D,P,F)];case"GatherNd":var G=Object(h.d)("x",e,t,n),U=Object(h.d)("indices",e,t,n);return[Jt.a(G,U)];case"SparseToDense":var z=Object(h.d)("sparseIndices",e,t,n),H=Object(h.d)("outputShape",e,t,n),V=Object(h.d)("sparseValues",e,t,n),W=Object(h.d)("defaultValue",e,t,n);return[Ot.a(z,V,H,V.dtype===W.dtype?W:qe.a(W,V.dtype))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"spectral":return r.Id((function(){return function(e,t,n){switch(e.op){case"FFT":return[Xt.a(Object(h.d)("x",e,t,n))];case"IFFT":return[Kt.a(Object(h.d)("x",e,t,n))];case"RFFT":return[qt.a(Object(h.d)("x",e,t,n))];case"IRFFT":return[Yt.a(Object(h.d)("x",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"transformation":return r.Id((function(){return function(e,t,n){switch(e.op){case"Cast":return[qe.a(Object(h.d)("x",e,t,n),Object(h.d)("dtype",e,t,n))];case"ExpandDims":var r=Object(h.d)("axis",e,t,n);return[Qt.a(Object(h.d)("x",e,t,n),r)];case"Squeeze":var a=Object(h.d)("axis",e,t,n);return[Ft.a(Object(h.d)("x",e,t,n),a)];case"Reshape":return[Gt.a(Object(h.d)("x",e,t,n),Object(h.d)("shape",e,t,n))];case"MirrorPad":return[Zt.a(Object(h.d)("x",e,t,n),Object(h.d)("padding",e,t,n),Object(h.d)("mode",e,t,n))];case"PadV2":case"Pad":return[$t.a(Object(h.d)("x",e,t,n),Object(h.d)("padding",e,t,n),Object(h.d)("constantValue",e,t,n))];case"SpaceToBatchND":var i=Object(h.d)("blockShape",e,t,n),o=Object(h.d)("paddings",e,t,n);return[en.a(Object(h.d)("x",e,t,n),i,o)];case"BatchToSpaceND":var s=Object(h.d)("blockShape",e,t,n),c=Object(h.d)("crops",e,t,n);return[tn.a(Object(h.d)("x",e,t,n),s,c)];case"DepthToSpace":var u=Object(h.d)("blockSize",e,t,n),l=Object(h.d)("dataFormat",e,t,n).toUpperCase();return[nn.a(Object(h.d)("x",e,t,n),u,l)];case"BroadcastTo":return[rn.a(Object(h.d)("x",e,t,n),Object(h.d)("shape",e,t,n))];default:throw TypeError("Node type ".concat(e.op," is not implemented"))}}(e,t,n)}));case"hash_table":return it(e,t,n,a);case"custom":var i=Object(p.a)(e.op);if(i&&i.customExecutor)return i.customExecutor(new f(e,t,n));throw TypeError("Custom op ".concat(e.op," is not registered."));default:throw TypeError("Unknown op '".concat(e.op,"'. File an issue at ")+"https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()")}}(e,t,n);return r.Ld.isPromise(i)?i.then((function(e){return[].concat(e)})):[].concat(i)}var on=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object(s.a)(this,e),this.weightMap=t,this.tensorArrayMap=n,this.tensorListMap=r,this.functionMap=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}return Object(c.a)(e,[{key:"newFrame",value:function(e,t){return{id:e,frameName:t,iterationId:0}}},{key:"currentContext",get:function(){return this.contexts},set:function(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}},{key:"currentContextId",get:function(){return this._currentContextIds[0]}},{key:"currentContextIds",get:function(){return this._currentContextIds}},{key:"generateCurrentContextIds",value:function(){for(var e=[],t=0;t<this.contexts.length-1;t++){var n=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(n))}e.push(""),this._currentContextIds=e}},{key:"contextIdforContexts",value:function(e){return e?e.map((function(e){return 0===e.id&&0===e.iterationId?"":"".concat(e.frameName,"-").concat(e.iterationId)})).join("/"):""}},{key:"enterFrame",value:function(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}},{key:"exitFrame",value:function(){if(!(this.contexts&&this.contexts.length>1))throw new Error("Cannot exit frame, the context is empty");this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift()}},{key:"nextIteration",value:function(){if(!(this.contexts&&this.contexts.length>0))throw new Error("Cannot increase frame iteration, the context is empty");this.contexts=this.contexts.slice(),this.lastId++;var e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}},{key:"getWeight",value:function(e){return this.weightMap[e]}},{key:"addTensorArray",value:function(e){this.tensorArrayMap[e.id]=e}},{key:"getTensorArray",value:function(e){return this.tensorArrayMap[e]}},{key:"addTensorList",value:function(e){this.tensorListMap[e.id]=e}},{key:"getTensorList",value:function(e){return this.tensorListMap[e]}},{key:"dispose",value:function(e){for(var t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(var n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}]),e}();function sn(e,t,n,r){var a=new Set,i=[],o=null,s=null,c=new Set,u=Object.keys(e).map((function(e){return Object(h.g)(e)[0]})),l=[];null!=r&&(l=r.map((function(e){return Object(h.g)(e.name)[0]})));for(var f=Object(d.a)(t);f.length>0;){var p=f.pop();(dn(p)||hn(p)||fn(p))&&null==o&&(s=(o=p).children.map((function(e){return e.name})).filter((function(e){return a.has(e)}))),a.add(p.name),null==n[p.name]&&(-1===u.indexOf(p.name)&&-1===l.indexOf(p.name)&&(0!==p.inputs.length?p.inputs.forEach((function(e){c.has(e.name)||(c.add(e.name),f.push(e))})):i.push(p.name)))}return{inputs:e,outputs:t,usedNodes:a,missingInputs:i,dynamicNode:o,syncInputs:s}}var cn=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],un=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],ln=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function dn(e){return cn.indexOf(e.op)>=0}function hn(e){return un.indexOf(e.op)>=0}function fn(e){return ln.indexOf(e.op)>=0}var pn=function(){function e(t,n){var r=this;Object(s.a)(this,e),this.graph=t,this.parent=n,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this._outputs=t.outputs,this._inputs=t.inputs,this._initNodes=t.initNodes,this._signature=t.signature,this._functions=t.functions,null!=t.functions&&Object.keys(t.functions).forEach((function(n){r._functionExecutorMap[n]=new e(t.functions[n],r)}))}return Object(c.a)(e,[{key:"weightIds",get:function(){return this.parent?this.parent.weightIds:this._weightIds}},{key:"functionExecutorMap",get:function(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}},{key:"weightMap",get:function(){return this.parent?this.parent.weightMap:this._weightMap},set:function(e){var t,n=Object.keys(e).map((function(t){return e[t].map((function(e){return e.id}))}));this._weightIds=(t=[]).concat.apply(t,Object(d.a)(n)),this._weightMap=e}},{key:"resourceManager",set:function(e){this._resourceManager=e}},{key:"inputs",get:function(){return this._inputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"outputs",get:function(){return this._outputs.map((function(e){return{name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}}))}},{key:"inputNodes",get:function(){return this._inputs.map((function(e){return e.signatureKey||e.name}))}},{key:"outputNodes",get:function(){return this._outputs.map((function(e){var t=e.signatureKey||e.name;return e.defaultOutput?"".concat(t,":").concat(e.defaultOutput):t}))}},{key:"functions",get:function(){var e=this;return Object.keys(this._functions).reduce((function(t,n){return t[n]=e._functions[n].signature,t}),{})}},{key:"getCompilationKey",value:function(e,t){var n=e.map((function(e){return e.name})).sort(),r=t.map((function(e){return e.name})).sort();return n.join(this.SEPERATOR)+"--"+r.join(this.SEPERATOR)}},{key:"compile",value:function(e,t){var n=sn(e,t,this.weightMap,this._initNodes),r=n.missingInputs,a=n.dynamicNode,i=n.syncInputs;if(null!=a)throw new Error("This execution contains the node '".concat(a.name,"', which has ")+"the dynamic op '".concat(a.op,"'. Please use ")+"model.executeAsync() instead. Alternatively, to avoid the "+"dynamic ops, specify the inputs [".concat(i,"]"));if(r.length>0){var o=t.map((function(e){return e.name})),s=Object.keys(e);throw new Error("Cannot compute the outputs [".concat(o,"] from the provided inputs ")+"[".concat(s,"]. Missing the following inputs: [").concat(r,"]"))}return function(e,t,n){var r=n.usedNodes,a=n.inputs,i=[],o=Object.keys(a).map((function(e){return Object(h.g)(e)[0]})).map((function(t){return e.nodes[t]})),s=e.initNodes;o.forEach((function(e){r.has(e.name)&&i.push(e)})),e.weights.forEach((function(e){r.has(e.name)&&i.push(e)})),null!=s&&s.forEach((function(e){r.has(e.name)&&i.push(e)}));for(var c=new Set,u=[];i.length>0;){var l=i.pop();c.add(l.name),t[l.name]||u.push(l),l.children.forEach((function(e){!c.has(e.name)&&r.has(e.name)&&e.inputs.every((function(e){return c.has(e.name)}))&&i.push(e)}))}return u}(this.graph,this.weightMap,n)}},{key:"execute",value:function(e,t){var n=this;e=this.mapInputs(e);var a=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);var i=a.map((function(e){return n.graph.nodes[Object(h.g)(e)[0]]})),o=t.map((function(e){return Object(h.g)(e)[0]})),s=o.map((function(e){return n.graph.nodes[e]}));0===s.length&&(s=this._outputs);var c=this.getCompilationKey(i,s),u=this.compiledMap.get(c);null==u&&(u=this.compile(e,s),this.compiledMap.set(c,u));var d={},f={};return Object(r.Id)((function(){var a=new on(n.weightMap,d,f,n.functionExecutorMap),i=Object.assign({},n.weightMap);Object.keys(e).forEach((function(t){var n=Object(h.g)(t),r=Object(l.a)(n,2),a=r[0],o=[];o[r[1]]=e[t],i[a]=o}));for(var s=n.getFrozenTensorIds(i),c={},p=0;p<u.length;p++){var m=u[p];if(!i[m.name]){var v=an(m,i,a,n._resourceManager);if(r.Ld.isPromise(v))throw new Error("The execution of the op '".concat(m.op,"' returned a promise. ")+"Please use model.executeAsync() instead.");i[m.name]=v,n.checkTensorForDisposal(m.name,m,i,a,s,o,c)}}return null==n.parent&&a.dispose(s),t.map((function(e){return Object(h.e)(e,i,a)}))}))}},{key:"getFrozenTensorIds",value:function(e){var t=[].concat.apply([],Object.keys(e).map((function(t){return e[t]})).map((function(e){return e.map((function(e){return e.id}))})));return new Set(t)}},{key:"checkTensorForDisposal",value:function(e,t,n,r,a,i,o){"control"!==t.category&&-1===i.indexOf(e)&&(n[e].forEach((function(e){null!=e&&(o[e.id]=(o[e.id]||0)+t.children.length)})),t.inputs.forEach((function(e){if("control"!==e.category){var t=Object(h.f)(e.name,n,r);null!=t&&t.forEach((function(e){if(e&&!a.has(e.id)){var t=o[e.id];1===t?(e.dispose(),delete o[e.id]):null!=t&&o[e.id]--}}))}})))}},{key:"executeAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this._executeAsync(t,n));case 1:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"_executeAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r,a,o,s,c,u,l,f,p,m=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=m.length>2&&void 0!==m[2]&&m[2],a=m.length>3&&void 0!==m[3]?m[3]:{},o=m.length>4&&void 0!==m[4]?m[4]:{},r||(t=this.mapInputs(t),this.checkInputs(t),this.checkInputShapeAndType(t),n=this.mapOutputs(n),this.checkOutputs(n)),s=new on(this.weightMap,a,o,this.functionExecutorMap),e.next=7,this.executeWithControlFlow(t,s,n,r);case 7:return c=e.sent,u=n.map((function(e){return Object(h.e)(e,c,s)})),l=u.map((function(e){return e.id})),f=Object.keys(t).map((function(e){return t[e].id})),p=new Set([].concat(Object(d.a)(l),Object(d.a)(f),Object(d.a)(this.weightIds))),Object.keys(c).forEach((function(e){c[e].forEach((function(e){!e||e.isDisposed||p.has(e.id)||e.dispose()}))})),null==this.parent&&s.dispose(p),e.abrupt("return",u);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"executeFunctionAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n,r){var a,o=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.reduce((function(e,t,n){return e[o.inputs[n].name]=t,e}),{}),e.abrupt("return",this._executeAsync(a,this.outputNodes,!0,n,r));case 2:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"executeWithControlFlow",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n,r,a){var o,s,c,u,f,p,m,v,g,b,y,x,w,O,A,_,E,S=this;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=Object.keys(t),s=o.map((function(e){return S.graph.nodes[Object(h.g)(e)[0]]})),c=r.map((function(e){return Object(h.g)(e)[0]})),0===(u=c.map((function(e){return S.graph.nodes[e]}))).length&&(u=this._outputs),f=sn(t,u,this.weightMap,this._initNodes),p=f.usedNodes,m=f.missingInputs,v=f.dynamicNode,g=f.syncInputs,b=[].concat(Object(d.a)(s),Object(d.a)(this.graph.weights),Object(d.a)(this._initNodes||[])).map((function(e){return{node:e,contexts:n.currentContext}})),y=Object.assign({},this.weightMap),Object.keys(t).forEach((function(e){var n=Object(h.g)(e),r=Object(l.a)(n,2),a=r[0],i=[];i[r[1]]=t[e],y[a]=i})),x={},w=this.getFrozenTensorIds(y),O={};case 12:if(!(b.length>0)){e.next=18;break}return A=this.processStack(s,b,n,y,O,w,c,x,p),e.next=16,Promise.all(A);case 16:e.next=12;break;case 18:if(null!=v||a||console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead."),!((_=u.filter((function(e){return!dn(e)&&!Object(h.e)(e.name,y,n)})).map((function(e){return e.name}))).length>0)){e.next=24;break}throw E="",null!=v&&(E="Alternatively, to avoid the dynamic ops, use model.execute() "+"and specify the inputs [".concat(g,"]")),new Error("Cannot compute the outputs [".concat(_,"] from the provided ")+"inputs [".concat(o,"]. Consider providing the following inputs: ")+"[".concat(m,"]. ").concat(E));case 24:return e.abrupt("return",y);case 25:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"processStack",value:function(e,t,n,a,i,o,s,c,u){for(var d=this,f=[],p=function(){var e=t.pop();n.currentContext=e.contexts;var p="";if("Enter"===e.node.op&&Object(h.d)("isConstant",e.node,a,n)){var m=Object(h.b)(e.node.name,n),v=Object(l.a)(m,1);p=v[0]}if(null==a[e.node.name]){var g=an(e.node,a,n,d._resourceManager);if(!p){var b=Object(h.b)(e.node.name,n),y=Object(l.a)(b,1);p=y[0]}var x=n.currentContext;r.Ld.isPromise(g)?f.push(g.then((function(r){return a[p]=r,n.currentContext=x,d.checkTensorForDisposal(p,e.node,a,n,o,s,c),d.processChildNodes(e.node,t,n,a,i,u),r}))):(a[p]=g,d.checkTensorForDisposal(p,e.node,a,n,o,s,c),d.processChildNodes(e.node,t,n,a,i,u))}else d.processChildNodes(e.node,t,n,a,i,u)};t.length>0;)p();return f}},{key:"processChildNodes",value:function(e,t,n,r,a,i){e.children.forEach((function(e){var o=Object(h.b)(e.name,n),s=Object(l.a)(o,1)[0];!a[s]&&i.has(e.name)&&("Merge"===e.op?e.inputNames.some((function(e){return!!Object(h.e)(e,r,n)}))&&(a[s]=!0,t.push({contexts:n.currentContext,node:e})):e.inputNames.every((function(e){return!!Object(h.e)(e,r,n)}))&&(a[s]=!0,t.push({contexts:n.currentContext,node:e})))}))}},{key:"dispose",value:function(){var e=this;Object.keys(this.weightMap).forEach((function(t){return e.weightMap[t].forEach((function(e){return e.dispose()}))}))}},{key:"checkInputShapeAndType",value:function(e){var t=this;Object.keys(e).forEach((function(n){var a=e[n],i=Object(h.g)(n),o=Object(l.a)(i,1)[0],s=t.graph.nodes[o];if(s.attrParams.shape&&s.attrParams.shape.value){var c=s.attrParams.shape.value,u=c.length===a.shape.length&&a.shape.every((function(e,t){return-1===c[t]||c[t]===e}));r.Ld.assert(u,(function(){return"The shape of dict['".concat(s.name,"'] provided in ")+"model.execute(dict) must be [".concat(c,"], but was ")+"[".concat(a.shape,"]")}))}s.attrParams.dtype&&s.attrParams.dtype.value&&r.Ld.assert(a.dtype===s.attrParams.dtype.value,(function(){return"The dtype of dict['".concat(s.name,"'] provided in ")+"model.execute(dict) must be "+"".concat(s.attrParams.dtype.value,", but was ").concat(a.dtype)}))}))}},{key:"mapInputs",value:function(e){var t={};for(var n in e){if(null!=this._signature&&null!=this._signature.inputs&&null!=this._signature.inputs[n])t[this._signature.inputs[n].name]=e[n];else t[n]=e[n]}return t}},{key:"checkInputs",value:function(e){var t=this,n=Object.keys(e).filter((function(e){var n=Object(h.g)(e),r=Object(l.a)(n,1)[0];return null==t.graph.nodes[r]}));if(n.length>0)throw new Error("The dict provided in model.execute(dict) has "+"keys: [".concat(n,"] that are not part of graph"))}},{key:"mapOutputs",value:function(e){var t=this;return e.map((function(e){return null!=t._signature&&null!=t._signature.outputs&&null!=t._signature.outputs[e]?t._signature.outputs[e].name:e}),{})}},{key:"checkOutputs",value:function(e){var t=this;e.forEach((function(e){var n=Object(h.g)(e),r=Object(l.a)(n,1)[0];if(!t.graph.nodes[r])throw new Error("The output '".concat(e,"' is not found in the graph"))}))}}]),e}(),mn=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(s.a)(this,e),this.hashTableNameToHandle=t,this.hashTableMap=n}return Object(c.a)(e,[{key:"addHashTable",value:function(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}},{key:"getHashTableHandleByName",value:function(e){return this.hashTableNameToHandle[e]}},{key:"getHashTableById",value:function(e){return this.hashTableMap[e]}},{key:"dispose",value:function(){for(var e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(var t in this.hashTableNameToHandle)this.hashTableNameToHandle[t].dispose(),delete this.hashTableNameToHandle[t]}}]),e}(),vn="?tfjs-format=file",gn="model.json",bn=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(s.a)(this,e),this.modelUrl=t,this.loadOptions=n,this.version="n/a",null==n&&(this.loadOptions={}),this.resourceManager=new mn}return Object(c.a)(e,[{key:"modelVersion",get:function(){return this.version}},{key:"inputNodes",get:function(){return this.executor.inputNodes}},{key:"outputNodes",get:function(){return this.executor.outputNodes}},{key:"inputs",get:function(){return this.executor.inputs}},{key:"outputs",get:function(){return this.executor.outputs}},{key:"weights",get:function(){return this.executor.weightMap}},{key:"metadata",get:function(){return this.artifacts.userDefinedMetadata}},{key:"modelSignature",get:function(){return this.signature}},{key:"findIOHandler",value:function(){var e=this.modelUrl;if(null!=e.load)this.handler=e;else if(null!=this.loadOptions.requestInit)this.handler=r.qd.browserHTTPRequest(e,this.loadOptions);else{var t=r.qd.getLoadHandlers(e,this.loadOptions);if(0===t.length)t.push(r.qd.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error("Found more than one (".concat(t.length,") load handlers for ")+"URL '".concat([e],"'"));this.handler=t[0]}}},{key:"load",value:function(){var e=Object(o.a)(i.a.mark((function e(){var t;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.findIOHandler(),null!=this.handler.load){e.next=3;break}throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");case 3:return e.next=5,this.handler.load();case 5:return t=e.sent,e.abrupt("return",this.loadSync(t));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadSync",value:function(e){this.artifacts=e;var t,n=this.artifacts.modelTopology;t=null!=this.artifacts.userDefinedMetadata&&null!=this.artifacts.userDefinedMetadata.signature?this.artifacts.userDefinedMetadata.signature:this.artifacts.signature,this.signature=t,this.version="".concat(n.versions.producer,".").concat(n.versions.minConsumer);var a=r.qd.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new pn(u.a.Instance.transformGraph(n,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(a),this.executor.resourceManager=this.resourceManager,null!=e.modelInitializer&&null!=e.modelInitializer.node){var i=u.a.Instance.transformGraph(e.modelInitializer);this.initializer=new pn(i),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}},{key:"save",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!==typeof t){e.next=9;break}if(0!==(a=r.qd.getSaveHandlers(t)).length){e.next=6;break}throw new Error("Cannot find any save handlers for URL '".concat(t,"'"));case 6:if(!(a.length>1)){e.next=8;break}throw new Error("Found more than one (".concat(a.length,") save handlers for ")+"URL '".concat(t,"'"));case 8:t=a[0];case 9:if(null!=t.save){e.next=11;break}throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");case 11:return e.abrupt("return",t.save(this.artifacts));case 12:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"predict",value:function(e,t){return this.execute(e,this.outputNodes)}},{key:"normalizeInputs",value:function(e){if(!(e instanceof r.Qc)&&!Array.isArray(e))return e;if((e=Array.isArray(e)?e:[e]).length!==this.inputNodes.length)throw new Error("Input tensor count mismatch,"+"the graph model has ".concat(this.inputNodes.length," placeholders, ")+"while there are ".concat(e.length," input tensors."));return this.inputNodes.reduce((function(t,n,r){return t[n]=e[r],t}),{})}},{key:"normalizeOutputs",value:function(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}},{key:"execute",value:function(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);var n=this.executor.execute(e,t);return n.length>1?n:n[0]}},{key:"executeAsync",value:function(){var e=Object(o.a)(i.a.mark((function e(t,n){var r;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.normalizeInputs(t),n=this.normalizeOutputs(n),e.next=4,this.executor.executeAsync(t,n);case 4:return r=e.sent,e.abrupt("return",r.length>1?r:r[0]);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"convertTensorMapToTensorsMap",value:function(e){return Object.keys(e).reduce((function(t,n){return t[n]=[e[n]],t}),{})}},{key:"dispose",value:function(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}]),e}();function yn(e){return xn.apply(this,arguments)}function xn(){return(xn=Object(o.a)(i.a.mark((function e(t){var n,r,a=arguments;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=a.length>1&&void 0!==a[1]?a[1]:{},null!=t){e.next=3;break}throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");case 3:return null==n&&(n={}),n.fromTFHub&&null==t.load&&(t.endsWith("/")||(t+="/"),t="".concat(t).concat(gn).concat(vn)),r=new bn(t,n),e.next=8,r.load();case 8:return e.abrupt("return",r);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var wn=function(){return(wn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function On(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))}function An(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((a=(a=o.trys).length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}function _n(e,t,n,r){return new(n||(n=Promise))((function(a,i){function o(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))}function En(e,t){var n,r,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(a=2&i[0]?r.return:i[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,i[1])).done)return a;switch(r=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=(a=o.trys).length>0&&a[a.length-1])&&(6===i[0]||2===i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],r=0}finally{n=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}var Sn=function(e){return{startEndTensor:e,startPoint:Object(r.zd)(e,[0,0],[-1,2]),endPoint:Object(r.zd)(e,[0,2],[-1,2])}},Cn={strides:[8,16],anchors:[2,6]};function Tn(e,t){var n,a,i;if(e.topLeft instanceof r.Qc&&e.bottomRight instanceof r.Qc){var o=Object(r.Id)((function(){return[Object(r.hd)([Object(r.zd)(Object(r.Dd)(t-1,e.topLeft),0,1),Object(r.zd)(e.topLeft,1,1)]),Object(r.hd)([Object(r.Dd)(t-1,Object(r.zd)(e.bottomRight,0,1)),Object(r.zd)(e.bottomRight,1,1)])]}));n=o[0],a=o[1],null!=e.landmarks&&(i=Object(r.Id)((function(){var n=Object(r.Dd)(Object(r.Gd)([t-1,0]),e.landmarks),a=Object(r.Gd)([1,-1]);return Object(r.td)(n,a)})))}else{var s=e.topLeft,c=s[0],u=s[1],l=e.bottomRight,d=l[0],h=l[1];n=[t-1-c,u],a=[t-1-d,h],null!=e.landmarks&&(i=e.landmarks.map((function(e){return[t-1-e[0],e[1]]})))}var f={topLeft:n,bottomRight:a};return null!=i&&(f.landmarks=i),null!=e.probability&&(f.probability=e.probability instanceof r.Qc?e.probability.clone():e.probability),f}function Mn(e,t){return Object(r.Id)((function(){var n;return n=e.hasOwnProperty("box")?e.box:e,Object(r.Bd)(function(e,t){var n=Object(r.td)(e.startPoint,t),a=Object(r.td)(e.endPoint,t),i=Object(r.id)([n,a],1);return Sn(i)}(n,t).startEndTensor)}))}var kn=function(){function e(e,t,n,a,i,o){this.blazeFaceModel=e,this.width=t,this.height=n,this.maxFaces=a,this.anchorsData=function(e,t,n){for(var r=[],a=0;a<n.strides.length;a++)for(var i=n.strides[a],o=Math.floor((t+i-1)/i),s=Math.floor((e+i-1)/i),c=n.anchors[a],u=0;u<o;u++)for(var l=i*(u+.5),d=0;d<s;d++)for(var h=i*(d+.5),f=0;f<c;f++)r.push([h,l]);return r}(t,n,Cn),this.anchors=Object(r.Hd)(this.anchorsData),this.inputSizeData=[t,n],this.inputSize=Object(r.Gd)([t,n]),this.iouThreshold=i,this.scoreThreshold=o}return e.prototype.getBoundingBoxes=function(e,t,n){return void 0===n&&(n=!0),_n(this,void 0,void 0,(function(){var a,i,o,s,c,u,l,d,h,f,p,m,v,g,b=this;return En(this,(function(y){switch(y.label){case 0:return a=Object(r.Id)((function(){var t=r.pd.resizeBilinear(e,[b.width,b.height]),n=Object(r.td)(Object(r.Dd)(Object(r.kd)(t,255),.5),2),a=b.blazeFaceModel.predict(n),i=Object(r.Bd)(a),o=function(e,t,n){var a=Object(r.zd)(e,[0,1],[-1,2]),i=Object(r.bd)(a,t),o=Object(r.zd)(e,[0,3],[-1,2]),s=Object(r.kd)(o,n),c=Object(r.kd)(i,n),u=Object(r.kd)(s,2),l=Object(r.Dd)(c,u),d=Object(r.bd)(c,u),h=Object(r.td)(l,n),f=Object(r.td)(d,n);return Object(r.id)([h,f],1)}(i,b.anchors,b.inputSize),s=Object(r.zd)(i,[0,0],[-1,1]);return[i,o,Object(r.Bd)(Object(r.yd)(s))]})),i=a[0],o=a[1],s=a[2],c=console.warn,console.warn=function(){},u=r.pd.nonMaxSuppression(o,s,this.maxFaces,this.iouThreshold,this.scoreThreshold),console.warn=c,[4,u.array()];case 1:return l=y.sent(),u.dispose(),d=l.map((function(e){return Object(r.zd)(o,[e,0],[1,-1])})),t?[3,3]:[4,Promise.all(d.map((function(e){return _n(b,void 0,void 0,(function(){var t;return En(this,(function(n){switch(n.label){case 0:return[4,e.array()];case 1:return t=n.sent(),e.dispose(),[2,t]}}))}))})))];case 2:d=y.sent(),y.label=3;case 3:for(h=e.shape[1],f=e.shape[2],p=t?Object(r.kd)([f,h],this.inputSize):[f/this.inputSizeData[0],h/this.inputSizeData[1]],m=[],v=function(e){var a=d[e],o=Object(r.Id)((function(){var o=Sn(a instanceof r.Qc?a:Object(r.Hd)(a));if(!n)return o;var c,u=l[e];return c=t?Object(r.zd)(b.anchors,[u,0],[1,2]):b.anchorsData[u],{box:o,landmarks:Object(r.wd)(Object(r.Bd)(Object(r.zd)(i,[u,5],[1,-1])),[6,-1]),probability:Object(r.zd)(s,[u],[1]),anchor:c}}));m.push(o)},g=0;g<d.length;g++)v(g);return o.dispose(),s.dispose(),i.dispose(),[2,{boxes:m,scaleFactor:p}]}}))}))},e.prototype.estimateFaces=function(e,t,n,a){return void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===a&&(a=!0),_n(this,void 0,void 0,(function(){var i,o,s,c,u,l,d=this;return En(this,(function(h){switch(h.label){case 0:return i=function(e){return e instanceof r.Qc?[e.shape[0],e.shape[1]]:[e.height,e.width]}(e),o=i[1],s=Object(r.Id)((function(){return e instanceof r.Qc||(e=r.dd.fromPixels(e)),Object(r.nd)(Object(r.fd)(e,"float32"),0)})),[4,this.getBoundingBoxes(s,t,a)];case 1:return c=h.sent(),u=c.boxes,l=c.scaleFactor,s.dispose(),t?[2,u.map((function(e){var t=Mn(e,l),i={topLeft:Object(r.zd)(t,[0],[2]),bottomRight:Object(r.zd)(t,[2],[2])};if(a){var s=e,c=s.landmarks,u=s.probability,d=s.anchor,h=Object(r.td)(Object(r.bd)(c,d),l);i.landmarks=h,i.probability=u}return n&&(i=Tn(i,o)),i}))]:[2,Promise.all(u.map((function(e){return _n(d,void 0,void 0,(function(){var t,r,i,s,c,u,d,h,f,p,m,v=this;return En(this,(function(g){switch(g.label){case 0:return t=Mn(e,l),a?[3,2]:[4,t.array()];case 1:return c=g.sent(),r={topLeft:c.slice(0,2),bottomRight:c.slice(2)},[3,4];case 2:return[4,Promise.all([e.landmarks,t,e.probability].map((function(e){return _n(v,void 0,void 0,(function(){return En(this,(function(t){return[2,e.array()]}))}))})))];case 3:i=g.sent(),s=i[0],c=i[1],u=i[2],d=e.anchor,f=(h=l)[0],p=h[1],m=s.map((function(e){return[(e[0]+d[0])*f,(e[1]+d[1])*p]})),r={topLeft:c.slice(0,2),bottomRight:c.slice(2),landmarks:m,probability:u},function(e){e.startEndTensor.dispose(),e.startPoint.dispose(),e.endPoint.dispose()}(e.box),e.landmarks.dispose(),e.probability.dispose(),g.label=4;case 4:return t.dispose(),n&&(r=Tn(r,o)),[2,r]}}))}))})))]}}))}))},e}();function Rn(e){var t=void 0===e?{}:e,n=t.maxFaces,r=void 0===n?10:n,a=t.inputWidth,i=void 0===a?128:a,o=t.inputHeight,s=void 0===o?128:o,c=t.iouThreshold,u=void 0===c?.3:c,l=t.scoreThreshold,d=void 0===l?.75:l,h=t.modelUrl;return _n(this,void 0,void 0,(function(){var e;return En(this,(function(t){switch(t.label){case 0:return null==h?[3,2]:[4,yn(h)];case 1:return e=t.sent(),[3,4];case 2:return[4,yn("https://tfhub.dev/tensorflow/tfjs-model/blazeface/1/default/1",{fromTFHub:!0})];case 3:e=t.sent(),t.label=4;case 4:return[2,new kn(e,i,s,r,u,d)]}}))}))}var In={silhouette:[10,338,297,332,284,251,389,356,454,323,361,288,397,365,379,378,400,377,152,148,176,149,150,136,172,58,132,93,234,127,162,21,54,103,67,109],lipsUpperOuter:[61,185,40,39,37,0,267,269,270,409,291],lipsLowerOuter:[146,91,181,84,17,314,405,321,375,291],lipsUpperInner:[78,191,80,81,82,13,312,311,310,415,308],lipsLowerInner:[78,95,88,178,87,14,317,402,318,324,308],rightEyeUpper0:[246,161,160,159,158,157,173],rightEyeLower0:[33,7,163,144,145,153,154,155,133],rightEyeUpper1:[247,30,29,27,28,56,190],rightEyeLower1:[130,25,110,24,23,22,26,112,243],rightEyeUpper2:[113,225,224,223,222,221,189],rightEyeLower2:[226,31,228,229,230,231,232,233,244],rightEyeLower3:[143,111,117,118,119,120,121,128,245],rightEyebrowUpper:[156,70,63,105,66,107,55,193],rightEyebrowLower:[35,124,46,53,52,65],rightEyeIris:[473,474,475,476,477],leftEyeUpper0:[466,388,387,386,385,384,398],leftEyeLower0:[263,249,390,373,374,380,381,382,362],leftEyeUpper1:[467,260,259,257,258,286,414],leftEyeLower1:[359,255,339,254,253,252,256,341,463],leftEyeUpper2:[342,445,444,443,442,441,413],leftEyeLower2:[446,261,448,449,450,451,452,453,464],leftEyeLower3:[372,340,346,347,348,349,350,357,465],leftEyebrowUpper:[383,300,293,334,296,336,285,417],leftEyebrowLower:[265,353,276,283,282,295],leftEyeIris:[468,469,470,471,472],midwayBetweenEyes:[168],noseTip:[1],noseBottom:[2],noseRightCorner:[98],noseLeftCorner:[327],rightCheek:[205],leftCheek:[425]};function jn(e){return[Math.abs(e.endPoint[0]-e.startPoint[0]),Math.abs(e.endPoint[1]-e.startPoint[1])]}function Bn(e){return[e.startPoint[0]+(e.endPoint[0]-e.startPoint[0])/2,e.startPoint[1]+(e.endPoint[1]-e.startPoint[1])/2]}function Ln(e,t){void 0===t&&(t=1.5);var n=Bn(e),r=jn(e),a=[t*r[0]/2,t*r[1]/2];return{startPoint:[n[0]-a[0],n[1]-a[1]],endPoint:[n[0]+a[0],n[1]+a[1]],landmarks:e.landmarks}}function Nn(e){var t=Bn(e),n=jn(e),r=Math.max.apply(Math,n)/2;return{startPoint:[t[0]-r,t[1]-r],endPoint:[t[0]+r,t[1]+r],landmarks:e.landmarks}}var Dn=[[1,0,0],[0,1,0],[0,0,1]];function Pn(e,t){return[[1,0,e],[0,1,t],[0,0,1]]}function Fn(e,t){for(var n=0,r=0;r<e.length;r++)n+=e[r]*t[r];return n}function Gn(e,t){for(var n=[],r=0;r<e.length;r++)n.push(e[r][t]);return n}function Un(e,t){for(var n=[],r=e.length,a=0;a<r;a++){n.push([]);for(var i=0;i<r;i++)n[a].push(Fn(e[a],Gn(t,i)))}return n}function zn(e,t){var n=Math.cos(e),r=Math.sin(e),a=[[n,-r,0],[r,n,0],[0,0,1]],i=Un(Pn(t[0],t[1]),a);return Un(i,Pn(-t[0],-t[1]))}var Hn=[13,In.midwayBetweenEyes[0]],Vn=[3,2],Wn=In.leftEyeLower0,Jn=[Wn[0],Wn[Wn.length-1]],Xn=In.rightEyeLower0,Kn=[Xn[0],Xn[Xn.length-1]],qn=[{key:"EyeUpper0",indices:[9,10,11,12,13,14,15]},{key:"EyeUpper1",indices:[25,26,27,28,29,30,31]},{key:"EyeUpper2",indices:[41,42,43,44,45,46,47]},{key:"EyeLower0",indices:[0,1,2,3,4,5,6,7,8]},{key:"EyeLower1",indices:[16,17,18,19,20,21,22,23,24]},{key:"EyeLower2",indices:[32,33,34,35,36,37,38,39,40]},{key:"EyeLower3",indices:[54,55,56,57,58,59,60,61,62]},{key:"EyebrowUpper",indices:[63,64,65,66,67,68,69,70]},{key:"EyebrowLower",indices:[48,49,50,51,52,53]}];function Yn(e,t,n,r){for(var a=0;a<qn.length;a++){var i=qn[a],o=i.key,s=i.indices,c=In[""+n+o];if(null==r||r.includes(o))for(var u=0;u<s.length;u++){var l=s[u];e[c[u]]=[t[l][0],t[l][1],(t[l][2]+e[c[u]][2])/2]}}}var Qn=function(){function e(e,t,n,r,a,i,o){this.regionsOfInterest=[],this.runsWithoutFaceDetector=0,this.boundingBoxDetector=e,this.meshDetector=t,this.irisModel=o,this.meshWidth=n,this.meshHeight=r,this.maxContinuousChecks=a,this.maxFaces=i}return e.prototype.transformRawCoords=function(e,t,n,r){var a,i,o,s,c=this,u=jn({startPoint:t.startPoint,endPoint:t.endPoint}),l=[u[0]/this.meshWidth,u[1]/this.meshHeight],d=e.map((function(e){return[l[0]*(e[0]-c.meshWidth/2),l[1]*(e[1]-c.meshHeight/2),e[2]]})),h=zn(n,[0,0]),f=d.map((function(e){return function(e,t){return[Fn(e,t[0]),Fn(e,t[1])]}(e,h).concat([e[2]])})),p=(i=[[(a=r)[0][0],a[1][0]],[a[0][1],a[1][1]]],o=[a[0][2],a[1][2]],s=[-Fn(i[0],o),-Fn(i[1],o)],[i[0].concat(s[0]),i[1].concat(s[1]),[0,0,1]]),m=Bn({startPoint:t.startPoint,endPoint:t.endPoint}).concat([1]),v=[Fn(m,p[0]),Fn(m,p[1])];return f.map((function(e){return[e[0]+v[0],e[1]+v[1],e[2]]}))},e.prototype.getLeftToRightEyeDepthDifference=function(e){return e[Jn[0]][2]-e[Kn[0]][2]},e.prototype.getEyeBox=function(e,t,n,a,i){void 0===i&&(i=!1);var o=Nn(Ln(this.calculateLandmarksBoundingBox([e[n],e[a]]),2.3)),s=jn(o),c=r.pd.cropAndResize(t,[[o.startPoint[1]/this.meshHeight,o.startPoint[0]/this.meshWidth,o.endPoint[1]/this.meshHeight,o.endPoint[0]/this.meshWidth]],[0],[64,64]);return i&&(c=r.pd.flipLeftRight(c)),{box:o,boxSize:s,crop:c}},e.prototype.getEyeCoords=function(e,t,n,r){void 0===r&&(r=!1);for(var a=[],i=0;i<76;i++){var o=e[3*i],s=e[3*i+1],c=e[3*i+2];a.push([(r?1-o/64:o/64)*n[0]+t.startPoint[0],s/64*n[1]+t.startPoint[1],c])}return{rawCoords:a,iris:a.slice(71)}},e.prototype.getAdjustedIrisCoords=function(e,t,n){var r=e[In[n+"EyeUpper0"][3]][2],a=e[In[n+"EyeLower0"][4]][2],i=(r+a)/2;return t.map((function(e,t){var n=i;return 2===t?n=r:4===t&&(n=a),[e[0],e[1],n]}))},e.prototype.predict=function(e,t){return On(this,void 0,void 0,(function(){var n,a,i,o,s=this;return An(this,(function(c){switch(c.label){case 0:return this.shouldUpdateRegionsOfInterest()?[4,this.boundingBoxDetector.getBoundingBoxes(e,!1,!0)]:[3,2];case 1:return n=c.sent(),a=n.boxes,i=n.scaleFactor,0===a.length?(this.regionsOfInterest=[],[2,null]):(o=a.map((function(e){var t,n,a={startPoint:Object(r.Bd)(e.box.startPoint).arraySync(),endPoint:Object(r.Bd)(e.box.endPoint).arraySync()},o=Nn(Ln((n=i,{startPoint:[(t=a).startPoint[0]*n[0],t.startPoint[1]*n[1]],endPoint:[t.endPoint[0]*n[0],t.endPoint[1]*n[1]]})));return wn({},o,{landmarks:e.landmarks.arraySync()})})),a.forEach((function(e){null!=e&&null!=e.startPoint&&(e.startEndTensor.dispose(),e.startPoint.dispose(),e.endPoint.dispose())})),this.updateRegionsOfInterest(o),this.runsWithoutFaceDetector=0,[3,3]);case 2:this.runsWithoutFaceDetector++,c.label=3;case 3:return[2,Object(r.Id)((function(){return s.regionsOfInterest.map((function(n,a){var i,o=n.landmarks.length>=468,c=Hn[0],u=Hn[1];!1===o&&(c=Vn[0],u=Vn[1]),i=function(e,t){var n;return(n=Math.PI/2-Math.atan2(-(t[1]-e[1]),t[0]-e[0]))-2*Math.PI*Math.floor((n+Math.PI)/(2*Math.PI))}(n.landmarks[c],n.landmarks[u]);var l=Bn({startPoint:n.startPoint,endPoint:n.endPoint}),d=[l[0]/e.shape[2],l[1]/e.shape[1]],h=e,f=Dn;0!==i&&(h=r.pd.rotateWithOffset(e,i,0,d),f=zn(-i,l));var p={startPoint:n.startPoint,endPoint:n.endPoint},m=Object(r.kd)(function(e,t,n){var a=t.shape[1],i=t.shape[2],o=[[e.startPoint[1]/a,e.startPoint[0]/i,e.endPoint[1]/a,e.endPoint[0]/i]];return r.pd.cropAndResize(t,o,[0],n,"bilinear",0)}(p,h,[s.meshHeight,s.meshWidth]),255),v=s.meshDetector.predict(m),g=v[1],b=v[2],y=Object(r.wd)(b,[-1,3]).arraySync();if(t){var x=s.getEyeBox(y,m,Jn[0],Jn[1],!0),w=x.box,O=x.boxSize,A=x.crop,_=s.getEyeBox(y,m,Kn[0],Kn[1]),E=_.box,S=_.boxSize,C=_.crop,T=s.irisModel.predict(Object(r.hd)([A,C])).dataSync(),M=T.slice(0,228),k=s.getEyeCoords(M,w,O,!0),R=k.rawCoords,I=k.iris,j=T.slice(228),B=s.getEyeCoords(j,E,S),L=B.rawCoords,N=B.iris,D=s.getLeftToRightEyeDepthDifference(y);Math.abs(D)<30?(Yn(y,R,"left"),Yn(y,L,"right")):D<1?Yn(y,R,"left",["EyeUpper0","EyeLower0"]):Yn(y,L,"right",["EyeUpper0","EyeLower0"]);var P=s.getAdjustedIrisCoords(y,I,"left"),F=s.getAdjustedIrisCoords(y,N,"right");y=y.concat(P).concat(F)}var G=s.transformRawCoords(y,n,i,f),U=Object(r.Hd)(G),z=Ln(s.calculateLandmarksBoundingBox(G)),H=Nn(z);return s.regionsOfInterest[a]=wn({},H,{landmarks:U.arraySync()}),{coords:Object(r.Hd)(y,[y.length,3]),scaledCoords:U,box:z,flag:Object(r.Bd)(g)}}))}))]}}))}))},e.prototype.updateRegionsOfInterest=function(e){for(var t=0;t<e.length;t++){var n=e[t],r=this.regionsOfInterest[t],a=0;if(r&&r.startPoint){var i=n.startPoint,o=i[0],s=i[1],c=n.endPoint,u=c[0],l=c[1],d=r.startPoint,h=d[0],f=d[1],p=r.endPoint,m=p[0],v=p[1],g=Math.max(o,h),b=Math.max(s,f),y=(Math.min(u,m)-g)*(Math.min(l,v)-b);a=y/((u-o)*(l-s)+(m-h)*(v-s)-y)}a<.25&&(this.regionsOfInterest[t]=n)}this.regionsOfInterest=this.regionsOfInterest.slice(0,e.length)},e.prototype.clearRegionOfInterest=function(e){null!=this.regionsOfInterest[e]&&(this.regionsOfInterest=this.regionsOfInterest.slice(0,e).concat(this.regionsOfInterest.slice(e+1)))},e.prototype.shouldUpdateRegionsOfInterest=function(){var e=this.regionsOfInterest.length,t=0===e;return 1===this.maxFaces||t?t:e!==this.maxFaces&&this.runsWithoutFaceDetector>=this.maxContinuousChecks},e.prototype.calculateLandmarksBoundingBox=function(e){var t=e.map((function(e){return e[0]})),n=e.map((function(e){return e[1]}));return{startPoint:[Math.min.apply(Math,t),Math.min.apply(Math,n)],endPoint:[Math.max.apply(Math,t),Math.max.apply(Math,n)]}},e}(),Zn=[[.499976992607117,.652534008026123],[.500025987625122,.547487020492554],[.499974012374878,.602371990680695],[.482113003730774,.471979022026062],[.500150978565216,.527155995368958],[.499909996986389,.498252987861633],[.499523013830185,.40106201171875],[.289712011814117,.380764007568359],[.499954998493195,.312398016452789],[.499987006187439,.269918978214264],[.500023007392883,.107050001621246],[.500023007392883,.666234016418457],[.5000159740448,.679224014282227],[.500023007392883,.692348003387451],[.499976992607117,.695277988910675],[.499976992607117,.70593398809433],[.499976992607117,.719385027885437],[.499976992607117,.737019002437592],[.499967992305756,.781370997428894],[.499816000461578,.562981009483337],[.473773002624512,.573909997940063],[.104906998574734,.254140973091125],[.365929991006851,.409575998783112],[.338757991790771,.41302502155304],[.311120003461838,.409460008144379],[.274657994508743,.389131009578705],[.393361985683441,.403706014156342],[.345234006643295,.344011008739471],[.370094001293182,.346076011657715],[.319321990013123,.347265005111694],[.297903001308441,.353591024875641],[.24779200553894,.410809993743896],[.396889001131058,.842755019664764],[.280097991228104,.375599980354309],[.106310002505779,.399955987930298],[.2099249958992,.391353011131287],[.355807989835739,.534406006336212],[.471751004457474,.65040397644043],[.474155008792877,.680191993713379],[.439785003662109,.657229006290436],[.414617002010345,.66654098033905],[.450374007225037,.680860996246338],[.428770989179611,.682690978050232],[.374971002340317,.727805018424988],[.486716985702515,.547628998756409],[.485300987958908,.527395009994507],[.257764995098114,.314490020275116],[.401223003864288,.455172002315521],[.429818987846375,.548614978790283],[.421351999044418,.533740997314453],[.276895999908447,.532056987285614],[.483370006084442,.499586999416351],[.33721199631691,.282882988452911],[.296391993761063,.293242990970612],[.169294998049736,.193813979625702],[.447580009698868,.302609980106354],[.392390012741089,.353887975215912],[.354490011930466,.696784019470215],[.067304998636246,.730105042457581],[.442739009857178,.572826027870178],[.457098007202148,.584792017936707],[.381974011659622,.694710969924927],[.392388999462128,.694203019142151],[.277076005935669,.271932005882263],[.422551989555359,.563233017921448],[.385919004678726,.281364023685455],[.383103013038635,.255840003490448],[.331431001424789,.119714021682739],[.229923993349075,.232002973556519],[.364500999450684,.189113974571228],[.229622006416321,.299540996551514],[.173287004232407,.278747975826263],[.472878992557526,.666198015213013],[.446828007698059,.668527007102966],[.422762006521225,.673889994621277],[.445307999849319,.580065965652466],[.388103008270264,.693961024284363],[.403039008378983,.706539988517761],[.403629004955292,.693953037261963],[.460041999816895,.557139039039612],[.431158006191254,.692366003990173],[.452181994915009,.692366003990173],[.475387006998062,.692366003990173],[.465828001499176,.779190003871918],[.472328990697861,.736225962638855],[.473087012767792,.717857003211975],[.473122000694275,.704625964164734],[.473033010959625,.695277988910675],[.427942007780075,.695277988910675],[.426479011774063,.703539967536926],[.423162013292313,.711845993995667],[.4183090031147,.720062971115112],[.390094995498657,.639572978019714],[.013953999616206,.560034036636353],[.499913990497589,.58014702796936],[.413199990987778,.69539999961853],[.409626007080078,.701822996139526],[.468080013990402,.601534962654114],[.422728985548019,.585985004901886],[.463079988956451,.593783974647522],[.37211999297142,.47341400384903],[.334562003612518,.496073007583618],[.411671012639999,.546965003013611],[.242175996303558,.14767599105835],[.290776997804642,.201445996761322],[.327338010072708,.256527006626129],[.399509996175766,.748921036720276],[.441727995872498,.261676013469696],[.429764986038208,.187834024429321],[.412198007106781,.108901023864746],[.288955003023148,.398952007293701],[.218936994671822,.435410976409912],[.41278201341629,.398970007896423],[.257135003805161,.355440020561218],[.427684992551804,.437960982322693],[.448339998722076,.536936044692993],[.178560003638268,.45755398273468],[.247308000922203,.457193970680237],[.286267012357712,.467674970626831],[.332827985286713,.460712015628815],[.368755996227264,.447206974029541],[.398963987827301,.432654976844788],[.476410001516342,.405806005001068],[.189241006970406,.523923993110657],[.228962004184723,.348950982093811],[.490725994110107,.562400996685028],[.404670000076294,.485132992267609],[.019469000399113,.401564002037048],[.426243007183075,.420431017875671],[.396993011236191,.548797011375427],[.266469985246658,.376977026462555],[.439121007919312,.51895797252655],[.032313998788595,.644356966018677],[.419054001569748,.387154996395111],[.462783008813858,.505746960639954],[.238978996872902,.779744982719421],[.198220998048782,.831938028335571],[.107550002634525,.540755033493042],[.183610007166862,.740257024765015],[.134409993886948,.333683013916016],[.385764002799988,.883153975009918],[.490967005491257,.579378008842468],[.382384985685349,.508572995662689],[.174399003386497,.397670984268188],[.318785011768341,.39623498916626],[.343364000320435,.400596976280212],[.396100014448166,.710216999053955],[.187885001301765,.588537991046906],[.430987000465393,.944064974784851],[.318993002176285,.898285031318665],[.266247987747192,.869701027870178],[.500023007392883,.190576016902924],[.499976992607117,.954452991485596],[.366169989109039,.398822009563446],[.393207013607025,.39553701877594],[.410373002290726,.391080021858215],[.194993004202843,.342101991176605],[.388664990663528,.362284004688263],[.365961998701096,.355970978736877],[.343364000320435,.355356991291046],[.318785011768341,.35834002494812],[.301414996385574,.363156020641327],[.058132998645306,.319076001644135],[.301414996385574,.387449026107788],[.499987989664078,.618434011936188],[.415838003158569,.624195992946625],[.445681989192963,.566076993942261],[.465844005346298,.620640993118286],[.49992299079895,.351523995399475],[.288718998432159,.819945991039276],[.335278987884521,.852819979190826],[.440512001514435,.902418971061707],[.128294005990028,.791940987110138],[.408771991729736,.373893976211548],[.455606997013092,.451801002025604],[.499877005815506,.908990025520325],[.375436991453171,.924192011356354],[.11421000212431,.615022003650665],[.448662012815475,.695277988910675],[.4480200111866,.704632043838501],[.447111994028091,.715808033943176],[.444831997156143,.730794012546539],[.430011987686157,.766808986663818],[.406787008047104,.685672998428345],[.400738000869751,.681069016456604],[.392399996519089,.677703022956848],[.367855995893478,.663918972015381],[.247923001646996,.601333022117615],[.452769994735718,.420849978923798],[.43639200925827,.359887003898621],[.416164010763168,.368713974952698],[.413385987281799,.692366003990173],[.228018000721931,.683571994304657],[.468268007040024,.352671027183533],[.411361992359161,.804327011108398],[.499989002943039,.469825029373169],[.479153990745544,.442654013633728],[.499974012374878,.439637005329132],[.432112008333206,.493588984012604],[.499886006116867,.866917014122009],[.49991300702095,.821729004383087],[.456548988819122,.819200992584229],[.344549000263214,.745438992977142],[.37890899181366,.574010014533997],[.374292999505997,.780184984207153],[.319687992334366,.570737957954407],[.357154995203018,.604269981384277],[.295284003019333,.621580958366394],[.447750002145767,.862477004528046],[.410986006259918,.508723020553589],[.31395098567009,.775308012962341],[.354128003120422,.812552988529205],[.324548006057739,.703992962837219],[.189096003770828,.646299958229065],[.279776990413666,.71465802192688],[.1338230073452,.682700991630554],[.336768001317978,.644733011722565],[.429883986711502,.466521978378296],[.455527991056442,.548622965812683],[.437114000320435,.558896005153656],[.467287987470627,.529924988746643],[.414712011814117,.335219979286194],[.37704598903656,.322777986526489],[.344107985496521,.320150971412659],[.312875986099243,.32233202457428],[.283526003360748,.333190023899078],[.241245999932289,.382785975933075],[.102986000478268,.468762993812561],[.267612010240555,.424560010433197],[.297879010438919,.433175981044769],[.333433985710144,.433878004550934],[.366427004337311,.426115989685059],[.396012008190155,.416696012020111],[.420121014118195,.41022801399231],[.007561000064015,.480777025222778],[.432949006557465,.569517970085144],[.458638995885849,.479089021682739],[.473466008901596,.545744001865387],[.476087987422943,.563830018043518],[.468472003936768,.555056989192963],[.433990985155106,.582361996173859],[.483518004417419,.562983989715576],[.482482999563217,.57784903049469],[.42645001411438,.389798998832703],[.438998997211456,.39649498462677],[.450067013502121,.400434017181396],[.289712011814117,.368252992630005],[.276670008897781,.363372981548309],[.517862021923065,.471948027610779],[.710287988185883,.380764007568359],[.526226997375488,.573909997940063],[.895093023777008,.254140973091125],[.634069979190826,.409575998783112],[.661242008209229,.41302502155304],[.688880026340485,.409460008144379],[.725341975688934,.389131009578705],[.606630027294159,.40370500087738],[.654766023159027,.344011008739471],[.629905998706818,.346076011657715],[.680678009986877,.347265005111694],[.702096998691559,.353591024875641],[.75221198797226,.410804986953735],[.602918028831482,.842862963676453],[.719901978969574,.375599980354309],[.893692970275879,.399959981441498],[.790081977844238,.391354024410248],[.643998026847839,.534487962722778],[.528249025344849,.65040397644043],[.525849997997284,.680191040039062],[.560214996337891,.657229006290436],[.585384011268616,.66654098033905],[.549625992774963,.680860996246338],[.57122802734375,.682691991329193],[.624852001667023,.72809898853302],[.513050019741058,.547281980514526],[.51509702205658,.527251958847046],[.742246985435486,.314507007598877],[.598631024360657,.454979002475739],[.570338010787964,.548575043678284],[.578631997108459,.533622980117798],[.723087012767792,.532054007053375],[.516445994377136,.499638974666595],[.662801027297974,.282917976379395],[.70362401008606,.293271005153656],[.830704987049103,.193813979625702],[.552385985851288,.302568018436432],[.607609987258911,.353887975215912],[.645429015159607,.696707010269165],[.932694971561432,.730105042457581],[.557260990142822,.572826027870178],[.542901992797852,.584792017936707],[.6180260181427,.694710969924927],[.607590973377228,.694203019142151],[.722943007946014,.271963000297546],[.577413976192474,.563166975975037],[.614082992076874,.281386971473694],[.616907000541687,.255886018276215],[.668509006500244,.119913995265961],[.770092010498047,.232020974159241],[.635536015033722,.189248979091644],[.77039098739624,.299556016921997],[.826722025871277,.278755009174347],[.527121007442474,.666198015213013],[.553171992301941,.668527007102966],[.577238023281097,.673889994621277],[.554691970348358,.580065965652466],[.611896991729736,.693961024284363],[.59696102142334,.706539988517761],[.596370995044708,.693953037261963],[.539958000183105,.557139039039612],[.568841993808746,.692366003990173],[.547818005084991,.692366003990173],[.52461302280426,.692366003990173],[.534089982509613,.779141008853912],[.527670979499817,.736225962638855],[.526912987232208,.717857003211975],[.526877999305725,.704625964164734],[.526966989040375,.695277988910675],[.572058022022247,.695277988910675],[.573521018028259,.703539967536926],[.57683801651001,.711845993995667],[.581691026687622,.720062971115112],[.609944999217987,.639909982681274],[.986046016216278,.560034036636353],[.5867999792099,.69539999961853],[.590372025966644,.701822996139526],[.531915009021759,.601536989212036],[.577268004417419,.585934996604919],[.536915004253387,.593786001205444],[.627542972564697,.473352015018463],[.665585994720459,.495950996875763],[.588353991508484,.546862006187439],[.757824003696442,.14767599105835],[.709249973297119,.201507985591888],[.672684013843536,.256581008434296],[.600408971309662,.74900496006012],[.55826598405838,.261672019958496],[.570303976535797,.187870979309082],[.588165998458862,.109044015407562],[.711045026779175,.398952007293701],[.781069993972778,.435405015945435],[.587247014045715,.398931980133057],[.742869973182678,.355445981025696],[.572156012058258,.437651991844177],[.55186802148819,.536570012569427],[.821442008018494,.457556009292603],[.752701997756958,.457181990146637],[.71375697851181,.467626988887787],[.66711300611496,.460672974586487],[.631101012229919,.447153985500336],[.6008620262146,.432473003864288],[.523481011390686,.405627012252808],[.810747981071472,.523926019668579],[.771045982837677,.348959028720856],[.509127020835876,.562718033790588],[.595292985439301,.485023975372314],[.980530977249146,.401564002037048],[.573499977588654,.420000016689301],[.602994978427887,.548687994480133],[.733529984951019,.376977026462555],[.560611009597778,.519016981124878],[.967685997486115,.644356966018677],[.580985009670258,.387160003185272],[.537728011608124,.505385041236877],[.760966002941132,.779752969741821],[.801778972148895,.831938028335571],[.892440974712372,.54076099395752],[.816350996494293,.740260004997253],[.865594983100891,.333687007427216],[.614073991775513,.883246004581451],[.508952975273132,.579437971115112],[.617941975593567,.508316040039062],[.825608015060425,.397674977779388],[.681214988231659,.39623498916626],[.656635999679565,.400596976280212],[.603900015354156,.710216999053955],[.81208598613739,.588539004325867],[.56801301240921,.944564998149872],[.681007981300354,.898285031318665],[.733752012252808,.869701027870178],[.633830010890961,.398822009563446],[.606792986392975,.39553701877594],[.589659988880157,.391062021255493],[.805015981197357,.342108011245728],[.611334979534149,.362284004688263],[.634037971496582,.355970978736877],[.656635999679565,.355356991291046],[.681214988231659,.35834002494812],[.698584973812103,.363156020641327],[.941866993904114,.319076001644135],[.698584973812103,.387449026107788],[.584177017211914,.624107003211975],[.554318010807037,.566076993942261],[.534153997898102,.62064003944397],[.711217999458313,.819975018501282],[.664629995822906,.852871000766754],[.559099972248077,.902631998062134],[.871706008911133,.791940987110138],[.591234028339386,.373893976211548],[.544341027736664,.451583981513977],[.624562978744507,.924192011356354],[.88577002286911,.615028977394104],[.551338016986847,.695277988910675],[.551980018615723,.704632043838501],[.552887976169586,.715808033943176],[.555167973041534,.730794012546539],[.569944024085999,.767035007476807],[.593203008174896,.685675978660583],[.599261999130249,.681069016456604],[.607599973678589,.677703022956848],[.631937980651855,.663500010967255],[.752032995223999,.601315021514893],[.547226011753082,.420395016670227],[.563543975353241,.359827995300293],[.583841025829315,.368713974952698],[.586614012718201,.692366003990173],[.771915018558502,.683578014373779],[.531597018241882,.352482974529266],[.588370978832245,.804440975189209],[.52079701423645,.442565023899078],[.567984998226166,.493479013442993],[.543282985687256,.819254994392395],[.655317008495331,.745514988899231],[.621008992195129,.574018001556396],[.625559985637665,.78031200170517],[.680198013782501,.570719003677368],[.64276397228241,.604337990283966],[.704662978649139,.621529996395111],[.552012026309967,.862591981887817],[.589071989059448,.508637011051178],[.685944974422455,.775357007980347],[.645735025405884,.812640011310577],[.675342977046967,.703978002071381],[.810858011245728,.646304965019226],[.72012197971344,.714666962623596],[.866151988506317,.682704985141754],[.663187026977539,.644596993923187],[.570082008838654,.466325998306274],[.544561982154846,.548375964164734],[.562758982181549,.558784961700439],[.531987011432648,.530140042304993],[.585271000862122,.335177004337311],[.622952997684479,.32277899980545],[.655896008014679,.320163011550903],[.687132000923157,.322345972061157],[.716481983661652,.333200991153717],[.758756995201111,.382786989212036],[.897013008594513,.468769013881683],[.732392013072968,.424547016620636],[.70211398601532,.433162987232208],[.66652500629425,.433866024017334],[.633504986763,.426087975502014],[.603875994682312,.416586995124817],[.579657971858978,.409945011138916],[.992439985275269,.480777025222778],[.567192018032074,.569419980049133],[.54136598110199,.478899002075195],[.526564002037048,.546118021011353],[.523913025856018,.563830018043518],[.531529009342194,.555056989192963],[.566035985946655,.582329034805298],[.51631098985672,.563053965568542],[.5174720287323,.577877044677734],[.573594987392426,.389806985855103],[.560697972774506,.395331978797913],[.549755990505219,.399751007556915],[.710287988185883,.368252992630005],[.723330020904541,.363372981548309]];function $n(e){return On(this,void 0,void 0,(function(){var t,n,r,a,i,o,s,c,u,l,d,h,f,p,m,v;return An(this,(function(g){switch(g.label){case 0:return t=e.maxContinuousChecks,n=void 0===t?5:t,r=e.detectionConfidence,a=void 0===r?.9:r,i=e.maxFaces,o=void 0===i?10:i,s=e.iouThreshold,c=void 0===s?.3:s,u=e.scoreThreshold,l=void 0===u?.75:u,d=e.shouldLoadIrisModel,h=void 0===d||d,f=e.modelUrl,p=e.detectorModelUrl,m=e.irisModelUrl,h?[4,Promise.all([er(p,o,c,l),tr(f),nr(m)])]:[3,2];case 1:return v=g.sent(),[3,4];case 2:return[4,Promise.all([er(p,o,c,l),tr(f)])];case 3:v=g.sent(),g.label=4;case 4:return[2,new ir(v[0],v[1],n,a,o,h?v[2]:null)]}}))}))}function er(e,t,n,r){return On(this,void 0,void 0,(function(){return An(this,(function(a){return[2,Rn({modelUrl:e,maxFaces:t,iouThreshold:n,scoreThreshold:r})]}))}))}function tr(e){return On(this,void 0,void 0,(function(){return An(this,(function(t){return null!=e?[2,yn(e)]:[2,yn("https://tfhub.dev/mediapipe/tfjs-model/facemesh/1/default/1",{fromTFHub:!0})]}))}))}function nr(e){return On(this,void 0,void 0,(function(){return An(this,(function(t){return null!=e?[2,yn(e)]:[2,yn("https://tfhub.dev/mediapipe/tfjs-model/iris/1/default/2",{fromTFHub:!0})]}))}))}function rr(e,t){if(e.mesh instanceof r.Qc){var n=Object(r.Id)((function(){var n=Object(r.Gd)([t-1,0,0]),a=Object(r.Gd)([1,-1,1]);return Object(r.Id)((function(){return[Object(r.hd)([Object(r.Dd)(t-1,Object(r.zd)(e.boundingBox.topLeft,0,1)),Object(r.zd)(e.boundingBox.topLeft,1,1)]),Object(r.hd)([Object(r.Dd)(t-1,Object(r.zd)(e.boundingBox.bottomRight,0,1)),Object(r.zd)(e.boundingBox.bottomRight,1,1)]),Object(r.td)(Object(r.Dd)(n,e.mesh),a),Object(r.td)(Object(r.Dd)(n,e.scaledMesh),a)]}))})),a=n[0],i=n[1],o=n[2],s=n[3];return Object.assign({},e,{boundingBox:{topLeft:a,bottomRight:i},mesh:o,scaledMesh:s})}return Object.assign({},e,{boundingBox:{topLeft:[t-1-e.boundingBox.topLeft[0],e.boundingBox.topLeft[1]],bottomRight:[t-1-e.boundingBox.bottomRight[0],e.boundingBox.bottomRight[1]]},mesh:e.mesh.map((function(e){var n=e.slice(0);return n[0]=t-1-e[0],n})),scaledMesh:e.scaledMesh.map((function(e){var n=e.slice(0);return n[0]=t-1-e[0],n}))})}var ar,ir=function(){function e(e,t,n,r,a,i){this.kind="MediaPipeFaceMesh",this.pipeline=new Qn(e,t,192,192,n,a,i),this.detectionConfidence=r}return e.getAnnotations=function(){return In},e.getUVCoords=function(){return Zn},e.prototype.estimateFaces=function(e){return On(this,void 0,void 0,(function(){var t,n,a,i,o,s,c,u,l,d,h,f,p=this;return An(this,(function(m){switch(m.label){case 0:if(t=e.returnTensors,n=void 0!==t&&t,a=e.flipHorizontal,i=void 0!==a&&a,o=e.predictIrises,s=void 0===o||o,c=e.input,s&&null==this.pipeline.irisModel)throw new Error("The iris model was not loaded as part of facemesh. Please initialize the model with facemesh.load({shouldLoadIrisModel: true}).");return u=function(e){return e instanceof r.Qc?[e.shape[0],e.shape[1]]:[e.height,e.width]}(c),l=u[1],d=Object(r.Id)((function(){return c instanceof r.Qc||(c=r.dd.fromPixels(c)),Object(r.nd)(Object(r.fd)(c,"float32"),0)})),"webgl"!==Object(r.od)()?[3,2]:(f=Object(r.md)().get("WEBGL_PACK_DEPTHWISECONV"),Object(r.md)().set("WEBGL_PACK_DEPTHWISECONV",!0),[4,this.pipeline.predict(d,s)]);case 1:return h=m.sent(),Object(r.md)().set("WEBGL_PACK_DEPTHWISECONV",f),[3,4];case 2:return[4,this.pipeline.predict(d,s)];case 3:h=m.sent(),m.label=4;case 4:return d.dispose(),null!=h&&h.length>0?[2,Promise.all(h.map((function(e,t){return On(p,void 0,void 0,(function(){var a,o,c,u,d,h,f,p,m,v,g,b,y,x,w=this;return An(this,(function(O){switch(O.label){case 0:return a=e.coords,o=e.scaledCoords,c=e.box,u=e.flag,d=[u],n||(d=d.concat([a,o])),[4,Promise.all(d.map((function(e){return On(w,void 0,void 0,(function(){return An(this,(function(t){return[2,e.array()]}))}))})))];case 1:if(h=O.sent(),f=h[0],u.dispose(),f<this.detectionConfidence&&this.pipeline.clearRegionOfInterest(t),n)return p={kind:"MediaPipePredictionTensors",faceInViewConfidence:f,mesh:a,scaledMesh:o,boundingBox:{topLeft:Object(r.Gd)(c.startPoint),bottomRight:Object(r.Gd)(c.endPoint)}},i?[2,rr(p,l)]:[2,p];for(x in m=h.slice(1),v=m[0],g=m[1],o.dispose(),a.dispose(),b={kind:"MediaPipePredictionValues",faceInViewConfidence:f,boundingBox:{topLeft:c.startPoint,bottomRight:c.endPoint},mesh:v,scaledMesh:g},i&&(b=rr(b,l)),y={},In)(s||!1===x.includes("Iris"))&&(y[x]=In[x].map((function(e){return b.scaledMesh[e]})));return b.annotations=y,[2,b]}}))}))})))]:[2,[]]}}))}))},e}();function or(e,t){return void 0===e&&(e=ar.mediapipeFacemesh),void 0===t&&(t={}),On(this,void 0,void 0,(function(){return An(this,(function(n){if(e===ar.mediapipeFacemesh)return[2,$n(t)];throw new Error(e+" is not a valid package name.")}))}))}(ar||(ar={})).mediapipeFacemesh="mediapipe-facemesh"},function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(1),a=n.n(r),i=n(2),o=n(28),s=n(8),c={cover:"cover",contain:"contain"},u=Object(i.css)(["flex:1 1;overflow:hidden;object-fit:",";"],(function(e){return c[e.fit]})),l=i.default.img.withConfig({displayName:"StyledImage",componentId:"ey4zx9-0"})([""," "," "," "," ",""],o.f,(function(e){return e.fit&&u}),(function(e){return e.fillProp&&Object(o.d)(e.fillProp)}),(function(e){return e.theme.image&&e.theme.image.extend}),(function(e){return e.opacityProp&&"opacity: "+(!0===e.opacityProp?e.theme.global.opacity.medium:e.theme.global.opacity[e.opacityProp]||e.opacityProp)+";\n  "}));function d(){return(d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}l.defaultProps={},Object.setPrototypeOf(l.defaultProps,s.a);var h=Object(r.forwardRef)((function(e,t){var n=e.a11yTitle,i=e.fallback,o=e.onError,s=e.opacity,c=e.fill,u=e.src,h=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,["a11yTitle","fallback","onError","opacity","fill","src"]),f=Object(r.useState)(!1),p=f[0],m=f[1],v={onError:(o||i)&&function(e){o&&o(e),m(!0)}};return a.a.createElement(l,d({"aria-label":n},h,v,{ref:t,opacityProp:s,fillProp:c,src:p?i:u}))}));h.displayName="Image";var f=h},,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(68),a=n(12),i=n(4),o=n(1),s=n(180),c=n(181);function u(e,t){var n=Object(o.useRef)(),u=t||n,l=Object(o.useState)((function(){return new s.AnimationMixer(void 0)})),d=Object(a.a)(l,1)[0],h=Object(o.useMemo)((function(){return{ref:u,clips:e,actions:e.reduce((function(e,t){return Object(i.a)({},e,Object(r.a)({},t.name,null))}),{}),names:e.map((function(e){return e.name})),mixer:d}}),[e,d,u]);return Object(c.b)((function(e,t){return d.update(t)})),Object(o.useEffect)((function(){var t=u.current;return t&&e.forEach((function(e){return h.actions[e.name]=d.clipAction(e,t)})),function(){return Object.values(h.actions).forEach((function(e){t&&d.uncacheAction(e,t)}))}}),[h,e,d,t,u]),h}},,,,,function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(181),a=n(180),i=function(e){a.Loader.call(this,e),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}};i.prototype=Object.assign(Object.create(a.Loader.prototype),{constructor:i,setDecoderPath:function(e){return this.decoderPath=e,this},setDecoderConfig:function(e){return this.decoderConfig=e,this},setWorkerLimit:function(e){return this.workerLimit=e,this},setVerbosity:function(){console.warn("THREE.DRACOLoader: The .setVerbosity() method has been removed.")},setDrawMode:function(){console.warn("THREE.DRACOLoader: The .setDrawMode() method has been removed.")},setSkipDequantization:function(){console.warn("THREE.DRACOLoader: The .setSkipDequantization() method has been removed.")},load:function(e,t,n,r){var i=this,o=new a.FileLoader(this.manager);o.setPath(this.path),o.setResponseType("arraybuffer"),o.setRequestHeader(this.requestHeader),o.setWithCredentials(this.withCredentials),o.load(e,(function(e){var n={attributeIDs:i.defaultAttributeIDs,attributeTypes:i.defaultAttributeTypes,useUniqueIDs:!1};i.decodeGeometry(e,n).then(t).catch(r)}),n,r)},decodeDracoFile:function(e,t,n,r){var a={attributeIDs:n||this.defaultAttributeIDs,attributeTypes:r||this.defaultAttributeTypes,useUniqueIDs:!!n};this.decodeGeometry(e,a).then(t)},decodeGeometry:function(e,t){var n=this;for(var r in t.attributeTypes){var a=t.attributeTypes[r];void 0!==a.BYTES_PER_ELEMENT&&(t.attributeTypes[r]=a.name)}var o,s=JSON.stringify(t);if(i.taskCache.has(e)){var c=i.taskCache.get(e);if(c.key===s)return c.promise;if(0===e.byteLength)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}var u=this.workerNextTaskID++,l=e.byteLength,d=this._getWorker(u,l).then((function(n){return o=n,new Promise((function(n,r){o._callbacks[u]={resolve:n,reject:r},o.postMessage({type:"decode",id:u,taskConfig:t,buffer:e},[e])}))})).then((function(e){return n._createGeometry(e.geometry)}));return d.catch((function(){return!0})).then((function(){o&&u&&n._releaseTask(o,u)})),i.taskCache.set(e,{key:s,promise:d}),d},_createGeometry:function(e){var t=new a.BufferGeometry;e.index&&t.setIndex(new a.BufferAttribute(e.index.array,1));for(var n=0;n<e.attributes.length;n++){var r=e.attributes[n],i=r.name,o=r.array,s=r.itemSize;t.setAttribute(i,new a.BufferAttribute(o,s))}return t},_loadLibrary:function(e,t){var n=new a.FileLoader(this.manager);return n.setPath(this.decoderPath),n.setResponseType(t),n.setWithCredentials(this.withCredentials),new Promise((function(t,r){n.load(e,t,void 0,r)}))},preload:function(){return this._initDecoder(),this},_initDecoder:function(){var e=this;if(this.decoderPending)return this.decoderPending;var t="object"!==typeof WebAssembly||"js"===this.decoderConfig.type,n=[];return t?n.push(this._loadLibrary("draco_decoder.js","text")):(n.push(this._loadLibrary("draco_wasm_wrapper.js","text")),n.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(n).then((function(n){var r=n[0];t||(e.decoderConfig.wasmBinary=n[1]);var a=i.DRACOWorker.toString(),o=["/* draco decoder */",r,"","/* worker */",a.substring(a.indexOf("{")+1,a.lastIndexOf("}"))].join("\n");e.workerSourceURL=URL.createObjectURL(new Blob([o]))})),this.decoderPending},_getWorker:function(e,t){var n=this;return this._initDecoder().then((function(){var r;n.workerPool.length<n.workerLimit?((r=new Worker(n.workerSourceURL))._callbacks={},r._taskCosts={},r._taskLoad=0,r.postMessage({type:"init",decoderConfig:n.decoderConfig}),r.onmessage=function(e){var t=e.data;switch(t.type){case"decode":r._callbacks[t.id].resolve(t);break;case"error":r._callbacks[t.id].reject(t);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+t.type+'"')}},n.workerPool.push(r)):n.workerPool.sort((function(e,t){return e._taskLoad>t._taskLoad?-1:1}));return(r=n.workerPool[n.workerPool.length-1])._taskCosts[e]=t,r._taskLoad+=t,r}))},_releaseTask:function(e,t){e._taskLoad-=e._taskCosts[t],delete e._callbacks[t],delete e._taskCosts[t]},debug:function(){console.log("Task load: ",this.workerPool.map((function(e){return e._taskLoad})))},dispose:function(){for(var e=0;e<this.workerPool.length;++e)this.workerPool[e].terminate();return this.workerPool.length=0,this}}),i.DRACOWorker=function(){var e,t;function n(e,t,n,r,a,i){var o=i.num_components(),s=n.num_points()*o,c=s*a.BYTES_PER_ELEMENT,u=function(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32}}(e,a),l=e._malloc(c);t.GetAttributeDataArrayForAllPoints(n,i,u,c,l);var d=new a(e.HEAPF32.buffer,l,s).slice();return e._free(l),{name:r,array:d,itemSize:o}}onmessage=function(r){var a=r.data;switch(a.type){case"init":e=a.decoderConfig,t=new Promise((function(t){e.onModuleLoaded=function(e){t({draco:e})},DracoDecoderModule(e)}));break;case"decode":var i=a.buffer,o=a.taskConfig;t.then((function(e){var t=e.draco,r=new t.Decoder,s=new t.DecoderBuffer;s.Init(new Int8Array(i),i.byteLength);try{var c=function(e,t,r,a){var i,o,s=a.attributeIDs,c=a.attributeTypes,u=t.GetEncodedGeometryType(r);if(u===e.TRIANGULAR_MESH)i=new e.Mesh,o=t.DecodeBufferToMesh(r,i);else{if(u!==e.POINT_CLOUD)throw new Error("THREE.DRACOLoader: Unexpected geometry type.");i=new e.PointCloud,o=t.DecodeBufferToPointCloud(r,i)}if(!o.ok()||0===i.ptr)throw new Error("THREE.DRACOLoader: Decoding failed: "+o.error_msg());var l={index:null,attributes:[]};for(var d in s){var h,f,p=self[c[d]];if(a.useUniqueIDs)f=s[d],h=t.GetAttributeByUniqueId(i,f);else{if(-1===(f=t.GetAttributeId(i,e[s[d]])))continue;h=t.GetAttribute(i,f)}l.attributes.push(n(e,t,i,d,p,h))}u===e.TRIANGULAR_MESH&&(l.index=function(e,t,n){var r=3*n.num_faces(),a=4*r,i=e._malloc(a);t.GetTrianglesUInt32Array(n,a,i);var o=new Uint32Array(e.HEAPF32.buffer,i,r).slice();return e._free(i),{array:o,itemSize:1}}(e,t,i));return e.destroy(i),l}(t,r,s,o),u=c.attributes.map((function(e){return e.array.buffer}));c.index&&u.push(c.index.array.buffer),self.postMessage({type:"decode",id:a.id,geometry:c},u)}catch(l){console.error(l),self.postMessage({type:"error",id:a.id,error:l.message})}finally{t.destroy(s),t.destroy(r)}}))}}},i.taskCache=new WeakMap,i.setDecoderPath=function(){console.warn("THREE.DRACOLoader: The .setDecoderPath() method has been removed. Use instance methods.")},i.setDecoderConfig=function(){console.warn("THREE.DRACOLoader: The .setDecoderConfig() method has been removed. Use instance methods.")},i.releaseDecoderModule=function(){console.warn("THREE.DRACOLoader: The .releaseDecoderModule() method has been removed. Use instance methods.")},i.getDecoderModule=function(){console.warn("THREE.DRACOLoader: The .getDecoderModule() method has been removed. Use instance methods.")};var o=function(){var e=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),t=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]);if("object"!==typeof WebAssembly)return{supported:!1};var n,r="B9h9z9tFBBBF8fL9gBB9gLaaaaaFa9gEaaaB9gFaFa9gEaaaFaEMcBFFFGGGEIIILF9wFFFLEFBFKNFaFCx/IFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBF8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBGy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBEn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBIi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBKI9z9iqlBOc+x8ycGBM/qQFTa8jUUUUBCU/EBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAGTkUUUBRNCUoBAG9uC/wgBZHKCUGAKCUG9JyRVAECFJRICBRcGXEXAcAF9PQFAVAFAclAcAVJAF9JyRMGXGXAG9FQBAMCbJHKC9wZRSAKCIrCEJCGrRQANCUGJRfCBRbAIRTEXGXAOATlAQ9PQBCBRISEMATAQJRIGXAS9FQBCBRtCBREEXGXAOAIlCi9PQBCBRISLMANCU/CBJAEJRKGXGXGXGXGXATAECKrJ2BBAtCKZrCEZfIBFGEBMAKhB83EBAKCNJhB83EBSEMAKAI2BIAI2BBHmCKrHYAYCE6HYy86BBAKCFJAICIJAYJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCGJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCEJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCIJAYAmJHY2BBAI2BFHmCKrHPAPCE6HPy86BBAKCLJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCKJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCOJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCNJAYAmJHY2BBAI2BGHmCKrHPAPCE6HPy86BBAKCVJAYAPJHY2BBAmCIrCEZHPAPCE6HPy86BBAKCcJAYAPJHY2BBAmCGrCEZHPAPCE6HPy86BBAKCMJAYAPJHY2BBAmCEZHmAmCE6Hmy86BBAKCSJAYAmJHm2BBAI2BEHICKrHYAYCE6HYy86BBAKCQJAmAYJHm2BBAICIrCEZHYAYCE6HYy86BBAKCfJAmAYJHm2BBAICGrCEZHYAYCE6HYy86BBAKCbJAmAYJHK2BBAICEZHIAICE6HIy86BBAKAIJRISGMAKAI2BNAI2BBHmCIrHYAYCb6HYy86BBAKCFJAICNJAYJHY2BBAmCbZHmAmCb6Hmy86BBAKCGJAYAmJHm2BBAI2BFHYCIrHPAPCb6HPy86BBAKCEJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCIJAmAYJHm2BBAI2BGHYCIrHPAPCb6HPy86BBAKCLJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCKJAmAYJHm2BBAI2BEHYCIrHPAPCb6HPy86BBAKCOJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCNJAmAYJHm2BBAI2BIHYCIrHPAPCb6HPy86BBAKCVJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCcJAmAYJHm2BBAI2BLHYCIrHPAPCb6HPy86BBAKCMJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCSJAmAYJHm2BBAI2BKHYCIrHPAPCb6HPy86BBAKCQJAmAPJHm2BBAYCbZHYAYCb6HYy86BBAKCfJAmAYJHm2BBAI2BOHICIrHYAYCb6HYy86BBAKCbJAmAYJHK2BBAICbZHIAICb6HIy86BBAKAIJRISFMAKAI8pBB83BBAKCNJAICNJ8pBB83BBAICTJRIMAtCGJRtAECTJHEAS9JQBMMGXAIQBCBRISEMGXAM9FQBANAbJ2BBRtCBRKAfREEXAEANCU/CBJAKJ2BBHTCFrCBATCFZl9zAtJHt86BBAEAGJREAKCFJHKAM9HQBMMAfCFJRfAIRTAbCFJHbAG9HQBMMABAcAG9sJANCUGJAMAG9sTkUUUBpANANCUGJAMCaJAG9sJAGTkUUUBpMAMCBAIyAcJRcAIQBMC9+RKSFMCBC99AOAIlAGCAAGCA9Ly6yRKMALCU/EBJ8kUUUUBAKM+OmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUFT+JUUUBpALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM+lLKFaF99GaG99FaG99GXGXAGCI9HQBAF9FQFEXGXGX9DBBB8/9DBBB+/ABCGJHG1BB+yAB1BBHE+yHI+L+TABCFJHL1BBHK+yHO+L+THN9DBBBB9gHVyAN9DBB/+hANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE86BBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG86BBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG86BBABCIJRBAFCaJHFQBSGMMAF9FQBEXGXGX9DBBB8/9DBBB+/ABCIJHG8uFB+yAB8uFBHE+yHI+L+TABCGJHL8uFBHK+yHO+L+THN9DBBBB9gHVyAN9DB/+g6ANAN+U9DBBBBANAVyHcAc+MHMAECa3yAI+SHIAI+UAcAMAKCa3yAO+SHcAc+U+S+S+R+VHO+U+SHN+L9DBBB9P9d9FQBAN+oRESFMCUUUU94REMAGAE87FBGXGX9DBBB8/9DBBB+/Ac9DBBBB9gyAcAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMALAG87FBGXGX9DBBB8/9DBBB+/AI9DBBBB9gyAIAO+U+SHN+L9DBBB9P9d9FQBAN+oRGSFMCUUUU94RGMABAG87FBABCNJRBAFCaJHFQBMMM/SEIEaE99EaF99GXAF9FQBCBREABRIEXGXGX9D/zI818/AICKJ8uFBHLCEq+y+VHKAI8uFB+y+UHO9DB/+g6+U9DBBB8/9DBBB+/AO9DBBBB9gy+SHN+L9DBBB9P9d9FQBAN+oRVSFMCUUUU94RVMAICIJ8uFBRcAICGJ8uFBRMABALCFJCEZAEqCFWJAV87FBGXGXAKAM+y+UHN9DB/+g6+U9DBBB8/9DBBB+/AN9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRMSFMCUUUU94RMMABALCGJCEZAEqCFWJAM87FBGXGXAKAc+y+UHK9DB/+g6+U9DBBB8/9DBBB+/AK9DBBBB9gy+SHS+L9DBBB9P9d9FQBAS+oRcSFMCUUUU94RcMABALCaJCEZAEqCFWJAc87FBGXGX9DBBU8/AOAO+U+TANAN+U+TAKAK+U+THO9DBBBBAO9DBBBB9gy+R9DB/+g6+U9DBBB8/+SHO+L9DBBB9P9d9FQBAO+oRcSFMCUUUU94RcMABALCEZAEqCFWJAc87FBAICNJRIAECIJREAFCaJHFQBMMM9JBGXAGCGrAF9sHF9FQBEXABAB8oGBHGCNWCN91+yAGCi91CnWCUUU/8EJ+++U84GBABCIJRBAFCaJHFQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEM/lFFFaGXGXAFABqCEZ9FQBABRESFMGXGXAGCT9PQBABRESFMABREEXAEAF8oGBjGBAECIJAFCIJ8oGBjGBAECNJAFCNJ8oGBjGBAECSJAFCSJ8oGBjGBAECTJREAFCTJRFAGC9wJHGCb9LQBMMAGCI9JQBEXAEAF8oGBjGBAFCIJRFAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF2BB86BBAECFJREAFCFJRFAGCaJHGQBMMABMoFFGaGXGXABCEZ9FQBABRESFMAFCgFZC+BwsN9sRIGXGXAGCT9PQBABRESFMABREEXAEAIjGBAECSJAIjGBAECNJAIjGBAECIJAIjGBAECTJREAGC9wJHGCb9LQBMMAGCI9JQBEXAEAIjGBAECIJREAGC98JHGCE9LQBMMGXAG9FQBEXAEAF86BBAECFJREAGCaJHGQBMMABMMMFBCUNMIT9kBB";WebAssembly.validate(e)&&(r="B9h9z9tFBBBFiI9gBB9gLaaaaaFa9gEaaaB9gFaFaEMcBBFBFFGGGEILF9wFFFLEFBFKNFaFCx/aFMO/LFVK9tv9t9vq95GBt9f9f939h9z9t9f9j9h9s9s9f9jW9vq9zBBp9tv9z9o9v9wW9f9kv9j9v9kv9WvqWv94h919m9mvqBG8Z9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv94h919m9mvqBIy9tv9z9o9v9wW9f9kv9j9v9kv9J9u9kv949TvZ91v9u9jvBLn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9P9jWBKi9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9R919hWBOn9tv9z9o9v9wW9f9kv9j9v9kv69p9sWvq9F949wBNI9z9iqlBVc+N9IcIBTEM9+FLa8jUUUUBCTlRBCBRFEXCBRGCBREEXABCNJAGJAECUaAFAGrCFZHIy86BBAEAIJREAGCFJHGCN9HQBMAFCx+YUUBJAE86BBAFCEWCxkUUBJAB8pEN83EBAFCFJHFCUG9HQBMMk8lLbaE97F9+FaL978jUUUUBCU/KBlHL8kUUUUBC9+RKGXAGCFJAI9LQBCaRKAE2BBC+gF9HQBALAEAIJHOAGlAG/8cBBCUoBAG9uC/wgBZHKCUGAKCUG9JyRNAECFJRKCBRVGXEXAVAF9PQFANAFAVlAVANJAF9JyRcGXGXAG9FQBAcCbJHIC9wZHMCE9sRSAMCFWRQAICIrCEJCGrRfCBRbEXAKRTCBRtGXEXGXAOATlAf9PQBCBRKSLMALCU/CBJAtAM9sJRmATAfJRKCBREGXAMCoB9JQBAOAKlC/gB9JQBCBRIEXAmAIJREGXGXGXGXGXATAICKrJ2BBHYCEZfIBFGEBMAECBDtDMIBSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIBAKCTJRKMGXGXGXGXGXAYCGrCEZfIBFGEBMAECBDtDMITSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMITAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMITAKCTJRKMGXGXGXGXGXAYCIrCEZfIBFGEBMAECBDtDMIASEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIAAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAEAKDBBBDMIAAKCTJRKMGXGXGXGXGXAYCKrfIBFGEBMAECBDtDMI8wSEMAEAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCIJAeDeBJAYCx+YUUBJ2BBJRKSGMAEAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHYCEWCxkUUBJDBEBAYCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHYCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMI8wAKCNJAeDeBJAYCx+YUUBJ2BBJRKSFMAEAKDBBBDMI8wAKCTJRKMAICoBJREAICUFJAM9LQFAERIAOAKlC/fB9LQBMMGXAEAM9PQBAECErRIEXGXAOAKlCi9PQBCBRKSOMAmAEJRYGXGXGXGXGXATAECKrJ2BBAICKZrCEZfIBFGEBMAYCBDtDMIBSEMAYAKDBBIAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnHPCGD+MFAPDQBTFtGmEYIPLdKeOnC0+G+MiDtD9OHdCEDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCIJAeDeBJAiCx+YUUBJ2BBJRKSGMAYAKDBBNAKDBBBHPCID+MFAPDQBTFtGmEYIPLdKeOnC+P+e+8/4BDtD9OHdCbDbD8jHPAPDQBFGENVcMILKOSQfbHeD8dBh+BsxoxoUwN0AeD8dFhxoUwkwk+gUa0sHnhTkAnsHnhNkAnsHn7CgFZHiCEWCxkUUBJDBEBAiCx+YUUBJDBBBHeAeDQBBBBBBBBBBBBBBBBAnhAk7CgFZHiCEWCxkUUBJDBEBD9uDQBFGEILKOTtmYPdenDfAdAPD9SDMIBAKCNJAeDeBJAiCx+YUUBJ2BBJRKSFMAYAKDBBBDMIBAKCTJRKMAICGJRIAECTJHEAM9JQBMMGXAK9FQBAKRTAtCFJHtCI6QGSFMMCBRKSEMGXAM9FQBALCUGJAbJREALAbJDBGBReCBRYEXAEALCU/CBJAYJHIDBIBHdCFD9tAdCFDbHPD9OD9hD9RHdAIAMJDBIBH8ZCFD9tA8ZAPD9OD9hD9RH8ZDQBTFtGmEYIPLdKeOnHpAIAQJDBIBHyCFD9tAyAPD9OD9hD9RHyAIASJDBIBH8cCFD9tA8cAPD9OD9hD9RH8cDQBTFtGmEYIPLdKeOnH8dDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGEAeD9uHeDyBjGBAEAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeApA8dDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNiV8ZcpMyS8cQ8df8eb8fHdAyA8cDQNiV8ZcpMyS8cQ8df8eb8fH8ZDQBFTtGEmYILPdKOenHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJHIAeAdA8ZDQNVi8ZcMpySQ8c8dfb8e8fHPAPDQBFGEBFGEBFGEBFGED9uHeDyBjGBAIAGJHIAeAPAPDQILKOILKOILKOILKOD9uHeDyBjGBAIAGJHIAeAPAPDQNVcMNVcMNVcMNVcMD9uHeDyBjGBAIAGJHIAeAPAPDQSQfbSQfbSQfbSQfbD9uHeDyBjGBAIAGJREAYCTJHYAM9JQBMMAbCIJHbAG9JQBMMABAVAG9sJALCUGJAcAG9s/8cBBALALCUGJAcCaJAG9sJAG/8cBBMAcCBAKyAVJRVAKQBMC9+RKSFMCBC99AOAKlAGCAAGCA9Ly6yRKMALCU/KBJ8kUUUUBAKMNBT+BUUUBM+KmFTa8jUUUUBCoFlHL8kUUUUBC9+RKGXAFCE9uHOCtJAI9LQBCaRKAE2BBHNC/wFZC/gF9HQBANCbZHVCF9LQBALCoBJCgFCUF/8MBALC84Jha83EBALC8wJha83EBALC8oJha83EBALCAJha83EBALCiJha83EBALCTJha83EBALha83ENALha83EBAEAIJC9wJRcAECFJHNAOJRMGXAF9FQBCQCbAVCF6yRSABRECBRVCBRQCBRfCBRICBRKEXGXAMAcuQBC9+RKSEMGXGXAN2BBHOC/vF9LQBALCoBJAOCIrCa9zAKJCbZCEWJHb8oGIRTAb8oGBRtGXAOCbZHbAS9PQBALAOCa9zAIJCbZCGWJ8oGBAVAbyROAb9FRbGXGXAGCG9HQBABAt87FBABCIJAO87FBABCGJAT87FBSFMAEAtjGBAECNJAOjGBAECIJATjGBMAVAbJRVALCoBJAKCEWJHmAOjGBAmATjGIALAICGWJAOjGBALCoBJAKCFJCbZHKCEWJHTAtjGBATAOjGIAIAbJRIAKCFJRKSGMGXGXAbCb6QBAQAbJAbC989zJCFJRQSFMAM1BBHbCgFZROGXGXAbCa9MQBAMCFJRMSFMAM1BFHbCgBZCOWAOCgBZqROGXAbCa9MQBAMCGJRMSFMAM1BGHbCgBZCfWAOqROGXAbCa9MQBAMCEJRMSFMAM1BEHbCgBZCdWAOqROGXAbCa9MQBAMCIJRMSFMAM2BIC8cWAOqROAMCLJRMMAOCFrCBAOCFZl9zAQJRQMGXGXAGCG9HQBABAt87FBABCIJAQ87FBABCGJAT87FBSFMAEAtjGBAECNJAQjGBAECIJATjGBMALCoBJAKCEWJHOAQjGBAOATjGIALAICGWJAQjGBALCoBJAKCFJCbZHKCEWJHOAtjGBAOAQjGIAICFJRIAKCFJRKSFMGXAOCDF9LQBALAIAcAOCbZJ2BBHbCIrHTlCbZCGWJ8oGBAVCFJHtATyROALAIAblCbZCGWJ8oGBAtAT9FHmJHtAbCbZHTyRbAT9FRTGXGXAGCG9HQBABAV87FBABCIJAb87FBABCGJAO87FBSFMAEAVjGBAECNJAbjGBAECIJAOjGBMALAICGWJAVjGBALCoBJAKCEWJHYAOjGBAYAVjGIALAICFJHICbZCGWJAOjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAIAmJCbZHICGWJAbjGBALCoBJAKCGJCbZHKCEWJHOAVjGBAOAbjGIAKCFJRKAIATJRIAtATJRVSFMAVCBAM2BBHYyHTAOC/+F6HPJROAYCbZRtGXGXAYCIrHmQBAOCFJRbSFMAORbALAIAmlCbZCGWJ8oGBROMGXGXAtQBAbCFJRVSFMAbRVALAIAYlCbZCGWJ8oGBRbMGXGXAP9FQBAMCFJRYSFMAM1BFHYCgFZRTGXGXAYCa9MQBAMCGJRYSFMAM1BGHYCgBZCOWATCgBZqRTGXAYCa9MQBAMCEJRYSFMAM1BEHYCgBZCfWATqRTGXAYCa9MQBAMCIJRYSFMAM1BIHYCgBZCdWATqRTGXAYCa9MQBAMCLJRYSFMAMCKJRYAM2BLC8cWATqRTMATCFrCBATCFZl9zAQJHQRTMGXGXAmCb6QBAYRPSFMAY1BBHMCgFZROGXGXAMCa9MQBAYCFJRPSFMAY1BFHMCgBZCOWAOCgBZqROGXAMCa9MQBAYCGJRPSFMAY1BGHMCgBZCfWAOqROGXAMCa9MQBAYCEJRPSFMAY1BEHMCgBZCdWAOqROGXAMCa9MQBAYCIJRPSFMAYCLJRPAY2BIC8cWAOqROMAOCFrCBAOCFZl9zAQJHQROMGXGXAtCb6QBAPRMSFMAP1BBHMCgFZRbGXGXAMCa9MQBAPCFJRMSFMAP1BFHMCgBZCOWAbCgBZqRbGXAMCa9MQBAPCGJRMSFMAP1BGHMCgBZCfWAbqRbGXAMCa9MQBAPCEJRMSFMAP1BEHMCgBZCdWAbqRbGXAMCa9MQBAPCIJRMSFMAPCLJRMAP2BIC8cWAbqRbMAbCFrCBAbCFZl9zAQJHQRbMGXGXAGCG9HQBABAT87FBABCIJAb87FBABCGJAO87FBSFMAEATjGBAECNJAbjGBAECIJAOjGBMALCoBJAKCEWJHYAOjGBAYATjGIALAICGWJATjGBALCoBJAKCFJCbZCEWJHYAbjGBAYAOjGIALAICFJHICbZCGWJAOjGBALCoBJAKCGJCbZCEWJHOATjGBAOAbjGIALAIAm9FAmCb6qJHICbZCGWJAbjGBAIAt9FAtCb6qJRIAKCEJRKMANCFJRNABCKJRBAECSJREAKCbZRKAICbZRIAfCEJHfAF9JQBMMCBC99AMAc6yRKMALCoFJ8kUUUUBAKM/tIFGa8jUUUUBCTlRLC9+RKGXAFCLJAI9LQBCaRKAE2BBC/+FZC/QF9HQBALhB83ENAECFJRKAEAIJC98JREGXAF9FQBGXAGCG6QBEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMALCNJAICFZCGWqHGAICGrCBAICFrCFZl9zAG8oGBJHIjGBABAIjGBABCIJRBAFCaJHFQBSGMMEXGXAKAE9JQBC9+bMAK1BBHGCgFZRIGXGXAGCa9MQBAKCFJRKSFMAK1BFHGCgBZCOWAICgBZqRIGXAGCa9MQBAKCGJRKSFMAK1BGHGCgBZCfWAIqRIGXAGCa9MQBAKCEJRKSFMAK1BEHGCgBZCdWAIqRIGXAGCa9MQBAKCIJRKSFMAK2BIC8cWAIqRIAKCLJRKMABAICGrCBAICFrCFZl9zALCNJAICFZCGWqHI8oGBJHG87FBAIAGjGBABCGJRBAFCaJHFQBMMCBC99AKAE6yRKMAKM/dLEK97FaF97GXGXAGCI9HQBAF9FQFCBRGEXABABDBBBHECiD+rFCiD+sFD/6FHIAECND+rFCiD+sFD/6FAID/gFAECTD+rFCiD+sFD/6FHLD/gFD/kFD/lFHKCBDtD+2FHOAICUUUU94DtHND9OD9RD/kFHI9DBB/+hDYAIAID/mFAKAKD/mFALAOALAND9OD9RD/kFHIAID/mFD/kFD/kFD/jFD/nFHLD/mF9DBBX9LDYHOD/kFCgFDtD9OAECUUU94DtD9OD9QAIALD/mFAOD/kFCND+rFCU/+EDtD9OD9QAKALD/mFAOD/kFCTD+rFCUU/8ODtD9OD9QDMBBABCTJRBAGCIJHGAF9JQBSGMMAF9FQBCBRGEXABCTJHVAVDBBBHECBDtHOCUU98D8cFCUU98D8cEHND9OABDBBBHKAEDQILKOSQfbPden8c8d8e8fCggFDtD9OD/6FAKAEDQBFGENVcMTtmYi8ZpyHECTD+sFD/6FHID/gFAECTD+rFCTD+sFD/6FHLD/gFD/kFD/lFHE9DB/+g6DYALAEAOD+2FHOALCUUUU94DtHcD9OD9RD/kFHLALD/mFAEAED/mFAIAOAIAcD9OD9RD/kFHEAED/mFD/kFD/kFD/jFD/nFHID/mF9DBBX9LDYHOD/kFCTD+rFALAID/mFAOD/kFCggEDtD9OD9QHLAEAID/mFAOD/kFCaDbCBDnGCBDnECBDnKCBDnOCBDncCBDnMCBDnfCBDnbD9OHEDQNVi8ZcMpySQ8c8dfb8e8fD9QDMBBABAKAND9OALAEDQBFTtGEmYILPdKOenD9QDMBBABCAJRBAGCIJHGAF9JQBMMM/hEIGaF97FaL978jUUUUBCTlREGXAF9FQBCBRIEXAEABDBBBHLABCTJHKDBBBHODQILKOSQfbPden8c8d8e8fHNCTD+sFHVCID+rFDMIBAB9DBBU8/DY9D/zI818/DYAVCEDtD9QD/6FD/nFHVALAODQBFGENVcMTtmYi8ZpyHLCTD+rFCTD+sFD/6FD/mFHOAOD/mFAVALCTD+sFD/6FD/mFHcAcD/mFAVANCTD+rFCTD+sFD/6FD/mFHNAND/mFD/kFD/kFD/lFCBDtD+4FD/jF9DB/+g6DYHVD/mF9DBBX9LDYHLD/kFCggEDtHMD9OAcAVD/mFALD/kFCTD+rFD9QHcANAVD/mFALD/kFCTD+rFAOAVD/mFALD/kFAMD9OD9QHVDQBFTtGEmYILPdKOenHLD8dBAEDBIBDyB+t+J83EBABCNJALD8dFAEDBIBDyF+t+J83EBAKAcAVDQNVi8ZcMpySQ8c8dfb8e8fHVD8dBAEDBIBDyG+t+J83EBABCiJAVD8dFAEDBIBDyE+t+J83EBABCAJRBAICIJHIAF9JQBMMM9jFF97GXAGCGrAF9sHG9FQBCBRFEXABABDBBBHECND+rFCND+sFD/6FAECiD+sFCnD+rFCUUU/8EDtD+uFD/mFDMBBABCTJRBAFCIJHFAG9JQBMMM9TFEaCBCB8oGUkUUBHFABCEJC98ZJHBjGUkUUBGXGXAB8/BCTWHGuQBCaREABAGlCggEJCTrXBCa6QFMAFREMAEMMMFBCUNMIT9tBB",console.log("Warning: meshopt_decoder is using experimental SIMD support"));var a=WebAssembly.instantiate(function(e){for(var n=new Uint8Array(e.length),r=0;r<e.length;++r){var a=e.charCodeAt(r);n[r]=a>96?a-71:a>64?a-65:a>47?a+4:a>46?63:62}var i=0;for(r=0;r<e.length;++r)n[i++]=n[r]<60?t[n[r]]:64*(n[r]-60)+n[++r];return n.buffer.slice(0,i)}(r),{}).then((function(e){(n=e.instance).exports.__wasm_call_ctors()}));function i(e,t,r,a,i,o){var s=n.exports.sbrk,c=r+3&-4,u=s(c*a),l=s(i.length),d=new Uint8Array(n.exports.memory.buffer);d.set(i,l);var h=e(u,r,a,l,i.length);if(0==h&&o&&o(u,c,a),t.set(d.subarray(u,u+r*a)),s(u-s(0)),0!=h)throw new Error("Malformed buffer data: "+h)}var o={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},s={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:a,supported:!0,decodeVertexBuffer:function(e,t,r,a,s){i(n.exports.meshopt_decodeVertexBuffer,e,t,r,a,n.exports[o[s]])},decodeIndexBuffer:function(e,t,r,a){i(n.exports.meshopt_decodeIndexBuffer,e,t,r,a)},decodeIndexSequence:function(e,t,r,a){i(n.exports.meshopt_decodeIndexSequence,e,t,r,a)},decodeGltfBuffer:function(e,t,r,a,c,u){i(n.exports[s[c]],e,t,r,a,n.exports[o[u]])}}}(),s=function(){function e(e){a.Loader.call(this,e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new o(e)})),this.register((function(e){return new c(e)})),this.register((function(e){return new u(e)})),this.register((function(e){return new s(e)})),this.register((function(e){return new r(e)})),this.register((function(e){return new l(e)}))}function t(){var e={};return{get:function(t){return e[t]},add:function(t,n){e[t]=n},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(a.Loader.prototype),{constructor:e,load:function(e,t,n,r){var i,o=this;i=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:a.LoaderUtils.extractUrlBase(e),this.manager.itemStart(e);var s=function(t){r?r(t):console.error(t),o.manager.itemError(e),o.manager.itemEnd(e)},c=new a.FileLoader(this.manager);c.setPath(this.path),c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(e,(function(n){try{o.parse(n,i,(function(n){t(n),o.manager.itemEnd(e)}),s)}catch(r){s(r)}}),n,s)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(e){return this.ktx2Loader=e,this},setMeshoptDecoder:function(e){return this.meshoptDecoder=e,this},register:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(e,t,r,o){var s,c={},u={};if("string"===typeof e)s=e;else if(a.LoaderUtils.decodeText(new Uint8Array(e,0,4))===d){try{c[n.KHR_BINARY_GLTF]=new p(e)}catch(A){return void(o&&o(A))}s=c[n.KHR_BINARY_GLTF].content}else s=a.LoaderUtils.decodeText(new Uint8Array(e));var l=JSON.parse(s);if(void 0===l.asset||l.asset.version[0]<2)o&&o(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var h=new V(l,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(var f=0;f<this.pluginCallbacks.length;f++){var g=this.pluginCallbacks[f](h);u[g.name]=g,c[g.name]=!0}if(l.extensionsUsed)for(var x=0;x<l.extensionsUsed.length;++x){var w=l.extensionsUsed[x],O=l.extensionsRequired||[];switch(w){case n.KHR_MATERIALS_UNLIT:c[w]=new i;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:c[w]=new b;break;case n.KHR_DRACO_MESH_COMPRESSION:c[w]=new m(l,this.dracoLoader);break;case n.KHR_TEXTURE_TRANSFORM:c[w]=new v;break;case n.KHR_MESH_QUANTIZATION:c[w]=new y;break;default:O.indexOf(w)>=0&&void 0===u[w]&&console.warn('THREE.GLTFLoader: Unknown extension "'+w+'".')}}h.setExtensions(c),h.setPlugins(u),h.parse(r,o)}}});var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function r(e){this.parser=e,this.name=n.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function i(){this.name=n.KHR_MATERIALS_UNLIT}function o(e){this.parser=e,this.name=n.KHR_MATERIALS_CLEARCOAT}function s(e){this.parser=e,this.name=n.KHR_MATERIALS_TRANSMISSION}function c(e){this.parser=e,this.name=n.KHR_TEXTURE_BASISU}function u(e){this.parser=e,this.name=n.EXT_TEXTURE_WEBP,this.isSupported=null}function l(e){this.name=n.EXT_MESHOPT_COMPRESSION,this.parser=e}r.prototype._markDefs=function(){for(var e=this.parser,t=this.parser.json.nodes||[],n=0,r=t.length;n<r;n++){var a=t[n];a.extensions&&a.extensions[this.name]&&void 0!==a.extensions[this.name].light&&e._addNodeRef(this.cache,a.extensions[this.name].light)}},r.prototype._loadLight=function(e){var t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;var i,o=t.json,s=((o.extensions&&o.extensions[this.name]||{}).lights||[])[e],c=new a.Color(16777215);void 0!==s.color&&c.fromArray(s.color);var u=void 0!==s.range?s.range:0;switch(s.type){case"directional":(i=new a.DirectionalLight(c)).target.position.set(0,0,-1),i.add(i.target);break;case"point":(i=new a.PointLight(c)).distance=u;break;case"spot":(i=new a.SpotLight(c)).distance=u,s.spot=s.spot||{},s.spot.innerConeAngle=void 0!==s.spot.innerConeAngle?s.spot.innerConeAngle:0,s.spot.outerConeAngle=void 0!==s.spot.outerConeAngle?s.spot.outerConeAngle:Math.PI/4,i.angle=s.spot.outerConeAngle,i.penumbra=1-s.spot.innerConeAngle/s.spot.outerConeAngle,i.target.position.set(0,0,-1),i.add(i.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+s.type)}return i.position.set(0,0,0),i.decay=2,void 0!==s.intensity&&(i.intensity=s.intensity),i.name=t.createUniqueName(s.name||"light_"+e),r=Promise.resolve(i),t.cache.add(n,r),r},r.prototype.createNodeAttachment=function(e){var t=this,n=this.parser,r=n.json.nodes[e],a=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===a?null:this._loadLight(a).then((function(e){return n._getNodeRef(t.cache,a,e)}))},i.prototype.getMaterialType=function(){return a.MeshBasicMaterial},i.prototype.extendParams=function(e,t,n){var r=[];e.color=new a.Color(1,1,1),e.opacity=1;var i=t.pbrMetallicRoughness;if(i){if(Array.isArray(i.baseColorFactor)){var o=i.baseColorFactor;e.color.fromArray(o),e.opacity=o[3]}void 0!==i.baseColorTexture&&r.push(n.assignTexture(e,"map",i.baseColorTexture))}return Promise.all(r)},o.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?a.MeshPhysicalMaterial:null},o.prototype.extendMaterialParams=function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var i=[],o=r.extensions[this.name];if(void 0!==o.clearcoatFactor&&(t.clearcoat=o.clearcoatFactor),void 0!==o.clearcoatTexture&&i.push(n.assignTexture(t,"clearcoatMap",o.clearcoatTexture)),void 0!==o.clearcoatRoughnessFactor&&(t.clearcoatRoughness=o.clearcoatRoughnessFactor),void 0!==o.clearcoatRoughnessTexture&&i.push(n.assignTexture(t,"clearcoatRoughnessMap",o.clearcoatRoughnessTexture)),void 0!==o.clearcoatNormalTexture&&(i.push(n.assignTexture(t,"clearcoatNormalMap",o.clearcoatNormalTexture)),void 0!==o.clearcoatNormalTexture.scale)){var s=o.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new a.Vector2(s,-s)}return Promise.all(i)},s.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?a.MeshPhysicalMaterial:null},s.prototype.extendMaterialParams=function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var a=[],i=r.extensions[this.name];return void 0!==i.transmissionFactor&&(t.transmission=i.transmissionFactor),void 0!==i.transmissionTexture&&a.push(n.assignTexture(t,"transmissionMap",i.transmissionTexture)),Promise.all(a)},c.prototype.loadTexture=function(e){var t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;var a=r.extensions[this.name],i=n.images[a.source],o=t.options.ktx2Loader;if(!o){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,i,o)},u.prototype.loadTexture=function(e){var t=this.name,n=this.parser,r=n.json,a=r.textures[e];if(!a.extensions||!a.extensions[t])return null;var i=a.extensions[t],o=r.images[i.source],s=n.textureLoader;if(o.uri){var c=n.options.manager.getHandler(o.uri);null!==c&&(s=c)}return this.detectSupport().then((function(a){if(a)return n.loadTextureImage(e,o,s);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))},u.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise((function(e){var t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported},l.prototype.loadBufferView=function(e){var t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){var r=n.extensions[this.name],a=this.parser.getDependency("buffer",r.buffer),i=this.parser.options.meshoptDecoder;if(!i||!i.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([a,i.ready]).then((function(e){var t=r.byteOffset||0,n=r.byteLength||0,a=r.count,o=r.byteStride,s=new ArrayBuffer(a*o),c=new Uint8Array(e[0],t,n);return i.decodeGltfBuffer(new Uint8Array(s),a,o,c,r.mode,r.filter),s}))}return null};var d="glTF",h=1313821514,f=5130562;function p(e){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var t=new DataView(e,0,12);if(this.header={magic:a.LoaderUtils.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==d)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var r=this.header.length-12,i=new DataView(e,12),o=0;o<r;){var s=i.getUint32(o,!0);o+=4;var c=i.getUint32(o,!0);if(o+=4,c===h){var u=new Uint8Array(e,12+o,s);this.content=a.LoaderUtils.decodeText(u)}else if(c===f){var l=12+o;this.body=e.slice(l,l+s)}o+=s}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function m(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function v(){this.name=n.KHR_TEXTURE_TRANSFORM}function g(e){a.MeshStandardMaterial.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),i=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),o=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),s={specular:{value:(new a.Color).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=s,this.onBeforeCompile=function(e){for(var a in s)e.uniforms[a]=s[a];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",i).replace("#include <lights_physical_fragment>",o)},Object.defineProperties(this,{specular:{get:function(){return s.specular.value},set:function(e){s.specular.value=e}},specularMap:{get:function(){return s.specularMap.value},set:function(e){s.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return s.glossiness.value},set:function(e){s.glossiness.value=e}},glossinessMap:{get:function(){return s.glossinessMap.value},set:function(e){s.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function b(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return g},extendParams:function(e,t,n){var r=t.extensions[this.name];e.color=new a.Color(1,1,1),e.opacity=1;var i=[];if(Array.isArray(r.diffuseFactor)){var o=r.diffuseFactor;e.color.fromArray(o),e.opacity=o[3]}if(void 0!==r.diffuseTexture&&i.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new a.Color(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new a.Color(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var s=r.specularGlossinessTexture;i.push(n.assignTexture(e,"glossinessMap",s)),i.push(n.assignTexture(e,"specularMap",s))}return Promise.all(i)},createMaterial:function(e){var t=new g(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=a.TangentSpaceNormalMap,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function y(){this.name=n.KHR_MESH_QUANTIZATION}function x(e,t,n,r){a.Interpolant.call(this,e,t,n,r)}m.prototype.decodePrimitive=function(e,t){var n=this.json,r=this.dracoLoader,a=e.extensions[this.name].bufferView,i=e.extensions[this.name].attributes,o={},s={},c={};for(var u in i){var l=I[u]||u.toLowerCase();o[l]=i[u]}for(var d in e.attributes){l=I[d]||d.toLowerCase();if(void 0!==i[d]){var h=n.accessors[e.attributes[d]],f=T[h.componentType];c[l]=f,s[l]=!0===h.normalized}}return t.getDependency("bufferView",a).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],a=s[n];void 0!==a&&(r.normalized=a)}t(e)}),o,c)}))}))},v.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},g.prototype=Object.create(a.MeshStandardMaterial.prototype),g.prototype.constructor=g,g.prototype.copy=function(e){return a.MeshStandardMaterial.prototype.copy.call(this,e),this.specularMap=e.specularMap,this.specular.copy(e.specular),this.glossinessMap=e.glossinessMap,this.glossiness=e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},x.prototype=Object.create(a.Interpolant.prototype),x.prototype.constructor=x,x.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,a=e*r*3+r,i=0;i!==r;i++)t[i]=n[a+i];return t},x.prototype.beforeStart_=x.prototype.copySampleValue_,x.prototype.afterEnd_=x.prototype.copySampleValue_,x.prototype.interpolate_=function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=2*o,c=3*o,u=r-t,l=(n-t)/u,d=l*l,h=d*l,f=e*c,p=f-c,m=-2*h+3*d,v=h-d,g=1-m,b=v-d+l,y=0;y!==o;y++){var x=i[p+y+o],w=i[p+y+s]*u,O=i[f+y+o],A=i[f+y]*u;a[y]=g*x+b*w+m*O+v*A}return a};var w=0,O=1,A=2,_=3,E=4,S=5,C=6,T={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},M={9728:a.NearestFilter,9729:a.LinearFilter,9984:a.NearestMipmapNearestFilter,9985:a.LinearMipmapNearestFilter,9986:a.NearestMipmapLinearFilter,9987:a.LinearMipmapLinearFilter},k={33071:a.ClampToEdgeWrapping,33648:a.MirroredRepeatWrapping,10497:a.RepeatWrapping},R={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},I={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},j={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},B={CUBICSPLINE:void 0,LINEAR:a.InterpolateLinear,STEP:a.InterpolateDiscrete},L="OPAQUE",N="MASK",D="BLEND";function P(e,t){return"string"!==typeof e||""===e?"":(/^https?:\/\//i.test(t)&&/^\//.test(e)&&(t=t.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:t+e)}function F(e,t,n){for(var r in n.extensions)void 0===e[r]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[r]=n.extensions[r])}function G(e,t){void 0!==t.extras&&("object"===typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function U(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var n=0,r=t.weights.length;n<r;n++)e.morphTargetInfluences[n]=t.weights[n];if(t.extras&&Array.isArray(t.extras.targetNames)){var a=t.extras.targetNames;if(e.morphTargetInfluences.length===a.length){e.morphTargetDictionary={};for(var i=0,o=a.length;i<o;i++)e.morphTargetDictionary[a[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function z(e){var t=e.extensions&&e.extensions[n.KHR_DRACO_MESH_COMPRESSION];return t?"draco:"+t.bufferView+":"+t.indices+":"+H(t.attributes):e.indices+":"+H(e.attributes)+":"+e.mode}function H(e){for(var t="",n=Object.keys(e).sort(),r=0,a=n.length;r<a;r++)t+=n[r]+":"+e[n[r]]+";";return t}function V(e,n){this.json=e||{},this.extensions={},this.plugins={},this.options=n||{},this.cache=new t,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!==typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new a.ImageBitmapLoader(this.options.manager):this.textureLoader=new a.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new a.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function W(e,t,n){var r=t.attributes,i=[];function o(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(var s in r){var c=I[s]||s.toLowerCase();c in e.attributes||i.push(o(r[s],c))}if(void 0!==t.indices&&!e.index){var u=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));i.push(u)}return G(e,t),function(e,t,n){var r=t.attributes,i=new a.Box3;if(void 0!==r.POSITION){var o=(f=n.json.accessors[r.POSITION]).min,s=f.max;if(void 0!==o&&void 0!==s){i.set(new a.Vector3(o[0],o[1],o[2]),new a.Vector3(s[0],s[1],s[2]));var c=t.targets;if(void 0!==c){for(var u=new a.Vector3,l=new a.Vector3,d=0,h=c.length;d<h;d++){var f,p=c[d];if(void 0!==p.POSITION)o=(f=n.json.accessors[p.POSITION]).min,s=f.max,void 0!==o&&void 0!==s?(l.setX(Math.max(Math.abs(o[0]),Math.abs(s[0]))),l.setY(Math.max(Math.abs(o[1]),Math.abs(s[1]))),l.setZ(Math.max(Math.abs(o[2]),Math.abs(s[2]))),u.max(l)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}i.expandByVector(u)}e.boundingBox=i;var m=new a.Sphere;i.getCenter(m.center),m.radius=i.min.distanceTo(i.max)/2,e.boundingSphere=m}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,n),Promise.all(i).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,a=!1,i=0,o=t.length;i<o&&(void 0!==(d=t[i]).POSITION&&(r=!0),void 0!==d.NORMAL&&(a=!0),!r||!a);i++);if(!r&&!a)return Promise.resolve(e);for(var s=[],c=[],u=0,l=t.length;u<l;u++){var d=t[u];if(r){var h=void 0!==d.POSITION?n.getDependency("accessor",d.POSITION):e.attributes.position;s.push(h)}a&&(h=void 0!==d.NORMAL?n.getDependency("accessor",d.NORMAL):e.attributes.normal,c.push(h))}return Promise.all([Promise.all(s),Promise.all(c)]).then((function(t){var n=t[0],i=t[1];return r&&(e.morphAttributes.position=n),a&&(e.morphAttributes.normal=i),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function J(e,t){var n=e.getIndex();if(null===n){var r=[],i=e.getAttribute("position");if(void 0===i)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var o=0;o<i.count;o++)r.push(o);e.setIndex(r),n=e.getIndex()}var s=n.count-2,c=[];if(t===a.TriangleFanDrawMode)for(var u=1;u<=s;u++)c.push(n.getX(0)),c.push(n.getX(u)),c.push(n.getX(u+1));else for(var l=0;l<s;l++)l%2===0?(c.push(n.getX(l)),c.push(n.getX(l+1)),c.push(n.getX(l+2))):(c.push(n.getX(l+2)),c.push(n.getX(l+1)),c.push(n.getX(l)));c.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var d=e.clone();return d.setIndex(c),d}return V.prototype.setExtensions=function(e){this.extensions=e},V.prototype.setPlugins=function(e){this.plugins=e},V.prototype.parse=function(e,t){var n=this,r=this.json,a=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){var i={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};F(a,i,r),G(i,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(i)}))).then((function(){e(i)}))})).catch(t)},V.prototype._markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r=0,a=t.length;r<a;r++)for(var i=t[r].joints,o=0,s=i.length;o<s;o++)e[i[o]].isBone=!0;for(var c=0,u=e.length;c<u;c++){var l=e[c];void 0!==l.mesh&&(this._addNodeRef(this.meshCache,l.mesh),void 0!==l.skin&&(n[l.mesh].isSkinnedMesh=!0)),void 0!==l.camera&&this._addNodeRef(this.cameraCache,l.camera)}},V.prototype._addNodeRef=function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)},V.prototype._getNodeRef=function(e,t,n){if(e.refs[t]<=1)return n;var r=n.clone();return r.name+="_instance_"+e.uses[t]++,r},V.prototype._invokeOne=function(e){var t=Object.values(this.plugins);t.push(this);for(var n=0;n<t.length;n++){var r=e(t[n]);if(r)return r}},V.prototype._invokeAll=function(e){var t=Object.values(this.plugins);t.unshift(this);for(var n=[],r=0;r<t.length;r++){var a=e(t[r]);a&&n.push(a)}return n},V.prototype.getDependency=function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r},V.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var n=this,r=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(r.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t},V.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var a=this.options;return new Promise((function(e,n){r.load(P(t.uri,a.path),e,void 0,(function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},V.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))},V.prototype.loadAccessor=function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var i=[];return void 0!==r.bufferView?i.push(this.getDependency("bufferView",r.bufferView)):i.push(null),void 0!==r.sparse&&(i.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),i.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(i).then((function(e){var i,o,s=e[0],c=R[r.type],u=T[r.componentType],l=u.BYTES_PER_ELEMENT,d=l*c,h=r.byteOffset||0,f=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,p=!0===r.normalized;if(f&&f!==d){var m=Math.floor(h/f),v="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+m+":"+r.count,g=t.cache.get(v);g||(i=new u(s,m*f,r.count*f/l),g=new a.InterleavedBuffer(i,f/l),t.cache.add(v,g)),o=new a.InterleavedBufferAttribute(g,c,h%f/l,p)}else i=null===s?new u(r.count*c):new u(s,h,r.count*c),o=new a.BufferAttribute(i,c,p);if(void 0!==r.sparse){var b=R.SCALAR,y=T[r.sparse.indices.componentType],x=r.sparse.indices.byteOffset||0,w=r.sparse.values.byteOffset||0,O=new y(e[1],x,r.sparse.count*b),A=new u(e[2],w,r.sparse.count*c);null!==s&&(o=new a.BufferAttribute(o.array.slice(),o.itemSize,o.normalized));for(var _=0,E=O.length;_<E;_++){var S=O[_];if(o.setX(S,A[_*c]),c>=2&&o.setY(S,A[_*c+1]),c>=3&&o.setZ(S,A[_*c+2]),c>=4&&o.setW(S,A[_*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o}))},V.prototype.loadTexture=function(e){var t=this.json,n=this.options,r=t.textures[e],a=t.images[r.source],i=this.textureLoader;if(a.uri){var o=n.manager.getHandler(a.uri);null!==o&&(i=o)}return this.loadTextureImage(e,a,i)},V.prototype.loadTextureImage=function(e,t,n){var r=this,i=this.json,o=this.options,s=i.textures[e],c=self.URL||self.webkitURL,u=t.uri,l=!1,d=!0;if("image/jpeg"===t.mimeType&&(d=!1),void 0!==t.bufferView)u=r.getDependency("bufferView",t.bufferView).then((function(e){if("image/png"===t.mimeType){var n=new DataView(e,25,1).getUint8(0,!1);d=6===n||4===n||3===n}l=!0;var r=new Blob([e],{type:t.mimeType});return u=c.createObjectURL(r)}));else if(void 0===t.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");return Promise.resolve(u).then((function(e){return new Promise((function(t,r){var i=t;!0===n.isImageBitmapLoader&&(i=function(e){t(new a.CanvasTexture(e))}),n.load(P(e,o.path),i,void 0,r)}))})).then((function(t){!0===l&&c.revokeObjectURL(u),t.flipY=!1,s.name&&(t.name=s.name),d||(t.format=a.RGBFormat);var n=(i.samplers||{})[s.sampler]||{};return t.magFilter=M[n.magFilter]||a.LinearFilter,t.minFilter=M[n.minFilter]||a.LinearMipmapLinearFilter,t.wrapS=k[n.wrapS]||a.RepeatWrapping,t.wrapT=k[n.wrapT]||a.RepeatWrapping,r.associations.set(t,{type:"textures",index:e}),t}))},V.prototype.assignTexture=function(e,t,r){var a=this;return this.getDependency("texture",r.index).then((function(i){if(void 0===r.texCoord||0==r.texCoord||"aoMap"===t&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),a.extensions[n.KHR_TEXTURE_TRANSFORM]){var o=void 0!==r.extensions?r.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;if(o){var s=a.associations.get(i);i=a.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(i,o),a.associations.set(i,s)}}e[t]=i}))},V.prototype.assignFinalMaterial=function(e){var t=e.geometry,n=e.material,r=void 0!==t.attributes.tangent,i=void 0!==t.attributes.color,o=void 0===t.attributes.normal,s=!0===e.isSkinnedMesh,c=Object.keys(t.morphAttributes).length>0,u=c&&void 0!==t.morphAttributes.normal;if(e.isPoints){var l="PointsMaterial:"+n.uuid,d=this.cache.get(l);d||(d=new a.PointsMaterial,a.Material.prototype.copy.call(d,n),d.color.copy(n.color),d.map=n.map,d.sizeAttenuation=!1,this.cache.add(l,d)),n=d}else if(e.isLine){l="LineBasicMaterial:"+n.uuid;var h=this.cache.get(l);h||(h=new a.LineBasicMaterial,a.Material.prototype.copy.call(h,n),h.color.copy(n.color),this.cache.add(l,h)),n=h}if(r||i||o||s||c){l="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(l+="specular-glossiness:"),s&&(l+="skinning:"),r&&(l+="vertex-tangents:"),i&&(l+="vertex-colors:"),o&&(l+="flat-shading:"),c&&(l+="morph-targets:"),u&&(l+="morph-normals:");var f=this.cache.get(l);f||(f=n.clone(),s&&(f.skinning=!0),i&&(f.vertexColors=!0),o&&(f.flatShading=!0),c&&(f.morphTargets=!0),u&&(f.morphNormals=!0),r&&(f.vertexTangents=!0,f.normalScale&&(f.normalScale.y*=-1),f.clearcoatNormalScale&&(f.clearcoatNormalScale.y*=-1)),this.cache.add(l,f),this.associations.set(f,this.associations.get(n))),n=f}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n},V.prototype.getMaterialType=function(){return a.MeshStandardMaterial},V.prototype.loadMaterial=function(e){var t,r=this,i=this.json,o=this.extensions,s=i.materials[e],c={},u=s.extensions||{},l=[];if(u[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var d=o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=d.getMaterialType(),l.push(d.extendParams(c,s,r))}else if(u[n.KHR_MATERIALS_UNLIT]){var h=o[n.KHR_MATERIALS_UNLIT];t=h.getMaterialType(),l.push(h.extendParams(c,s,r))}else{var f=s.pbrMetallicRoughness||{};if(c.color=new a.Color(1,1,1),c.opacity=1,Array.isArray(f.baseColorFactor)){var p=f.baseColorFactor;c.color.fromArray(p),c.opacity=p[3]}void 0!==f.baseColorTexture&&l.push(r.assignTexture(c,"map",f.baseColorTexture)),c.metalness=void 0!==f.metallicFactor?f.metallicFactor:1,c.roughness=void 0!==f.roughnessFactor?f.roughnessFactor:1,void 0!==f.metallicRoughnessTexture&&(l.push(r.assignTexture(c,"metalnessMap",f.metallicRoughnessTexture)),l.push(r.assignTexture(c,"roughnessMap",f.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),l.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,c)}))))}!0===s.doubleSided&&(c.side=a.DoubleSide);var m=s.alphaMode||L;return m===D?(c.transparent=!0,c.depthWrite=!1):(c.transparent=!1,m===N&&(c.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&t!==a.MeshBasicMaterial&&(l.push(r.assignTexture(c,"normalMap",s.normalTexture)),c.normalScale=new a.Vector2(1,-1),void 0!==s.normalTexture.scale&&c.normalScale.set(s.normalTexture.scale,-s.normalTexture.scale)),void 0!==s.occlusionTexture&&t!==a.MeshBasicMaterial&&(l.push(r.assignTexture(c,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(c.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&t!==a.MeshBasicMaterial&&(c.emissive=(new a.Color).fromArray(s.emissiveFactor)),void 0!==s.emissiveTexture&&t!==a.MeshBasicMaterial&&l.push(r.assignTexture(c,"emissiveMap",s.emissiveTexture)),Promise.all(l).then((function(){var i;return i=t===g?o[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(c):new t(c),s.name&&(i.name=s.name),i.map&&(i.map.encoding=a.sRGBEncoding),i.emissiveMap&&(i.emissiveMap.encoding=a.sRGBEncoding),G(i,s),r.associations.set(i,{type:"materials",index:e}),s.extensions&&F(o,i,s),i}))},V.prototype.createUniqueName=function(e){for(var t=a.PropertyBinding.sanitizeNodeName(e||""),n=t,r=1;this.nodeNamesUsed[n];++r)n=t+"_"+r;return this.nodeNamesUsed[n]=!0,n},V.prototype.loadGeometries=function(e){var t=this,r=this.extensions,i=this.primitiveCache;function o(e){return r[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return W(n,e,t)}))}for(var s=[],c=0,u=e.length;c<u;c++){var l,d=e[c],h=z(d),f=i[h];if(f)s.push(f.promise);else l=d.extensions&&d.extensions[n.KHR_DRACO_MESH_COMPRESSION]?o(d):W(new a.BufferGeometry,d,t),i[h]={primitive:d,promise:l},s.push(l)}return Promise.all(s)},V.prototype.loadMesh=function(e){for(var t,n=this,r=this.json,i=this.extensions,o=r.meshes[e],s=o.primitives,c=[],u=0,l=s.length;u<l;u++){var d=void 0===s[u].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new a.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:a.FrontSide})),t.DefaultMaterial):this.getDependency("material",s[u].material);c.push(d)}return c.push(n.loadGeometries(s)),Promise.all(c).then((function(t){for(var r=t.slice(0,t.length-1),c=t[t.length-1],u=[],l=0,d=c.length;l<d;l++){var h,f=c[l],p=s[l],m=r[l];if(p.mode===E||p.mode===S||p.mode===C||void 0===p.mode)!0!==(h=!0===o.isSkinnedMesh?new a.SkinnedMesh(f,m):new a.Mesh(f,m)).isSkinnedMesh||h.geometry.attributes.skinWeight.normalized||h.normalizeSkinWeights(),p.mode===S?h.geometry=J(h.geometry,a.TriangleStripDrawMode):p.mode===C&&(h.geometry=J(h.geometry,a.TriangleFanDrawMode));else if(p.mode===O)h=new a.LineSegments(f,m);else if(p.mode===_)h=new a.Line(f,m);else if(p.mode===A)h=new a.LineLoop(f,m);else{if(p.mode!==w)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+p.mode);h=new a.Points(f,m)}Object.keys(h.geometry.morphAttributes).length>0&&U(h,o),h.name=n.createUniqueName(o.name||"mesh_"+e),G(h,o),p.extensions&&F(i,h,p),n.assignFinalMaterial(h),u.push(h)}if(1===u.length)return u[0];for(var v=new a.Group,g=0,b=u.length;g<b;g++)v.add(u[g]);return v}))},V.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new a.PerspectiveCamera(a.MathUtils.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new a.OrthographicCamera(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),G(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},V.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))},V.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],n=[],r=[],i=[],o=[],s=[],c=0,u=t.channels.length;c<u;c++){var l=t.channels[c],d=t.samplers[l.sampler],h=l.target,f=void 0!==h.node?h.node:h.id,p=void 0!==t.parameters?t.parameters[d.input]:d.input,m=void 0!==t.parameters?t.parameters[d.output]:d.output;n.push(this.getDependency("node",f)),r.push(this.getDependency("accessor",p)),i.push(this.getDependency("accessor",m)),o.push(d),s.push(h)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(i),Promise.all(o),Promise.all(s)]).then((function(n){for(var r=n[0],i=n[1],o=n[2],s=n[3],c=n[4],u=[],l=0,d=r.length;l<d;l++){var h=r[l],f=i[l],p=o[l],m=s[l],v=c[l];if(void 0!==h){var g;switch(h.updateMatrix(),h.matrixAutoUpdate=!0,j[v.path]){case j.weights:g=a.NumberKeyframeTrack;break;case j.rotation:g=a.QuaternionKeyframeTrack;break;case j.position:case j.scale:default:g=a.VectorKeyframeTrack}var b=h.name?h.name:h.uuid,y=void 0!==m.interpolation?B[m.interpolation]:a.InterpolateLinear,w=[];j[v.path]===j.weights?h.traverse((function(e){!0===e.isMesh&&e.morphTargetInfluences&&w.push(e.name?e.name:e.uuid)})):w.push(b);var O=p.array;if(p.normalized){var A;if(O.constructor===Int8Array)A=1/127;else if(O.constructor===Uint8Array)A=1/255;else if(O.constructor==Int16Array)A=1/32767;else{if(O.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");A=1/65535}for(var _=new Float32Array(O.length),E=0,S=O.length;E<S;E++)_[E]=O[E]*A;O=_}for(var C=0,T=w.length;C<T;C++){var M=new g(w[C]+"."+j[v.path],f.array,O,y);"CUBICSPLINE"===m.interpolation&&(M.createInterpolant=function(e){return new x(this.times,this.values,this.getValueSize()/3,e)},M.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),u.push(M)}}}var k=t.name?t.name:"animation_"+e;return new a.AnimationClip(k,void 0,u)}))},V.prototype.loadNode=function(e){var t=this.json,n=this.extensions,r=this,i=t.nodes[e],o=i.name?r.createUniqueName(i.name):"";return function(){var t=[];return void 0!==i.mesh&&t.push(r.getDependency("mesh",i.mesh).then((function(e){var t=r._getNodeRef(r.meshCache,i.mesh,e);return void 0!==i.weights&&t.traverse((function(e){if(e.isMesh)for(var t=0,n=i.weights.length;t<n;t++)e.morphTargetInfluences[t]=i.weights[t]})),t}))),void 0!==i.camera&&t.push(r.getDependency("camera",i.camera).then((function(e){return r._getNodeRef(r.cameraCache,i.camera,e)}))),r._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){var s;if((s=!0===i.isBone?new a.Bone:t.length>1?new a.Group:1===t.length?t[0]:new a.Object3D)!==t[0])for(var c=0,u=t.length;c<u;c++)s.add(t[c]);if(i.name&&(s.userData.name=i.name,s.name=o),G(s,i),i.extensions&&F(n,s,i),void 0!==i.matrix){var l=new a.Matrix4;l.fromArray(i.matrix),s.applyMatrix4(l)}else void 0!==i.translation&&s.position.fromArray(i.translation),void 0!==i.rotation&&s.quaternion.fromArray(i.rotation),void 0!==i.scale&&s.scale.fromArray(i.scale);return r.associations.set(s,{type:"nodes",index:e}),s}))},V.prototype.loadScene=function(){function e(t,n,r,i){var o=r.nodes[t];return i.getDependency("node",t).then((function(e){return void 0===o.skin?e:i.getDependency("skin",o.skin).then((function(e){for(var n=[],r=0,a=(t=e).joints.length;r<a;r++)n.push(i.getDependency("node",t.joints[r]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(e.isMesh){for(var r=[],i=[],o=0,s=n.length;o<s;o++){var c=n[o];if(c){r.push(c);var u=new a.Matrix4;void 0!==t.inverseBindMatrices&&u.fromArray(t.inverseBindMatrices.array,16*o),i.push(u)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[o])}e.bind(new a.Skeleton(r,i),e.matrixWorld)}})),e}));var t})).then((function(t){n.add(t);var a=[];if(o.children)for(var s=o.children,c=0,u=s.length;c<u;c++){var l=s[c];a.push(e(l,t,r,i))}return Promise.all(a)}))}return function(t){var n=this.json,r=this.extensions,i=this.json.scenes[t],o=new a.Group;i.name&&(o.name=this.createUniqueName(i.name)),G(o,i),i.extensions&&F(r,o,i);for(var s=i.nodes||[],c=[],u=0,l=s.length;u<l;u++)c.push(e(s[u],o,n,this));return Promise.all(c).then((function(){return o}))}}(),e}();function c(e,t){return function(n){if(e){var r=new i;r.setDecoderPath("string"===typeof e?e:"https://www.gstatic.com/draco/v1/decoders/"),n.setDRACOLoader(r)}t&&n.setMeshoptDecoder(o)}}function u(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=Object(r.c)(s,e,c(t,n));return a}u.preload=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return r.c.preload(s,e,c(t,n))}}])]);
//# sourceMappingURL=4.d8e0805a.chunk.js.map