{"version":3,"sources":["libs/math.ts","store/makeObservable.ts","store/PredictionsStore.ts","components/CustomScrollbarBox.tsx","theme.ts","components/FinishedButton.tsx","store/store.ts","hooks/useQuery.tsx","components/ModalButton.tsx","modals/About.tsx","modals/Credits.tsx","modals/Privacy.tsx","modals/ModalSelector.tsx","components/PageContainer.tsx","chapters/Chapters.tsx","components/RoutedAnchor.tsx","plain/PageBodyButton.tsx","hooks/useIsActive.tsx","components/CameraIndicator.tsx","components/FullWidthStack.tsx","components/Frames.tsx","plain/Links.tsx","plain/Home.tsx","plain/Permission.tsx","Routes.ts","hooks/useChapterNumber.tsx","hooks/usePageType.tsx","hooks/useNextStep.tsx","components/ChapterAndCoverFinishedButton.tsx","components/timeline/ChapterIndicators.tsx","components/timeline/ChapterSelectDropdown.tsx","components/timeline/FadeOutBox.tsx","components/timeline/ModalButtons.tsx","components/timeline/MuteButton.tsx","components/timeline/NextChapterButton.tsx","components/timeline/PlayPauseButton.tsx","components/timeline/RewindButton.tsx","components/timeline/ShowMenuButton.tsx","components/timeline/ControlButtonRow.tsx","components/timeline/Timeline.tsx","components/MediaContainer.tsx","App.tsx","index.tsx"],"names":["lerp","from","to","amount","clamp","value","min","max","Math","lerpTheta","circleAt","PI","removeLoops","distance","floor","unloopedDistance","isLeft","offset","makeObservable","target","listeners","Set","unsubscribe","listenerFunc","delete","get","set","newValue","forEach","listener","subscribe","onChanged","add","PredictionsStore","getMouthPosition","scaledMesh","topHead","bottomHead","topLip","bottomLip","headSize","Vector3","distanceTo","mouthGap","areEyesOpen","topLeftEyelid","bottomLeftEyelid","leftEyeLeftCrease","leftEyeRightCrease","topRightEyelid","bottomRightEyelid","rightEyeLeftCrease","rightEyeRightCrease","leftEyeWidth","rightEyeWidth","leftEyeOpenGap","rightEyeOpenGap","empiricalLeftEyeOpenAmount","empiricalRightEyeOpenAmount","getScaledMesh","prediction","video","map","x","y","z","videoWidth","videoHeight","getMesh","aspect","mesh","getBoundingBox","topLeft","boundingBox","bottomRight","getOrthoVectors","forward","a","b","c","side1","subVectors","side2","crossVectors","normalize","getForwardVector","left","a2","b2","c2","side3","side4","getLeftVector","up","sub","getUpVector","predictions","modelPromise","webcam","isUpdating","hasFirstFace","isPaused","pauseFor","duration","console","log","Promise","resolve","setTimeout","update","size","undefined","facemesh","mediapipeFacemesh","shouldLoadIrisModel","maxFaces","requestAnimationFrame","readyState","HTMLMediaElement","HAVE_METADATA","estimateFaces","input","returnTensors","flipHorizontal","predictIrises","rawPrediction","orthoVectors","mouthOpened","eyesOpened","CustomScrollbarBox","styled","Box","colorTheme","yellowAlternative","black","white","offWhite","offWhiteOpaque","lightGrey","darkGrey","red","redLight","grayLight","charcoal","blue","blueLight","green","greenLight","yellow","yellowOpaque","customTheme","tip","content","background","color","global","colors","font","family","borderSize","medium","small","breakpoints","large","xlarge","heading","responsiveBreakpoint","level","height","weight","paragraph","maxWidth","text","xsmall","button","border","radius","width","padding","horizontal","vertical","layer","overlay","opacity","FinishedButton","props","useState","progress","setProgress","shouldShow","useEffect","shouldProgress","timeout","toProgress","clearTimeout","textWidth","style","display","plain","onClick","label","AnimateWidthAndHover","zIndex","position","pad","currentWidth","fullWidth","AnimatedBackground","styledWidth","direction","align","gap","overflow","flex","viewBox","fill","xmlns","d","lineHeight","initialState","webcamStream","chapter","isHeadingShown","isCameraEnabled","isActive","webcamAspect","webcamHTMLElement","document","createElement","store","create","toggleCamera","turnOffCamera","turnOnCamera","localStorage","setItem","maybeStream","getTracks","track","stop","srcObject","pause","reject","canGetWebcam","navigator","mediaDevices","getUserMedia","aspectRatio","then","stream","catch","error","addEventListener","cloneNode","play","getVideoTracks","getSettings","videoAspect","getItem","getState","useStore","createStoreHook","activityDetector","createActivityDetector","timeToIdle","ignoredEventsWhenIdle","on","setState","useQuery","location","useLocation","search","useMemo","URLSearchParams","OpenModalButton","query","history","useHistory","Button","as","event","modal","push","toString","CloseModalButton","About","isSmall","useContext","ResponsiveContext","textSize","Text","Credits","Privacy","ModalSelector","close","useCallback","onClose","frameColor","textColor","Modal","children","backgroundColor","state","Layer","full","responsive","animate","onEsc","animation","ModalContainer","isXSmall","window","innerWidth","margin","top","bottom","className","ScrollableFrame","outlineOffset","outline","showBorder","setShowBorder","ScrollableBox","onScroll","scrollTop","right","ScrollingHeadingBlock","bottomBorderStyle","borderBottom","justify","CloseButtonSmall","transform","CloseButtonNotSmall","ModalContent","PageContainer","Grommet","theme","Cover4","React","lazy","Cover2","Cover3","Chapter1","Chapter2","Chapter3","Chapter4","Chapter","memo","isCover","chapterNumber","transitionTrigger","transition","useTransition","enter","delay","leave","pair","Error","div","fallback","displayName","RoutedButton","href","OnHoverBox","fillColor","PageBodyButton","textContent","useIsActive","CameraIndicatorBox","borderColor","isOn","DisabledCameraBox","pointerEvents","AnimatePosition","AnimateMargin","whiteSpace","userSelect","CameraIndicatorBoxSmall","ChapterCameraIndicator","WebcamNotification","isShown","setIsShown","FadeOutBox","CameraIcon","TwoElementCrossFade","isFirstShown","disabled","CameraIconOn","fillRule","clipRule","cx","cy","r","CameraIconOff","x1","y1","x2","y2","stroke","strokeWidth","styleMap","center","StyledStackLayer","guiding","anchor","fillContainer","interactive","FullWidthStack","guidingChild","interactiveChild","rest","prunedChildren","Children","toArray","filter","toChildIndex","child","index","length","guidingIndex","interactiveIndex","styledChildren","buildStyledChildren","StyledStack","PageFrame","PageFrameWithCameraIndicator","Links","LinksSmall","isOnDark","LinksFloating","LinkFrame","LinksHeading","Heading","Home","HomeContainer","HomeContent","marginTop","marginHorizontal","Permission","PermissionContainer","Frame","PermissionContent","DeclineText","textDecoration","AcceptText","CameraIndicator","margins","validateChapterNumber","maybeValidStringChapterNumber","some","parseChapterNumber","maybeStringChapterNumber","parseInt","validatePageTypeQuery","type","parsePageTypeQuery","useChapterNumber","maybeChapterNumber","pathname","split","usePageType","useNextStep","pageType","nextPageType","nextChapterNumber","rewind","ChapterAndCoverNextButton","nextStep","isChapterComplete","ChapterIndicators","Grid","columns","count","getClickCoordinates","startsWith","isTouchEvent","changedTouches","clientX","clientY","StyleChildrenOnHover","ChapterIndicator","currentChapter","ref","useRef","isThisTheCurrentChapter","current","nativeEvent","rect","getBoundingClientRect","relativeX","StoreScrubber","isDragging","setIsDragging","oldState","newState","wasPlaying","getIsPlaying","onScrubberDragStart","onScrubberDragEnd","onScrubberDrag","onDrag","onDragStart","onDragEnd","Scrubber","buttonRef","containerRef","container","element","relativePosition","containerDimensions","dragInitial","dragCurrent","startPosition","setTransform","clippedX","onDragStartInner","preventDefault","onDragInner","onDragEndInner","passive","removeEventListener","useDraggableElement","buttonStyle","round","ChapterSelectDropdown","isOpen","setIsOpen","buttonText","DropButton","onOpen","open","dropAlign","dropContent","ModalButtons","StyledModalButtonText","MuteButton","isMuted","setMuted","icon","NextChapterButton","PlayPauseButton","Icon","intention","RewindButton","seekTimeDelta","clipPath","id","ShowMenuButton","ThreeDotsMenuButton","onMouseEnter","setHasTimeoutElapsed","buttonProps","StyledDot","borderRadius","ControlButtonRow","onOpenChange","hasTimeoutElapsed","rows","Timeline","Media","FrameBox","NextButton","isSmallOrMedium","minHeight","KnownRoute","ChapterRouter","match","params","replace","url","App","basename","exact","path","render","WebFont","custom","families","ReactDOM","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.7e0331dc.chunk.js","sourcesContent":["export function lerp(from: number, to: number, amount: number): number {\n  amount = amount < 0 ? 0 : amount;\n  amount = amount > 1 ? 1 : amount;\n  return from + (to - from) * amount;\n}\n\nexport const clamp = (value: number, min: number, max: number): number =>\n  Math.min(Math.max(min, value), max);\n\nexport function lerpTheta(\n  from: number,\n  to: number,\n  amount: number,\n  circleAt: number = Math.PI * 2\n) {\n  const removeLoops = (distance: number) =>\n    clamp(distance - Math.floor(distance / circleAt) * circleAt, 0, circleAt);\n\n  const distance = to - from;\n  const unloopedDistance = removeLoops(distance);\n  const isLeft = unloopedDistance > Math.PI;\n  const offset = isLeft ? unloopedDistance - Math.PI * 2 : unloopedDistance;\n  return lerp(from, from + offset, amount);\n}\n","export function makeObservable<T>(target: T): Observable<T> {\n  const listeners = new Set<(value: T) => void>();\n\n  let value = target;\n\n  const get = () => value;\n\n  const set = (newValue: T) => {\n    if (value === newValue) return;\n    value = newValue;\n\n    listeners.forEach((listener) => listener(value));\n  };\n\n  const subscribe = (onChanged: (value: T) => void) => {\n    listeners.add(onChanged);\n    return () => unsubscribe(onChanged);\n  };\n\n  const unsubscribe = (listenerFunc: (value: T) => void) => {\n    listeners.delete(listenerFunc);\n  };\n\n  return {\n    get,\n    set,\n    subscribe,\n    listeners,\n  };\n}\ninterface Observable<T> {\n  get(): T;\n  set(value: T): void;\n  subscribe(listener: (value: T) => void): () => void;\n  readonly listeners: Set<(value: T) => void>;\n}\n","import * as facemesh from \"@tensorflow-models/face-landmarks-detection\";\nimport {\n  AnnotatedPrediction,\n  MediaPipeFaceMesh,\n} from \"@tensorflow-models/face-landmarks-detection/dist/mediapipe-facemesh\";\nimport \"@tensorflow/tfjs-backend-webgl\";\nimport { clamp } from \"src/libs/math\";\nimport { V2 } from \"src/libs/v2\";\nimport { V3 } from \"src/libs/v3\";\nimport { Vector3 } from \"three\";\nimport { makeObservable } from \"./makeObservable\";\n\nexport interface Predictions {\n  scaledMesh: V3[];\n  mesh: V3[];\n  boundingBox: {\n    topLeft: V2;\n    bottomRight: V2;\n  };\n\n  orthoVectors: {\n    up: Vector3;\n    left: Vector3;\n    forward: Vector3;\n  };\n\n  mouthOpened: number;\n  eyesOpened: boolean;\n}\n\nexport class PredictionsStore {\n  private static predictions = makeObservable<Predictions[]>([]);\n  private static modelPromise: undefined | Promise<MediaPipeFaceMesh>;\n  private static webcam: undefined | HTMLVideoElement;\n  private static isUpdating = false;\n  static hasFirstFace = makeObservable(false);\n  static isPaused = false;\n  static pauseFor = async (duration: number) => {\n    console.log(\"Predictions paused\");\n    PredictionsStore.isPaused = true;\n    await new Promise((resolve) => {\n      setTimeout(resolve, duration);\n    });\n    console.log(\"Predictions resumed\");\n    PredictionsStore.isPaused = false;\n  };\n\n  static update = async () => {\n    PredictionsStore.isUpdating = false;\n    if (PredictionsStore.predictions.listeners.size === 0) return;\n    if (PredictionsStore.modelPromise === undefined) {\n      console.log(\"Loading model\");\n      PredictionsStore.modelPromise = facemesh.load(\n        facemesh.SupportedPackages.mediapipeFacemesh,\n        {\n          shouldLoadIrisModel: true,\n          maxFaces: 1,\n        }\n      );\n      console.log(\"Loaded model\");\n    }\n    if (PredictionsStore.webcam === undefined) return;\n    const webcam = PredictionsStore.webcam;\n\n    PredictionsStore.isUpdating = true;\n\n    if (PredictionsStore.isPaused)\n      return requestAnimationFrame(PredictionsStore.update);\n\n    if (webcam.readyState < HTMLMediaElement.HAVE_METADATA)\n      return requestAnimationFrame(PredictionsStore.update);\n\n    const rawPrediction = await (\n      await PredictionsStore.modelPromise\n    ).estimateFaces({\n      input: webcam,\n      returnTensors: false,\n      flipHorizontal: false,\n      predictIrises: true,\n    });\n\n    PredictionsStore.hasFirstFace.set(true);\n\n    const predictions = rawPrediction.map((prediction) => {\n      const scaledMesh = getScaledMesh(prediction, webcam);\n      const mesh = getMesh(prediction, webcam);\n      const boundingBox = getBoundingBox(prediction, webcam);\n      const orthoVectors = getOrthoVectors(mesh);\n      const mouthOpened = getMouthPosition(mesh);\n      const eyesOpened = areEyesOpen(mesh);\n\n      return {\n        scaledMesh,\n        boundingBox,\n        orthoVectors,\n        mouthOpened,\n        mesh,\n        eyesOpened,\n      };\n    });\n\n    PredictionsStore.predictions.set(predictions);\n\n    requestAnimationFrame(PredictionsStore.update);\n  };\n\n  static subscribe = (\n    webcam: HTMLVideoElement,\n    listener: (value: Predictions[]) => void\n  ) => {\n    const unsubscribe = PredictionsStore.predictions.subscribe(listener);\n    console.log(\n      `Added subscriber, have ${PredictionsStore.predictions.listeners.size} listeners`\n    );\n    PredictionsStore.webcam = webcam;\n    if (!PredictionsStore.isUpdating) PredictionsStore.update();\n    return () => {\n      console.log(\"Removing subscriber\");\n      return unsubscribe();\n    };\n  };\n\n  static get = PredictionsStore.predictions.get;\n}\n\nfunction getMouthPosition(scaledMesh: V3[]) {\n  const topHead = scaledMesh[10]!;\n  const bottomHead = scaledMesh[152]!;\n\n  const topLip = scaledMesh[12]!;\n  const bottomLip = scaledMesh[15]!;\n\n  const headSize = new Vector3(...topHead).distanceTo(\n    new Vector3(...bottomHead)\n  );\n  const mouthGap = new Vector3(...topLip).distanceTo(new Vector3(...bottomLip));\n\n  const empiricalMouthOpenAmount = clamp(\n    (mouthGap / headSize - 0.03) / 0.15,\n    0,\n    1\n  );\n  return empiricalMouthOpenAmount;\n}\n\nfunction areEyesOpen(scaledMesh: V3[]) {\n  const topLeftEyelid = scaledMesh[159]!;\n  const bottomLeftEyelid = scaledMesh[145]!;\n\n  const leftEyeLeftCrease = scaledMesh[33]!;\n  const leftEyeRightCrease = scaledMesh[133]!;\n\n  const topRightEyelid = scaledMesh[386]!;\n  const bottomRightEyelid = scaledMesh[374]!;\n\n  const rightEyeLeftCrease = scaledMesh[362]!;\n  const rightEyeRightCrease = scaledMesh[263]!;\n\n  const leftEyeWidth = new Vector3(...leftEyeLeftCrease).distanceTo(\n    new Vector3(...leftEyeRightCrease)\n  );\n\n  const rightEyeWidth = new Vector3(...rightEyeLeftCrease).distanceTo(\n    new Vector3(...rightEyeRightCrease)\n  );\n\n  const leftEyeOpenGap = new Vector3(...bottomLeftEyelid).distanceTo(\n    new Vector3(...topLeftEyelid)\n  );\n  const rightEyeOpenGap = new Vector3(...bottomRightEyelid).distanceTo(\n    new Vector3(...topRightEyelid)\n  );\n\n  const empiricalLeftEyeOpenAmount = clamp(\n    leftEyeOpenGap / (leftEyeWidth * 2),\n    0,\n    1\n  );\n  const empiricalRightEyeOpenAmount = clamp(\n    rightEyeOpenGap / (rightEyeWidth * 2),\n    0,\n    1\n  );\n\n  return (\n    empiricalLeftEyeOpenAmount > 0.11 && empiricalRightEyeOpenAmount > 0.11\n  );\n}\n\nfunction getScaledMesh(\n  prediction: AnnotatedPrediction,\n  video: HTMLVideoElement\n) {\n  return (prediction.scaledMesh as V3[]).map(([x, y, z]) => {\n    return [\n      x / video.videoWidth,\n      -y / video.videoHeight,\n      -z / video.videoWidth,\n    ] as V3;\n  });\n}\n\nfunction getMesh(prediction: AnnotatedPrediction, video: HTMLVideoElement) {\n  const aspect = video.videoWidth / video.videoHeight;\n  if (video.videoHeight > video.videoWidth) {\n    return (prediction.mesh as V3[]).map(([x, y, z]) => {\n      return [x / 192, (-y / 192) * aspect, -z / 192] as V3;\n    });\n  } else {\n    return (prediction.mesh as V3[]).map(([x, y, z]) => {\n      const correctedX = (x - 192 / 2) / 192 / aspect + 0.5;\n      return [correctedX, -y / 192, -z / 192] as V3;\n    });\n  }\n}\n\nfunction getBoundingBox(\n  prediction: AnnotatedPrediction,\n  video: HTMLVideoElement\n) {\n  const topLeft = [\n    (prediction.boundingBox.topLeft as V2)[0] / video.videoWidth,\n    -(prediction.boundingBox.topLeft as V2)[1] / video.videoHeight,\n  ] as V2;\n  const bottomRight = [\n    (prediction.boundingBox.bottomRight as V2)[0] / video.videoWidth,\n    -(prediction.boundingBox.bottomRight as V2)[1] / video.videoHeight,\n  ] as V2;\n  const boundingBox = {\n    topLeft: topLeft,\n    bottomRight: bottomRight,\n  };\n  return boundingBox;\n}\n\nfunction getOrthoVectors(mesh: V3[]) {\n  const forward = getForwardVector(mesh);\n  const left = getLeftVector(mesh);\n  const up = getUpVector(mesh);\n  return { up, forward, left };\n}\n\nfunction getUpVector(mesh: V3[]) {\n  return new Vector3(...mesh[199]!).sub(new Vector3(...mesh[9]!)).normalize();\n}\n\nfunction getLeftVector(mesh: V3[]) {\n  const a2 = new Vector3(...mesh[4]!);\n  const b2 = new Vector3(...mesh[10]!);\n  const c2 = new Vector3(...mesh[152]!);\n  const side3 = new Vector3().subVectors(a2, b2);\n  const side4 = new Vector3().subVectors(a2, c2);\n  const facingSidewaysFromHead = new Vector3()\n    .crossVectors(side3, side4)\n    .normalize();\n  return facingSidewaysFromHead;\n}\n\nfunction getForwardVector(mesh: V3[]) {\n  const a = new Vector3(mesh[151]![0]!, mesh[151]![1]!, mesh[151]![2]!);\n  const b = new Vector3(mesh[285]![0]!, mesh[285]![1]!, mesh[285]![2]!);\n  const c = new Vector3(mesh[55]![0]!, mesh[55]![1]!, mesh[55]![2]!);\n\n  const side1 = new Vector3().subVectors(a, b);\n  const side2 = new Vector3().subVectors(a, c);\n  const facingOutFromHead = new Vector3()\n    .crossVectors(side2, side1)\n    .normalize();\n  return facingOutFromHead;\n}\n","import { Box } from \"grommet\";\nimport styled from \"styled-components\";\nimport { colorTheme } from \"../theme\";\n\nexport const CustomScrollbarBox = styled(Box)`\n  &::-webkit-scrollbar {\n    width: 20px;\n  }\n\n  &::-webkit-scrollbar-track {\n  }\n\n  &::-webkit-scrollbar-thumb {\n    background-color: ${colorTheme.yellowAlternative};\n    outline-offset: -2px;\n    outline: 2px solid ${colorTheme.black};\n  }\n`;\n","import { ThemeType } from \"grommet\";\n\nexport const colorTheme = {\n  black: \"#202122\",\n  white: \"#FFFFFF\",\n  offWhite: \"#F8F9FA\",\n  offWhiteOpaque: \"rgba(248, 249, 250, 0.2)\",\n  lightGrey: \"#A2A9B1\",\n  darkGrey: \"#202122\",\n  red: \"#E01010\",\n  redLight: \"#FF5959\",\n  grayLight: \"#A2A9B1\",\n  charcoal: \"#2C2A21\",\n  blue: \"#312DFF\",\n  blueLight: \"#757AFF\",\n  green: \"#168500\",\n  greenLight: \"#20BF00\",\n  yellow: \"#FFD700\",\n  yellowOpaque: \"rgba(255, 215, 0, 0)\",\n  yellowAlternative: \"#E8C100\",\n} as const;\n\nexport const customTheme: ThemeType = {\n  tip: {\n    content: {\n      background: {\n        color: \"white\",\n      },\n    },\n  },\n  global: {\n    colors: {\n      ...colorTheme,\n    },\n    font: {\n      family: \"Roboto, sans-serif\",\n    },\n    borderSize: {\n      medium: \"3px\",\n      small: \"1px\",\n    },\n\n    breakpoints: {\n      small: {\n        value: 767,\n      },\n      medium: {\n        value: 1199,\n      },\n      large: {\n        value: 1439,\n      },\n      xlarge: {},\n    },\n  },\n  heading: {\n    responsiveBreakpoint: undefined,\n    level: {\n      \"1\": {\n        small: {\n          size: \"32px\",\n          height: \"48px\",\n        },\n        medium: {\n          size: \"48px\",\n          height: \"56.25px\",\n        },\n      },\n      \"2\": {\n        small: {\n          size: \"24px\",\n          height: \"32px\",\n        },\n      },\n    },\n    weight: 400,\n  },\n  paragraph: {\n    small: {\n      size: \"24px\",\n      height: \"32px\",\n      maxWidth: undefined,\n    },\n    medium: {\n      size: \"32px\",\n      height: \"48px\",\n      maxWidth: undefined,\n    },\n  },\n  text: {\n    xsmall: {\n      size: \"18px\",\n      height: \"24px\",\n      maxWidth: undefined,\n    },\n    small: {\n      size: \"24px\",\n      height: \"32px\",\n      maxWidth: undefined,\n    },\n    medium: {\n      size: \"32px\",\n      height: \"48px\",\n      maxWidth: undefined,\n    },\n  },\n  button: {\n    border: {\n      radius: \"0\",\n      width: \"3px\",\n    },\n    padding: {\n      horizontal: \"30px\",\n      vertical: \"10px\",\n    },\n    size: {\n      small: {\n        border: {\n          radius: \"0\",\n        },\n      },\n    },\n  },\n  layer: {\n    overlay: {\n      background: {\n        opacity: 0,\n      },\n    },\n  },\n};\n","import { Box, Button, Text } from \"grommet\";\nimport { useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { colorTheme } from \"../theme\";\n\nexport const FinishedButton = (props: {\n  text: string;\n  textWidth: string;\n  shouldShow: boolean;\n  shouldProgress: boolean;\n  toProgress?: () => void;\n}) => {\n  const [progress, setProgress] = useState(0);\n  const shouldShow = props.shouldShow;\n\n  useEffect(() => {\n    if (!props.shouldProgress) {\n      setProgress(0);\n      return;\n    }\n    if (progress >= 6) {\n      return;\n    }\n    const timeout = setTimeout(() => {\n      if (progress >= 5) {\n        setProgress(0);\n        props.toProgress?.();\n      } else {\n        setProgress(progress + 1);\n      }\n    }, 1000);\n    return () => clearTimeout(timeout);\n  }, [progress, props.toProgress, props]);\n\n  const text = props.text;\n  const width = props.textWidth;\n\n  return (\n    <Box style={shouldShow ? {} : { display: \"none\" }}>\n      <Button\n        plain\n        onClick={props.toProgress}\n        label={\n          <AnimateWidthAndHover\n            border={{ size: \"3px\", color: colorTheme.white }}\n            style={{ zIndex: 10, position: \"relative\" }}\n            pad={{ horizontal: \"21px\", vertical: \"5px\" }}\n            currentWidth={progress < 2 ? \"80px\" : width}\n            fullWidth={width}\n            background={{ color: \"black\", opacity: 0.9 }}\n          >\n            <AnimatedBackground\n              background=\"blue\"\n              styledWidth={progress / 5}\n            ></AnimatedBackground>\n            <Box direction=\"row\" align=\"center\" gap=\"10px\" overflow=\"hidden\">\n              <Box flex={false} width=\"32px\" height=\"32px\">\n                <svg\n                  width=\"32\"\n                  height=\"32\"\n                  viewBox=\"0 0 32 32\"\n                  fill=\"none\"\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                >\n                  <rect x=\"7\" y=\"11\" width=\"10\" height=\"10\" fill=\"#F8F9FA\" />\n                  <path d=\"M27 16L17 25L17 7L27 16Z\" fill=\"#F8F9FA\" />\n                </svg>\n              </Box>\n              <Box flex={false} height=\"24px\" overflow=\"hidden\">\n                <Text color=\"white\" size=\"24px\" style={{ lineHeight: \"100%\" }}>\n                  {text}\n                </Text>\n              </Box>\n            </Box>\n          </AnimateWidthAndHover>\n        }\n      />\n    </Box>\n  );\n};\n\nconst AnimatedBackground = styled(Box)<{ styledWidth: number }>`\n  transition: right 1s linear;\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: ${(props) => (1 - props.styledWidth) * 100}%;\n  bottom: 0;\n  z-index: -1;\n`;\n\nconst AnimateWidthAndHover = styled(Box)<{\n  currentWidth: string;\n  fullWidth: string;\n}>`\n  transition: width 1s linear, transform 0.2s;\n  width: ${(props) => props.currentWidth};\n  &:hover {\n    transition: width 0.6s;\n    width: ${(props) => props.fullWidth};\n  }\n`;\n","import createActivityDetector from \"activity-detector\";\nimport createStoreHook from \"zustand\";\nimport create from \"zustand/vanilla\";\nimport { NonFunctionProperties } from \"../@types/NonFunctionProperties\";\n\ntype State = {\n  webcamStream: MediaStream | undefined;\n  chapter:\n    | {\n        play: () => void;\n        pause: () => void;\n        rewind: () => void;\n        setProgress: (progress: number) => void;\n        getIsPlaying: () => boolean;\n        getProgress: () => number;\n        seekTimeDelta: (delta: number) => void;\n        seekTime: (time: number) => void;\n        setMuted: (isMuted: boolean) => void;\n        setVolume: (volume: number) => void;\n        isMuted: boolean;\n        intention: \"PLAY\" | \"PAUSE\";\n        progress: number;\n      }\n    | undefined;\n  toggleCamera: () => void;\n  turnOnCamera: () => void;\n  turnOffCamera: () => void;\n  isCameraEnabled: boolean;\n  isHeadingShown: boolean;\n  isActive: boolean;\n  webcamHTMLElement: HTMLVideoElement;\n  webcamAspect: number;\n};\n\nconst initialState: NonFunctionProperties<State> = {\n  webcamStream: undefined,\n  chapter: undefined,\n  isHeadingShown: true,\n  isCameraEnabled: true,\n  isActive: true,\n  webcamAspect: 4 / 3,\n  webcamHTMLElement: document.createElement(\"video\"),\n};\n\nexport const store = create<State>((set, get) => ({\n  ...initialState,\n  toggleCamera: () => {\n    const maybeStream = get().webcamStream;\n    const isOn = maybeStream !== undefined;\n    if (isOn) {\n      get().turnOffCamera();\n    } else {\n      get().turnOnCamera();\n    }\n  },\n  turnOffCamera: () => {\n    localStorage.setItem(\"isWebcamWanted\", \"false\");\n    const maybeStream = get().webcamStream;\n    const isOn = maybeStream !== undefined;\n    if (isOn) {\n      const stream = maybeStream!;\n      stream.getTracks().forEach((track) => track.stop());\n      set({ webcamStream: undefined });\n      const webcam = get().webcamHTMLElement;\n      webcam.srcObject = null;\n      webcam.pause();\n    }\n  },\n  turnOnCamera: async () => {\n    localStorage.setItem(\"isWebcamWanted\", \"true\");\n    const webcamIsOpen = get().webcamStream !== undefined;\n    if (webcamIsOpen) return;\n\n    getWebcam()\n      .then((stream) => {\n        stream.getTracks().forEach((track) => {\n          track.addEventListener(\"ended\", () => {\n            set({ webcamStream: undefined });\n          });\n\n          set({ webcamStream: stream });\n        });\n        const webcam = get().webcamHTMLElement.cloneNode() as HTMLVideoElement;\n\n        if (webcam.srcObject !== stream) {\n          webcam.srcObject = stream;\n          webcam.play();\n        }\n\n        const track = stream.getVideoTracks()[0]!;\n        webcam.width = track.getSettings().width!;\n        webcam.height = track.getSettings().height!;\n\n        const videoAspect = webcam.width / webcam.height;\n        set({ webcamAspect: videoAspect, webcamHTMLElement: webcam });\n      })\n      .catch((error) => console.error(error));\n  },\n}));\n\nif (localStorage.getItem(\"isWebcamWanted\") === \"true\") {\n  store.getState().turnOnCamera();\n} else {\n  store.getState().turnOffCamera();\n}\n\nexport const useStore = createStoreHook(store);\n\nfunction getWebcam() {\n  return new Promise<MediaStream>((resolve, reject) => {\n    const canGetWebcam =\n      !!navigator.mediaDevices && !!navigator.mediaDevices.getUserMedia;\n\n    if (!canGetWebcam) {\n      reject(\"Could not access navigator.mediaDevices\");\n      return;\n    }\n    try {\n      navigator.mediaDevices\n        .getUserMedia({\n          video: {\n            aspectRatio: 4 / 3,\n            width: 320,\n            height: 240,\n          },\n        })\n        .then((stream) => resolve(stream))\n        .catch((error) => {\n          console.log(\"Something went wrong accessing webcam!\");\n          reject(error);\n        });\n    } catch (error) {\n      console.log(\"Something went wrong accessing webcam!\");\n      reject(error);\n    }\n  });\n}\n\nconst activityDetector = createActivityDetector({\n  timeToIdle: 4000,\n  ignoredEventsWhenIdle: [],\n});\n\nactivityDetector.on(\"idle\", () => {\n  store.setState({ isActive: false });\n});\n\nactivityDetector.on(\"active\", () => {\n  store.setState({ isActive: true });\n});\n","import { useMemo } from \"react\";\nimport { useLocation } from \"react-router-dom\";\n\nexport function useQuery() {\n  const location = useLocation().search;\n  return useMemo(() => new URLSearchParams(location), [location]);\n}\n","import { Button, ButtonProps } from \"grommet\";\nimport React from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { useQuery } from \"../hooks/useQuery\";\n\nexport const OpenModalButton = (\n  props: ButtonProps & {\n    modal: \"about\" | \"privacy\" | \"credits\";\n  } & Pick<\n      React.DetailedHTMLProps<\n        React.ButtonHTMLAttributes<HTMLButtonElement>,\n        HTMLButtonElement\n      >,\n      \"onClick\"\n    >\n) => {\n  const query = useQuery();\n  const history = useHistory();\n\n  return (\n    <Button\n      {...props}\n      as={\"div\"}\n      onClick={(event) => {\n        props.onClick?.(event);\n        query.set(\"modal\", props.modal);\n        history.push({\n          ...history.location,\n          search: query.toString(),\n        });\n      }}\n    />\n  );\n};\n\nexport const CloseModalButton = (\n  props: ButtonProps &\n    Pick<\n      React.DetailedHTMLProps<\n        React.ButtonHTMLAttributes<HTMLButtonElement>,\n        HTMLButtonElement\n      >,\n      \"onClick\"\n    >\n) => {\n  const query = useQuery();\n  const history = useHistory();\n\n  return (\n    <Button\n      {...props}\n      as={\"div\"}\n      onClick={(event) => {\n        props.onClick?.(event);\n        query.delete(\"modal\");\n        history.push({\n          ...history.location,\n          search: query.toString(),\n        });\n      }}\n    />\n  );\n};\n","import { ResponsiveContext, Text } from \"grommet\";\nimport React, { useContext } from \"react\";\n\nexport const About = () => {\n  const size = useContext(ResponsiveContext) as\n    | \"small\"\n    | \"medium\"\n    | \"large\"\n    | \"xlarge\";\n\n  const isSmall = size === \"small\";\n  const textSize = isSmall ? \"20px\" : \"24px\";\n  const lineHeight = isSmall ? \"30px\" : \"36px\";\n\n  return (\n    <>\n      <Text size={textSize} style={{ lineHeight: lineHeight }} color=\"black\">\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euism\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n        <br />\n        <br />\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euismod\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n        <br />\n        <br />\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euismod\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n        <br />\n        <br />\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euismod\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n        <br />\n        <br />\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euismod\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n        <br />\n        <br />\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euismod\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n      </Text>\n    </>\n  );\n};\n","import { ResponsiveContext, Text } from \"grommet\";\nimport React, { useContext } from \"react\";\n\nexport const Credits = () => {\n  const size = useContext(ResponsiveContext) as\n    | \"small\"\n    | \"medium\"\n    | \"large\"\n    | \"xlarge\";\n\n  const isSmall = size === \"small\";\n\n  const textSize = isSmall ? \"20px\" : \"24px\";\n  const lineHeight = isSmall ? \"30px\" : \"36px\";\n  return (\n    <>\n      <Text size={textSize} style={{ lineHeight: lineHeight }} color=\"black\">\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euism\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n        <br />\n        <br />\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euismod\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n        <br />\n        <br />\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euismod\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n      </Text>\n    </>\n  );\n};\n","import { ResponsiveContext, Text } from \"grommet\";\nimport React, { useContext } from \"react\";\n\nexport const Privacy = () => {\n  const size = useContext(ResponsiveContext) as\n    | \"small\"\n    | \"medium\"\n    | \"large\"\n    | \"xlarge\";\n\n  const isSmall = size === \"small\";\n  const textSize = isSmall ? \"20px\" : \"24px\";\n  const lineHeight = isSmall ? \"30px\" : \"36px\";\n  return (\n    <>\n      <Text size={textSize} style={{ lineHeight: lineHeight }} color=\"black\">\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euism\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n        <br />\n        <br />\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euismod\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n        <br />\n        <br />\n        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Eget euismod\n        neque, sed justo, nibh pulvinar fringilla euismod scelerisque. Eu et\n        scelerisque maecenas magna dolor id arcu massa orci. Nunc commodo neque,\n        quis eu eget imperdiet purus duis. Venenatis, amet sapien sollicitudin\n        auctor sed gravida aliquet bibendum.\n      </Text>\n    </>\n  );\n};\n","import { Box, BoxProps, Layer, ResponsiveContext, Text } from \"grommet\";\nimport {\n  CSSProperties,\n  PropsWithChildren,\n  useCallback,\n  useContext,\n  useState,\n} from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { CloseModalButton } from \"../components/ModalButton\";\nimport { useQuery } from \"../hooks/useQuery\";\nimport { useStore } from \"../store/store\";\nimport { colorTheme } from \"../theme\";\nimport { About } from \"./About\";\nimport { Credits } from \"./Credits\";\nimport { CustomScrollbarBox } from \"../components/CustomScrollbarBox\";\nimport { Privacy } from \"./Privacy\";\n\nexport const ModalSelector = () => {\n  const query = useQuery();\n  const history = useHistory();\n\n  const close = useCallback(() => {\n    query.delete(\"modal\");\n    history.push({\n      ...history.location,\n      search: query.toString(),\n    });\n  }, [history, query]);\n\n  switch (query.get(\"modal\")) {\n    case \"about\":\n      return (\n        <Modal\n          onClose={close}\n          frameColor={colorTheme.blue}\n          textColor={colorTheme.white}\n          heading=\"About\"\n        >\n          <About />\n        </Modal>\n      );\n    case \"privacy\":\n      return (\n        <Modal\n          onClose={close}\n          frameColor={colorTheme.red}\n          textColor={colorTheme.white}\n          heading=\"Privacy\"\n        >\n          <Privacy />\n        </Modal>\n      );\n    case \"credits\":\n      return (\n        <Modal\n          onClose={close}\n          frameColor={colorTheme.green}\n          textColor={colorTheme.white}\n          heading=\"Credits\"\n        >\n          <Credits />\n        </Modal>\n      );\n    default:\n      return null;\n  }\n};\n\nconst Modal = ({\n  onClose,\n  children,\n  frameColor,\n  textColor,\n  heading,\n}: PropsWithChildren<{\n  onClose: () => void;\n  frameColor: string;\n  textColor: string;\n  heading: string;\n}>) => {\n  const backgroundColor = useStore((state) =>\n    state.chapter !== undefined ? \"black\" : \"yellowAlternative\"\n  );\n  return (\n    <>\n      <Layer\n        full\n        responsive={false}\n        animate\n        position={\"bottom\"}\n        onEsc={onClose}\n        animation={\"fadeIn\"}\n      >\n        <Box fill background={backgroundColor}></Box>\n      </Layer>\n      <Layer\n        full\n        responsive={false}\n        animate\n        position={\"bottom\"}\n        onEsc={onClose}\n        animation={\"slide\"}\n        style={{\n          backgroundColor: \"rgba(0,0,0,0)\",\n        }}\n      >\n        <ModalContainer\n          frameColor={frameColor}\n          textColor={textColor}\n          heading={heading}\n        >\n          <ModalContent>{children}</ModalContent>\n        </ModalContainer>\n      </Layer>\n    </>\n  );\n};\n\nconst ModalContainer = ({\n  children,\n  textColor,\n  frameColor,\n  heading,\n}: PropsWithChildren<{\n  frameColor: string;\n  textColor: string;\n  heading: string;\n}>) => {\n  const size = useContext(ResponsiveContext) as\n    | \"small\"\n    | \"medium\"\n    | \"large\"\n    | \"xlarge\";\n\n  let props: BoxProps;\n  switch (size) {\n    case \"small\":\n      const isXSmall = window.innerWidth < 500;\n\n      props = {\n        margin: {\n          horizontal: isXSmall ? \"8px\" : \"16px\",\n          top: isXSmall ? \"8px\" : \"16px\",\n          bottom: \"-4px\",\n        },\n        gap: \"48px\",\n      };\n      break;\n    case \"medium\":\n      props = {\n        margin: { horizontal: \"48px\", top: \"48px\", bottom: \"-4px\" },\n        gap: \"48px\",\n      };\n      break;\n    case \"large\":\n      props = {\n        margin: { horizontal: \"48px\", top: \"48px\", bottom: \"-4px\" },\n        width: { max: \"1080px\" },\n      };\n      break;\n    case \"xlarge\":\n      props = {\n        margin: { horizontal: \"48px\", top: \"48px\", bottom: \"-4px\" },\n        width: { max: \"1080px\" },\n      };\n      break;\n  }\n\n  return (\n    <Box fill overflow=\"hidden\" align=\"center\">\n      <Box className=\"modal container\" {...props} background=\"yellow\">\n        <ScrollableFrame\n          textColor={textColor}\n          frameColor={frameColor}\n          heading={heading}\n        >\n          {children}\n        </ScrollableFrame>\n      </Box>\n    </Box>\n  );\n};\n\nconst ScrollableFrame = ({\n  children,\n  frameColor,\n  textColor,\n  heading,\n}: PropsWithChildren<{\n  frameColor: string;\n  textColor: string;\n  heading: string;\n}>) => {\n  const style: CSSProperties = {\n    outlineOffset: `-3px`,\n    outline: `3px ${frameColor} solid`,\n  };\n\n  const [showBorder, setShowBorder] = useState(false);\n  const isSmall = useContext(ResponsiveContext) === \"small\";\n  const textSize = isSmall ? \"24px\" : \"48px\";\n\n  const ScrollableBox = isSmall ? Box : CustomScrollbarBox;\n\n  return (\n    <Box className=\"scrollable-frame\" style={style} flex={false} fill>\n      <ScrollingHeadingBlock frameColor={frameColor} showBorder={showBorder}>\n        <Text size={textSize} color={textColor} style={{ lineHeight: \"100%\" }}>\n          {heading}\n        </Text>\n      </ScrollingHeadingBlock>\n\n      <Box fill>\n        <ScrollableBox\n          flex={false}\n          overflow={{ horizontal: \"hidden\", vertical: \"auto\" }}\n          onScroll={(event) =>\n            setShowBorder((event.target as HTMLElement).scrollTop !== 0)\n          }\n          height=\"100%\"\n          margin={{ right: isSmall ? \"0\" : \"12px\" }}\n        >\n          {children}\n        </ScrollableBox>\n      </Box>\n    </Box>\n  );\n};\n\nconst ScrollingHeadingBlock = ({\n  frameColor,\n  children,\n  showBorder,\n}: PropsWithChildren<{\n  frameColor: string;\n  showBorder: boolean;\n}>) => {\n  let bottomBorderStyle = showBorder\n    ? { borderBottom: `3px solid ${colorTheme.yellowAlternative}` }\n    : { borderBottom: `3px solid ${colorTheme.yellow}` };\n\n  const isSmall = useContext(ResponsiveContext) === \"small\";\n\n  return (\n    <Box\n      flex={false}\n      className=\"heading-block\"\n      direction=\"row\"\n      style={bottomBorderStyle}\n      justify={\"between\"}\n    >\n      <Box\n        background={frameColor}\n        pad={{ horizontal: isSmall ? \"16px\" : \"20px\", vertical: \"12px\" }}\n      >\n        {children}\n      </Box>\n      {isSmall ? <CloseButtonSmall /> : <CloseButtonNotSmall />}\n    </Box>\n  );\n};\n\nconst CloseButtonSmall = () => {\n  return (\n    <Box pad={{ right: \"11px\", top: \"10px\" }}>\n      <CloseModalButton\n        plain\n        fill\n        label={\n          <svg\n            width=\"32\"\n            height=\"32\"\n            viewBox=\"0 0 32 32\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <rect\n              x=\"6.82837\"\n              y=\"4\"\n              width=\"29.1079\"\n              height=\"4\"\n              transform=\"rotate(45 6.82837 4)\"\n              fill=\"#202122\"\n            />\n            <rect\n              x=\"27.4109\"\n              y=\"6.82849\"\n              width=\"29.1079\"\n              height=\"4\"\n              transform=\"rotate(135 27.4109 6.82849)\"\n              fill=\"#202122\"\n            />\n          </svg>\n        }\n      />\n    </Box>\n  );\n};\n\nconst CloseButtonNotSmall = () => {\n  return (\n    <Box pad={{ right: \"6px\", top: \"4px\" }}>\n      <CloseModalButton\n        plain\n        fill\n        label={\n          <svg\n            width=\"64\"\n            height=\"64\"\n            viewBox=\"0 0 64 64\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <rect\n              x=\"13.6567\"\n              y=\"8\"\n              width=\"58.2158\"\n              height=\"8\"\n              transform=\"rotate(45 13.6567 8)\"\n              fill=\"#202122\"\n            />\n            <rect\n              x=\"54.8218\"\n              y=\"13.6567\"\n              width=\"58.2158\"\n              height=\"8\"\n              transform=\"rotate(135 54.8218 13.6567)\"\n              fill=\"#202122\"\n            />\n          </svg>\n        }\n      />\n    </Box>\n  );\n};\n\nconst ModalContent = ({ children }: PropsWithChildren<{}>) => {\n  const size = useContext(ResponsiveContext) as\n    | \"small\"\n    | \"medium\"\n    | \"large\"\n    | \"xlarge\";\n\n  let props: BoxProps;\n  switch (size) {\n    case \"small\":\n      props = {\n        margin: { left: \"18px\", right: \"18px\", top: \"56px\" },\n        pad: { bottom: \"68px\" },\n      };\n      break;\n    case \"medium\":\n      props = {\n        margin: { left: \"60px\", right: \"28px\", top: \"48px\" },\n        width: { max: \"600px\" },\n        pad: { bottom: \"132px\" },\n      };\n      break;\n    case \"large\":\n      props = {\n        margin: { top: \"48px\", left: \"192px\", right: 192 - 32 + \"px\" },\n        width: { max: \"600px\" },\n        pad: { bottom: \"132px\" },\n      };\n      break;\n    case \"xlarge\":\n      props = {\n        margin: { top: \"48px\", left: \"240px\", right: 240 - 32 + \"px\" },\n        width: { max: \"600px\" },\n        pad: { bottom: \"132px\" },\n      };\n      break;\n  }\n  return (\n    <Box align=\"center\">\n      <Box gap={\"40px\"} {...props} flex={false}>\n        {children}\n      </Box>\n    </Box>\n  );\n};\n","import { Grommet } from \"grommet\";\nimport React, { PropsWithChildren } from \"react\";\nimport { ModalSelector } from \"../modals/ModalSelector\";\nimport { customTheme } from \"../theme\";\n\nexport const PageContainer = ({\n  children,\n  backgroundColor,\n}: PropsWithChildren<{ backgroundColor: \"yellow\" | \"black\" }>) => {\n  return (\n    <Grommet theme={customTheme} full background={backgroundColor}>\n      {children}\n      <ModalSelector />\n    </Grommet>\n  );\n};\n","import { useTransition } from \"@react-spring/core\";\nimport { Box, Text } from \"grommet\";\nimport React, { memo, Suspense, useMemo } from \"react\";\nimport { animated } from \"react-spring\";\nimport { PredictionsStore } from \"src/store/PredictionsStore\";\n\nconst Cover4 = React.lazy(async () => import(\"./chapter4/Cover4\"));\nconst Cover2 = React.lazy(async () => import(\"./chapter2/Cover2\"));\nconst Cover3 = React.lazy(async () => import(\"./chapter3/Cover3\"));\nconst Chapter1 = React.lazy(async () => import(\"./chapter1/Chapter1\"));\nconst Chapter2 = React.lazy(async () => import(\"./chapter2/Chapter2\"));\nconst Chapter3 = React.lazy(async () => import(\"./chapter3/Chapter3\"));\nconst Chapter4 = React.lazy(async () => import(\"./chapter4/Chapter4\"));\n\nexport const Chapter = memo(\n  ({\n    isCover,\n    chapterNumber,\n  }: {\n    isCover: boolean;\n    chapterNumber: 1 | 2 | 3 | 4;\n  }) => {\n    const transitionTrigger = useMemo(() => {\n      PredictionsStore.pauseFor(700);\n      return { isCover, chapterNumber };\n    }, [chapterNumber, isCover]);\n    const transition = useTransition(transitionTrigger, {\n      from: { opacity: 0 },\n      enter: { opacity: 1, delay: 200 },\n      leave: { opacity: 0 },\n    });\n\n    return (\n      <Box fill flex={false} style={{ position: \"relative\" }}>\n        {transition((style, { isCover, chapterNumber }) => {\n          let pair;\n          if (isCover) {\n            switch (chapterNumber) {\n              case 1:\n                throw new Error(\"No cover for chapter 1\");\n              case 2:\n                pair = <Cover2 />;\n                break;\n              case 3:\n                pair = <Cover3 />;\n                break;\n              case 4:\n                pair = <Cover4 />;\n                break;\n            }\n          } else {\n            switch (chapterNumber) {\n              case 1:\n                pair = <Chapter1 />;\n                break;\n              case 2:\n                pair = <Chapter2 />;\n                break;\n              case 3:\n                pair = <Chapter3 />;\n                break;\n              case 4:\n                pair = <Chapter4 />;\n                break;\n            }\n          }\n          return (\n            <animated.div\n              style={{\n                ...style,\n                width: \"100%\",\n                height: \"100%\",\n                position: \"absolute\",\n                top: 0,\n              }}\n            >\n              <Suspense fallback={<Text>Loading...</Text>}>{pair}</Suspense>\n            </animated.div>\n          );\n        })}\n      </Box>\n    );\n  }\n);\n\nChapter.displayName = \"Chapter\";\n","import { Button, ButtonProps } from \"grommet\";\nimport React from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { Routes } from \"../Routes\";\n\nexport const RoutedButton = (\n  props: ButtonProps & { href: Routes } & Pick<\n      React.DetailedHTMLProps<\n        React.ButtonHTMLAttributes<HTMLButtonElement>,\n        HTMLButtonElement\n      >,\n      \"onClick\"\n    >\n) => {\n  return (\n    <Link to={props.href}>\n      <Button {...props} as={\"div\"} />\n    </Link>\n  );\n};\n","import { Box, Text } from \"grommet\";\nimport React, { ReactNode } from \"react\";\nimport styled from \"styled-components\";\nimport { RoutedButton } from \"../components/RoutedAnchor\";\nimport { Routes } from \"../Routes\";\nimport { colorTheme } from \"../theme\";\n\nconst OnHoverBox = styled(Box)<{ fillColor: string }>`\n  &:hover {\n    background-color: ${(props) => props.fillColor};\n\n    & > span {\n      color: ${colorTheme.offWhite};\n    }\n  }\n\n  & > span {\n    color: ${(props) => props.fillColor};\n  }\n\n  transition: color 0.2s, background-color 0.2s;\n`;\n\nexport const PageBodyButton = ({\n  color,\n  textContent,\n  href,\n  onClick,\n  size = \"small\",\n}: {\n  onClick?: () => void;\n  color: keyof typeof colorTheme;\n  textContent: ReactNode;\n  href: Routes;\n  size?: \"large\" | \"small\";\n}) => {\n  const pad =\n    size === \"small\"\n      ? { horizontal: \"24px\", vertical: \"9px\" }\n      : { horizontal: \"30px\", vertical: \"13px\" };\n\n  return (\n    <Box className=\"custom button\" direction=\"row\">\n      <RoutedButton\n        onClick={onClick}\n        plain\n        label={\n          <OnHoverBox\n            border={{ color, style: \"solid\", size: \"3px\" }}\n            pad={pad}\n            fillColor={colorTheme[color]}\n          >\n            <Text size=\"24px\" style={{ lineHeight: \"100%\" }} color={color}>\n              {textContent}\n            </Text>\n          </OnHoverBox>\n        }\n        href={href}\n      />\n    </Box>\n  );\n};\n","import { useStore } from \"../store/store\";\n\nexport function useIsActive() {\n  return useStore((state) => state.isActive);\n}\n","import { Box, Button, ResponsiveContext, Text } from \"grommet\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport styled from \"styled-components\";\nimport { useIsActive } from \"../hooks/useIsActive\";\nimport { store, useStore } from \"../store/store\";\nimport { colorTheme } from \"../theme\";\n\nexport const CameraIndicatorBox = ({\n  borderColor = \"yellow\",\n}: {\n  borderColor?: \"yellow\" | \"black\";\n}) => {\n  const isSmall = useContext(ResponsiveContext) === \"small\";\n  const isOn = useStore((state) => state.webcamStream !== undefined);\n  const isActive = useIsActive();\n  const toggleCamera = useStore((state) => state.toggleCamera);\n\n  const isCameraEnabled = useStore((state) => state.isCameraEnabled);\n\n  if (!isCameraEnabled) {\n    return <DisabledCameraBox />;\n  }\n  if (isSmall) {\n    return <CameraIndicatorBoxSmall borderColor={borderColor} />;\n  }\n\n  const onText = \"Webcam on\";\n  const offText = \"Webcam off\";\n  const text = isOn ? onText : offText;\n  const width = \"186px\";\n\n  return (\n    <Button\n      style={{ pointerEvents: \"all\" }}\n      plain\n      onClick={() => toggleCamera()}\n      label={\n        <AnimateWidthAndHover\n          currentWidth={!isActive ? \"48px\" : width}\n          fullWidth={width}\n          direction=\"row\"\n          border={{ color: borderColor, size: \"3px\" }}\n          height=\"48px\"\n          style={{ position: \"relative\" }}\n          background=\"charcoal\"\n          className=\"CameraIndicatorBox\"\n          align=\"center\"\n          overflow=\"hidden\"\n        >\n          <AnimatePosition flex={false} isLeft={!isOn} width=\"42px\">\n            <CameraIcon />\n          </AnimatePosition>\n          <AnimateMargin\n            pad={{ horizontal: \"20px\", vertical: \"8px\" }}\n            isLeft={isOn}\n            flex={false}\n            height=\"18px\"\n            justify=\"center\"\n            style={{\n              whiteSpace: \"nowrap\",\n              overflow: \"hidden\",\n            }}\n          >\n            <Text\n              size=\"18px\"\n              color=\"grayLight\"\n              style={{ userSelect: \"none\", lineHeight: \"18px\" }}\n            >\n              {text}\n            </Text>\n          </AnimateMargin>\n        </AnimateWidthAndHover>\n      }\n    />\n  );\n};\n\nconst CameraIndicatorBoxSmall = ({\n  borderColor = \"yellow\",\n}: {\n  borderColor?: \"yellow\" | \"black\";\n}) => {\n  return (\n    <Button\n      style={{ pointerEvents: \"all\" }}\n      plain\n      onClick={store.getState().toggleCamera}\n      label={\n        <Box\n          direction=\"row\"\n          border={{ color: borderColor, size: \"3px\" }}\n          height=\"48px\"\n          style={{ position: \"relative\" }}\n          background=\"charcoal\"\n          className=\"CameraIndicatorBox\"\n          align=\"center\"\n          overflow=\"hidden\"\n        >\n          <Box flex={false} width=\"42px\">\n            <CameraIcon />\n          </Box>\n        </Box>\n      }\n    ></Button>\n  );\n};\n\nfunction DisabledCameraBox() {\n  return (\n    <Box fill=\"horizontal\" flex={false}>\n      <Box justify=\"end\" gap={\"16px\"}>\n        <CameraIndicatorBoxSmall borderColor={\"yellow\"} />\n      </Box>\n    </Box>\n  );\n}\n\nexport const ChapterCameraIndicator = () => {\n  const isCameraEnabled = useStore((state) => state.isCameraEnabled);\n\n  if (isCameraEnabled) {\n    return (\n      <Box fill=\"horizontal\" flex={false}>\n        <Box justify=\"end\" gap={\"16px\"}>\n          <CameraIndicatorBox />\n          <WebcamNotification />\n        </Box>\n      </Box>\n    );\n  } else {\n    return <DisabledCameraBox />;\n  }\n};\n\nconst WebcamNotification = () => {\n  const [isShown, setIsShown] = useState(true);\n  useEffect(() => {\n    const timeout =\n      isShown &&\n      setTimeout(() => {\n        setIsShown(false);\n      }, 3000);\n    return () => {\n      timeout && clearTimeout(timeout);\n    };\n  }, [isShown]);\n\n  return (\n    <FadeOutBox\n      isShown={isShown}\n      flex={false}\n      style={{\n        position: \"absolute\",\n        top: \"calc(16px + 100%)\",\n        right: 0,\n        zIndex: 1,\n        width: \"186px\",\n      }}\n      background={\"black\"}\n      pad=\"10px\"\n      border={{ color: \"red\", size: \"3px\" }}\n    >\n      <Text size=\"xsmall\" color=\"offWhite\">\n        To make this sequence interactive, turn on your webcam\n      </Text>\n    </FadeOutBox>\n  );\n};\n\nconst CameraIcon = () => {\n  const isCameraEnabled = useStore((state) => state.isCameraEnabled);\n  const isOn = useStore((state) => state.webcamStream !== undefined);\n\n  return (\n    <TwoElementCrossFade\n      isFirstShown={isOn}\n      width=\"42px\"\n      height=\"42px\"\n      flex={false}\n    >\n      <Box className=\"first\">\n        <CameraIconOn disabled={!isCameraEnabled} />\n      </Box>\n      <Box className=\"last\">\n        <CameraIconOff disabled={!isCameraEnabled} />\n      </Box>\n    </TwoElementCrossFade>\n  );\n};\n\nconst CameraIconOn = ({ disabled = false }: { disabled?: boolean }) => {\n  return (\n    <svg\n      width=\"42px\"\n      height=\"42px\"\n      viewBox=\"0 0 42 42\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect\n        width=\"42\"\n        height=\"42\"\n        fill={disabled ? colorTheme.lightGrey : \"#20BF00\"}\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M11 12.7C9.89543 12.7 9 13.5954 9 14.7V29.9C9 31.0046 9.89543 31.9 11 31.9H31C32.1046 31.9 33 31.0046 33 29.9V14.7C33 13.5954 32.1046 12.7 31 12.7H11ZM21 28C24.3137 28 27 25.3137 27 22C27 18.6863 24.3137 16 21 16C17.6863 16 15 18.6863 15 22C15 25.3137 17.6863 28 21 28Z\"\n        fill=\"#202122\"\n      />\n      <path\n        d=\"M15 13C15 10.7909 16.7909 9 19 9H23C25.2091 9 27 10.7909 27 13H15Z\"\n        fill=\"#202122\"\n      />\n      <circle cx=\"21\" cy=\"22\" r=\"4\" fill=\"#202122\" />\n    </svg>\n  );\n};\n\nconst CameraIconOff = ({ disabled = false }: { disabled?: boolean }) => {\n  return (\n    <svg\n      width=\"42px\"\n      height=\"42px\"\n      viewBox=\"0 0 42 42\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <rect\n        width=\"42\"\n        height=\"42\"\n        fill={disabled ? colorTheme.lightGrey : \"#FF5959\"}\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M11 12.7C9.89543 12.7 9 13.5954 9 14.7V29.9C9 31.0045 9.89543 31.9 11 31.9H31C32.1046 31.9 33 31.0045 33 29.9V14.7C33 13.5954 32.1046 12.7 31 12.7H11ZM21 28C24.3137 28 27 25.3137 27 22C27 18.6862 24.3137 16 21 16C17.6863 16 15 18.6862 15 22C15 25.3137 17.6863 28 21 28Z\"\n        fill=\"#202122\"\n      />\n      <path\n        d=\"M15 13C15 10.7909 16.7909 9 19 9H23C25.2091 9 27 10.7909 27 13H15Z\"\n        fill=\"#202122\"\n      />\n      <circle cx=\"21\" cy=\"22\" r=\"4\" fill=\"#202122\" />\n      <line\n        x1=\"8.58579\"\n        y1=\"34.0416\"\n        x2=\"34.0416\"\n        y2=\"8.58575\"\n        stroke=\"#202122\"\n        strokeWidth=\"4\"\n      />\n    </svg>\n  );\n};\n\nconst FadeOutBox = styled(Box)<{ isShown: boolean }>`\n  opacity: ${(props) => (props.isShown ? \"1\" : \"0\")};\n  transition: opacity 0.6s;\n`;\n\nconst AnimatePosition = styled(Box)<{ isLeft: boolean }>`\n  position: absolute;\n  left: ${(props) => (props.isLeft ? \"0\" : \"100%\")};\n  right: ${(props) => (props.isLeft ? \"100%\" : \"0\")};\n  transform: translateX(${(props) => (!props.isLeft ? \"-100%\" : \"0%\")});\n  top: 0;\n  transition: left 0.2s, right 0.2s, transform 0.2s;\n`;\n\nconst AnimateMargin = styled(Box)<{ isLeft: boolean }>`\n  margin-left: ${(props) => (props.isLeft ? \"0\" : \"48px\")};\n  margin-right: ${(props) => (props.isLeft ? \"48px\" : \"0\")};\n  transition: margin-left 0.2s, margin-right 0.2s;\n`;\n\nconst AnimateWidthAndHover = styled(Box)<{\n  currentWidth: string;\n  fullWidth: string;\n}>`\n  transition: width 0.2s linear;\n  width: ${(props) => props.currentWidth};\n  &:hover {\n    width: ${(props) => props.fullWidth};\n  }\n`;\n\nconst TwoElementCrossFade = styled(Box)<{ isFirstShown: boolean }>`\n  & > .first {\n    position: relative;\n    transition: opacity 0.2s;\n    opacity: ${(props) => (props.isFirstShown ? \"1\" : \"0\")};\n    width: 100%;\n  }\n\n  & > .last {\n    position: absolute;\n    transition: opacity 0.2s;\n    top: 0;\n    right: 0;\n    left: 0;\n    bottom: 0;\n    opacity: ${(props) => (props.isFirstShown ? \"0\" : \"1\")};\n  }\n`;\n","import React, {\n  Children,\n  PropsWithChildren,\n  ReactNode,\n  ReactText,\n} from \"react\";\n\nimport { StyledStack } from \"grommet/components/Stack/StyledStack\";\nimport { StackProps } from \"grommet\";\nimport styled from \"styled-components\";\n\nconst styleMap = {\n  fill: `\n    top: 0;\n    left: 0;\n    bottom: 0;\n    right: 0;\n  `,\n  center: `\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n  `,\n  left: `\n    top: 50%;\n    left: 0;\n    transform: translateY(-50%);\n  `,\n  right: `\n    top: 50%;\n    right: 0;\n    transform: translateY(-50%);\n  `,\n  top: `\n    top: 0;\n    left: 50%;\n    transform: translateX(-50%);\n  `,\n  bottom: `\n    bottom: 0;\n    left: 50%;\n    transform: translateX(-50%);\n  `,\n  \"top-fill\": `\n    top: 0;\n    left: 0;\n    width: 100%;\n  `,\n  \"top-left\": `\n    top: 0;\n    left: 0;\n  `,\n  \"bottom-left\": `\n    bottom: 0;\n    left: 0;\n  `,\n  \"top-right\": `\n    top: 0;\n    right: 0;\n  `,\n  \"bottom-right\": `\n    bottom: 0;\n    right: 0;\n  `,\n} as const;\n\nconst StyledStackLayer = styled.div<{\n  guiding?: boolean;\n  fillContainer?: boolean | \"horizontal\" | \"vertical\";\n  interactive: boolean;\n  anchor?: keyof typeof styleMap;\n}>`\n  position: ${(props) => (props.guiding ? \"relative\" : \"absolute\")};\n  ${(props) => props.guiding && \"display: block;\"}\n  ${(props) => !props.guiding && `${styleMap[props.anchor || \"fill\"]};`}\n  ${(props) =>\n    props.fillContainer &&\n    `\n    width: 100%;\n    height: 100%;\n  `}\n  ${(props) => !props.interactive && `pointer-events: none;`}\n`;\n\nconst buildStyledChildren = ({\n  anchor,\n  fill,\n  guidingIndex,\n  interactiveChild,\n  interactiveIndex,\n}: {\n  anchor: keyof typeof styleMap;\n  fill: StackProps[\"fill\"];\n  guidingIndex: ReactText;\n  interactiveChild: StackProps[\"interactiveChild\"];\n  interactiveIndex: string | number | undefined;\n}) => (child: ReactNode, index: number) => {\n  const interactive =\n    interactiveChild === undefined || interactiveIndex === index;\n  const isGuidingIndex = index === guidingIndex;\n  const props = isGuidingIndex\n    ? { guiding: true, fillContainer: fill }\n    : { anchor };\n\n  return (\n    <StyledStackLayer key={index} interactive={interactive} {...props}>\n      {child}\n    </StyledStackLayer>\n  );\n};\n\nexport const FullWidthStack = ({\n  anchor,\n  children,\n  fill,\n  guidingChild,\n  interactiveChild,\n  ...rest\n}: PropsWithChildren<\n  Omit<StackProps, \"anchor\"> & { anchor: keyof typeof styleMap }\n>) => {\n  const prunedChildren = Children.toArray(children).filter((c) => c);\n  const toChildIndex = (child: string | number | undefined) => {\n    let index = child;\n    if (index === \"first\" || !index) index = 0;\n    else if (index === \"last\") index = prunedChildren.length - 1;\n    return index;\n  };\n\n  const guidingIndex = toChildIndex(guidingChild);\n  const interactiveIndex = interactiveChild && toChildIndex(interactiveChild);\n\n  const styledChildren = prunedChildren.map(\n    buildStyledChildren({\n      anchor,\n      fill,\n      guidingIndex,\n      interactiveChild,\n      interactiveIndex,\n    })\n  );\n\n  return (\n    <StyledStack fillContainer={fill} {...rest}>\n      {styledChildren}\n    </StyledStack>\n  );\n};\n","import { Box, ResponsiveContext, Text } from \"grommet\";\nimport React, { PropsWithChildren, useContext } from \"react\";\nimport { CameraIndicatorBox } from \"./CameraIndicator\";\nimport { FullWidthStack } from \"./FullWidthStack\";\n\nexport const PageFrame = ({\n  children,\n  frameColor,\n  textColor,\n  heading,\n}: PropsWithChildren<{\n  frameColor: string;\n  textColor: string;\n  heading: string;\n}>) => {\n  const style = {\n    outlineOffset: `-3px`,\n    outline: `3px ${frameColor} solid`,\n  };\n\n  const size = useContext(ResponsiveContext) as \"small\" | string;\n  const isSmall = size === \"small\";\n\n  const textSize = isSmall ? \"24px\" : \"48px\";\n\n  return (\n    <Box className=\"frame\" style={style} flex={false}>\n      <Box className=\"heading-block\" direction=\"row\">\n        <Box\n          background={frameColor}\n          pad={{ horizontal: isSmall ? \"16px\" : \"20px\", vertical: \"12px\" }}\n        >\n          <Text\n            size={textSize}\n            color={textColor}\n            style={{ lineHeight: \"100%\" }}\n          >\n            {heading}\n          </Text>\n        </Box>\n      </Box>\n\n      {children}\n    </Box>\n  );\n};\n\nexport const PageFrameWithCameraIndicator = ({\n  children,\n  frameColor,\n  textColor,\n  heading,\n}: PropsWithChildren<{\n  frameColor: string;\n  textColor: string;\n  heading: string;\n}>) => {\n  const style = {\n    outlineOffset: `-3px`,\n    outline: `3px ${frameColor} solid`,\n  };\n\n  const size = useContext(ResponsiveContext) as \"small\" | string;\n  const isSmall = size === \"small\";\n  const textSize = isSmall ? \"24px\" : \"48px\";\n\n  return (\n    <Box\n      className=\"page frame with camera indicator\"\n      style={style}\n      flex={false}\n    >\n      <FullWidthStack fill anchor=\"top-fill\">\n        <Box fill>{children}</Box>\n\n        <Box\n          className=\"heading-block\"\n          direction=\"row\"\n          flex={false}\n          justify=\"between\"\n          align=\"start\"\n          style={{ userSelect: \"none\", pointerEvents: \"none\" }}\n        >\n          <Box\n            background={frameColor}\n            pad={{ horizontal: isSmall ? \"16px\" : \"20px\", vertical: \"12px\" }}\n          >\n            <Text\n              size={textSize}\n              color={textColor}\n              style={{ lineHeight: \"100%\" }}\n            >\n              {heading}\n            </Text>\n          </Box>\n          <CameraIndicatorBox borderColor=\"black\" />\n        </Box>\n      </FullWidthStack>\n    </Box>\n  );\n};\n","import { Box, Heading, ResponsiveContext } from \"grommet\";\nimport React, { CSSProperties, PropsWithChildren, useContext } from \"react\";\nimport styled from \"styled-components\";\nimport { colorTheme } from \"../theme\";\nimport { OpenModalButton } from \"../components/ModalButton\";\n\nexport const Links = () => {\n  const size = useContext(ResponsiveContext);\n\n  switch (size) {\n    case \"small\":\n      return <LinksSmall />;\n    case \"medium\":\n      return <LinksFloating position=\"below\" />;\n    default:\n      return <LinksFloating position=\"bottom-right\" />;\n  }\n};\n\nfunction LinksSmall({ isOnDark = false }: { isOnDark?: boolean }) {\n  const blue = !isOnDark ? colorTheme.blue : colorTheme.blueLight;\n  const red = !isOnDark ? colorTheme.red : colorTheme.redLight;\n  const green = !isOnDark ? colorTheme.green : colorTheme.greenLight;\n  const text = !isOnDark ? colorTheme.white : colorTheme.black;\n  return (\n    <Box className=\"links\" gap=\"24px\">\n      <OpenModalButton\n        modal=\"about\"\n        plain\n        label={\n          <LinkFrame textColor={text} frameColor={blue} heading=\"About\">\n            <Box height={\"32px\"}></Box>\n          </LinkFrame>\n        }\n      />\n      <OpenModalButton\n        modal=\"privacy\"\n        plain\n        label={\n          <LinkFrame textColor={text} frameColor={red} heading=\"Privacy\">\n            <Box height={\"32px\"}></Box>\n          </LinkFrame>\n        }\n      />\n      <OpenModalButton\n        modal=\"credits\"\n        plain\n        label={\n          <LinkFrame textColor={text} frameColor={green} heading=\"Credits\">\n            <Box height={\"32px\"}></Box>\n          </LinkFrame>\n        }\n      />\n    </Box>\n  );\n}\n\nconst LinksFloating = ({\n  position,\n}: {\n  position: \"below\" | \"bottom-right\";\n}) => {\n  const style: CSSProperties =\n    position === \"below\"\n      ? { position: \"relative\", left: \"-454px\", top: \"0px\" }\n      : { position: \"relative\", left: \"-282px\", top: \"-100px\" };\n  return (\n    <Box className=\"links\" direction=\"row\" justify=\"end\" style={style}>\n      <div style={{ position: \"relative\" }}>\n        <div\n          style={{\n            position: \"absolute\",\n            top: \"64px\",\n          }}\n        >\n          <OpenModalButton\n            modal=\"about\"\n            plain\n            fill\n            label={\n              <LinkFrame\n                textColor={colorTheme.white}\n                frameColor={colorTheme.blue}\n                heading=\"About\"\n              >\n                <Box height={\"64px\"} width={\"128px\"}></Box>\n              </LinkFrame>\n            }\n          />\n        </div>\n        <div\n          style={{\n            position: \"absolute\",\n            left: \"204px\",\n          }}\n        >\n          <OpenModalButton\n            modal=\"privacy\"\n            plain\n            fill\n            label={\n              <LinkFrame\n                textColor={colorTheme.white}\n                frameColor={colorTheme.red}\n                heading=\"Privacy\"\n              >\n                <Box height={\"96px\"} width={\"142px\"}></Box>\n              </LinkFrame>\n            }\n          />\n        </div>\n        <div\n          style={{\n            position: \"absolute\",\n            left: \"314px\",\n            top: \"84px\",\n          }}\n        >\n          <OpenModalButton\n            modal=\"credits\"\n            plain\n            fill\n            label={\n              <LinkFrame\n                textColor={colorTheme.white}\n                frameColor={colorTheme.green}\n                heading=\"Credits\"\n              >\n                <Box height={\"60px\"} width={\"140px\"}></Box>\n              </LinkFrame>\n            }\n          />\n        </div>\n      </div>\n    </Box>\n  );\n};\n\nconst OnHoverBox = styled(Box)`\n  &:hover {\n    transform: translateY(-4px);\n  }\n\n  transition: transform 0.2s;\n`;\n\nconst LinkFrame = ({\n  children,\n  frameColor,\n  textColor,\n  heading,\n}: PropsWithChildren<{\n  frameColor: string;\n  textColor: string;\n  heading: string;\n}>) => {\n  return (\n    <OnHoverBox\n      className=\"link frame\"\n      style={{\n        outlineOffset: `-3px`,\n        outline: `3px ${frameColor} solid`,\n      }}\n      margin={{ bottom: \"8px\" }}\n    >\n      <LinksHeading\n        textColor={textColor}\n        frameColor={frameColor}\n        heading={heading}\n      />\n      {children}\n    </OnHoverBox>\n  );\n};\n\nconst LinksHeading = ({\n  frameColor,\n  textColor,\n  heading,\n}: {\n  frameColor: string;\n  textColor: string;\n  heading: string;\n}) => {\n  return (\n    <Box className=\"link heading\" direction=\"row\">\n      <Box\n        background={frameColor}\n        pad={{ horizontal: \"16px\", vertical: \"8px\" }}\n      >\n        <Heading level={2} color={textColor} margin=\"0\" size=\"small\">\n          {heading}\n        </Heading>\n      </Box>\n    </Box>\n  );\n};\n","import { Box, BoxProps, ResponsiveContext, Text } from \"grommet\";\nimport React, { PropsWithChildren, useContext, useEffect } from \"react\";\nimport { colorTheme } from \"../theme\";\nimport { PageBodyButton } from \"./PageBodyButton\";\nimport { PageFrame } from \"../components/Frames\";\nimport { Links } from \"./Links\";\nimport { store } from \"../store/store\";\n\nexport const Home = () => {\n  useEffect(() => {\n    store.setState({ isCameraEnabled: true });\n  }, []);\n\n  return (\n    <HomeContainer>\n      <HomeContent />\n    </HomeContainer>\n  );\n};\n\nconst HomeContainer = ({ children }: PropsWithChildren<{}>) => {\n  const size = useContext(ResponsiveContext) as\n    | \"small\"\n    | \"medium\"\n    | \"large\"\n    | \"xlarge\";\n\n  let props: BoxProps;\n  switch (size) {\n    case \"small\":\n      const isXSmall = window.innerWidth < 500;\n      props = { margin: isXSmall ? \"8px\" : \"16px\", gap: \"48px\" };\n      break;\n    case \"medium\":\n      props = {\n        margin: { horizontal: \"64px\", top: \"96px\", bottom: \"64px\" },\n        gap: \"48px\",\n      };\n      break;\n    case \"large\":\n      props = {\n        margin: { left: \"64px\", top: \"96px\", bottom: \"20px\" },\n        width: { max: \"896px\" },\n      };\n      break;\n    case \"xlarge\":\n      props = {\n        margin: { left: \"112px\", top: \"112px\", bottom: \"20px\" },\n        width: { max: \"896px\" },\n      };\n      break;\n  }\n\n  return (\n    <Box className=\"home container\" {...props}>\n      <PageFrame\n        textColor={colorTheme.yellow}\n        frameColor={colorTheme.black}\n        heading=\"Discriminator\"\n      >\n        {children}\n      </PageFrame>\n      <Links />\n    </Box>\n  );\n};\n\nconst HomeContent = () => {\n  const size = useContext(ResponsiveContext) as\n    | \"small\"\n    | \"medium\"\n    | \"large\"\n    | \"xlarge\";\n\n  const isSmall = size === \"small\";\n  const marginTop = isSmall ? \"56px\" : \"48px\";\n  const marginHorizontal = isSmall ? \"32px\" : \"64px\";\n\n  const textSize = isSmall ? \"20px\" : \"24px\";\n  const lineHeight = isSmall ? \"30px\" : \"36px\";\n\n  return (\n    <Box\n      gap={\"40px\"}\n      margin={{ horizontal: marginHorizontal, top: marginTop, bottom: \"64px\" }}\n    >\n      <Text size={textSize} style={{ lineHeight: lineHeight }} color=\"black\">\n        Egestas enim cursus pretium leo, egestas blandit egestas nunc magna.\n        Lectus euismod mauris faucibus massa nibh condimentum vitae nunc quis.\n        Lacus vitae amet aliquam id leo. Interdum vulputate eu et aliquet elit\n        morbi bibendum. Tellus euismod metus, id feugiat amet.\n      </Text>\n\n      <PageBodyButton\n        color=\"blue\"\n        textContent=\"Start\"\n        href=\"/permissions\"\n        size={isSmall ? \"small\" : \"large\"}\n      />\n    </Box>\n  );\n};\n","import { Box, BoxProps, ResponsiveContext, Text } from \"grommet\";\nimport React, {\n  PropsWithChildren,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport { colorTheme } from \"../theme\";\nimport { PageBodyButton } from \"./PageBodyButton\";\nimport {\n  PageFrame,\n  PageFrameWithCameraIndicator,\n} from \"../components/Frames\";\nimport { Links } from \"./Links\";\nimport { CameraIndicatorBox } from \"../components/CameraIndicator\";\nimport { store } from \"../store/store\";\n\nexport const Permission = () => {\n  useEffect(() => {\n    store.setState({ isCameraEnabled: true });\n  }, []);\n  const [showBorder, setShowBorder] = useState(false);\n  const isSmall = useContext(ResponsiveContext) === \"small\";\n  return (\n    <Box fill>\n      {!isSmall && <CameraIndicator showBorder={showBorder} />}\n      <Box\n        overflow=\"auto\"\n        onScroll={(event) =>\n          setShowBorder((event.target as HTMLElement).scrollTop !== 0)\n        }\n        height=\"100%\"\n      >\n        <PermissionContainer>\n          <PermissionContent />\n        </PermissionContainer>\n      </Box>\n    </Box>\n  );\n};\n\nconst PermissionContainer = ({ children }: PropsWithChildren<{}>) => {\n  const size = useContext(ResponsiveContext) as\n    | \"small\"\n    | \"medium\"\n    | \"large\"\n    | \"xlarge\";\n\n  let props: BoxProps;\n  switch (size) {\n    case \"small\":\n      const isXSmall = window.innerWidth < 500;\n\n      props = {\n        margin: {\n          horizontal: isXSmall ? \"8px\" : \"16px\",\n          top: isXSmall ? \"8px\" : \"16px\",\n          bottom: \"32px\",\n        },\n        gap: \"48px\",\n      };\n      break;\n    case \"medium\":\n      props = {\n        margin: { horizontal: \"64px\", top: \"16px\", bottom: \"64px\" },\n        gap: \"48px\",\n      };\n      break;\n    case \"large\":\n      props = {\n        margin: { left: \"64px\", top: \"20px\", bottom: \"20px\" },\n        width: { max: \"896px\" },\n      };\n      break;\n    case \"xlarge\":\n      props = {\n        margin: { left: \"112px\", top: \"36px\", bottom: \"20px\" },\n        width: { max: \"896px\" },\n      };\n      break;\n  }\n\n  const Frame = size === \"small\" ? PageFrameWithCameraIndicator : PageFrame;\n\n  return (\n    <Box className=\"permission container\" {...props}>\n      <Frame\n        textColor={colorTheme.yellow}\n        frameColor={colorTheme.black}\n        heading=\"Discriminator\"\n      >\n        {children}\n      </Frame>\n      <Links />\n    </Box>\n  );\n};\n\nconst PermissionContent = () => {\n  const size = useContext(ResponsiveContext) as\n    | \"small\"\n    | \"medium\"\n    | \"large\"\n    | \"xlarge\";\n\n  const isSmall = size === \"small\";\n  const marginTop = isSmall ? \"104px\" : \"48px\";\n  const marginHorizontal = isSmall ? \"32px\" : \"64px\";\n\n  const textSize = isSmall ? \"20px\" : \"24px\";\n  const lineHeight = isSmall ? \"30px\" : \"36px\";\n\n  const DeclineText = () =>\n    isSmall ? (\n      <span>\n        <span style={{ textDecoration: \"underline\" }}>Do not use</span> webcam\n      </span>\n    ) : (\n      <span>\n        Continue <span style={{ textDecoration: \"underline\" }}>without</span>{\" \"}\n        webcam\n      </span>\n    );\n  const AcceptText = () =>\n    isSmall ? (\n      <span>\n        <span style={{ textDecoration: \"underline\" }}>Use</span> webcam\n      </span>\n    ) : (\n      <span>\n        Continue <span style={{ textDecoration: \"underline\" }}>with</span>{\" \"}\n        webcam\n      </span>\n    );\n\n  return (\n    <Box\n      gap={\"40px\"}\n      margin={{ horizontal: marginHorizontal, top: marginTop, bottom: \"64px\" }}\n    >\n      <Text size={textSize} style={{ lineHeight: lineHeight }} color=\"black\">\n        To get out the best out of this experience, we recommend to enable your\n        webcam. We do not store any of your information (see our privacy\n        policy). If you choose to not enable your webcam you will see xyz.\n      </Text>\n\n      <PageBodyButton\n        color={\"red\"}\n        onClick={() => store.setState({ webcamStream: undefined })}\n        textContent={<DeclineText />}\n        href=\"/chapter/1?type=chapter\"\n      />\n      <PageBodyButton\n        color={\"green\"}\n        onClick={() => store.getState().turnOnCamera()}\n        textContent={<AcceptText />}\n        href=\"/chapter/1?type=chapter\"\n      />\n    </Box>\n  );\n};\n\nconst CameraIndicator = ({\n  showBorder,\n  backgroundColor = \"yellow\",\n}: {\n  showBorder: boolean;\n  backgroundColor?: \"black\" | \"yellow\";\n}) => {\n  const size = useContext(ResponsiveContext) as\n    | \"small\"\n    | \"medium\"\n    | \"large\"\n    | \"xlarge\";\n\n  const margins =\n    size === \"small\" || size === \"medium\"\n      ? { right: \"16px\", top: \"16px\", bottom: \"12px\" }\n      : { right: \"13px\", top: \"12px\", bottom: \"12px\" };\n  const bottomBorderStyle = showBorder\n    ? { borderBottom: `3px solid ${colorTheme.yellowAlternative}` }\n    : {};\n  return (\n    <Box\n      fill=\"horizontal\"\n      background={backgroundColor}\n      flex={false}\n      style={bottomBorderStyle}\n    >\n      <Box direction=\"row\" justify=\"end\" margin={margins}>\n        <CameraIndicatorBox />\n      </Box>\n    </Box>\n  );\n};\n","const routes = [\n  \"/\",\n  \"/home\",\n  \"/cover\",\n  \"/permissions\",\n  \"/coil\",\n  \"/chapter/1?type=chapter\",\n  \"/chapter/2?type=cover\",\n  \"/chapter/2?type=chapter\",\n  \"/chapter/3?type=cover\",\n  \"/chapter/3?type=chapter\",\n  \"/chapter/4?type=cover\",\n  \"/chapter/4?type=chapter\",\n] as const;\n\nexport const validateChapterNumber = (\n  maybeValidStringChapterNumber?: string\n) => {\n  return [...\"1234\"].some(\n    (chapterNumber) => chapterNumber === maybeValidStringChapterNumber\n  );\n};\n\nexport const parseChapterNumber = (\n  maybeStringChapterNumber?: string\n): 1 | 2 | 3 | 4 => {\n  if (\n    maybeStringChapterNumber === undefined ||\n    !validateChapterNumber(maybeStringChapterNumber)\n  ) {\n    throw new Error(\"Invalid chapter number\");\n  } else {\n    return parseInt(maybeStringChapterNumber, 10) as 1 | 2 | 3 | 4;\n  }\n};\n\nexport const validatePageTypeQuery = (\n  query: URLSearchParams,\n  chapterNumber: number\n) => {\n  const type = query.get(\"type\");\n  if (chapterNumber === 1 && type === \"cover\") return false;\n  const isValidQuery = type === \"cover\" || type === \"chapter\";\n\n  return isValidQuery;\n};\n\nexport const parsePageTypeQuery = (\n  query: URLSearchParams,\n  chapterNumber: number\n) => {\n  if (!validatePageTypeQuery(query, chapterNumber)) {\n    throw new Error(\"Invalid page type\");\n  } else {\n    return query.get(\"type\") as \"cover\" | \"chapter\";\n  }\n};\n\nexport type Routes = typeof routes[number];\n","import { useLocation } from \"react-router-dom\";\nimport { parseChapterNumber } from \"../Routes\";\n\nexport function useChapterNumber() {\n  const location = useLocation();\n  const maybeChapterNumber = location.pathname.split(\n    \"/chapter/\",\n    2\n  )?.[1]?.[0] as string | undefined;\n\n  return parseChapterNumber(maybeChapterNumber);\n}\n","import { parsePageTypeQuery } from \"../Routes\";\nimport { useChapterNumber } from \"./useChapterNumber\";\nimport { useQuery } from \"./useQuery\";\n\nexport function usePageType() {\n  const query = useQuery();\n  const chapterNumber = useChapterNumber();\n  return parsePageTypeQuery(query, chapterNumber);\n}\n","import { useHistory } from \"react-router-dom\";\nimport { store } from \"../store/store\";\nimport { useChapterNumber } from \"./useChapterNumber\";\nimport { usePageType } from \"./usePageType\";\n\nexport function useNextStep() {\n  const history = useHistory();\n  const chapterNumber = useChapterNumber();\n  const pageType = usePageType();\n\n  const nextPageType = pageType === \"cover\" ? \"chapter\" : \"cover\";\n  const nextChapterNumber =\n    pageType === \"cover\" ? chapterNumber : chapterNumber + 1;\n\n  const nextStep = () => {\n    if (nextPageType === \"chapter\") {\n      store.getState().chapter?.play();\n    } else {\n      store.getState().chapter?.rewind();\n    }\n\n    history.push(`/chapter/${nextChapterNumber}?type=${nextPageType}`);\n  };\n  return nextStep;\n}\n","import { useNextStep } from \"../hooks/useNextStep\";\nimport { usePageType } from \"../hooks/usePageType\";\nimport { useStore } from \"../store/store\";\nimport { FinishedButton } from \"./FinishedButton\";\n\nexport const ChapterAndCoverNextButton = () => {\n  const pageType = usePageType();\n  const nextStep = useNextStep();\n  const isChapterComplete = useStore((state) => state.chapter?.progress === 1);\n  const shouldShow = pageType === \"cover\" || isChapterComplete;\n\n  const text = pageType === \"cover\" ? \"Go to chapter\" : \"Go to next chapter\";\n  const width = pageType === \"cover\" ? \"235px\" : \"286px\";\n\n  return (\n    <FinishedButton\n      shouldProgress={false}\n      shouldShow={shouldShow}\n      text={text}\n      textWidth={width}\n      toProgress={nextStep}\n    />\n  );\n};\n","import { Box, Button, Grid } from \"grommet\";\nimport React, {\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport { useHistory } from \"react-router-dom\";\nimport { clamp } from \"src/libs/math\";\nimport styled from \"styled-components\";\nimport { useChapterNumber } from \"../../hooks/useChapterNumber\";\nimport { usePageType } from \"../../hooks/usePageType\";\nimport { store, useStore } from \"../../store/store\";\n\nexport const ChapterIndicators = () => {\n  return (\n    <Grid\n      fill\n      responsive={false}\n      columns={{ count: 4, size: \"auto\" }}\n      gap={\"4px\"}\n    >\n      <ChapterIndicator chapter={1} />\n      <ChapterIndicator chapter={2} />\n      <ChapterIndicator chapter={3} />\n      <ChapterIndicator chapter={4} />\n    </Grid>\n  );\n};\n\nfunction isTouchEvent(event: TouchEvent | MouseEvent): event is TouchEvent {\n  return event.type.startsWith(\"touch\");\n}\n\nfunction getClickCoordinates(\n  event: TouchEvent | MouseEvent\n): { x: number; y: number } {\n  if (isTouchEvent(event)) {\n    const x = event.changedTouches[0]?.clientX ?? 0;\n    const y = event.changedTouches[0]?.clientY ?? 0;\n    return { x, y };\n  } else {\n    const x = event.clientX;\n    const y = event.clientY;\n    return { x, y };\n  }\n}\n\nconst StyleChildrenOnHover = styled(Box)`\n  & {\n    position: relative;\n    height: 16px;\n  }\n  &:hover > :first-child {\n    height: 16px;\n  }\n\n  & > :first-child {\n    transition: height 0.1s;\n  }\n  & .scrubber-dot {\n    transition: width 0.1s, height 0.1s;\n  }\n\n  &:hover .scrubber-dot {\n    width: 26px;\n    height: 26px;\n  }\n\n  .scrubber-button:active .scrubber-dot {\n    width: 26px !important;\n    height: 26px !important;\n  }\n`;\n\nconst ChapterIndicator = ({ chapter }: { chapter: number }) => {\n  const currentChapter = useChapterNumber();\n  const ref = useRef<HTMLDivElement>(null);\n  const history = useHistory();\n  const pageType = usePageType();\n  const onClick = (event: React.MouseEvent<HTMLDivElement>) => {\n    const clickWasOnIndicator = event.target === ref.current;\n    if (!clickWasOnIndicator) return;\n    const isThisTheCurrentChapter = currentChapter === chapter;\n    if (!isThisTheCurrentChapter) {\n      history.push(`/chapter/${chapter}`);\n      return;\n    }\n    const { x } = getClickCoordinates(event.nativeEvent);\n    const rect = (event.target as HTMLDivElement).getBoundingClientRect();\n    const relativeX = Math.min(Math.max((x - rect.x) / rect.width, 0), 1);\n\n    store.getState().chapter?.setProgress(relativeX);\n    if (pageType !== \"chapter\") {\n      history.push(`/chapter/${currentChapter}?type=chapter`);\n    }\n  };\n  const isThisTheCurrentChapter = currentChapter === chapter;\n  return (\n    <StyleChildrenOnHover ref={ref as any} onClick={onClick} align=\"center\">\n      <Box\n        className=\"indicator-bar\"\n        background={{ color: \"yellowAlternative\", opacity: 0.8 }}\n        height=\"8px\"\n        style={{\n          pointerEvents: \"none\",\n          position: \"absolute\",\n          top: 0,\n          left: 0,\n          bottom: 0,\n          right: 0,\n          margin: \"auto\",\n        }}\n      />\n      {isThisTheCurrentChapter && <StoreScrubber />}\n    </StyleChildrenOnHover>\n  );\n};\n\nconst StoreScrubber = () => {\n  const [isDragging, setIsDragging] = useState(false);\n  const progress = useStore(\n    (state) => state.chapter?.progress || 0,\n    (oldState, newState) => {\n      const isSame = oldState === newState;\n      if (isSame) return true;\n      return isDragging;\n    }\n  );\n\n  const wasPlaying = useRef(store.getState().chapter?.getIsPlaying() ?? false);\n\n  const onScrubberDragStart = useCallback(() => {\n    setIsDragging(true);\n    wasPlaying.current = store.getState().chapter?.getIsPlaying() ?? false;\n    store.getState().chapter?.pause();\n  }, []);\n\n  const onScrubberDragEnd = useCallback((progress: number): void => {\n    setIsDragging(false);\n    store.getState().chapter?.setProgress(progress);\n    if (wasPlaying.current) store.getState().chapter?.play();\n  }, []);\n\n  const onScrubberDrag = useCallback((progress: number): void => {\n    store.getState().chapter?.setProgress(progress);\n  }, []);\n\n  return (\n    <Scrubber\n      position={progress}\n      onDrag={onScrubberDrag}\n      onDragStart={onScrubberDragStart}\n      onDragEnd={onScrubberDragEnd}\n    />\n  );\n};\n\nconst Scrubber = ({\n  onDragStart,\n  onDrag,\n  onDragEnd,\n  position = 0,\n}: {\n  position?: number;\n  onDragStart?: () => void;\n  onDrag?: (position: number) => void;\n  onDragEnd?: (position: number) => void;\n}) => {\n  const buttonRef = useRef<HTMLButtonElement>(null);\n  const containerRef = useRef<HTMLDivElement>(null);\n\n  useDraggableElement(\n    containerRef,\n    buttonRef,\n    position,\n    onDragStart,\n    onDrag,\n    onDragEnd\n  );\n\n  const buttonStyle: React.CSSProperties = useMemo(\n    () => ({\n      position: \"absolute\",\n      pointerEvents: \"auto\",\n      top: \"50%\",\n      transform: \"translateY(-50%)\",\n      width: \"auto\",\n      height: \"auto\",\n    }),\n    []\n  );\n  return (\n    <Box fill=\"horizontal\" ref={containerRef} style={{ pointerEvents: \"none\" }}>\n      <Button\n        style={buttonStyle}\n        className=\"scrubber-button\"\n        ref={buttonRef}\n        plain\n        label={\n          <Box\n            className=\"scrubber-dot\"\n            style={{ pointerEvents: \"none\" }}\n            round=\"100%\"\n            background=\"yellowAlternative\"\n            width=\"20px\"\n            height=\"20px\"\n          ></Box>\n        }\n      />\n    </Box>\n  );\n};\n\nfunction useDraggableElement(\n  container: React.RefObject<HTMLDivElement>,\n  element: React.RefObject<HTMLElement>,\n  relativePosition: number,\n  onDragStart: (() => void) | undefined,\n  onDrag: ((relativePosition: number) => void) | undefined,\n  onDragEnd: ((relativePosition: number) => void) | undefined\n) {\n  useEffect(() => {\n    if (!container.current || !element.current) return;\n    const containerDimensions = container.current.getBoundingClientRect();\n\n    let dragInitial = 0;\n    let dragCurrent = 0;\n    let startPosition = 0 + relativePosition * containerDimensions.width;\n    let isDragging: boolean = false;\n\n    const setTransform = (clippedX: number) => {\n      if (!element.current) return;\n      element.current.style.transform = `translate(${clippedX}px, -50%)`;\n    };\n\n    setTransform(startPosition);\n    const onDragStartInner = (event: TouchEvent | MouseEvent) => {\n      if (event.target !== element.current) {\n        isDragging = false;\n        return;\n      }\n\n      event.preventDefault();\n      const { x } = getClickCoordinates(event);\n      dragInitial = x - startPosition;\n      isDragging = true;\n      onDragStart?.();\n    };\n\n    const onDragInner = (event: TouchEvent | MouseEvent) => {\n      if (!isDragging) return;\n      if (!element.current) return;\n      event.preventDefault();\n\n      const { x } = getClickCoordinates(event);\n\n      dragCurrent = x - dragInitial;\n\n      const clippedX = Math.min(\n        Math.max(dragCurrent, 0),\n        containerDimensions.width\n      );\n      dragCurrent = clippedX;\n      const relativeX = clamp(clippedX / containerDimensions.width, 0, 1);\n\n      onDrag?.(relativeX);\n      setTransform(clippedX);\n    };\n\n    const onDragEndInner = (event: TouchEvent | MouseEvent) => {\n      if (!isDragging) return;\n      event.preventDefault();\n      startPosition = dragCurrent;\n      const clippedX = Math.min(\n        Math.max(dragCurrent, 0),\n        containerDimensions.width\n      );\n      const relativeX = clippedX / containerDimensions.width;\n\n      onDragEnd?.(relativeX);\n      isDragging = false;\n    };\n\n    window.addEventListener(\"mousemove\", onDragInner, false);\n    window.addEventListener(\"mousedown\", onDragStartInner, false);\n    window.addEventListener(\"mouseup\", onDragEndInner, false);\n\n    window.addEventListener(\"touchmove\", onDragInner, { passive: false });\n    window.addEventListener(\"touchstart\", onDragStartInner, { passive: false });\n    window.addEventListener(\"touchend\", onDragEndInner, { passive: false });\n\n    return () => {\n      window.removeEventListener(\"mousemove\", onDragInner);\n      window.removeEventListener(\"mousedown\", onDragStartInner);\n      window.removeEventListener(\"mouseup\", onDragEndInner);\n\n      window.removeEventListener(\"touchmove\", onDragInner);\n      window.removeEventListener(\"touchstart\", onDragStartInner);\n      window.removeEventListener(\"touchend\", onDragEndInner);\n    };\n  }, [element, onDragEnd, relativePosition, container, onDragStart, onDrag]);\n}\n","import { Box, DropButton, Text } from \"grommet\";\nimport React, { useState } from \"react\";\nimport { useChapterNumber } from \"../../hooks/useChapterNumber\";\nimport { colorTheme } from \"../../theme\";\nimport { RoutedButton } from \"../RoutedAnchor\";\n\nexport const ChapterSelectDropdown = () => {\n  const [isOpen, setIsOpen] = useState(false);\n  const onOpen = () => {\n    setIsOpen(true);\n  };\n  const onClose = () => {\n    setIsOpen(false);\n  };\n\n  const chapterNumber = useChapterNumber();\n  const buttonText = chapterNumber + \"/4\";\n\n  return (\n    <DropButton\n      plain\n      onOpen={onOpen}\n      onClose={onClose}\n      open={isOpen}\n      dropAlign={{ bottom: \"top\" }}\n      label={\n        <Box direction=\"row\">\n          <Text color=\"offWhite\" size=\"24px\" style={{ lineHeight: \"36px\" }}>\n            {buttonText}\n          </Text>\n          {!isOpen ? (\n            <svg\n              width=\"32\"\n              height=\"32\"\n              viewBox=\"0 0 32 32\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            >\n              <path\n                fillRule=\"evenodd\"\n                clipRule=\"evenodd\"\n                d=\"M6 19.9646L8.98938 22.954L16 15.9434L23.0106 22.954L26 19.9646L16.0354 10L16 10.0354L15.9646 10L6 19.9646Z\"\n                fill={colorTheme.offWhite}\n              />\n            </svg>\n          ) : (\n            <svg\n              width=\"32\"\n              height=\"32\"\n              viewBox=\"0 0 32 32\"\n              fill=\"none\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n            >\n              <path\n                fillRule=\"evenodd\"\n                clipRule=\"evenodd\"\n                d=\"M26 12.9894L23.0106 10L16 17.0106L8.98938 10L6 12.9894L15.9646 22.954L16 22.9186L16.0354 22.954L26 12.9894Z\"\n                fill=\"#F8F9FA\"\n              />\n            </svg>\n          )}\n        </Box>\n      }\n      dropContent={\n        <Box\n          background=\"black\"\n          pad=\"24px\"\n          border={{ color: \"offWhite\", size: \"3px\" }}\n          gap=\"24px\"\n        >\n          <RoutedButton\n            plain\n            href=\"/chapter/1?type=chapter\"\n            onClick={onClose}\n            label={\n              <Text color=\"offWhite\" size=\"24px\" style={{ lineHeight: \"36px\" }}>\n                Chapter 1\n              </Text>\n            }\n          />\n          <RoutedButton\n            plain\n            href=\"/chapter/2?type=cover\"\n            onClick={onClose}\n            label={\n              <Text color=\"offWhite\" size=\"24px\" style={{ lineHeight: \"36px\" }}>\n                Chapter 2\n              </Text>\n            }\n          />\n          <RoutedButton\n            plain\n            href=\"/chapter/3?type=cover\"\n            onClick={onClose}\n            label={\n              <Text color=\"offWhite\" size=\"24px\" style={{ lineHeight: \"36px\" }}>\n                Chapter 3\n              </Text>\n            }\n          />\n          <RoutedButton\n            plain\n            href=\"/chapter/4?type=cover\"\n            onClick={onClose}\n            label={\n              <Text color=\"offWhite\" size=\"24px\" style={{ lineHeight: \"36px\" }}>\n                Chapter 4\n              </Text>\n            }\n          />\n        </Box>\n      }\n    />\n  );\n};\n","import { Box } from \"grommet\";\nimport styled from \"styled-components\";\n\nexport const FadeOutBox = styled(Box)<{ isShown: boolean }>`\n  opacity: ${(props) => (props.isShown ? \"1\" : \"0\")};\n  transition: opacity 0.6s;\n`;\n","import { Text } from \"grommet\";\nimport React from \"react\";\nimport styled from \"styled-components\";\nimport { colorTheme } from \"../../theme\";\nimport { OpenModalButton } from \"../ModalButton\";\nimport { FadeOutBox } from \"./FadeOutBox\";\n\nexport function ModalButtons(props: { isOpen: boolean; isSmall: boolean }) {\n  return (\n    <FadeOutBox\n      isShown={props.isOpen}\n      flex={false}\n      direction=\"row\"\n      gap=\"20px\"\n      justify={props.isSmall ? \"between\" : \"end\"}\n      style={{ pointerEvents: !props.isOpen ? \"none\" : \"auto\" }}\n      align=\"center\"\n      width=\"100%\"\n    >\n      <OpenModalButton\n        plain\n        modal=\"about\"\n        label={\n          <StyledModalButtonText size=\"small\">About</StyledModalButtonText>\n        }\n      />\n      <OpenModalButton\n        plain\n        modal=\"privacy\"\n        label={\n          <StyledModalButtonText size=\"small\">Privacy</StyledModalButtonText>\n        }\n      />\n      <OpenModalButton\n        plain\n        modal=\"credits\"\n        label={\n          <StyledModalButtonText size=\"small\">Credits</StyledModalButtonText>\n        }\n      />\n    </FadeOutBox>\n  );\n}\nconst StyledModalButtonText = styled(Text)`\n  color: ${colorTheme.offWhite};\n  transition: text-decoration 0.2s;\n  text-decoration: underline solid transparent;\n\n  &:hover {\n    text-decoration: underline solid ${colorTheme.offWhite};\n  }\n`;\n","import { Button } from \"grommet\";\nimport { store, useStore } from \"../../store/store\";\nimport { colorTheme } from \"../../theme\";\n\nexport const MuteButton = () => {\n  const offWhite = colorTheme.offWhite;\n\n  const isMuted = useStore((state) => state.chapter?.isMuted ?? false);\n  return (\n    <Button\n      plain\n      onClick={() => store.getState().chapter?.setMuted(!isMuted)}\n      icon={\n        isMuted ? (\n          <svg\n            width=\"32\"\n            height=\"32\"\n            viewBox=\"0 0 32 32\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              clipRule=\"evenodd\"\n              d=\"M19.5703 15.8855L15.7328 19.723V26.7948L11.6462 23.8096L5 30.4558L2.17157 27.6274L7.59256 22.2064H4V9.58838H9.45161L15.7328 5V14.0662L18.7988 11.0001C18.5606 10.2606 18.2707 9.54782 17.9341 8.86679L20.6234 7.53736C20.8056 7.9058 20.9761 8.28171 21.1345 8.66451L22.9105 6.88846C22.8453 6.74883 22.7787 6.61014 22.7106 6.47242L23.9287 5.87025L27.6274 2.17157L30.4558 4.99999L26.8014 8.6544C27.5147 10.9529 27.9001 13.4093 27.9001 15.959C27.9001 19.8597 26.998 23.5422 25.3999 26.775L22.7106 25.4455C24.106 22.6227 24.9001 19.3947 24.9001 15.959C24.9001 14.2824 24.711 12.6553 24.3552 11.1006L22.3592 13.0967C22.4983 14.0295 22.5705 14.9856 22.5705 15.959C22.5705 18.9945 21.8685 21.862 20.6234 24.3806L17.9341 23.0511C18.9765 20.9425 19.5705 18.5295 19.5705 15.959C19.5705 15.9345 19.5704 15.91 19.5703 15.8855Z\"\n              fill=\"#F8F9FA\"\n            />\n          </svg>\n        ) : (\n          <svg\n            width=\"32\"\n            height=\"32\"\n            viewBox=\"0 0 32 32\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            <path\n              d=\"M15.7328 5L9.45161 9.58838H4V22.2064H9.45161L15.7328 26.7948V5Z\"\n              fill=\"#F8F9FA\"\n            />\n            <path\n              fillRule=\"evenodd\"\n              clipRule=\"evenodd\"\n              d=\"M24.9001 15.959C24.9001 12.5232 24.106 9.29527 22.7106 6.47242L25.3999 5.14298C26.998 8.37576 27.9001 12.0583 27.9001 15.959C27.9001 19.8597 26.998 23.5422 25.3999 26.775L22.7106 25.4455C24.106 22.6227 24.9001 19.3947 24.9001 15.959ZM19.5705 15.959C19.5705 13.3884 18.9765 10.9755 17.9341 8.86679L20.6234 7.53735C21.8685 10.056 22.5705 12.9235 22.5705 15.959C22.5705 18.9945 21.8685 21.862 20.6234 24.3806L17.9341 23.0511C18.9765 20.9425 19.5705 18.5295 19.5705 15.959Z\"\n              fill=\"#F8F9FA\"\n            />\n          </svg>\n        )\n      }\n      color={offWhite}\n    />\n  );\n};\n","import { Button } from \"grommet\";\nimport React from \"react\";\nimport { useNextStep } from \"../../hooks/useNextStep\";\nimport { colorTheme } from \"../../theme\";\n\nexport const NextChapterButton = () => {\n  const offWhite = colorTheme.offWhite;\n  const nextStep = useNextStep();\n  return (\n    <Button\n      onClick={nextStep}\n      plain\n      icon={\n        <svg\n          width=\"32\"\n          height=\"32\"\n          viewBox=\"0 0 32 32\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <path d=\"M4 6L20 16L4 26V6Z\" fill={offWhite} />\n          <rect\n            width=\"5\"\n            height=\"20\"\n            transform=\"matrix(-1 0 0 1 27 6)\"\n            fill={offWhite}\n          />\n        </svg>\n      }\n      color=\"offWhite\"\n    />\n  );\n};\n","import { Button } from \"grommet\";\nimport React from \"react\";\nimport { store, useStore } from \"../../store/store\";\nimport { colorTheme } from \"../../theme\";\n\nexport const PlayPauseButton = ({ disabled }: { disabled: boolean }) => {\n  const offWhite = colorTheme.offWhite;\n  const Icon = useStore((state) =>\n    state.chapter?.intention === undefined ||\n    state.chapter?.intention === \"PAUSE\" ? (\n      <svg\n        width=\"32\"\n        height=\"32\"\n        viewBox=\"0 0 32 32\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <path d=\"M8 6L26 16L8 26V6Z\" fill={offWhite} />\n      </svg>\n    ) : (\n      <svg\n        width=\"32\"\n        height=\"32\"\n        viewBox=\"0 0 32 32\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <rect x=\"7\" y=\"6\" width=\"6\" height=\"20\" fill={offWhite} />\n        <rect x=\"19\" y=\"6\" width=\"6\" height=\"20\" fill={offWhite} />\n      </svg>\n    )\n  );\n\n  return (\n    <Button\n      plain\n      onClick={() =>\n        store.getState().chapter?.getIsPlaying()\n          ? store.getState().chapter?.pause()\n          : store.getState().chapter?.play()\n      }\n      icon={Icon}\n      color=\"offWhite\"\n      disabled={disabled}\n    ></Button>\n  );\n};\n","import { Button } from \"grommet\";\nimport React from \"react\";\nimport { store } from \"../../store/store\";\nimport { colorTheme } from \"../../theme\";\n\nexport const RewindButton = ({ disabled }: { disabled: boolean }) => {\n  const offWhite = colorTheme.offWhite;\n\n  return (\n    <Button\n      plain\n      onClick={() => store.getState().chapter?.seekTimeDelta(-10)}\n      icon={\n        <svg\n          width=\"32\"\n          height=\"32\"\n          viewBox=\"0 0 32 32\"\n          fill=\"none\"\n          xmlns=\"http://www.w3.org/2000/svg\"\n        >\n          <g clipPath=\"url(#clip0)\">\n            <path\n              d=\"M16 6C21.5228 6 26 10.4772 26 16C26 21.5228 21.5228 26 16 26C10.4772 26 6 21.5228 6 16C6 13.239 7.11898 10.7393 8.92817 8.92969\"\n              stroke={offWhite}\n              strokeWidth=\"3\"\n            />\n            <path\n              d=\"M10.006 5.32348L17.5519 1.86969L15.9737 11.0902L10.006 5.32348Z\"\n              fill={offWhite}\n            />\n            <path\n              d=\"M14.1289 19H13V14.6484L11.6523 15.0664V14.1484L14.0078 13.3047H14.1289V19ZM19.8086 16.6484C19.8086 17.4349 19.6458 18.0365 19.3203 18.4531C18.9948 18.8698 18.5182 19.0781 17.8906 19.0781C17.2708 19.0781 16.7969 18.8737 16.4688 18.4648C16.1406 18.056 15.9727 17.4701 15.9648 16.707V15.6602C15.9648 14.8659 16.1289 14.263 16.457 13.8516C16.7878 13.4401 17.263 13.2344 17.8828 13.2344C18.5026 13.2344 18.9766 13.4388 19.3047 13.8477C19.6328 14.2539 19.8008 14.8385 19.8086 15.6016V16.6484ZM18.6797 15.5C18.6797 15.0286 18.6146 14.6862 18.4844 14.4727C18.3568 14.2565 18.1562 14.1484 17.8828 14.1484C17.6172 14.1484 17.4206 14.2513 17.293 14.457C17.168 14.6602 17.1016 14.9792 17.0938 15.4141V16.7969C17.0938 17.2604 17.1562 17.6055 17.2812 17.832C17.4089 18.056 17.612 18.168 17.8906 18.168C18.1667 18.168 18.3659 18.0599 18.4883 17.8438C18.6107 17.6276 18.6745 17.2969 18.6797 16.8516V15.5Z\"\n              fill={offWhite}\n            />\n          </g>\n          <defs>\n            <clipPath id=\"clip0\">\n              <rect width=\"32\" height=\"32\" fill={offWhite} />\n            </clipPath>\n          </defs>\n        </svg>\n      }\n      color=\"offWhite\"\n      disabled={disabled}\n    ></Button>\n  );\n};\n","import { Box, Button, ButtonType, Timeout } from \"grommet\";\nimport { useEffect, useRef } from \"react\";\nimport styled from \"styled-components\";\nimport { colorTheme } from \"../../theme\";\n\nexport function ShowMenuButton(props: {\n  setHasTimeoutElapsed: (arg0: boolean) => void;\n  setIsOpen: (arg0: boolean) => void;\n  isOpen: boolean;\n}) {\n  const timeout = useRef<Timeout>();\n  useEffect(() => {\n    return () => {\n      if (timeout.current) clearTimeout(timeout.current);\n      timeout.current = undefined;\n    };\n  });\n  return (\n    <Box align=\"center\" justify=\"center\">\n      <ThreeDotsMenuButton\n        isOpen={props.isOpen}\n        onMouseEnter={() => {\n          if (timeout.current) clearTimeout(timeout.current);\n          props.setHasTimeoutElapsed(false);\n          timeout.current = setTimeout(\n            () => props.setHasTimeoutElapsed(true),\n            4000\n          ) as unknown as Timeout;\n          props.setIsOpen(true);\n        }}\n        onClick={() => {\n          props.setIsOpen(!props.isOpen);\n        }}\n      />\n    </Box>\n  );\n}\n\nfunction ThreeDotsMenuButton({\n  isOpen,\n  ...buttonProps\n}: ButtonType & { isOpen: boolean }) {\n  return (\n    <Button\n      {...buttonProps}\n      plain\n      label={\n        <Box\n          width=\"64px\"\n          height=\"32px\"\n          direction=\"row\"\n          flex={false}\n          justify=\"between\"\n          align=\"center\"\n          style={{ pointerEvents: \"auto\" }}\n        >\n          <StyledDot\n            width=\"14px\"\n            height=\"14px\"\n            style={{ borderRadius: \"50%\", transition: \"background 0.6s\" }}\n            border={{ color: colorTheme.offWhite, size: \"2px\" }}\n            background={!isOpen ? colorTheme.yellow : \"none\"}\n          />\n          <StyledDot\n            width=\"14px\"\n            height=\"14px\"\n            style={{ borderRadius: \"50%\", transition: \"background 0.6s\" }}\n            border={{ color: colorTheme.offWhite, size: \"2px\" }}\n            background={!isOpen ? colorTheme.yellow : \"none\"}\n          />\n          <StyledDot\n            width=\"14px\"\n            height=\"14px\"\n            style={{ borderRadius: \"50%\", transition: \"background 0.6s\" }}\n            border={{ color: colorTheme.offWhite, size: \"2px\" }}\n            background={!isOpen ? colorTheme.yellow : \"none\"}\n          />\n        </Box>\n      }\n    />\n  );\n}\nconst StyledDot = styled(Box)`\n  box-shadow: 0px 0px 10.4167px rgba(0, 0, 0, 0.3);\n`;\n","import { Grid, ResponsiveContext } from \"grommet\";\nimport React, { useContext, useEffect, useState } from \"react\";\nimport { useLocation } from \"react-router\";\nimport { useIsActive } from \"../../hooks/useIsActive\";\nimport { usePageType } from \"../../hooks/usePageType\";\nimport { ChapterSelectDropdown } from \"./ChapterSelectDropdown\";\nimport { FadeOutBox } from \"./FadeOutBox\";\nimport { ModalButtons } from \"./ModalButtons\";\nimport { MuteButton } from \"./MuteButton\";\nimport { NextChapterButton } from \"./NextChapterButton\";\nimport { PlayPauseButton } from \"./PlayPauseButton\";\nimport { RewindButton } from \"./RewindButton\";\nimport { ShowMenuButton } from \"./ShowMenuButton\";\n\nexport const ControlButtonRow = ({\n  onOpenChange,\n}: {\n  onOpenChange: (isOpen: boolean) => void;\n}) => {\n  const isCover = usePageType() === \"cover\";\n  const size = useContext(ResponsiveContext);\n  const isSmall = size === \"small\";\n\n  const [isOpen, setIsOpen] = useState(true);\n  const [hasTimeoutElapsed, setHasTimeoutElapsed] = useState(true);\n  const isActive = useIsActive();\n\n  const location = useLocation();\n\n  useEffect(() => {\n    setIsOpen(false);\n  }, [location]);\n\n  useEffect(() => {\n    onOpenChange(isOpen);\n  }, [isOpen, onOpenChange]);\n\n  useEffect(() => {\n    if (isOpen && hasTimeoutElapsed && !isActive) {\n      setIsOpen(false);\n    }\n  }, [hasTimeoutElapsed, isActive, isOpen]);\n\n  return (\n    <Grid\n      fill=\"horizontal\"\n      rows={isSmall ? \"3\" : \"1\"}\n      columns={isSmall ? [\"flex\"] : [\"25%\", \"auto\", \"25%\"]}\n      pad={{ horizontal: \"16px\", top: \"0px\" }}\n      gap=\"20px\"\n    >\n      <FadeOutBox\n        isShown={isOpen}\n        flex={false}\n        justify={isSmall ? \"between\" : \"start\"}\n        direction=\"row\"\n        align=\"center\"\n        gap=\"20px\"\n        style={{ pointerEvents: !isOpen ? \"none\" : \"auto\" }}\n      >\n        <PlayPauseButton disabled={isCover} />\n        <MuteButton />\n        <RewindButton disabled={isCover} />\n        <NextChapterButton />\n        <ChapterSelectDropdown />\n      </FadeOutBox>\n\n      {isSmall && <ModalButtons isSmall={isSmall} isOpen={isOpen} />}\n      <ShowMenuButton\n        isOpen={isOpen}\n        setIsOpen={setIsOpen}\n        setHasTimeoutElapsed={setHasTimeoutElapsed}\n      />\n      {!isSmall && <ModalButtons isSmall={isSmall} isOpen={isOpen} />}\n    </Grid>\n  );\n};\n","import { Box } from \"grommet\";\nimport React, { useState } from \"react\";\nimport { ChapterIndicators } from \"./ChapterIndicators\";\nimport { ControlButtonRow } from \"./ControlButtonRow\";\nimport { FadeOutBox } from \"./FadeOutBox\";\n\nexport const Timeline = () => {\n  const [isOpen, setIsOpen] = useState(true);\n  return (\n    <Box\n      gap=\"8px\"\n      pad=\"16px\"\n      style={{\n        position: \"absolute\",\n        bottom: 0,\n        left: 0,\n        right: 0,\n        background: isOpen\n          ? \"linear-gradient(0deg, rgba(32, 33, 34, 0.5), rgba(32, 33, 34, 0.5))\"\n          : \"none\",\n        zIndex: 10,\n        pointerEvents: !isOpen ? \"none\" : \"auto\",\n      }}\n    >\n      <FadeOutBox\n        isShown={isOpen}\n        style={{ pointerEvents: !isOpen ? \"none\" : \"auto\" }}\n      >\n        <ChapterIndicators />\n      </FadeOutBox>\n      <ControlButtonRow onOpenChange={setIsOpen} />\n    </Box>\n  );\n};\n","import { Box, ResponsiveContext, Text } from \"grommet\";\nimport React, {\n  PropsWithChildren,\n  useContext,\n  useEffect,\n  useState,\n} from \"react\";\nimport styled from \"styled-components\";\nimport {\n  CameraIndicatorBox,\n  ChapterCameraIndicator,\n} from \"./CameraIndicator\";\nimport { ChapterAndCoverNextButton } from \"./ChapterAndCoverFinishedButton\";\nimport { Timeline } from \"./timeline/Timeline\";\nimport { useIsActive } from \"../hooks/useIsActive\";\nimport { useStore } from \"../store/store\";\nimport { colorTheme } from \"../theme\";\n\nexport const Media = ({ children }: PropsWithChildren<{}>) => {\n  return (\n    <FrameBox\n      fill=\"vertical\"\n      background=\"black\"\n      height={{ min: \"396px\" }}\n      style={{ position: \"relative\" }}\n      frameColor=\"yellow\"\n      align=\"center\"\n    >\n      {children}\n\n      <NextButton />\n      <Heading />\n      <Timeline />\n    </FrameBox>\n  );\n};\n\nfunction NextButton() {\n  const size = useContext(ResponsiveContext);\n  const isSmall = size === \"small\";\n  return (\n    <Box\n      style={{\n        position: \"absolute\",\n        top: isSmall ? \"69%\" : \"77%\",\n        right: 0,\n      }}\n    >\n      <ChapterAndCoverNextButton />\n    </Box>\n  );\n}\n\nfunction Heading() {\n  const isActive = useIsActive();\n  const isHeadingShown = useStore((state) => state.isHeadingShown);\n  const size = useContext(ResponsiveContext);\n  const isSmall = size === \"small\";\n\n  const isSmallOrMedium = isSmall || size === \"medium\";\n\n  return (\n    <Box\n      style={{\n        position: \"absolute\",\n        top: 0,\n        left: 0,\n        right: 0,\n        userSelect: \"none\",\n        pointerEvents: \"none\",\n      }}\n      direction=\"row\"\n      flex={false}\n      justify=\"between\"\n      align=\"start\"\n    >\n      <FadeOutBox\n        isShown={isHeadingShown && isActive}\n        background={\"yellow\"}\n        pad={{\n          horizontal: \"16px\",\n          vertical: \"12px\",\n        }}\n      >\n        {isSmallOrMedium && <WebcamNotification />}\n        <Text\n          size=\"24px\"\n          color={colorTheme.black}\n          style={{\n            lineHeight: \"100%\",\n          }}\n        >\n          Discriminator\n        </Text>\n      </FadeOutBox>\n      <Box justify=\"end\">\n        {isSmallOrMedium && <CameraIndicatorBox />}\n        {!isSmallOrMedium && <ChapterCameraIndicator />}\n      </Box>\n    </Box>\n  );\n}\n\nconst WebcamNotification = () => {\n  const [isShown, setIsShown] = useState(true);\n  useEffect(() => {\n    const timeout =\n      isShown &&\n      setTimeout(() => {\n        setIsShown(false);\n      }, 3000);\n    return () => {\n      timeout && clearTimeout(timeout);\n    };\n  }, [isShown]);\n\n  return (\n    <FadeOutBox\n      isShown={isShown}\n      flex={false}\n      style={{\n        position: \"absolute\",\n        minHeight: \"100%\",\n        top: 0,\n        left: 0,\n        right: 0,\n        zIndex: 1,\n      }}\n      background={\"black\"}\n      pad=\"10px\"\n      border={{ color: \"red\", size: \"3px\" }}\n    >\n      <Text size=\"xsmall\" color=\"offWhite\">\n        To make this sequence interactive, turn on your webcam\n      </Text>\n    </FadeOutBox>\n  );\n};\n\nconst FadeOutBox = styled(Box)<{ isShown: boolean }>`\n  opacity: ${(props) => (props.isShown ? \"1\" : \"0\")};\n  transition: opacity 0.6s;\n`;\n\nconst FrameBox = styled(Box)<{\n  frameColor: keyof typeof colorTheme;\n}>`\n  & {\n    position: relative;\n    height: 100%;\n  }\n  &:after {\n    outline-offset: -3px;\n    outline: 3px ${(props) => colorTheme[props.frameColor]} solid;\n    content: \"\";\n    position: absolute;\n    pointer-events: none;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n  }\n`;\n","import React, { useEffect } from \"react\";\nimport {\n  HashRouter,\n  Route,\n  RouteComponentProps,\n  RouteProps,\n  Switch,\n} from \"react-router-dom\";\nimport { PageContainer } from \"./components/PageContainer\";\nimport { Chapter } from \"./chapters/Chapters\";\nimport { Home } from \"./plain/Home\";\nimport { Permission } from \"./plain/Permission\";\nimport {\n  parseChapterNumber,\n  parsePageTypeQuery,\n  Routes,\n  validateChapterNumber,\n  validatePageTypeQuery,\n} from \"./Routes\";\nimport { Media } from \"./components/MediaContainer\";\n\nconst KnownRoute = (props: RouteProps & { path: Routes | Routes[] }) => (\n  <Route {...props} />\n);\n\nfunction App() {\n  return (\n    <HashRouter basename={\"/\"}>\n      <Switch>\n        <KnownRoute exact path={\"/\"}>\n          <PageContainer backgroundColor={\"yellow\"}>\n            <Home />\n          </PageContainer>\n        </KnownRoute>\n        <KnownRoute path={[\"/home\", \"/coil\"]}>\n          <PageContainer backgroundColor={\"yellow\"}>\n            <Home />\n          </PageContainer>\n        </KnownRoute>\n        <KnownRoute path={\"/permissions\"}>\n          <PageContainer backgroundColor={\"yellow\"}>\n            <Permission />\n          </PageContainer>\n        </KnownRoute>\n\n        <Route\n          path={\"/chapter/:chapterNumber\"}\n          render={(props) => (\n            <PageContainer backgroundColor=\"black\">\n              <ChapterRouter {...props} />\n            </PageContainer>\n          )}\n        ></Route>\n\n        <Route>Missing Route</Route>\n      </Switch>\n    </HashRouter>\n  );\n}\n\nconst ChapterRouter = ({ match, history, location }: RouteComponentProps) => {\n  const maybeChapterNumber = (match.params as any)[\"chapterNumber\"] as\n    | string\n    | undefined;\n\n  useEffect(() => {\n    const isValidChapterNumber = validateChapterNumber(maybeChapterNumber);\n    if (!isValidChapterNumber) {\n      history.replace(`/chapter/1?type=chapter`);\n      return;\n    }\n\n    const chapterNumber = parseChapterNumber(maybeChapterNumber);\n    const query = new URLSearchParams(location.search);\n    const isValidQuery = validatePageTypeQuery(query, chapterNumber);\n\n    if (!isValidQuery) {\n      history.replace(\n        `${match.url}?type=${chapterNumber === 1 ? \"chapter\" : \"cover\"}`\n      );\n      return;\n    }\n  }, [history, location.search, match.url, maybeChapterNumber]);\n\n  const isValidChapterNumber = validateChapterNumber(maybeChapterNumber);\n  if (!isValidChapterNumber) return null;\n  const chapterNumber = parseChapterNumber(maybeChapterNumber);\n  const query = new URLSearchParams(location.search);\n  const isValidQuery = validatePageTypeQuery(query, chapterNumber);\n\n  if (!isValidQuery) return null;\n\n  const type = parsePageTypeQuery(query, chapterNumber);\n  return (\n    <Media>\n      <Chapter isCover={type !== \"chapter\"} chapterNumber={chapterNumber} />\n    </Media>\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport App from \"./App\";\nimport \"./index.css\";\n\nimport * as WebFont from \"webfontloader\";\n\nWebFont.load({\n  custom: { families: [\"Roboto\"] },\n});\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}